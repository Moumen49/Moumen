function fT(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(e,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();function hT(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var x_={exports:{}},v0={},g_={exports:{}},nt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qc=Symbol.for("react.element"),mT=Symbol.for("react.portal"),pT=Symbol.for("react.fragment"),xT=Symbol.for("react.strict_mode"),gT=Symbol.for("react.profiler"),vT=Symbol.for("react.provider"),yT=Symbol.for("react.context"),wT=Symbol.for("react.forward_ref"),_T=Symbol.for("react.suspense"),bT=Symbol.for("react.memo"),kT=Symbol.for("react.lazy"),Ig=Symbol.iterator;function ST(e){return e===null||typeof e!="object"?null:(e=Ig&&e[Ig]||e["@@iterator"],typeof e=="function"?e:null)}var v_={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y_=Object.assign,w_={};function qo(e,t,r){this.props=e,this.context=t,this.refs=w_,this.updater=r||v_}qo.prototype.isReactComponent={};qo.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};qo.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function __(){}__.prototype=qo.prototype;function fp(e,t,r){this.props=e,this.context=t,this.refs=w_,this.updater=r||v_}var hp=fp.prototype=new __;hp.constructor=fp;y_(hp,qo.prototype);hp.isPureReactComponent=!0;var Lg=Array.isArray,b_=Object.prototype.hasOwnProperty,mp={current:null},k_={key:!0,ref:!0,__self:!0,__source:!0};function S_(e,t,r){var n,s={},a=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(a=""+t.key),t)b_.call(t,n)&&!k_.hasOwnProperty(n)&&(s[n]=t[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var c=Array(o),u=0;u<o;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:qc,type:e,key:a,ref:i,props:s,_owner:mp.current}}function ET(e,t){return{$$typeof:qc,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function pp(e){return typeof e=="object"&&e!==null&&e.$$typeof===qc}function NT(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Mg=/\/+/g;function df(e,t){return typeof e=="object"&&e!==null&&e.key!=null?NT(""+e.key):t.toString(36)}function Ju(e,t,r,n,s){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case qc:case mT:i=!0}}if(i)return i=e,s=s(i),e=n===""?"."+df(i,0):n,Lg(s)?(r="",e!=null&&(r=e.replace(Mg,"$&/")+"/"),Ju(s,t,r,"",function(u){return u})):s!=null&&(pp(s)&&(s=ET(s,r+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(Mg,"$&/")+"/")+e)),t.push(s)),1;if(i=0,n=n===""?".":n+":",Lg(e))for(var o=0;o<e.length;o++){a=e[o];var c=n+df(a,o);i+=Ju(a,t,r,c,s)}else if(c=ST(e),typeof c=="function")for(e=c.call(e),o=0;!(a=e.next()).done;)a=a.value,c=n+df(a,o++),i+=Ju(a,t,r,c,s);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function mu(e,t,r){if(e==null)return e;var n=[],s=0;return Ju(e,n,"","",function(a){return t.call(r,a,s++)}),n}function TT(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Hr={current:null},Qu={transition:null},CT={ReactCurrentDispatcher:Hr,ReactCurrentBatchConfig:Qu,ReactCurrentOwner:mp};function E_(){throw Error("act(...) is not supported in production builds of React.")}nt.Children={map:mu,forEach:function(e,t,r){mu(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return mu(e,function(){t++}),t},toArray:function(e){return mu(e,function(t){return t})||[]},only:function(e){if(!pp(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};nt.Component=qo;nt.Fragment=pT;nt.Profiler=gT;nt.PureComponent=fp;nt.StrictMode=xT;nt.Suspense=_T;nt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=CT;nt.act=E_;nt.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=y_({},e.props),s=e.key,a=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,i=mp.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)b_.call(t,c)&&!k_.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&o!==void 0?o[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){o=Array(c);for(var u=0;u<c;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:qc,type:e.type,key:s,ref:a,props:n,_owner:i}};nt.createContext=function(e){return e={$$typeof:yT,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:vT,_context:e},e.Consumer=e};nt.createElement=S_;nt.createFactory=function(e){var t=S_.bind(null,e);return t.type=e,t};nt.createRef=function(){return{current:null}};nt.forwardRef=function(e){return{$$typeof:wT,render:e}};nt.isValidElement=pp;nt.lazy=function(e){return{$$typeof:kT,_payload:{_status:-1,_result:e},_init:TT}};nt.memo=function(e,t){return{$$typeof:bT,type:e,compare:t===void 0?null:t}};nt.startTransition=function(e){var t=Qu.transition;Qu.transition={};try{e()}finally{Qu.transition=t}};nt.unstable_act=E_;nt.useCallback=function(e,t){return Hr.current.useCallback(e,t)};nt.useContext=function(e){return Hr.current.useContext(e)};nt.useDebugValue=function(){};nt.useDeferredValue=function(e){return Hr.current.useDeferredValue(e)};nt.useEffect=function(e,t){return Hr.current.useEffect(e,t)};nt.useId=function(){return Hr.current.useId()};nt.useImperativeHandle=function(e,t,r){return Hr.current.useImperativeHandle(e,t,r)};nt.useInsertionEffect=function(e,t){return Hr.current.useInsertionEffect(e,t)};nt.useLayoutEffect=function(e,t){return Hr.current.useLayoutEffect(e,t)};nt.useMemo=function(e,t){return Hr.current.useMemo(e,t)};nt.useReducer=function(e,t,r){return Hr.current.useReducer(e,t,r)};nt.useRef=function(e){return Hr.current.useRef(e)};nt.useState=function(e){return Hr.current.useState(e)};nt.useSyncExternalStore=function(e,t,r){return Hr.current.useSyncExternalStore(e,t,r)};nt.useTransition=function(){return Hr.current.useTransition()};nt.version="18.3.1";g_.exports=nt;var E=g_.exports;const N_=hT(E),jT=fT({__proto__:null,default:N_},[E]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AT=E,FT=Symbol.for("react.element"),PT=Symbol.for("react.fragment"),RT=Object.prototype.hasOwnProperty,OT=AT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,DT={key:!0,ref:!0,__self:!0,__source:!0};function T_(e,t,r){var n,s={},a=null,i=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)RT.call(t,n)&&!DT.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:FT,type:e,key:a,ref:i,props:s,_owner:OT.current}}v0.Fragment=PT;v0.jsx=T_;v0.jsxs=T_;x_.exports=v0;var l=x_.exports,Sh={},C_={exports:{}},Sn={},j_={exports:{}},A_={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(oe,W){var ue=oe.length;oe.push(W);e:for(;0<ue;){var ve=ue-1>>>1,F=oe[ve];if(0<s(F,W))oe[ve]=W,oe[ue]=F,ue=ve;else break e}}function r(oe){return oe.length===0?null:oe[0]}function n(oe){if(oe.length===0)return null;var W=oe[0],ue=oe.pop();if(ue!==W){oe[0]=ue;e:for(var ve=0,F=oe.length,H=F>>>1;ve<H;){var D=2*(ve+1)-1,z=oe[D],B=D+1,ne=oe[B];if(0>s(z,ue))B<F&&0>s(ne,z)?(oe[ve]=ne,oe[B]=ue,ve=B):(oe[ve]=z,oe[D]=ue,ve=D);else if(B<F&&0>s(ne,ue))oe[ve]=ne,oe[B]=ue,ve=B;else break e}}return W}function s(oe,W){var ue=oe.sortIndex-W.sortIndex;return ue!==0?ue:oe.id-W.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var c=[],u=[],d=1,f=null,h=3,m=!1,x=!1,p=!1,g=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(oe){for(var W=r(u);W!==null;){if(W.callback===null)n(u);else if(W.startTime<=oe)n(u),W.sortIndex=W.expirationTime,t(c,W);else break;W=r(u)}}function _(oe){if(p=!1,v(oe),!x)if(r(c)!==null)x=!0,se(S);else{var W=r(u);W!==null&&ie(_,W.startTime-oe)}}function S(oe,W){x=!1,p&&(p=!1,y(T),T=-1),m=!0;var ue=h;try{for(v(W),f=r(c);f!==null&&(!(f.expirationTime>W)||oe&&!C());){var ve=f.callback;if(typeof ve=="function"){f.callback=null,h=f.priorityLevel;var F=ve(f.expirationTime<=W);W=e.unstable_now(),typeof F=="function"?f.callback=F:f===r(c)&&n(c),v(W)}else n(c);f=r(c)}if(f!==null)var H=!0;else{var D=r(u);D!==null&&ie(_,D.startTime-W),H=!1}return H}finally{f=null,h=ue,m=!1}}var b=!1,k=null,T=-1,j=5,V=-1;function C(){return!(e.unstable_now()-V<j)}function R(){if(k!==null){var oe=e.unstable_now();V=oe;var W=!0;try{W=k(!0,oe)}finally{W?X():(b=!1,k=null)}}else b=!1}var X;if(typeof w=="function")X=function(){w(R)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,Y=G.port2;G.port1.onmessage=R,X=function(){Y.postMessage(null)}}else X=function(){g(R,0)};function se(oe){k=oe,b||(b=!0,X())}function ie(oe,W){T=g(function(){oe(e.unstable_now())},W)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(oe){oe.callback=null},e.unstable_continueExecution=function(){x||m||(x=!0,se(S))},e.unstable_forceFrameRate=function(oe){0>oe||125<oe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<oe?Math.floor(1e3/oe):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(oe){switch(h){case 1:case 2:case 3:var W=3;break;default:W=h}var ue=h;h=W;try{return oe()}finally{h=ue}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(oe,W){switch(oe){case 1:case 2:case 3:case 4:case 5:break;default:oe=3}var ue=h;h=oe;try{return W()}finally{h=ue}},e.unstable_scheduleCallback=function(oe,W,ue){var ve=e.unstable_now();switch(typeof ue=="object"&&ue!==null?(ue=ue.delay,ue=typeof ue=="number"&&0<ue?ve+ue:ve):ue=ve,oe){case 1:var F=-1;break;case 2:F=250;break;case 5:F=1073741823;break;case 4:F=1e4;break;default:F=5e3}return F=ue+F,oe={id:d++,callback:W,priorityLevel:oe,startTime:ue,expirationTime:F,sortIndex:-1},ue>ve?(oe.sortIndex=ue,t(u,oe),r(c)===null&&oe===r(u)&&(p?(y(T),T=-1):p=!0,ie(_,ue-ve))):(oe.sortIndex=F,t(c,oe),x||m||(x=!0,se(S))),oe},e.unstable_shouldYield=C,e.unstable_wrapCallback=function(oe){var W=h;return function(){var ue=h;h=W;try{return oe.apply(this,arguments)}finally{h=ue}}}})(A_);j_.exports=A_;var IT=j_.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var LT=E,_n=IT;function ge(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var F_=new Set,sc={};function Ei(e,t){Po(e,t),Po(e+"Capture",t)}function Po(e,t){for(sc[e]=t,e=0;e<t.length;e++)F_.add(t[e])}var Bs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Eh=Object.prototype.hasOwnProperty,MT=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Bg={},Ug={};function BT(e){return Eh.call(Ug,e)?!0:Eh.call(Bg,e)?!1:MT.test(e)?Ug[e]=!0:(Bg[e]=!0,!1)}function UT(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function VT(e,t,r,n){if(t===null||typeof t>"u"||UT(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Gr(e,t,r,n,s,a,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=i}var kr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){kr[e]=new Gr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];kr[t]=new Gr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){kr[e]=new Gr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){kr[e]=new Gr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){kr[e]=new Gr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){kr[e]=new Gr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){kr[e]=new Gr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){kr[e]=new Gr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){kr[e]=new Gr(e,5,!1,e.toLowerCase(),null,!1,!1)});var xp=/[\-:]([a-z])/g;function gp(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(xp,gp);kr[t]=new Gr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(xp,gp);kr[t]=new Gr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(xp,gp);kr[t]=new Gr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){kr[e]=new Gr(e,1,!1,e.toLowerCase(),null,!1,!1)});kr.xlinkHref=new Gr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){kr[e]=new Gr(e,1,!1,e.toLowerCase(),null,!0,!0)});function vp(e,t,r,n){var s=kr.hasOwnProperty(t)?kr[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(VT(t,r,s,n)&&(r=null),n||s===null?BT(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Ks=LT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,pu=Symbol.for("react.element"),Zi=Symbol.for("react.portal"),eo=Symbol.for("react.fragment"),yp=Symbol.for("react.strict_mode"),Nh=Symbol.for("react.profiler"),P_=Symbol.for("react.provider"),R_=Symbol.for("react.context"),wp=Symbol.for("react.forward_ref"),Th=Symbol.for("react.suspense"),Ch=Symbol.for("react.suspense_list"),_p=Symbol.for("react.memo"),na=Symbol.for("react.lazy"),O_=Symbol.for("react.offscreen"),Vg=Symbol.iterator;function ul(e){return e===null||typeof e!="object"?null:(e=Vg&&e[Vg]||e["@@iterator"],typeof e=="function"?e:null)}var Dt=Object.assign,ff;function wl(e){if(ff===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);ff=t&&t[1]||""}return`
`+ff+e}var hf=!1;function mf(e,t){if(!e||hf)return"";hf=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),a=n.stack.split(`
`),i=s.length-1,o=a.length-1;1<=i&&0<=o&&s[i]!==a[o];)o--;for(;1<=i&&0<=o;i--,o--)if(s[i]!==a[o]){if(i!==1||o!==1)do if(i--,o--,0>o||s[i]!==a[o]){var c=`
`+s[i].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=i&&0<=o);break}}}finally{hf=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?wl(e):""}function $T(e){switch(e.tag){case 5:return wl(e.type);case 16:return wl("Lazy");case 13:return wl("Suspense");case 19:return wl("SuspenseList");case 0:case 2:case 15:return e=mf(e.type,!1),e;case 11:return e=mf(e.type.render,!1),e;case 1:return e=mf(e.type,!0),e;default:return""}}function jh(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case eo:return"Fragment";case Zi:return"Portal";case Nh:return"Profiler";case yp:return"StrictMode";case Th:return"Suspense";case Ch:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case R_:return(e.displayName||"Context")+".Consumer";case P_:return(e._context.displayName||"Context")+".Provider";case wp:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case _p:return t=e.displayName||null,t!==null?t:jh(e.type)||"Memo";case na:t=e._payload,e=e._init;try{return jh(e(t))}catch{}}return null}function zT(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return jh(t);case 8:return t===yp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ka(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function D_(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function WT(e){var t=D_(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(i){n=""+i,a.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function xu(e){e._valueTracker||(e._valueTracker=WT(e))}function I_(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=D_(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function hd(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Ah(e,t){var r=t.checked;return Dt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function $g(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=ka(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function L_(e,t){t=t.checked,t!=null&&vp(e,"checked",t,!1)}function Fh(e,t){L_(e,t);var r=ka(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Ph(e,t.type,r):t.hasOwnProperty("defaultValue")&&Ph(e,t.type,ka(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function zg(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Ph(e,t,r){(t!=="number"||hd(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var _l=Array.isArray;function wo(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+ka(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Rh(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ge(91));return Dt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Wg(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(ge(92));if(_l(r)){if(1<r.length)throw Error(ge(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:ka(r)}}function M_(e,t){var r=ka(t.value),n=ka(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Hg(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function B_(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Oh(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?B_(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var gu,U_=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(gu=gu||document.createElement("div"),gu.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=gu.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ac(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Fl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},HT=["Webkit","ms","Moz","O"];Object.keys(Fl).forEach(function(e){HT.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Fl[t]=Fl[e]})});function V_(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Fl.hasOwnProperty(e)&&Fl[e]?(""+t).trim():t+"px"}function $_(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=V_(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var GT=Dt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Dh(e,t){if(t){if(GT[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ge(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ge(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ge(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ge(62))}}function Ih(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Lh=null;function bp(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Mh=null,_o=null,bo=null;function Gg(e){if(e=Qc(e)){if(typeof Mh!="function")throw Error(ge(280));var t=e.stateNode;t&&(t=k0(t),Mh(e.stateNode,e.type,t))}}function z_(e){_o?bo?bo.push(e):bo=[e]:_o=e}function W_(){if(_o){var e=_o,t=bo;if(bo=_o=null,Gg(e),t)for(e=0;e<t.length;e++)Gg(t[e])}}function H_(e,t){return e(t)}function G_(){}var pf=!1;function K_(e,t,r){if(pf)return e(t,r);pf=!0;try{return H_(e,t,r)}finally{pf=!1,(_o!==null||bo!==null)&&(G_(),W_())}}function ic(e,t){var r=e.stateNode;if(r===null)return null;var n=k0(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(ge(231,t,typeof r));return r}var Bh=!1;if(Bs)try{var dl={};Object.defineProperty(dl,"passive",{get:function(){Bh=!0}}),window.addEventListener("test",dl,dl),window.removeEventListener("test",dl,dl)}catch{Bh=!1}function KT(e,t,r,n,s,a,i,o,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var Pl=!1,md=null,pd=!1,Uh=null,XT={onError:function(e){Pl=!0,md=e}};function qT(e,t,r,n,s,a,i,o,c){Pl=!1,md=null,KT.apply(XT,arguments)}function YT(e,t,r,n,s,a,i,o,c){if(qT.apply(this,arguments),Pl){if(Pl){var u=md;Pl=!1,md=null}else throw Error(ge(198));pd||(pd=!0,Uh=u)}}function Ni(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function X_(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Kg(e){if(Ni(e)!==e)throw Error(ge(188))}function JT(e){var t=e.alternate;if(!t){if(t=Ni(e),t===null)throw Error(ge(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var a=s.alternate;if(a===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===r)return Kg(s),e;if(a===n)return Kg(s),t;a=a.sibling}throw Error(ge(188))}if(r.return!==n.return)r=s,n=a;else{for(var i=!1,o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i){for(o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i)throw Error(ge(189))}}if(r.alternate!==n)throw Error(ge(190))}if(r.tag!==3)throw Error(ge(188));return r.stateNode.current===r?e:t}function q_(e){return e=JT(e),e!==null?Y_(e):null}function Y_(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Y_(e);if(t!==null)return t;e=e.sibling}return null}var J_=_n.unstable_scheduleCallback,Xg=_n.unstable_cancelCallback,QT=_n.unstable_shouldYield,ZT=_n.unstable_requestPaint,Kt=_n.unstable_now,e4=_n.unstable_getCurrentPriorityLevel,kp=_n.unstable_ImmediatePriority,Q_=_n.unstable_UserBlockingPriority,xd=_n.unstable_NormalPriority,t4=_n.unstable_LowPriority,Z_=_n.unstable_IdlePriority,y0=null,gs=null;function r4(e){if(gs&&typeof gs.onCommitFiberRoot=="function")try{gs.onCommitFiberRoot(y0,e,void 0,(e.current.flags&128)===128)}catch{}}var ns=Math.clz32?Math.clz32:a4,n4=Math.log,s4=Math.LN2;function a4(e){return e>>>=0,e===0?32:31-(n4(e)/s4|0)|0}var vu=64,yu=4194304;function bl(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function gd(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,a=e.pingedLanes,i=r&268435455;if(i!==0){var o=i&~s;o!==0?n=bl(o):(a&=i,a!==0&&(n=bl(a)))}else i=r&~s,i!==0?n=bl(i):a!==0&&(n=bl(a));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,a=t&-t,s>=a||s===16&&(a&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-ns(t),s=1<<r,n|=e[r],t&=~s;return n}function i4(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function o4(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-ns(a),o=1<<i,c=s[i];c===-1?(!(o&r)||o&n)&&(s[i]=i4(o,t)):c<=t&&(e.expiredLanes|=o),a&=~o}}function Vh(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function e2(){var e=vu;return vu<<=1,!(vu&4194240)&&(vu=64),e}function xf(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Yc(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-ns(t),e[t]=r}function l4(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-ns(r),a=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~a}}function Sp(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-ns(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var ht=0;function t2(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var r2,Ep,n2,s2,a2,$h=!1,wu=[],ma=null,pa=null,xa=null,oc=new Map,lc=new Map,ia=[],c4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function qg(e,t){switch(e){case"focusin":case"focusout":ma=null;break;case"dragenter":case"dragleave":pa=null;break;case"mouseover":case"mouseout":xa=null;break;case"pointerover":case"pointerout":oc.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":lc.delete(t.pointerId)}}function fl(e,t,r,n,s,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[s]},t!==null&&(t=Qc(t),t!==null&&Ep(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function u4(e,t,r,n,s){switch(t){case"focusin":return ma=fl(ma,e,t,r,n,s),!0;case"dragenter":return pa=fl(pa,e,t,r,n,s),!0;case"mouseover":return xa=fl(xa,e,t,r,n,s),!0;case"pointerover":var a=s.pointerId;return oc.set(a,fl(oc.get(a)||null,e,t,r,n,s)),!0;case"gotpointercapture":return a=s.pointerId,lc.set(a,fl(lc.get(a)||null,e,t,r,n,s)),!0}return!1}function i2(e){var t=Qa(e.target);if(t!==null){var r=Ni(t);if(r!==null){if(t=r.tag,t===13){if(t=X_(r),t!==null){e.blockedOn=t,a2(e.priority,function(){n2(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Zu(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=zh(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Lh=n,r.target.dispatchEvent(n),Lh=null}else return t=Qc(r),t!==null&&Ep(t),e.blockedOn=r,!1;t.shift()}return!0}function Yg(e,t,r){Zu(e)&&r.delete(t)}function d4(){$h=!1,ma!==null&&Zu(ma)&&(ma=null),pa!==null&&Zu(pa)&&(pa=null),xa!==null&&Zu(xa)&&(xa=null),oc.forEach(Yg),lc.forEach(Yg)}function hl(e,t){e.blockedOn===t&&(e.blockedOn=null,$h||($h=!0,_n.unstable_scheduleCallback(_n.unstable_NormalPriority,d4)))}function cc(e){function t(s){return hl(s,e)}if(0<wu.length){hl(wu[0],e);for(var r=1;r<wu.length;r++){var n=wu[r];n.blockedOn===e&&(n.blockedOn=null)}}for(ma!==null&&hl(ma,e),pa!==null&&hl(pa,e),xa!==null&&hl(xa,e),oc.forEach(t),lc.forEach(t),r=0;r<ia.length;r++)n=ia[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<ia.length&&(r=ia[0],r.blockedOn===null);)i2(r),r.blockedOn===null&&ia.shift()}var ko=Ks.ReactCurrentBatchConfig,vd=!0;function f4(e,t,r,n){var s=ht,a=ko.transition;ko.transition=null;try{ht=1,Np(e,t,r,n)}finally{ht=s,ko.transition=a}}function h4(e,t,r,n){var s=ht,a=ko.transition;ko.transition=null;try{ht=4,Np(e,t,r,n)}finally{ht=s,ko.transition=a}}function Np(e,t,r,n){if(vd){var s=zh(e,t,r,n);if(s===null)Nf(e,t,n,yd,r),qg(e,n);else if(u4(s,e,t,r,n))n.stopPropagation();else if(qg(e,n),t&4&&-1<c4.indexOf(e)){for(;s!==null;){var a=Qc(s);if(a!==null&&r2(a),a=zh(e,t,r,n),a===null&&Nf(e,t,n,yd,r),a===s)break;s=a}s!==null&&n.stopPropagation()}else Nf(e,t,n,null,r)}}var yd=null;function zh(e,t,r,n){if(yd=null,e=bp(n),e=Qa(e),e!==null)if(t=Ni(e),t===null)e=null;else if(r=t.tag,r===13){if(e=X_(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return yd=e,null}function o2(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(e4()){case kp:return 1;case Q_:return 4;case xd:case t4:return 16;case Z_:return 536870912;default:return 16}default:return 16}}var ca=null,Tp=null,ed=null;function l2(){if(ed)return ed;var e,t=Tp,r=t.length,n,s="value"in ca?ca.value:ca.textContent,a=s.length;for(e=0;e<r&&t[e]===s[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===s[a-n];n++);return ed=s.slice(e,1<n?1-n:void 0)}function td(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function _u(){return!0}function Jg(){return!1}function En(e){function t(r,n,s,a,i){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?_u:Jg,this.isPropagationStopped=Jg,this}return Dt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=_u)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=_u)},persist:function(){},isPersistent:_u}),t}var Yo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Cp=En(Yo),Jc=Dt({},Yo,{view:0,detail:0}),m4=En(Jc),gf,vf,ml,w0=Dt({},Jc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:jp,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ml&&(ml&&e.type==="mousemove"?(gf=e.screenX-ml.screenX,vf=e.screenY-ml.screenY):vf=gf=0,ml=e),gf)},movementY:function(e){return"movementY"in e?e.movementY:vf}}),Qg=En(w0),p4=Dt({},w0,{dataTransfer:0}),x4=En(p4),g4=Dt({},Jc,{relatedTarget:0}),yf=En(g4),v4=Dt({},Yo,{animationName:0,elapsedTime:0,pseudoElement:0}),y4=En(v4),w4=Dt({},Yo,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),_4=En(w4),b4=Dt({},Yo,{data:0}),Zg=En(b4),k4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},S4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},E4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function N4(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=E4[e])?!!t[e]:!1}function jp(){return N4}var T4=Dt({},Jc,{key:function(e){if(e.key){var t=k4[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=td(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?S4[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:jp,charCode:function(e){return e.type==="keypress"?td(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?td(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),C4=En(T4),j4=Dt({},w0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),e1=En(j4),A4=Dt({},Jc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:jp}),F4=En(A4),P4=Dt({},Yo,{propertyName:0,elapsedTime:0,pseudoElement:0}),R4=En(P4),O4=Dt({},w0,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),D4=En(O4),I4=[9,13,27,32],Ap=Bs&&"CompositionEvent"in window,Rl=null;Bs&&"documentMode"in document&&(Rl=document.documentMode);var L4=Bs&&"TextEvent"in window&&!Rl,c2=Bs&&(!Ap||Rl&&8<Rl&&11>=Rl),t1=" ",r1=!1;function u2(e,t){switch(e){case"keyup":return I4.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function d2(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var to=!1;function M4(e,t){switch(e){case"compositionend":return d2(t);case"keypress":return t.which!==32?null:(r1=!0,t1);case"textInput":return e=t.data,e===t1&&r1?null:e;default:return null}}function B4(e,t){if(to)return e==="compositionend"||!Ap&&u2(e,t)?(e=l2(),ed=Tp=ca=null,to=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return c2&&t.locale!=="ko"?null:t.data;default:return null}}var U4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function n1(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!U4[e.type]:t==="textarea"}function f2(e,t,r,n){z_(n),t=wd(t,"onChange"),0<t.length&&(r=new Cp("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Ol=null,uc=null;function V4(e){k2(e,0)}function _0(e){var t=so(e);if(I_(t))return e}function $4(e,t){if(e==="change")return t}var h2=!1;if(Bs){var wf;if(Bs){var _f="oninput"in document;if(!_f){var s1=document.createElement("div");s1.setAttribute("oninput","return;"),_f=typeof s1.oninput=="function"}wf=_f}else wf=!1;h2=wf&&(!document.documentMode||9<document.documentMode)}function a1(){Ol&&(Ol.detachEvent("onpropertychange",m2),uc=Ol=null)}function m2(e){if(e.propertyName==="value"&&_0(uc)){var t=[];f2(t,uc,e,bp(e)),K_(V4,t)}}function z4(e,t,r){e==="focusin"?(a1(),Ol=t,uc=r,Ol.attachEvent("onpropertychange",m2)):e==="focusout"&&a1()}function W4(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return _0(uc)}function H4(e,t){if(e==="click")return _0(t)}function G4(e,t){if(e==="input"||e==="change")return _0(t)}function K4(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var os=typeof Object.is=="function"?Object.is:K4;function dc(e,t){if(os(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Eh.call(t,s)||!os(e[s],t[s]))return!1}return!0}function i1(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function o1(e,t){var r=i1(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=i1(r)}}function p2(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?p2(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function x2(){for(var e=window,t=hd();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=hd(e.document)}return t}function Fp(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function X4(e){var t=x2(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&p2(r.ownerDocument.documentElement,r)){if(n!==null&&Fp(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,a=Math.min(n.start,s);n=n.end===void 0?a:Math.min(n.end,s),!e.extend&&a>n&&(s=n,n=a,a=s),s=o1(r,a);var i=o1(r,n);s&&i&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var q4=Bs&&"documentMode"in document&&11>=document.documentMode,ro=null,Wh=null,Dl=null,Hh=!1;function l1(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Hh||ro==null||ro!==hd(n)||(n=ro,"selectionStart"in n&&Fp(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Dl&&dc(Dl,n)||(Dl=n,n=wd(Wh,"onSelect"),0<n.length&&(t=new Cp("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=ro)))}function bu(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var no={animationend:bu("Animation","AnimationEnd"),animationiteration:bu("Animation","AnimationIteration"),animationstart:bu("Animation","AnimationStart"),transitionend:bu("Transition","TransitionEnd")},bf={},g2={};Bs&&(g2=document.createElement("div").style,"AnimationEvent"in window||(delete no.animationend.animation,delete no.animationiteration.animation,delete no.animationstart.animation),"TransitionEvent"in window||delete no.transitionend.transition);function b0(e){if(bf[e])return bf[e];if(!no[e])return e;var t=no[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in g2)return bf[e]=t[r];return e}var v2=b0("animationend"),y2=b0("animationiteration"),w2=b0("animationstart"),_2=b0("transitionend"),b2=new Map,c1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Aa(e,t){b2.set(e,t),Ei(t,[e])}for(var kf=0;kf<c1.length;kf++){var Sf=c1[kf],Y4=Sf.toLowerCase(),J4=Sf[0].toUpperCase()+Sf.slice(1);Aa(Y4,"on"+J4)}Aa(v2,"onAnimationEnd");Aa(y2,"onAnimationIteration");Aa(w2,"onAnimationStart");Aa("dblclick","onDoubleClick");Aa("focusin","onFocus");Aa("focusout","onBlur");Aa(_2,"onTransitionEnd");Po("onMouseEnter",["mouseout","mouseover"]);Po("onMouseLeave",["mouseout","mouseover"]);Po("onPointerEnter",["pointerout","pointerover"]);Po("onPointerLeave",["pointerout","pointerover"]);Ei("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ei("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ei("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ei("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ei("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ei("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var kl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Q4=new Set("cancel close invalid load scroll toggle".split(" ").concat(kl));function u1(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,YT(n,t,void 0,e),e.currentTarget=null}function k2(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],c=o.instance,u=o.currentTarget;if(o=o.listener,c!==a&&s.isPropagationStopped())break e;u1(s,o,u),a=c}else for(i=0;i<n.length;i++){if(o=n[i],c=o.instance,u=o.currentTarget,o=o.listener,c!==a&&s.isPropagationStopped())break e;u1(s,o,u),a=c}}}if(pd)throw e=Uh,pd=!1,Uh=null,e}function yt(e,t){var r=t[Yh];r===void 0&&(r=t[Yh]=new Set);var n=e+"__bubble";r.has(n)||(S2(t,e,2,!1),r.add(n))}function Ef(e,t,r){var n=0;t&&(n|=4),S2(r,e,n,t)}var ku="_reactListening"+Math.random().toString(36).slice(2);function fc(e){if(!e[ku]){e[ku]=!0,F_.forEach(function(r){r!=="selectionchange"&&(Q4.has(r)||Ef(r,!1,e),Ef(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[ku]||(t[ku]=!0,Ef("selectionchange",!1,t))}}function S2(e,t,r,n){switch(o2(t)){case 1:var s=f4;break;case 4:s=h4;break;default:s=Np}r=s.bind(null,t,r,e),s=void 0,!Bh||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function Nf(e,t,r,n,s){var a=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(i===4)for(i=n.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;i=i.return}for(;o!==null;){if(i=Qa(o),i===null)return;if(c=i.tag,c===5||c===6){n=a=i;continue e}o=o.parentNode}}n=n.return}K_(function(){var u=a,d=bp(r),f=[];e:{var h=b2.get(e);if(h!==void 0){var m=Cp,x=e;switch(e){case"keypress":if(td(r)===0)break e;case"keydown":case"keyup":m=C4;break;case"focusin":x="focus",m=yf;break;case"focusout":x="blur",m=yf;break;case"beforeblur":case"afterblur":m=yf;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Qg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=x4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=F4;break;case v2:case y2:case w2:m=y4;break;case _2:m=R4;break;case"scroll":m=m4;break;case"wheel":m=D4;break;case"copy":case"cut":case"paste":m=_4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=e1}var p=(t&4)!==0,g=!p&&e==="scroll",y=p?h!==null?h+"Capture":null:h;p=[];for(var w=u,v;w!==null;){v=w;var _=v.stateNode;if(v.tag===5&&_!==null&&(v=_,y!==null&&(_=ic(w,y),_!=null&&p.push(hc(w,_,v)))),g)break;w=w.return}0<p.length&&(h=new m(h,x,null,r,d),f.push({event:h,listeners:p}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",h&&r!==Lh&&(x=r.relatedTarget||r.fromElement)&&(Qa(x)||x[Us]))break e;if((m||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,m?(x=r.relatedTarget||r.toElement,m=u,x=x?Qa(x):null,x!==null&&(g=Ni(x),x!==g||x.tag!==5&&x.tag!==6)&&(x=null)):(m=null,x=u),m!==x)){if(p=Qg,_="onMouseLeave",y="onMouseEnter",w="mouse",(e==="pointerout"||e==="pointerover")&&(p=e1,_="onPointerLeave",y="onPointerEnter",w="pointer"),g=m==null?h:so(m),v=x==null?h:so(x),h=new p(_,w+"leave",m,r,d),h.target=g,h.relatedTarget=v,_=null,Qa(d)===u&&(p=new p(y,w+"enter",x,r,d),p.target=v,p.relatedTarget=g,_=p),g=_,m&&x)t:{for(p=m,y=x,w=0,v=p;v;v=Bi(v))w++;for(v=0,_=y;_;_=Bi(_))v++;for(;0<w-v;)p=Bi(p),w--;for(;0<v-w;)y=Bi(y),v--;for(;w--;){if(p===y||y!==null&&p===y.alternate)break t;p=Bi(p),y=Bi(y)}p=null}else p=null;m!==null&&d1(f,h,m,p,!1),x!==null&&g!==null&&d1(f,g,x,p,!0)}}e:{if(h=u?so(u):window,m=h.nodeName&&h.nodeName.toLowerCase(),m==="select"||m==="input"&&h.type==="file")var S=$4;else if(n1(h))if(h2)S=G4;else{S=W4;var b=z4}else(m=h.nodeName)&&m.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(S=H4);if(S&&(S=S(e,u))){f2(f,S,r,d);break e}b&&b(e,h,u),e==="focusout"&&(b=h._wrapperState)&&b.controlled&&h.type==="number"&&Ph(h,"number",h.value)}switch(b=u?so(u):window,e){case"focusin":(n1(b)||b.contentEditable==="true")&&(ro=b,Wh=u,Dl=null);break;case"focusout":Dl=Wh=ro=null;break;case"mousedown":Hh=!0;break;case"contextmenu":case"mouseup":case"dragend":Hh=!1,l1(f,r,d);break;case"selectionchange":if(q4)break;case"keydown":case"keyup":l1(f,r,d)}var k;if(Ap)e:{switch(e){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else to?u2(e,r)&&(T="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(T="onCompositionStart");T&&(c2&&r.locale!=="ko"&&(to||T!=="onCompositionStart"?T==="onCompositionEnd"&&to&&(k=l2()):(ca=d,Tp="value"in ca?ca.value:ca.textContent,to=!0)),b=wd(u,T),0<b.length&&(T=new Zg(T,e,null,r,d),f.push({event:T,listeners:b}),k?T.data=k:(k=d2(r),k!==null&&(T.data=k)))),(k=L4?M4(e,r):B4(e,r))&&(u=wd(u,"onBeforeInput"),0<u.length&&(d=new Zg("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=k))}k2(f,t)})}function hc(e,t,r){return{instance:e,listener:t,currentTarget:r}}function wd(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=ic(e,r),a!=null&&n.unshift(hc(e,a,s)),a=ic(e,t),a!=null&&n.push(hc(e,a,s))),e=e.return}return n}function Bi(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function d1(e,t,r,n,s){for(var a=t._reactName,i=[];r!==null&&r!==n;){var o=r,c=o.alternate,u=o.stateNode;if(c!==null&&c===n)break;o.tag===5&&u!==null&&(o=u,s?(c=ic(r,a),c!=null&&i.unshift(hc(r,c,o))):s||(c=ic(r,a),c!=null&&i.push(hc(r,c,o)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var Z4=/\r\n?/g,eC=/\u0000|\uFFFD/g;function f1(e){return(typeof e=="string"?e:""+e).replace(Z4,`
`).replace(eC,"")}function Su(e,t,r){if(t=f1(t),f1(e)!==t&&r)throw Error(ge(425))}function _d(){}var Gh=null,Kh=null;function Xh(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var qh=typeof setTimeout=="function"?setTimeout:void 0,tC=typeof clearTimeout=="function"?clearTimeout:void 0,h1=typeof Promise=="function"?Promise:void 0,rC=typeof queueMicrotask=="function"?queueMicrotask:typeof h1<"u"?function(e){return h1.resolve(null).then(e).catch(nC)}:qh;function nC(e){setTimeout(function(){throw e})}function Tf(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),cc(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);cc(t)}function ga(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function m1(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Jo=Math.random().toString(36).slice(2),ps="__reactFiber$"+Jo,mc="__reactProps$"+Jo,Us="__reactContainer$"+Jo,Yh="__reactEvents$"+Jo,sC="__reactListeners$"+Jo,aC="__reactHandles$"+Jo;function Qa(e){var t=e[ps];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Us]||r[ps]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=m1(e);e!==null;){if(r=e[ps])return r;e=m1(e)}return t}e=r,r=e.parentNode}return null}function Qc(e){return e=e[ps]||e[Us],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function so(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ge(33))}function k0(e){return e[mc]||null}var Jh=[],ao=-1;function Fa(e){return{current:e}}function _t(e){0>ao||(e.current=Jh[ao],Jh[ao]=null,ao--)}function gt(e,t){ao++,Jh[ao]=e.current,e.current=t}var Sa={},Lr=Fa(Sa),Zr=Fa(!1),fi=Sa;function Ro(e,t){var r=e.type.contextTypes;if(!r)return Sa;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in r)s[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function en(e){return e=e.childContextTypes,e!=null}function bd(){_t(Zr),_t(Lr)}function p1(e,t,r){if(Lr.current!==Sa)throw Error(ge(168));gt(Lr,t),gt(Zr,r)}function E2(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(ge(108,zT(e)||"Unknown",s));return Dt({},r,n)}function kd(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Sa,fi=Lr.current,gt(Lr,e),gt(Zr,Zr.current),!0}function x1(e,t,r){var n=e.stateNode;if(!n)throw Error(ge(169));r?(e=E2(e,t,fi),n.__reactInternalMemoizedMergedChildContext=e,_t(Zr),_t(Lr),gt(Lr,e)):_t(Zr),gt(Zr,r)}var Ts=null,S0=!1,Cf=!1;function N2(e){Ts===null?Ts=[e]:Ts.push(e)}function iC(e){S0=!0,N2(e)}function Pa(){if(!Cf&&Ts!==null){Cf=!0;var e=0,t=ht;try{var r=Ts;for(ht=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Ts=null,S0=!1}catch(s){throw Ts!==null&&(Ts=Ts.slice(e+1)),J_(kp,Pa),s}finally{ht=t,Cf=!1}}return null}var io=[],oo=0,Sd=null,Ed=0,In=[],Ln=0,hi=null,js=1,As="";function Wa(e,t){io[oo++]=Ed,io[oo++]=Sd,Sd=e,Ed=t}function T2(e,t,r){In[Ln++]=js,In[Ln++]=As,In[Ln++]=hi,hi=e;var n=js;e=As;var s=32-ns(n)-1;n&=~(1<<s),r+=1;var a=32-ns(t)+s;if(30<a){var i=s-s%5;a=(n&(1<<i)-1).toString(32),n>>=i,s-=i,js=1<<32-ns(t)+s|r<<s|n,As=a+e}else js=1<<a|r<<s|n,As=e}function Pp(e){e.return!==null&&(Wa(e,1),T2(e,1,0))}function Rp(e){for(;e===Sd;)Sd=io[--oo],io[oo]=null,Ed=io[--oo],io[oo]=null;for(;e===hi;)hi=In[--Ln],In[Ln]=null,As=In[--Ln],In[Ln]=null,js=In[--Ln],In[Ln]=null}var yn=null,gn=null,St=!1,es=null;function C2(e,t){var r=Mn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function g1(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,yn=e,gn=ga(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,yn=e,gn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=hi!==null?{id:js,overflow:As}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Mn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,yn=e,gn=null,!0):!1;default:return!1}}function Qh(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Zh(e){if(St){var t=gn;if(t){var r=t;if(!g1(e,t)){if(Qh(e))throw Error(ge(418));t=ga(r.nextSibling);var n=yn;t&&g1(e,t)?C2(n,r):(e.flags=e.flags&-4097|2,St=!1,yn=e)}}else{if(Qh(e))throw Error(ge(418));e.flags=e.flags&-4097|2,St=!1,yn=e}}}function v1(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;yn=e}function Eu(e){if(e!==yn)return!1;if(!St)return v1(e),St=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Xh(e.type,e.memoizedProps)),t&&(t=gn)){if(Qh(e))throw j2(),Error(ge(418));for(;t;)C2(e,t),t=ga(t.nextSibling)}if(v1(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ge(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){gn=ga(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}gn=null}}else gn=yn?ga(e.stateNode.nextSibling):null;return!0}function j2(){for(var e=gn;e;)e=ga(e.nextSibling)}function Oo(){gn=yn=null,St=!1}function Op(e){es===null?es=[e]:es.push(e)}var oC=Ks.ReactCurrentBatchConfig;function pl(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ge(309));var n=r.stateNode}if(!n)throw Error(ge(147,e));var s=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(i){var o=s.refs;i===null?delete o[a]:o[a]=i},t._stringRef=a,t)}if(typeof e!="string")throw Error(ge(284));if(!r._owner)throw Error(ge(290,e))}return e}function Nu(e,t){throw e=Object.prototype.toString.call(t),Error(ge(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function y1(e){var t=e._init;return t(e._payload)}function A2(e){function t(y,w){if(e){var v=y.deletions;v===null?(y.deletions=[w],y.flags|=16):v.push(w)}}function r(y,w){if(!e)return null;for(;w!==null;)t(y,w),w=w.sibling;return null}function n(y,w){for(y=new Map;w!==null;)w.key!==null?y.set(w.key,w):y.set(w.index,w),w=w.sibling;return y}function s(y,w){return y=_a(y,w),y.index=0,y.sibling=null,y}function a(y,w,v){return y.index=v,e?(v=y.alternate,v!==null?(v=v.index,v<w?(y.flags|=2,w):v):(y.flags|=2,w)):(y.flags|=1048576,w)}function i(y){return e&&y.alternate===null&&(y.flags|=2),y}function o(y,w,v,_){return w===null||w.tag!==6?(w=Df(v,y.mode,_),w.return=y,w):(w=s(w,v),w.return=y,w)}function c(y,w,v,_){var S=v.type;return S===eo?d(y,w,v.props.children,_,v.key):w!==null&&(w.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===na&&y1(S)===w.type)?(_=s(w,v.props),_.ref=pl(y,w,v),_.return=y,_):(_=ld(v.type,v.key,v.props,null,y.mode,_),_.ref=pl(y,w,v),_.return=y,_)}function u(y,w,v,_){return w===null||w.tag!==4||w.stateNode.containerInfo!==v.containerInfo||w.stateNode.implementation!==v.implementation?(w=If(v,y.mode,_),w.return=y,w):(w=s(w,v.children||[]),w.return=y,w)}function d(y,w,v,_,S){return w===null||w.tag!==7?(w=ai(v,y.mode,_,S),w.return=y,w):(w=s(w,v),w.return=y,w)}function f(y,w,v){if(typeof w=="string"&&w!==""||typeof w=="number")return w=Df(""+w,y.mode,v),w.return=y,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case pu:return v=ld(w.type,w.key,w.props,null,y.mode,v),v.ref=pl(y,null,w),v.return=y,v;case Zi:return w=If(w,y.mode,v),w.return=y,w;case na:var _=w._init;return f(y,_(w._payload),v)}if(_l(w)||ul(w))return w=ai(w,y.mode,v,null),w.return=y,w;Nu(y,w)}return null}function h(y,w,v,_){var S=w!==null?w.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return S!==null?null:o(y,w,""+v,_);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case pu:return v.key===S?c(y,w,v,_):null;case Zi:return v.key===S?u(y,w,v,_):null;case na:return S=v._init,h(y,w,S(v._payload),_)}if(_l(v)||ul(v))return S!==null?null:d(y,w,v,_,null);Nu(y,v)}return null}function m(y,w,v,_,S){if(typeof _=="string"&&_!==""||typeof _=="number")return y=y.get(v)||null,o(w,y,""+_,S);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case pu:return y=y.get(_.key===null?v:_.key)||null,c(w,y,_,S);case Zi:return y=y.get(_.key===null?v:_.key)||null,u(w,y,_,S);case na:var b=_._init;return m(y,w,v,b(_._payload),S)}if(_l(_)||ul(_))return y=y.get(v)||null,d(w,y,_,S,null);Nu(w,_)}return null}function x(y,w,v,_){for(var S=null,b=null,k=w,T=w=0,j=null;k!==null&&T<v.length;T++){k.index>T?(j=k,k=null):j=k.sibling;var V=h(y,k,v[T],_);if(V===null){k===null&&(k=j);break}e&&k&&V.alternate===null&&t(y,k),w=a(V,w,T),b===null?S=V:b.sibling=V,b=V,k=j}if(T===v.length)return r(y,k),St&&Wa(y,T),S;if(k===null){for(;T<v.length;T++)k=f(y,v[T],_),k!==null&&(w=a(k,w,T),b===null?S=k:b.sibling=k,b=k);return St&&Wa(y,T),S}for(k=n(y,k);T<v.length;T++)j=m(k,y,T,v[T],_),j!==null&&(e&&j.alternate!==null&&k.delete(j.key===null?T:j.key),w=a(j,w,T),b===null?S=j:b.sibling=j,b=j);return e&&k.forEach(function(C){return t(y,C)}),St&&Wa(y,T),S}function p(y,w,v,_){var S=ul(v);if(typeof S!="function")throw Error(ge(150));if(v=S.call(v),v==null)throw Error(ge(151));for(var b=S=null,k=w,T=w=0,j=null,V=v.next();k!==null&&!V.done;T++,V=v.next()){k.index>T?(j=k,k=null):j=k.sibling;var C=h(y,k,V.value,_);if(C===null){k===null&&(k=j);break}e&&k&&C.alternate===null&&t(y,k),w=a(C,w,T),b===null?S=C:b.sibling=C,b=C,k=j}if(V.done)return r(y,k),St&&Wa(y,T),S;if(k===null){for(;!V.done;T++,V=v.next())V=f(y,V.value,_),V!==null&&(w=a(V,w,T),b===null?S=V:b.sibling=V,b=V);return St&&Wa(y,T),S}for(k=n(y,k);!V.done;T++,V=v.next())V=m(k,y,T,V.value,_),V!==null&&(e&&V.alternate!==null&&k.delete(V.key===null?T:V.key),w=a(V,w,T),b===null?S=V:b.sibling=V,b=V);return e&&k.forEach(function(R){return t(y,R)}),St&&Wa(y,T),S}function g(y,w,v,_){if(typeof v=="object"&&v!==null&&v.type===eo&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case pu:e:{for(var S=v.key,b=w;b!==null;){if(b.key===S){if(S=v.type,S===eo){if(b.tag===7){r(y,b.sibling),w=s(b,v.props.children),w.return=y,y=w;break e}}else if(b.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===na&&y1(S)===b.type){r(y,b.sibling),w=s(b,v.props),w.ref=pl(y,b,v),w.return=y,y=w;break e}r(y,b);break}else t(y,b);b=b.sibling}v.type===eo?(w=ai(v.props.children,y.mode,_,v.key),w.return=y,y=w):(_=ld(v.type,v.key,v.props,null,y.mode,_),_.ref=pl(y,w,v),_.return=y,y=_)}return i(y);case Zi:e:{for(b=v.key;w!==null;){if(w.key===b)if(w.tag===4&&w.stateNode.containerInfo===v.containerInfo&&w.stateNode.implementation===v.implementation){r(y,w.sibling),w=s(w,v.children||[]),w.return=y,y=w;break e}else{r(y,w);break}else t(y,w);w=w.sibling}w=If(v,y.mode,_),w.return=y,y=w}return i(y);case na:return b=v._init,g(y,w,b(v._payload),_)}if(_l(v))return x(y,w,v,_);if(ul(v))return p(y,w,v,_);Nu(y,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,w!==null&&w.tag===6?(r(y,w.sibling),w=s(w,v),w.return=y,y=w):(r(y,w),w=Df(v,y.mode,_),w.return=y,y=w),i(y)):r(y,w)}return g}var Do=A2(!0),F2=A2(!1),Nd=Fa(null),Td=null,lo=null,Dp=null;function Ip(){Dp=lo=Td=null}function Lp(e){var t=Nd.current;_t(Nd),e._currentValue=t}function em(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function So(e,t){Td=e,Dp=lo=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Qr=!0),e.firstContext=null)}function Vn(e){var t=e._currentValue;if(Dp!==e)if(e={context:e,memoizedValue:t,next:null},lo===null){if(Td===null)throw Error(ge(308));lo=e,Td.dependencies={lanes:0,firstContext:e}}else lo=lo.next=e;return t}var Za=null;function Mp(e){Za===null?Za=[e]:Za.push(e)}function P2(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,Mp(t)):(r.next=s.next,s.next=r),t.interleaved=r,Vs(e,n)}function Vs(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var sa=!1;function Bp(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function R2(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Rs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function va(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,st&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,Vs(e,r)}return s=n.interleaved,s===null?(t.next=t,Mp(n)):(t.next=s.next,s.next=t),n.interleaved=t,Vs(e,r)}function rd(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Sp(e,r)}}function w1(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?s=a=i:a=a.next=i,r=r.next}while(r!==null);a===null?s=a=t:a=a.next=t}else s=a=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Cd(e,t,r,n){var s=e.updateQueue;sa=!1;var a=s.firstBaseUpdate,i=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var c=o,u=c.next;c.next=null,i===null?a=u:i.next=u,i=c;var d=e.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==i&&(o===null?d.firstBaseUpdate=u:o.next=u,d.lastBaseUpdate=c))}if(a!==null){var f=s.baseState;i=0,d=u=c=null,o=a;do{var h=o.lane,m=o.eventTime;if((n&h)===h){d!==null&&(d=d.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var x=e,p=o;switch(h=t,m=r,p.tag){case 1:if(x=p.payload,typeof x=="function"){f=x.call(m,f,h);break e}f=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=p.payload,h=typeof x=="function"?x.call(m,f,h):x,h==null)break e;f=Dt({},f,h);break e;case 2:sa=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,h=s.effects,h===null?s.effects=[o]:h.push(o))}else m={eventTime:m,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(u=d=m,c=f):d=d.next=m,i|=h;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;h=o,o=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(!0);if(d===null&&(c=f),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,t=s.shared.interleaved,t!==null){s=t;do i|=s.lane,s=s.next;while(s!==t)}else a===null&&(s.shared.lanes=0);pi|=i,e.lanes=i,e.memoizedState=f}}function _1(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(ge(191,s));s.call(n)}}}var Zc={},vs=Fa(Zc),pc=Fa(Zc),xc=Fa(Zc);function ei(e){if(e===Zc)throw Error(ge(174));return e}function Up(e,t){switch(gt(xc,t),gt(pc,e),gt(vs,Zc),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Oh(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Oh(t,e)}_t(vs),gt(vs,t)}function Io(){_t(vs),_t(pc),_t(xc)}function O2(e){ei(xc.current);var t=ei(vs.current),r=Oh(t,e.type);t!==r&&(gt(pc,e),gt(vs,r))}function Vp(e){pc.current===e&&(_t(vs),_t(pc))}var jt=Fa(0);function jd(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var jf=[];function $p(){for(var e=0;e<jf.length;e++)jf[e]._workInProgressVersionPrimary=null;jf.length=0}var nd=Ks.ReactCurrentDispatcher,Af=Ks.ReactCurrentBatchConfig,mi=0,Rt=null,sr=null,cr=null,Ad=!1,Il=!1,gc=0,lC=0;function Er(){throw Error(ge(321))}function zp(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!os(e[r],t[r]))return!1;return!0}function Wp(e,t,r,n,s,a){if(mi=a,Rt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,nd.current=e===null||e.memoizedState===null?fC:hC,e=r(n,s),Il){a=0;do{if(Il=!1,gc=0,25<=a)throw Error(ge(301));a+=1,cr=sr=null,t.updateQueue=null,nd.current=mC,e=r(n,s)}while(Il)}if(nd.current=Fd,t=sr!==null&&sr.next!==null,mi=0,cr=sr=Rt=null,Ad=!1,t)throw Error(ge(300));return e}function Hp(){var e=gc!==0;return gc=0,e}function hs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return cr===null?Rt.memoizedState=cr=e:cr=cr.next=e,cr}function $n(){if(sr===null){var e=Rt.alternate;e=e!==null?e.memoizedState:null}else e=sr.next;var t=cr===null?Rt.memoizedState:cr.next;if(t!==null)cr=t,sr=e;else{if(e===null)throw Error(ge(310));sr=e,e={memoizedState:sr.memoizedState,baseState:sr.baseState,baseQueue:sr.baseQueue,queue:sr.queue,next:null},cr===null?Rt.memoizedState=cr=e:cr=cr.next=e}return cr}function vc(e,t){return typeof t=="function"?t(e):t}function Ff(e){var t=$n(),r=t.queue;if(r===null)throw Error(ge(311));r.lastRenderedReducer=e;var n=sr,s=n.baseQueue,a=r.pending;if(a!==null){if(s!==null){var i=s.next;s.next=a.next,a.next=i}n.baseQueue=s=a,r.pending=null}if(s!==null){a=s.next,n=n.baseState;var o=i=null,c=null,u=a;do{var d=u.lane;if((mi&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(o=c=f,i=n):c=c.next=f,Rt.lanes|=d,pi|=d}u=u.next}while(u!==null&&u!==a);c===null?i=n:c.next=o,os(n,t.memoizedState)||(Qr=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do a=s.lane,Rt.lanes|=a,pi|=a,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Pf(e){var t=$n(),r=t.queue;if(r===null)throw Error(ge(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,a=t.memoizedState;if(s!==null){r.pending=null;var i=s=s.next;do a=e(a,i.action),i=i.next;while(i!==s);os(a,t.memoizedState)||(Qr=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function D2(){}function I2(e,t){var r=Rt,n=$n(),s=t(),a=!os(n.memoizedState,s);if(a&&(n.memoizedState=s,Qr=!0),n=n.queue,Gp(B2.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||cr!==null&&cr.memoizedState.tag&1){if(r.flags|=2048,yc(9,M2.bind(null,r,n,s,t),void 0,null),fr===null)throw Error(ge(349));mi&30||L2(r,t,s)}return s}function L2(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Rt.updateQueue,t===null?(t={lastEffect:null,stores:null},Rt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function M2(e,t,r,n){t.value=r,t.getSnapshot=n,U2(t)&&V2(e)}function B2(e,t,r){return r(function(){U2(t)&&V2(e)})}function U2(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!os(e,r)}catch{return!0}}function V2(e){var t=Vs(e,1);t!==null&&ss(t,e,1,-1)}function b1(e){var t=hs();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:vc,lastRenderedState:e},t.queue=e,e=e.dispatch=dC.bind(null,Rt,e),[t.memoizedState,e]}function yc(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Rt.updateQueue,t===null?(t={lastEffect:null,stores:null},Rt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function $2(){return $n().memoizedState}function sd(e,t,r,n){var s=hs();Rt.flags|=e,s.memoizedState=yc(1|t,r,void 0,n===void 0?null:n)}function E0(e,t,r,n){var s=$n();n=n===void 0?null:n;var a=void 0;if(sr!==null){var i=sr.memoizedState;if(a=i.destroy,n!==null&&zp(n,i.deps)){s.memoizedState=yc(t,r,a,n);return}}Rt.flags|=e,s.memoizedState=yc(1|t,r,a,n)}function k1(e,t){return sd(8390656,8,e,t)}function Gp(e,t){return E0(2048,8,e,t)}function z2(e,t){return E0(4,2,e,t)}function W2(e,t){return E0(4,4,e,t)}function H2(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function G2(e,t,r){return r=r!=null?r.concat([e]):null,E0(4,4,H2.bind(null,t,e),r)}function Kp(){}function K2(e,t){var r=$n();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&zp(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function X2(e,t){var r=$n();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&zp(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function q2(e,t,r){return mi&21?(os(r,t)||(r=e2(),Rt.lanes|=r,pi|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Qr=!0),e.memoizedState=r)}function cC(e,t){var r=ht;ht=r!==0&&4>r?r:4,e(!0);var n=Af.transition;Af.transition={};try{e(!1),t()}finally{ht=r,Af.transition=n}}function Y2(){return $n().memoizedState}function uC(e,t,r){var n=wa(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},J2(e))Q2(t,r);else if(r=P2(e,t,r,n),r!==null){var s=zr();ss(r,e,n,s),Z2(r,t,n)}}function dC(e,t,r){var n=wa(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(J2(e))Q2(t,s);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var i=t.lastRenderedState,o=a(i,r);if(s.hasEagerState=!0,s.eagerState=o,os(o,i)){var c=t.interleaved;c===null?(s.next=s,Mp(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}r=P2(e,t,s,n),r!==null&&(s=zr(),ss(r,e,n,s),Z2(r,t,n))}}function J2(e){var t=e.alternate;return e===Rt||t!==null&&t===Rt}function Q2(e,t){Il=Ad=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Z2(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Sp(e,r)}}var Fd={readContext:Vn,useCallback:Er,useContext:Er,useEffect:Er,useImperativeHandle:Er,useInsertionEffect:Er,useLayoutEffect:Er,useMemo:Er,useReducer:Er,useRef:Er,useState:Er,useDebugValue:Er,useDeferredValue:Er,useTransition:Er,useMutableSource:Er,useSyncExternalStore:Er,useId:Er,unstable_isNewReconciler:!1},fC={readContext:Vn,useCallback:function(e,t){return hs().memoizedState=[e,t===void 0?null:t],e},useContext:Vn,useEffect:k1,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,sd(4194308,4,H2.bind(null,t,e),r)},useLayoutEffect:function(e,t){return sd(4194308,4,e,t)},useInsertionEffect:function(e,t){return sd(4,2,e,t)},useMemo:function(e,t){var r=hs();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=hs();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=uC.bind(null,Rt,e),[n.memoizedState,e]},useRef:function(e){var t=hs();return e={current:e},t.memoizedState=e},useState:b1,useDebugValue:Kp,useDeferredValue:function(e){return hs().memoizedState=e},useTransition:function(){var e=b1(!1),t=e[0];return e=cC.bind(null,e[1]),hs().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Rt,s=hs();if(St){if(r===void 0)throw Error(ge(407));r=r()}else{if(r=t(),fr===null)throw Error(ge(349));mi&30||L2(n,t,r)}s.memoizedState=r;var a={value:r,getSnapshot:t};return s.queue=a,k1(B2.bind(null,n,a,e),[e]),n.flags|=2048,yc(9,M2.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=hs(),t=fr.identifierPrefix;if(St){var r=As,n=js;r=(n&~(1<<32-ns(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=gc++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=lC++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},hC={readContext:Vn,useCallback:K2,useContext:Vn,useEffect:Gp,useImperativeHandle:G2,useInsertionEffect:z2,useLayoutEffect:W2,useMemo:X2,useReducer:Ff,useRef:$2,useState:function(){return Ff(vc)},useDebugValue:Kp,useDeferredValue:function(e){var t=$n();return q2(t,sr.memoizedState,e)},useTransition:function(){var e=Ff(vc)[0],t=$n().memoizedState;return[e,t]},useMutableSource:D2,useSyncExternalStore:I2,useId:Y2,unstable_isNewReconciler:!1},mC={readContext:Vn,useCallback:K2,useContext:Vn,useEffect:Gp,useImperativeHandle:G2,useInsertionEffect:z2,useLayoutEffect:W2,useMemo:X2,useReducer:Pf,useRef:$2,useState:function(){return Pf(vc)},useDebugValue:Kp,useDeferredValue:function(e){var t=$n();return sr===null?t.memoizedState=e:q2(t,sr.memoizedState,e)},useTransition:function(){var e=Pf(vc)[0],t=$n().memoizedState;return[e,t]},useMutableSource:D2,useSyncExternalStore:I2,useId:Y2,unstable_isNewReconciler:!1};function Yn(e,t){if(e&&e.defaultProps){t=Dt({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function tm(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Dt({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var N0={isMounted:function(e){return(e=e._reactInternals)?Ni(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=zr(),s=wa(e),a=Rs(n,s);a.payload=t,r!=null&&(a.callback=r),t=va(e,a,s),t!==null&&(ss(t,e,s,n),rd(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=zr(),s=wa(e),a=Rs(n,s);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=va(e,a,s),t!==null&&(ss(t,e,s,n),rd(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=zr(),n=wa(e),s=Rs(r,n);s.tag=2,t!=null&&(s.callback=t),t=va(e,s,n),t!==null&&(ss(t,e,n,r),rd(t,e,n))}};function S1(e,t,r,n,s,a,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,i):t.prototype&&t.prototype.isPureReactComponent?!dc(r,n)||!dc(s,a):!0}function eb(e,t,r){var n=!1,s=Sa,a=t.contextType;return typeof a=="object"&&a!==null?a=Vn(a):(s=en(t)?fi:Lr.current,n=t.contextTypes,a=(n=n!=null)?Ro(e,s):Sa),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=N0,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=a),t}function E1(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&N0.enqueueReplaceState(t,t.state,null)}function rm(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},Bp(e);var a=t.contextType;typeof a=="object"&&a!==null?s.context=Vn(a):(a=en(t)?fi:Lr.current,s.context=Ro(e,a)),s.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(tm(e,t,a,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&N0.enqueueReplaceState(s,s.state,null),Cd(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Lo(e,t){try{var r="",n=t;do r+=$T(n),n=n.return;while(n);var s=r}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:s,digest:null}}function Rf(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function nm(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var pC=typeof WeakMap=="function"?WeakMap:Map;function tb(e,t,r){r=Rs(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Rd||(Rd=!0,hm=n),nm(e,t)},r}function rb(e,t,r){r=Rs(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){nm(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){nm(e,t),typeof n!="function"&&(ya===null?ya=new Set([this]):ya.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function N1(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new pC;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=jC.bind(null,e,t,r),t.then(e,e))}function T1(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function C1(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Rs(-1,1),t.tag=2,va(r,t,1))),r.lanes|=1),e)}var xC=Ks.ReactCurrentOwner,Qr=!1;function Ur(e,t,r,n){t.child=e===null?F2(t,null,r,n):Do(t,e.child,r,n)}function j1(e,t,r,n,s){r=r.render;var a=t.ref;return So(t,s),n=Wp(e,t,r,n,a,s),r=Hp(),e!==null&&!Qr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,$s(e,t,s)):(St&&r&&Pp(t),t.flags|=1,Ur(e,t,n,s),t.child)}function A1(e,t,r,n,s){if(e===null){var a=r.type;return typeof a=="function"&&!tx(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,nb(e,t,a,n,s)):(e=ld(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&s)){var i=a.memoizedProps;if(r=r.compare,r=r!==null?r:dc,r(i,n)&&e.ref===t.ref)return $s(e,t,s)}return t.flags|=1,e=_a(a,n),e.ref=t.ref,e.return=t,t.child=e}function nb(e,t,r,n,s){if(e!==null){var a=e.memoizedProps;if(dc(a,n)&&e.ref===t.ref)if(Qr=!1,t.pendingProps=n=a,(e.lanes&s)!==0)e.flags&131072&&(Qr=!0);else return t.lanes=e.lanes,$s(e,t,s)}return sm(e,t,r,n,s)}function sb(e,t,r){var n=t.pendingProps,s=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},gt(uo,cn),cn|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,gt(uo,cn),cn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,gt(uo,cn),cn|=n}else a!==null?(n=a.baseLanes|r,t.memoizedState=null):n=r,gt(uo,cn),cn|=n;return Ur(e,t,s,r),t.child}function ab(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function sm(e,t,r,n,s){var a=en(r)?fi:Lr.current;return a=Ro(t,a),So(t,s),r=Wp(e,t,r,n,a,s),n=Hp(),e!==null&&!Qr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,$s(e,t,s)):(St&&n&&Pp(t),t.flags|=1,Ur(e,t,r,s),t.child)}function F1(e,t,r,n,s){if(en(r)){var a=!0;kd(t)}else a=!1;if(So(t,s),t.stateNode===null)ad(e,t),eb(t,r,n),rm(t,r,n,s),n=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var c=i.context,u=r.contextType;typeof u=="object"&&u!==null?u=Vn(u):(u=en(r)?fi:Lr.current,u=Ro(t,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof i.getSnapshotBeforeUpdate=="function";f||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||c!==u)&&E1(t,i,n,u),sa=!1;var h=t.memoizedState;i.state=h,Cd(t,n,i,s),c=t.memoizedState,o!==n||h!==c||Zr.current||sa?(typeof d=="function"&&(tm(t,r,d,n),c=t.memoizedState),(o=sa||S1(t,r,o,n,h,c,u))?(f||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),i.props=n,i.state=c,i.context=u,n=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,R2(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:Yn(t.type,o),i.props=u,f=t.pendingProps,h=i.context,c=r.contextType,typeof c=="object"&&c!==null?c=Vn(c):(c=en(r)?fi:Lr.current,c=Ro(t,c));var m=r.getDerivedStateFromProps;(d=typeof m=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==f||h!==c)&&E1(t,i,n,c),sa=!1,h=t.memoizedState,i.state=h,Cd(t,n,i,s);var x=t.memoizedState;o!==f||h!==x||Zr.current||sa?(typeof m=="function"&&(tm(t,r,m,n),x=t.memoizedState),(u=sa||S1(t,r,u,n,h,x,c)||!1)?(d||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,x,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,x,c)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=x),i.props=n,i.state=x,i.context=c,n=u):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return am(e,t,r,n,a,s)}function am(e,t,r,n,s,a){ab(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return s&&x1(t,r,!1),$s(e,t,a);n=t.stateNode,xC.current=t;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=Do(t,e.child,null,a),t.child=Do(t,null,o,a)):Ur(e,t,o,a),t.memoizedState=n.state,s&&x1(t,r,!0),t.child}function ib(e){var t=e.stateNode;t.pendingContext?p1(e,t.pendingContext,t.pendingContext!==t.context):t.context&&p1(e,t.context,!1),Up(e,t.containerInfo)}function P1(e,t,r,n,s){return Oo(),Op(s),t.flags|=256,Ur(e,t,r,n),t.child}var im={dehydrated:null,treeContext:null,retryLane:0};function om(e){return{baseLanes:e,cachePool:null,transitions:null}}function ob(e,t,r){var n=t.pendingProps,s=jt.current,a=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(s&2)!==0),o?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),gt(jt,s&1),e===null)return Zh(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,a?(n=t.mode,a=t.child,i={mode:"hidden",children:i},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=j0(i,n,0,null),e=ai(e,n,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=om(r),t.memoizedState=im,e):Xp(t,i));if(s=e.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return gC(e,t,i,n,o,s,r);if(a){a=n.fallback,i=t.mode,s=e.child,o=s.sibling;var c={mode:"hidden",children:n.children};return!(i&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=_a(s,c),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?a=_a(o,a):(a=ai(a,i,r,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,i=e.child.memoizedState,i=i===null?om(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=e.childLanes&~r,t.memoizedState=im,n}return a=e.child,e=a.sibling,n=_a(a,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Xp(e,t){return t=j0({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Tu(e,t,r,n){return n!==null&&Op(n),Do(t,e.child,null,r),e=Xp(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function gC(e,t,r,n,s,a,i){if(r)return t.flags&256?(t.flags&=-257,n=Rf(Error(ge(422))),Tu(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,s=t.mode,n=j0({mode:"visible",children:n.children},s,0,null),a=ai(a,s,i,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,t.mode&1&&Do(t,e.child,null,i),t.child.memoizedState=om(i),t.memoizedState=im,a);if(!(t.mode&1))return Tu(e,t,i,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,a=Error(ge(419)),n=Rf(a,n,void 0),Tu(e,t,i,n)}if(o=(i&e.childLanes)!==0,Qr||o){if(n=fr,n!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|i)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,Vs(e,s),ss(n,e,s,-1))}return ex(),n=Rf(Error(ge(421))),Tu(e,t,i,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=AC.bind(null,e),s._reactRetry=t,null):(e=a.treeContext,gn=ga(s.nextSibling),yn=t,St=!0,es=null,e!==null&&(In[Ln++]=js,In[Ln++]=As,In[Ln++]=hi,js=e.id,As=e.overflow,hi=t),t=Xp(t,n.children),t.flags|=4096,t)}function R1(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),em(e.return,t,r)}function Of(e,t,r,n,s){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=s)}function lb(e,t,r){var n=t.pendingProps,s=n.revealOrder,a=n.tail;if(Ur(e,t,n.children,r),n=jt.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&R1(e,r,t);else if(e.tag===19)R1(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(gt(jt,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&jd(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),Of(t,!1,s,r,a);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&jd(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}Of(t,!0,r,null,a);break;case"together":Of(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function ad(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function $s(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),pi|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ge(153));if(t.child!==null){for(e=t.child,r=_a(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=_a(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function vC(e,t,r){switch(t.tag){case 3:ib(t),Oo();break;case 5:O2(t);break;case 1:en(t.type)&&kd(t);break;case 4:Up(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;gt(Nd,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(gt(jt,jt.current&1),t.flags|=128,null):r&t.child.childLanes?ob(e,t,r):(gt(jt,jt.current&1),e=$s(e,t,r),e!==null?e.sibling:null);gt(jt,jt.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return lb(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),gt(jt,jt.current),n)break;return null;case 22:case 23:return t.lanes=0,sb(e,t,r)}return $s(e,t,r)}var cb,lm,ub,db;cb=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};lm=function(){};ub=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,ei(vs.current);var a=null;switch(r){case"input":s=Ah(e,s),n=Ah(e,n),a=[];break;case"select":s=Dt({},s,{value:void 0}),n=Dt({},n,{value:void 0}),a=[];break;case"textarea":s=Rh(e,s),n=Rh(e,n),a=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=_d)}Dh(r,n);var i;r=null;for(u in s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var o=s[u];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(sc.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in n){var c=n[u];if(o=s!=null?s[u]:void 0,n.hasOwnProperty(u)&&c!==o&&(c!=null||o!=null))if(u==="style")if(o){for(i in o)!o.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in c)c.hasOwnProperty(i)&&o[i]!==c[i]&&(r||(r={}),r[i]=c[i])}else r||(a||(a=[]),a.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(a=a||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(sc.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&yt("scroll",e),a||o===c||(a=[])):(a=a||[]).push(u,c))}r&&(a=a||[]).push("style",r);var u=a;(t.updateQueue=u)&&(t.flags|=4)}};db=function(e,t,r,n){r!==n&&(t.flags|=4)};function xl(e,t){if(!St)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Nr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function yC(e,t,r){var n=t.pendingProps;switch(Rp(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nr(t),null;case 1:return en(t.type)&&bd(),Nr(t),null;case 3:return n=t.stateNode,Io(),_t(Zr),_t(Lr),$p(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Eu(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,es!==null&&(xm(es),es=null))),lm(e,t),Nr(t),null;case 5:Vp(t);var s=ei(xc.current);if(r=t.type,e!==null&&t.stateNode!=null)ub(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(ge(166));return Nr(t),null}if(e=ei(vs.current),Eu(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[ps]=t,n[mc]=a,e=(t.mode&1)!==0,r){case"dialog":yt("cancel",n),yt("close",n);break;case"iframe":case"object":case"embed":yt("load",n);break;case"video":case"audio":for(s=0;s<kl.length;s++)yt(kl[s],n);break;case"source":yt("error",n);break;case"img":case"image":case"link":yt("error",n),yt("load",n);break;case"details":yt("toggle",n);break;case"input":$g(n,a),yt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},yt("invalid",n);break;case"textarea":Wg(n,a),yt("invalid",n)}Dh(r,a),s=null;for(var i in a)if(a.hasOwnProperty(i)){var o=a[i];i==="children"?typeof o=="string"?n.textContent!==o&&(a.suppressHydrationWarning!==!0&&Su(n.textContent,o,e),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&Su(n.textContent,o,e),s=["children",""+o]):sc.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&yt("scroll",n)}switch(r){case"input":xu(n),zg(n,a,!0);break;case"textarea":xu(n),Hg(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=_d)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=B_(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[ps]=t,e[mc]=n,cb(e,t,!1,!1),t.stateNode=e;e:{switch(i=Ih(r,n),r){case"dialog":yt("cancel",e),yt("close",e),s=n;break;case"iframe":case"object":case"embed":yt("load",e),s=n;break;case"video":case"audio":for(s=0;s<kl.length;s++)yt(kl[s],e);s=n;break;case"source":yt("error",e),s=n;break;case"img":case"image":case"link":yt("error",e),yt("load",e),s=n;break;case"details":yt("toggle",e),s=n;break;case"input":$g(e,n),s=Ah(e,n),yt("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=Dt({},n,{value:void 0}),yt("invalid",e);break;case"textarea":Wg(e,n),s=Rh(e,n),yt("invalid",e);break;default:s=n}Dh(r,s),o=s;for(a in o)if(o.hasOwnProperty(a)){var c=o[a];a==="style"?$_(e,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&U_(e,c)):a==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&ac(e,c):typeof c=="number"&&ac(e,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(sc.hasOwnProperty(a)?c!=null&&a==="onScroll"&&yt("scroll",e):c!=null&&vp(e,a,c,i))}switch(r){case"input":xu(e),zg(e,n,!1);break;case"textarea":xu(e),Hg(e);break;case"option":n.value!=null&&e.setAttribute("value",""+ka(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?wo(e,!!n.multiple,a,!1):n.defaultValue!=null&&wo(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=_d)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Nr(t),null;case 6:if(e&&t.stateNode!=null)db(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(ge(166));if(r=ei(xc.current),ei(vs.current),Eu(t)){if(n=t.stateNode,r=t.memoizedProps,n[ps]=t,(a=n.nodeValue!==r)&&(e=yn,e!==null))switch(e.tag){case 3:Su(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Su(n.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[ps]=t,t.stateNode=n}return Nr(t),null;case 13:if(_t(jt),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(St&&gn!==null&&t.mode&1&&!(t.flags&128))j2(),Oo(),t.flags|=98560,a=!1;else if(a=Eu(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(ge(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(ge(317));a[ps]=t}else Oo(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Nr(t),a=!1}else es!==null&&(xm(es),es=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||jt.current&1?ir===0&&(ir=3):ex())),t.updateQueue!==null&&(t.flags|=4),Nr(t),null);case 4:return Io(),lm(e,t),e===null&&fc(t.stateNode.containerInfo),Nr(t),null;case 10:return Lp(t.type._context),Nr(t),null;case 17:return en(t.type)&&bd(),Nr(t),null;case 19:if(_t(jt),a=t.memoizedState,a===null)return Nr(t),null;if(n=(t.flags&128)!==0,i=a.rendering,i===null)if(n)xl(a,!1);else{if(ir!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=jd(e),i!==null){for(t.flags|=128,xl(a,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)a=r,e=n,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,e=i.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return gt(jt,jt.current&1|2),t.child}e=e.sibling}a.tail!==null&&Kt()>Mo&&(t.flags|=128,n=!0,xl(a,!1),t.lanes=4194304)}else{if(!n)if(e=jd(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),xl(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!St)return Nr(t),null}else 2*Kt()-a.renderingStartTime>Mo&&r!==1073741824&&(t.flags|=128,n=!0,xl(a,!1),t.lanes=4194304);a.isBackwards?(i.sibling=t.child,t.child=i):(r=a.last,r!==null?r.sibling=i:t.child=i,a.last=i)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Kt(),t.sibling=null,r=jt.current,gt(jt,n?r&1|2:r&1),t):(Nr(t),null);case 22:case 23:return Zp(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?cn&1073741824&&(Nr(t),t.subtreeFlags&6&&(t.flags|=8192)):Nr(t),null;case 24:return null;case 25:return null}throw Error(ge(156,t.tag))}function wC(e,t){switch(Rp(t),t.tag){case 1:return en(t.type)&&bd(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Io(),_t(Zr),_t(Lr),$p(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Vp(t),null;case 13:if(_t(jt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ge(340));Oo()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return _t(jt),null;case 4:return Io(),null;case 10:return Lp(t.type._context),null;case 22:case 23:return Zp(),null;case 24:return null;default:return null}}var Cu=!1,Rr=!1,_C=typeof WeakSet=="function"?WeakSet:Set,Pe=null;function co(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Bt(e,t,n)}else r.current=null}function cm(e,t,r){try{r()}catch(n){Bt(e,t,n)}}var O1=!1;function bC(e,t){if(Gh=vd,e=x2(),Fp(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var i=0,o=-1,c=-1,u=0,d=0,f=e,h=null;t:for(;;){for(var m;f!==r||s!==0&&f.nodeType!==3||(o=i+s),f!==a||n!==0&&f.nodeType!==3||(c=i+n),f.nodeType===3&&(i+=f.nodeValue.length),(m=f.firstChild)!==null;)h=f,f=m;for(;;){if(f===e)break t;if(h===r&&++u===s&&(o=i),h===a&&++d===n&&(c=i),(m=f.nextSibling)!==null)break;f=h,h=f.parentNode}f=m}r=o===-1||c===-1?null:{start:o,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Kh={focusedElem:e,selectionRange:r},vd=!1,Pe=t;Pe!==null;)if(t=Pe,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Pe=e;else for(;Pe!==null;){t=Pe;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var p=x.memoizedProps,g=x.memoizedState,y=t.stateNode,w=y.getSnapshotBeforeUpdate(t.elementType===t.type?p:Yn(t.type,p),g);y.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var v=t.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ge(163))}}catch(_){Bt(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,Pe=e;break}Pe=t.return}return x=O1,O1=!1,x}function Ll(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var a=s.destroy;s.destroy=void 0,a!==void 0&&cm(t,r,a)}s=s.next}while(s!==n)}}function T0(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function um(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function fb(e){var t=e.alternate;t!==null&&(e.alternate=null,fb(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ps],delete t[mc],delete t[Yh],delete t[sC],delete t[aC])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function hb(e){return e.tag===5||e.tag===3||e.tag===4}function D1(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||hb(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function dm(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=_d));else if(n!==4&&(e=e.child,e!==null))for(dm(e,t,r),e=e.sibling;e!==null;)dm(e,t,r),e=e.sibling}function fm(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(fm(e,t,r),e=e.sibling;e!==null;)fm(e,t,r),e=e.sibling}var gr=null,Qn=!1;function ea(e,t,r){for(r=r.child;r!==null;)mb(e,t,r),r=r.sibling}function mb(e,t,r){if(gs&&typeof gs.onCommitFiberUnmount=="function")try{gs.onCommitFiberUnmount(y0,r)}catch{}switch(r.tag){case 5:Rr||co(r,t);case 6:var n=gr,s=Qn;gr=null,ea(e,t,r),gr=n,Qn=s,gr!==null&&(Qn?(e=gr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):gr.removeChild(r.stateNode));break;case 18:gr!==null&&(Qn?(e=gr,r=r.stateNode,e.nodeType===8?Tf(e.parentNode,r):e.nodeType===1&&Tf(e,r),cc(e)):Tf(gr,r.stateNode));break;case 4:n=gr,s=Qn,gr=r.stateNode.containerInfo,Qn=!0,ea(e,t,r),gr=n,Qn=s;break;case 0:case 11:case 14:case 15:if(!Rr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var a=s,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&cm(r,t,i),s=s.next}while(s!==n)}ea(e,t,r);break;case 1:if(!Rr&&(co(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Bt(r,t,o)}ea(e,t,r);break;case 21:ea(e,t,r);break;case 22:r.mode&1?(Rr=(n=Rr)||r.memoizedState!==null,ea(e,t,r),Rr=n):ea(e,t,r);break;default:ea(e,t,r)}}function I1(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new _C),t.forEach(function(n){var s=FC.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Gn(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var a=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:gr=o.stateNode,Qn=!1;break e;case 3:gr=o.stateNode.containerInfo,Qn=!0;break e;case 4:gr=o.stateNode.containerInfo,Qn=!0;break e}o=o.return}if(gr===null)throw Error(ge(160));mb(a,i,s),gr=null,Qn=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){Bt(s,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)pb(t,e),t=t.sibling}function pb(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Gn(t,e),cs(e),n&4){try{Ll(3,e,e.return),T0(3,e)}catch(p){Bt(e,e.return,p)}try{Ll(5,e,e.return)}catch(p){Bt(e,e.return,p)}}break;case 1:Gn(t,e),cs(e),n&512&&r!==null&&co(r,r.return);break;case 5:if(Gn(t,e),cs(e),n&512&&r!==null&&co(r,r.return),e.flags&32){var s=e.stateNode;try{ac(s,"")}catch(p){Bt(e,e.return,p)}}if(n&4&&(s=e.stateNode,s!=null)){var a=e.memoizedProps,i=r!==null?r.memoizedProps:a,o=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&L_(s,a),Ih(o,i);var u=Ih(o,a);for(i=0;i<c.length;i+=2){var d=c[i],f=c[i+1];d==="style"?$_(s,f):d==="dangerouslySetInnerHTML"?U_(s,f):d==="children"?ac(s,f):vp(s,d,f,u)}switch(o){case"input":Fh(s,a);break;case"textarea":M_(s,a);break;case"select":var h=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var m=a.value;m!=null?wo(s,!!a.multiple,m,!1):h!==!!a.multiple&&(a.defaultValue!=null?wo(s,!!a.multiple,a.defaultValue,!0):wo(s,!!a.multiple,a.multiple?[]:"",!1))}s[mc]=a}catch(p){Bt(e,e.return,p)}}break;case 6:if(Gn(t,e),cs(e),n&4){if(e.stateNode===null)throw Error(ge(162));s=e.stateNode,a=e.memoizedProps;try{s.nodeValue=a}catch(p){Bt(e,e.return,p)}}break;case 3:if(Gn(t,e),cs(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{cc(t.containerInfo)}catch(p){Bt(e,e.return,p)}break;case 4:Gn(t,e),cs(e);break;case 13:Gn(t,e),cs(e),s=e.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(Jp=Kt())),n&4&&I1(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(Rr=(u=Rr)||d,Gn(t,e),Rr=u):Gn(t,e),cs(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(Pe=e,d=e.child;d!==null;){for(f=Pe=d;Pe!==null;){switch(h=Pe,m=h.child,h.tag){case 0:case 11:case 14:case 15:Ll(4,h,h.return);break;case 1:co(h,h.return);var x=h.stateNode;if(typeof x.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(p){Bt(n,r,p)}}break;case 5:co(h,h.return);break;case 22:if(h.memoizedState!==null){M1(f);continue}}m!==null?(m.return=h,Pe=m):M1(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{s=f.stateNode,u?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=f.stateNode,c=f.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=V_("display",i))}catch(p){Bt(e,e.return,p)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(p){Bt(e,e.return,p)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Gn(t,e),cs(e),n&4&&I1(e);break;case 21:break;default:Gn(t,e),cs(e)}}function cs(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(hb(r)){var n=r;break e}r=r.return}throw Error(ge(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(ac(s,""),n.flags&=-33);var a=D1(e);fm(e,a,s);break;case 3:case 4:var i=n.stateNode.containerInfo,o=D1(e);dm(e,o,i);break;default:throw Error(ge(161))}}catch(c){Bt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function kC(e,t,r){Pe=e,xb(e)}function xb(e,t,r){for(var n=(e.mode&1)!==0;Pe!==null;){var s=Pe,a=s.child;if(s.tag===22&&n){var i=s.memoizedState!==null||Cu;if(!i){var o=s.alternate,c=o!==null&&o.memoizedState!==null||Rr;o=Cu;var u=Rr;if(Cu=i,(Rr=c)&&!u)for(Pe=s;Pe!==null;)i=Pe,c=i.child,i.tag===22&&i.memoizedState!==null?B1(s):c!==null?(c.return=i,Pe=c):B1(s);for(;a!==null;)Pe=a,xb(a),a=a.sibling;Pe=s,Cu=o,Rr=u}L1(e)}else s.subtreeFlags&8772&&a!==null?(a.return=s,Pe=a):L1(e)}}function L1(e){for(;Pe!==null;){var t=Pe;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Rr||T0(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Rr)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:Yn(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&_1(t,a,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}_1(t,i,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&cc(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ge(163))}Rr||t.flags&512&&um(t)}catch(h){Bt(t,t.return,h)}}if(t===e){Pe=null;break}if(r=t.sibling,r!==null){r.return=t.return,Pe=r;break}Pe=t.return}}function M1(e){for(;Pe!==null;){var t=Pe;if(t===e){Pe=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Pe=r;break}Pe=t.return}}function B1(e){for(;Pe!==null;){var t=Pe;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{T0(4,t)}catch(c){Bt(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(c){Bt(t,s,c)}}var a=t.return;try{um(t)}catch(c){Bt(t,a,c)}break;case 5:var i=t.return;try{um(t)}catch(c){Bt(t,i,c)}}}catch(c){Bt(t,t.return,c)}if(t===e){Pe=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Pe=o;break}Pe=t.return}}var SC=Math.ceil,Pd=Ks.ReactCurrentDispatcher,qp=Ks.ReactCurrentOwner,Bn=Ks.ReactCurrentBatchConfig,st=0,fr=null,tr=null,br=0,cn=0,uo=Fa(0),ir=0,wc=null,pi=0,C0=0,Yp=0,Ml=null,Jr=null,Jp=0,Mo=1/0,Es=null,Rd=!1,hm=null,ya=null,ju=!1,ua=null,Od=0,Bl=0,mm=null,id=-1,od=0;function zr(){return st&6?Kt():id!==-1?id:id=Kt()}function wa(e){return e.mode&1?st&2&&br!==0?br&-br:oC.transition!==null?(od===0&&(od=e2()),od):(e=ht,e!==0||(e=window.event,e=e===void 0?16:o2(e.type)),e):1}function ss(e,t,r,n){if(50<Bl)throw Bl=0,mm=null,Error(ge(185));Yc(e,r,n),(!(st&2)||e!==fr)&&(e===fr&&(!(st&2)&&(C0|=r),ir===4&&oa(e,br)),tn(e,n),r===1&&st===0&&!(t.mode&1)&&(Mo=Kt()+500,S0&&Pa()))}function tn(e,t){var r=e.callbackNode;o4(e,t);var n=gd(e,e===fr?br:0);if(n===0)r!==null&&Xg(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Xg(r),t===1)e.tag===0?iC(U1.bind(null,e)):N2(U1.bind(null,e)),rC(function(){!(st&6)&&Pa()}),r=null;else{switch(t2(n)){case 1:r=kp;break;case 4:r=Q_;break;case 16:r=xd;break;case 536870912:r=Z_;break;default:r=xd}r=Sb(r,gb.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function gb(e,t){if(id=-1,od=0,st&6)throw Error(ge(327));var r=e.callbackNode;if(Eo()&&e.callbackNode!==r)return null;var n=gd(e,e===fr?br:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=Dd(e,n);else{t=n;var s=st;st|=2;var a=yb();(fr!==e||br!==t)&&(Es=null,Mo=Kt()+500,si(e,t));do try{TC();break}catch(o){vb(e,o)}while(!0);Ip(),Pd.current=a,st=s,tr!==null?t=0:(fr=null,br=0,t=ir)}if(t!==0){if(t===2&&(s=Vh(e),s!==0&&(n=s,t=pm(e,s))),t===1)throw r=wc,si(e,0),oa(e,n),tn(e,Kt()),r;if(t===6)oa(e,n);else{if(s=e.current.alternate,!(n&30)&&!EC(s)&&(t=Dd(e,n),t===2&&(a=Vh(e),a!==0&&(n=a,t=pm(e,a))),t===1))throw r=wc,si(e,0),oa(e,n),tn(e,Kt()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(ge(345));case 2:Ha(e,Jr,Es);break;case 3:if(oa(e,n),(n&130023424)===n&&(t=Jp+500-Kt(),10<t)){if(gd(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){zr(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=qh(Ha.bind(null,e,Jr,Es),t);break}Ha(e,Jr,Es);break;case 4:if(oa(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var i=31-ns(n);a=1<<i,i=t[i],i>s&&(s=i),n&=~a}if(n=s,n=Kt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*SC(n/1960))-n,10<n){e.timeoutHandle=qh(Ha.bind(null,e,Jr,Es),n);break}Ha(e,Jr,Es);break;case 5:Ha(e,Jr,Es);break;default:throw Error(ge(329))}}}return tn(e,Kt()),e.callbackNode===r?gb.bind(null,e):null}function pm(e,t){var r=Ml;return e.current.memoizedState.isDehydrated&&(si(e,t).flags|=256),e=Dd(e,t),e!==2&&(t=Jr,Jr=r,t!==null&&xm(t)),e}function xm(e){Jr===null?Jr=e:Jr.push.apply(Jr,e)}function EC(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],a=s.getSnapshot;s=s.value;try{if(!os(a(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function oa(e,t){for(t&=~Yp,t&=~C0,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-ns(t),n=1<<r;e[r]=-1,t&=~n}}function U1(e){if(st&6)throw Error(ge(327));Eo();var t=gd(e,0);if(!(t&1))return tn(e,Kt()),null;var r=Dd(e,t);if(e.tag!==0&&r===2){var n=Vh(e);n!==0&&(t=n,r=pm(e,n))}if(r===1)throw r=wc,si(e,0),oa(e,t),tn(e,Kt()),r;if(r===6)throw Error(ge(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ha(e,Jr,Es),tn(e,Kt()),null}function Qp(e,t){var r=st;st|=1;try{return e(t)}finally{st=r,st===0&&(Mo=Kt()+500,S0&&Pa())}}function xi(e){ua!==null&&ua.tag===0&&!(st&6)&&Eo();var t=st;st|=1;var r=Bn.transition,n=ht;try{if(Bn.transition=null,ht=1,e)return e()}finally{ht=n,Bn.transition=r,st=t,!(st&6)&&Pa()}}function Zp(){cn=uo.current,_t(uo)}function si(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,tC(r)),tr!==null)for(r=tr.return;r!==null;){var n=r;switch(Rp(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&bd();break;case 3:Io(),_t(Zr),_t(Lr),$p();break;case 5:Vp(n);break;case 4:Io();break;case 13:_t(jt);break;case 19:_t(jt);break;case 10:Lp(n.type._context);break;case 22:case 23:Zp()}r=r.return}if(fr=e,tr=e=_a(e.current,null),br=cn=t,ir=0,wc=null,Yp=C0=pi=0,Jr=Ml=null,Za!==null){for(t=0;t<Za.length;t++)if(r=Za[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,a=r.pending;if(a!==null){var i=a.next;a.next=s,n.next=i}r.pending=n}Za=null}return e}function vb(e,t){do{var r=tr;try{if(Ip(),nd.current=Fd,Ad){for(var n=Rt.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Ad=!1}if(mi=0,cr=sr=Rt=null,Il=!1,gc=0,qp.current=null,r===null||r.return===null){ir=1,wc=t,tr=null;break}e:{var a=e,i=r.return,o=r,c=t;if(t=br,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=o,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=T1(i);if(m!==null){m.flags&=-257,C1(m,i,o,a,t),m.mode&1&&N1(a,u,t),t=m,c=u;var x=t.updateQueue;if(x===null){var p=new Set;p.add(c),t.updateQueue=p}else x.add(c);break e}else{if(!(t&1)){N1(a,u,t),ex();break e}c=Error(ge(426))}}else if(St&&o.mode&1){var g=T1(i);if(g!==null){!(g.flags&65536)&&(g.flags|=256),C1(g,i,o,a,t),Op(Lo(c,o));break e}}a=c=Lo(c,o),ir!==4&&(ir=2),Ml===null?Ml=[a]:Ml.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var y=tb(a,c,t);w1(a,y);break e;case 1:o=c;var w=a.type,v=a.stateNode;if(!(a.flags&128)&&(typeof w.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(ya===null||!ya.has(v)))){a.flags|=65536,t&=-t,a.lanes|=t;var _=rb(a,o,t);w1(a,_);break e}}a=a.return}while(a!==null)}_b(r)}catch(S){t=S,tr===r&&r!==null&&(tr=r=r.return);continue}break}while(!0)}function yb(){var e=Pd.current;return Pd.current=Fd,e===null?Fd:e}function ex(){(ir===0||ir===3||ir===2)&&(ir=4),fr===null||!(pi&268435455)&&!(C0&268435455)||oa(fr,br)}function Dd(e,t){var r=st;st|=2;var n=yb();(fr!==e||br!==t)&&(Es=null,si(e,t));do try{NC();break}catch(s){vb(e,s)}while(!0);if(Ip(),st=r,Pd.current=n,tr!==null)throw Error(ge(261));return fr=null,br=0,ir}function NC(){for(;tr!==null;)wb(tr)}function TC(){for(;tr!==null&&!QT();)wb(tr)}function wb(e){var t=kb(e.alternate,e,cn);e.memoizedProps=e.pendingProps,t===null?_b(e):tr=t,qp.current=null}function _b(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=wC(r,t),r!==null){r.flags&=32767,tr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ir=6,tr=null;return}}else if(r=yC(r,t,cn),r!==null){tr=r;return}if(t=t.sibling,t!==null){tr=t;return}tr=t=e}while(t!==null);ir===0&&(ir=5)}function Ha(e,t,r){var n=ht,s=Bn.transition;try{Bn.transition=null,ht=1,CC(e,t,r,n)}finally{Bn.transition=s,ht=n}return null}function CC(e,t,r,n){do Eo();while(ua!==null);if(st&6)throw Error(ge(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(ge(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(l4(e,a),e===fr&&(tr=fr=null,br=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||ju||(ju=!0,Sb(xd,function(){return Eo(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=Bn.transition,Bn.transition=null;var i=ht;ht=1;var o=st;st|=4,qp.current=null,bC(e,r),pb(r,e),X4(Kh),vd=!!Gh,Kh=Gh=null,e.current=r,kC(r),ZT(),st=o,ht=i,Bn.transition=a}else e.current=r;if(ju&&(ju=!1,ua=e,Od=s),a=e.pendingLanes,a===0&&(ya=null),r4(r.stateNode),tn(e,Kt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(Rd)throw Rd=!1,e=hm,hm=null,e;return Od&1&&e.tag!==0&&Eo(),a=e.pendingLanes,a&1?e===mm?Bl++:(Bl=0,mm=e):Bl=0,Pa(),null}function Eo(){if(ua!==null){var e=t2(Od),t=Bn.transition,r=ht;try{if(Bn.transition=null,ht=16>e?16:e,ua===null)var n=!1;else{if(e=ua,ua=null,Od=0,st&6)throw Error(ge(331));var s=st;for(st|=4,Pe=e.current;Pe!==null;){var a=Pe,i=a.child;if(Pe.flags&16){var o=a.deletions;if(o!==null){for(var c=0;c<o.length;c++){var u=o[c];for(Pe=u;Pe!==null;){var d=Pe;switch(d.tag){case 0:case 11:case 15:Ll(8,d,a)}var f=d.child;if(f!==null)f.return=d,Pe=f;else for(;Pe!==null;){d=Pe;var h=d.sibling,m=d.return;if(fb(d),d===u){Pe=null;break}if(h!==null){h.return=m,Pe=h;break}Pe=m}}}var x=a.alternate;if(x!==null){var p=x.child;if(p!==null){x.child=null;do{var g=p.sibling;p.sibling=null,p=g}while(p!==null)}}Pe=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,Pe=i;else e:for(;Pe!==null;){if(a=Pe,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Ll(9,a,a.return)}var y=a.sibling;if(y!==null){y.return=a.return,Pe=y;break e}Pe=a.return}}var w=e.current;for(Pe=w;Pe!==null;){i=Pe;var v=i.child;if(i.subtreeFlags&2064&&v!==null)v.return=i,Pe=v;else e:for(i=w;Pe!==null;){if(o=Pe,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:T0(9,o)}}catch(S){Bt(o,o.return,S)}if(o===i){Pe=null;break e}var _=o.sibling;if(_!==null){_.return=o.return,Pe=_;break e}Pe=o.return}}if(st=s,Pa(),gs&&typeof gs.onPostCommitFiberRoot=="function")try{gs.onPostCommitFiberRoot(y0,e)}catch{}n=!0}return n}finally{ht=r,Bn.transition=t}}return!1}function V1(e,t,r){t=Lo(r,t),t=tb(e,t,1),e=va(e,t,1),t=zr(),e!==null&&(Yc(e,1,t),tn(e,t))}function Bt(e,t,r){if(e.tag===3)V1(e,e,r);else for(;t!==null;){if(t.tag===3){V1(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(ya===null||!ya.has(n))){e=Lo(r,e),e=rb(t,e,1),t=va(t,e,1),e=zr(),t!==null&&(Yc(t,1,e),tn(t,e));break}}t=t.return}}function jC(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=zr(),e.pingedLanes|=e.suspendedLanes&r,fr===e&&(br&r)===r&&(ir===4||ir===3&&(br&130023424)===br&&500>Kt()-Jp?si(e,0):Yp|=r),tn(e,t)}function bb(e,t){t===0&&(e.mode&1?(t=yu,yu<<=1,!(yu&130023424)&&(yu=4194304)):t=1);var r=zr();e=Vs(e,t),e!==null&&(Yc(e,t,r),tn(e,r))}function AC(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),bb(e,r)}function FC(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(ge(314))}n!==null&&n.delete(t),bb(e,r)}var kb;kb=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Zr.current)Qr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Qr=!1,vC(e,t,r);Qr=!!(e.flags&131072)}else Qr=!1,St&&t.flags&1048576&&T2(t,Ed,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;ad(e,t),e=t.pendingProps;var s=Ro(t,Lr.current);So(t,r),s=Wp(null,t,n,e,s,r);var a=Hp();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,en(n)?(a=!0,kd(t)):a=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Bp(t),s.updater=N0,t.stateNode=s,s._reactInternals=t,rm(t,n,e,r),t=am(null,t,n,!0,a,r)):(t.tag=0,St&&a&&Pp(t),Ur(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(ad(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=RC(n),e=Yn(n,e),s){case 0:t=sm(null,t,n,e,r);break e;case 1:t=F1(null,t,n,e,r);break e;case 11:t=j1(null,t,n,e,r);break e;case 14:t=A1(null,t,n,Yn(n.type,e),r);break e}throw Error(ge(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Yn(n,s),sm(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Yn(n,s),F1(e,t,n,s,r);case 3:e:{if(ib(t),e===null)throw Error(ge(387));n=t.pendingProps,a=t.memoizedState,s=a.element,R2(e,t),Cd(t,n,null,r);var i=t.memoizedState;if(n=i.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){s=Lo(Error(ge(423)),t),t=P1(e,t,n,r,s);break e}else if(n!==s){s=Lo(Error(ge(424)),t),t=P1(e,t,n,r,s);break e}else for(gn=ga(t.stateNode.containerInfo.firstChild),yn=t,St=!0,es=null,r=F2(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Oo(),n===s){t=$s(e,t,r);break e}Ur(e,t,n,r)}t=t.child}return t;case 5:return O2(t),e===null&&Zh(t),n=t.type,s=t.pendingProps,a=e!==null?e.memoizedProps:null,i=s.children,Xh(n,s)?i=null:a!==null&&Xh(n,a)&&(t.flags|=32),ab(e,t),Ur(e,t,i,r),t.child;case 6:return e===null&&Zh(t),null;case 13:return ob(e,t,r);case 4:return Up(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Do(t,null,n,r):Ur(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Yn(n,s),j1(e,t,n,s,r);case 7:return Ur(e,t,t.pendingProps,r),t.child;case 8:return Ur(e,t,t.pendingProps.children,r),t.child;case 12:return Ur(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,a=t.memoizedProps,i=s.value,gt(Nd,n._currentValue),n._currentValue=i,a!==null)if(os(a.value,i)){if(a.children===s.children&&!Zr.current){t=$s(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var o=a.dependencies;if(o!==null){i=a.child;for(var c=o.firstContext;c!==null;){if(c.context===n){if(a.tag===1){c=Rs(-1,r&-r),c.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}a.lanes|=r,c=a.alternate,c!==null&&(c.lanes|=r),em(a.return,r,t),o.lanes|=r;break}c=c.next}}else if(a.tag===10)i=a.type===t.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(ge(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),em(i,r,t),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===t){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}Ur(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,So(t,r),s=Vn(s),n=n(s),t.flags|=1,Ur(e,t,n,r),t.child;case 14:return n=t.type,s=Yn(n,t.pendingProps),s=Yn(n.type,s),A1(e,t,n,s,r);case 15:return nb(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:Yn(n,s),ad(e,t),t.tag=1,en(n)?(e=!0,kd(t)):e=!1,So(t,r),eb(t,n,s),rm(t,n,s,r),am(null,t,n,!0,e,r);case 19:return lb(e,t,r);case 22:return sb(e,t,r)}throw Error(ge(156,t.tag))};function Sb(e,t){return J_(e,t)}function PC(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mn(e,t,r,n){return new PC(e,t,r,n)}function tx(e){return e=e.prototype,!(!e||!e.isReactComponent)}function RC(e){if(typeof e=="function")return tx(e)?1:0;if(e!=null){if(e=e.$$typeof,e===wp)return 11;if(e===_p)return 14}return 2}function _a(e,t){var r=e.alternate;return r===null?(r=Mn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function ld(e,t,r,n,s,a){var i=2;if(n=e,typeof e=="function")tx(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case eo:return ai(r.children,s,a,t);case yp:i=8,s|=8;break;case Nh:return e=Mn(12,r,t,s|2),e.elementType=Nh,e.lanes=a,e;case Th:return e=Mn(13,r,t,s),e.elementType=Th,e.lanes=a,e;case Ch:return e=Mn(19,r,t,s),e.elementType=Ch,e.lanes=a,e;case O_:return j0(r,s,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case P_:i=10;break e;case R_:i=9;break e;case wp:i=11;break e;case _p:i=14;break e;case na:i=16,n=null;break e}throw Error(ge(130,e==null?e:typeof e,""))}return t=Mn(i,r,t,s),t.elementType=e,t.type=n,t.lanes=a,t}function ai(e,t,r,n){return e=Mn(7,e,n,t),e.lanes=r,e}function j0(e,t,r,n){return e=Mn(22,e,n,t),e.elementType=O_,e.lanes=r,e.stateNode={isHidden:!1},e}function Df(e,t,r){return e=Mn(6,e,null,t),e.lanes=r,e}function If(e,t,r){return t=Mn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function OC(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=xf(0),this.expirationTimes=xf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xf(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function rx(e,t,r,n,s,a,i,o,c){return e=new OC(e,t,r,o,c),t===1?(t=1,a===!0&&(t|=8)):t=0,a=Mn(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Bp(a),e}function DC(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Zi,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function Eb(e){if(!e)return Sa;e=e._reactInternals;e:{if(Ni(e)!==e||e.tag!==1)throw Error(ge(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(en(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ge(171))}if(e.tag===1){var r=e.type;if(en(r))return E2(e,r,t)}return t}function Nb(e,t,r,n,s,a,i,o,c){return e=rx(r,n,!0,e,s,a,i,o,c),e.context=Eb(null),r=e.current,n=zr(),s=wa(r),a=Rs(n,s),a.callback=t??null,va(r,a,s),e.current.lanes=s,Yc(e,s,n),tn(e,n),e}function A0(e,t,r,n){var s=t.current,a=zr(),i=wa(s);return r=Eb(r),t.context===null?t.context=r:t.pendingContext=r,t=Rs(a,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=va(s,t,i),e!==null&&(ss(e,s,i,a),rd(e,s,i)),i}function Id(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function $1(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function nx(e,t){$1(e,t),(e=e.alternate)&&$1(e,t)}function IC(){return null}var Tb=typeof reportError=="function"?reportError:function(e){console.error(e)};function sx(e){this._internalRoot=e}F0.prototype.render=sx.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ge(409));A0(e,t,null,null)};F0.prototype.unmount=sx.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;xi(function(){A0(null,e,null,null)}),t[Us]=null}};function F0(e){this._internalRoot=e}F0.prototype.unstable_scheduleHydration=function(e){if(e){var t=s2();e={blockedOn:null,target:e,priority:t};for(var r=0;r<ia.length&&t!==0&&t<ia[r].priority;r++);ia.splice(r,0,e),r===0&&i2(e)}};function ax(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function P0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function z1(){}function LC(e,t,r,n,s){if(s){if(typeof n=="function"){var a=n;n=function(){var u=Id(i);a.call(u)}}var i=Nb(t,n,e,0,null,!1,!1,"",z1);return e._reactRootContainer=i,e[Us]=i.current,fc(e.nodeType===8?e.parentNode:e),xi(),i}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var u=Id(c);o.call(u)}}var c=rx(e,0,!1,null,null,!1,!1,"",z1);return e._reactRootContainer=c,e[Us]=c.current,fc(e.nodeType===8?e.parentNode:e),xi(function(){A0(t,c,r,n)}),c}function R0(e,t,r,n,s){var a=r._reactRootContainer;if(a){var i=a;if(typeof s=="function"){var o=s;s=function(){var c=Id(i);o.call(c)}}A0(t,i,e,s)}else i=LC(r,t,e,s,n);return Id(i)}r2=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=bl(t.pendingLanes);r!==0&&(Sp(t,r|1),tn(t,Kt()),!(st&6)&&(Mo=Kt()+500,Pa()))}break;case 13:xi(function(){var n=Vs(e,1);if(n!==null){var s=zr();ss(n,e,1,s)}}),nx(e,1)}};Ep=function(e){if(e.tag===13){var t=Vs(e,134217728);if(t!==null){var r=zr();ss(t,e,134217728,r)}nx(e,134217728)}};n2=function(e){if(e.tag===13){var t=wa(e),r=Vs(e,t);if(r!==null){var n=zr();ss(r,e,t,n)}nx(e,t)}};s2=function(){return ht};a2=function(e,t){var r=ht;try{return ht=e,t()}finally{ht=r}};Mh=function(e,t,r){switch(t){case"input":if(Fh(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=k0(n);if(!s)throw Error(ge(90));I_(n),Fh(n,s)}}}break;case"textarea":M_(e,r);break;case"select":t=r.value,t!=null&&wo(e,!!r.multiple,t,!1)}};H_=Qp;G_=xi;var MC={usingClientEntryPoint:!1,Events:[Qc,so,k0,z_,W_,Qp]},gl={findFiberByHostInstance:Qa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},BC={bundleType:gl.bundleType,version:gl.version,rendererPackageName:gl.rendererPackageName,rendererConfig:gl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ks.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=q_(e),e===null?null:e.stateNode},findFiberByHostInstance:gl.findFiberByHostInstance||IC,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Au=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Au.isDisabled&&Au.supportsFiber)try{y0=Au.inject(BC),gs=Au}catch{}}Sn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=MC;Sn.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ax(t))throw Error(ge(200));return DC(e,t,null,r)};Sn.createRoot=function(e,t){if(!ax(e))throw Error(ge(299));var r=!1,n="",s=Tb;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=rx(e,1,!1,null,null,r,!1,n,s),e[Us]=t.current,fc(e.nodeType===8?e.parentNode:e),new sx(t)};Sn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ge(188)):(e=Object.keys(e).join(","),Error(ge(268,e)));return e=q_(t),e=e===null?null:e.stateNode,e};Sn.flushSync=function(e){return xi(e)};Sn.hydrate=function(e,t,r){if(!P0(t))throw Error(ge(200));return R0(null,e,t,!0,r)};Sn.hydrateRoot=function(e,t,r){if(!ax(e))throw Error(ge(405));var n=r!=null&&r.hydratedSources||null,s=!1,a="",i=Tb;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=Nb(t,null,e,1,r??null,s,!1,a,i),e[Us]=t.current,fc(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new F0(t)};Sn.render=function(e,t,r){if(!P0(t))throw Error(ge(200));return R0(null,e,t,!1,r)};Sn.unmountComponentAtNode=function(e){if(!P0(e))throw Error(ge(40));return e._reactRootContainer?(xi(function(){R0(null,null,e,!1,function(){e._reactRootContainer=null,e[Us]=null})}),!0):!1};Sn.unstable_batchedUpdates=Qp;Sn.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!P0(r))throw Error(ge(200));if(e==null||e._reactInternals===void 0)throw Error(ge(38));return R0(e,t,r,!1,n)};Sn.version="18.3.1-next-f1338f8080-20240426";function Cb(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Cb)}catch(e){console.error(e)}}Cb(),C_.exports=Sn;var UC=C_.exports,W1=UC;Sh.createRoot=W1.createRoot,Sh.hydrateRoot=W1.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _c(){return _c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_c.apply(this,arguments)}var da;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(da||(da={}));const H1="popstate";function VC(e){e===void 0&&(e={});function t(n,s){let{pathname:a,search:i,hash:o}=n.location;return gm("",{pathname:a,search:i,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:Ld(s)}return zC(t,r,null,e)}function Ot(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function ix(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function $C(){return Math.random().toString(36).substr(2,8)}function G1(e,t){return{usr:e.state,key:e.key,idx:t}}function gm(e,t,r,n){return r===void 0&&(r=null),_c({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Qo(t):t,{state:r,key:t&&t.key||n||$C()})}function Ld(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Qo(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function zC(e,t,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:a=!1}=n,i=s.history,o=da.Pop,c=null,u=d();u==null&&(u=0,i.replaceState(_c({},i.state,{idx:u}),""));function d(){return(i.state||{idx:null}).idx}function f(){o=da.Pop;let g=d(),y=g==null?null:g-u;u=g,c&&c({action:o,location:p.location,delta:y})}function h(g,y){o=da.Push;let w=gm(p.location,g,y);u=d()+1;let v=G1(w,u),_=p.createHref(w);try{i.pushState(v,"",_)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;s.location.assign(_)}a&&c&&c({action:o,location:p.location,delta:1})}function m(g,y){o=da.Replace;let w=gm(p.location,g,y);u=d();let v=G1(w,u),_=p.createHref(w);i.replaceState(v,"",_),a&&c&&c({action:o,location:p.location,delta:0})}function x(g){let y=s.location.origin!=="null"?s.location.origin:s.location.href,w=typeof g=="string"?g:Ld(g);return w=w.replace(/ $/,"%20"),Ot(y,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,y)}let p={get action(){return o},get location(){return e(s,i)},listen(g){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(H1,f),c=g,()=>{s.removeEventListener(H1,f),c=null}},createHref(g){return t(s,g)},createURL:x,encodeLocation(g){let y=x(g);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:h,replace:m,go(g){return i.go(g)}};return p}var K1;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(K1||(K1={}));function WC(e,t,r){return r===void 0&&(r="/"),HC(e,t,r)}function HC(e,t,r,n){let s=typeof t=="string"?Qo(t):t,a=Bo(s.pathname||"/",r);if(a==null)return null;let i=jb(e);GC(i);let o=null;for(let c=0;o==null&&c<i.length;++c){let u=nj(a);o=tj(i[c],u)}return o}function jb(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(a,i,o)=>{let c={relativePath:o===void 0?a.path||"":o,caseSensitive:a.caseSensitive===!0,childrenIndex:i,route:a};c.relativePath.startsWith("/")&&(Ot(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let u=ba([n,c.relativePath]),d=r.concat(c);a.children&&a.children.length>0&&(Ot(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),jb(a.children,t,d,u)),!(a.path==null&&!a.index)&&t.push({path:u,score:ZC(u,a.index),routesMeta:d})};return e.forEach((a,i)=>{var o;if(a.path===""||!((o=a.path)!=null&&o.includes("?")))s(a,i);else for(let c of Ab(a.path))s(a,i,c)}),t}function Ab(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let i=Ab(n.join("/")),o=[];return o.push(...i.map(c=>c===""?a:[a,c].join("/"))),s&&o.push(...i),o.map(c=>e.startsWith("/")&&c===""?"/":c)}function GC(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:ej(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const KC=/^:[\w-]+$/,XC=3,qC=2,YC=1,JC=10,QC=-2,X1=e=>e==="*";function ZC(e,t){let r=e.split("/"),n=r.length;return r.some(X1)&&(n+=QC),t&&(n+=qC),r.filter(s=>!X1(s)).reduce((s,a)=>s+(KC.test(a)?XC:a===""?YC:JC),n)}function ej(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function tj(e,t,r){let{routesMeta:n}=e,s={},a="/",i=[];for(let o=0;o<n.length;++o){let c=n[o],u=o===n.length-1,d=a==="/"?t:t.slice(a.length)||"/",f=vm({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),h=c.route;if(!f)return null;Object.assign(s,f.params),i.push({params:s,pathname:ba([a,f.pathname]),pathnameBase:lj(ba([a,f.pathnameBase])),route:h}),f.pathnameBase!=="/"&&(a=ba([a,f.pathnameBase]))}return i}function vm(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=rj(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let a=s[0],i=a.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((u,d,f)=>{let{paramName:h,isOptional:m}=d;if(h==="*"){let p=o[f]||"";i=a.slice(0,a.length-p.length).replace(/(.)\/+$/,"$1")}const x=o[f];return m&&!x?u[h]=void 0:u[h]=(x||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:i,pattern:e}}function rj(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),ix(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,c)=>(n.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function nj(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return ix(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Bo(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}const sj=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,aj=e=>sj.test(e);function ij(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?Qo(e):e,a;if(r)if(aj(r))a=r;else{if(r.includes("//")){let i=r;r=r.replace(/\/\/+/g,"/"),ix(!1,"Pathnames cannot have embedded double slashes - normalizing "+(i+" -> "+r))}r.startsWith("/")?a=q1(r.substring(1),"/"):a=q1(r,t)}else a=t;return{pathname:a,search:cj(n),hash:uj(s)}}function q1(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function Lf(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function oj(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function ox(e,t){let r=oj(e);return t?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function lx(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=Qo(e):(s=_c({},e),Ot(!s.pathname||!s.pathname.includes("?"),Lf("?","pathname","search",s)),Ot(!s.pathname||!s.pathname.includes("#"),Lf("#","pathname","hash",s)),Ot(!s.search||!s.search.includes("#"),Lf("#","search","hash",s)));let a=e===""||s.pathname==="",i=a?"/":s.pathname,o;if(i==null)o=r;else{let f=t.length-1;if(!n&&i.startsWith("..")){let h=i.split("/");for(;h[0]==="..";)h.shift(),f-=1;s.pathname=h.join("/")}o=f>=0?t[f]:"/"}let c=ij(s,o),u=i&&i!=="/"&&i.endsWith("/"),d=(a||i===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const ba=e=>e.join("/").replace(/\/\/+/g,"/"),lj=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),cj=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,uj=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function dj(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Fb=["post","put","patch","delete"];new Set(Fb);const fj=["get",...Fb];new Set(fj);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function bc(){return bc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},bc.apply(this,arguments)}const O0=E.createContext(null),Pb=E.createContext(null),Xs=E.createContext(null),D0=E.createContext(null),qs=E.createContext({outlet:null,matches:[],isDataRoute:!1}),Rb=E.createContext(null);function hj(e,t){let{relative:r}=t===void 0?{}:t;Zo()||Ot(!1);let{basename:n,navigator:s}=E.useContext(Xs),{hash:a,pathname:i,search:o}=I0(e,{relative:r}),c=i;return n!=="/"&&(c=i==="/"?n:ba([n,i])),s.createHref({pathname:c,search:o,hash:a})}function Zo(){return E.useContext(D0)!=null}function Ra(){return Zo()||Ot(!1),E.useContext(D0).location}function Ob(e){E.useContext(Xs).static||E.useLayoutEffect(e)}function Oa(){let{isDataRoute:e}=E.useContext(qs);return e?Nj():mj()}function mj(){Zo()||Ot(!1);let e=E.useContext(O0),{basename:t,future:r,navigator:n}=E.useContext(Xs),{matches:s}=E.useContext(qs),{pathname:a}=Ra(),i=JSON.stringify(ox(s,r.v7_relativeSplatPath)),o=E.useRef(!1);return Ob(()=>{o.current=!0}),E.useCallback(function(u,d){if(d===void 0&&(d={}),!o.current)return;if(typeof u=="number"){n.go(u);return}let f=lx(u,JSON.parse(i),a,d.relative==="path");e==null&&t!=="/"&&(f.pathname=f.pathname==="/"?t:ba([t,f.pathname])),(d.replace?n.replace:n.push)(f,d.state,d)},[t,n,i,a,e])}function Db(){let{matches:e}=E.useContext(qs),t=e[e.length-1];return t?t.params:{}}function I0(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=E.useContext(Xs),{matches:s}=E.useContext(qs),{pathname:a}=Ra(),i=JSON.stringify(ox(s,n.v7_relativeSplatPath));return E.useMemo(()=>lx(e,JSON.parse(i),a,r==="path"),[e,i,a,r])}function pj(e,t){return xj(e,t)}function xj(e,t,r,n){Zo()||Ot(!1);let{navigator:s}=E.useContext(Xs),{matches:a}=E.useContext(qs),i=a[a.length-1],o=i?i.params:{};i&&i.pathname;let c=i?i.pathnameBase:"/";i&&i.route;let u=Ra(),d;if(t){var f;let g=typeof t=="string"?Qo(t):t;c==="/"||(f=g.pathname)!=null&&f.startsWith(c)||Ot(!1),d=g}else d=u;let h=d.pathname||"/",m=h;if(c!=="/"){let g=c.replace(/^\//,"").split("/");m="/"+h.replace(/^\//,"").split("/").slice(g.length).join("/")}let x=WC(e,{pathname:m}),p=_j(x&&x.map(g=>Object.assign({},g,{params:Object.assign({},o,g.params),pathname:ba([c,s.encodeLocation?s.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?c:ba([c,s.encodeLocation?s.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),a,r,n);return t&&p?E.createElement(D0.Provider,{value:{location:bc({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:da.Pop}},p):p}function gj(){let e=Ej(),t=dj(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return E.createElement(E.Fragment,null,E.createElement("h2",null,"Unexpected Application Error!"),E.createElement("h3",{style:{fontStyle:"italic"}},t),r?E.createElement("pre",{style:s},r):null,null)}const vj=E.createElement(gj,null);class yj extends E.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?E.createElement(qs.Provider,{value:this.props.routeContext},E.createElement(Rb.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function wj(e){let{routeContext:t,match:r,children:n}=e,s=E.useContext(O0);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),E.createElement(qs.Provider,{value:t},n)}function _j(e,t,r,n){var s;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var a;if(!r)return null;if(r.errors)e=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let i=e,o=(s=r)==null?void 0:s.errors;if(o!=null){let d=i.findIndex(f=>f.route.id&&(o==null?void 0:o[f.route.id])!==void 0);d>=0||Ot(!1),i=i.slice(0,Math.min(i.length,d+1))}let c=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<i.length;d++){let f=i[d];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=d),f.route.id){let{loaderData:h,errors:m}=r,x=f.route.loader&&h[f.route.id]===void 0&&(!m||m[f.route.id]===void 0);if(f.route.lazy||x){c=!0,u>=0?i=i.slice(0,u+1):i=[i[0]];break}}}return i.reduceRight((d,f,h)=>{let m,x=!1,p=null,g=null;r&&(m=o&&f.route.id?o[f.route.id]:void 0,p=f.route.errorElement||vj,c&&(u<0&&h===0?(Tj("route-fallback"),x=!0,g=null):u===h&&(x=!0,g=f.route.hydrateFallbackElement||null)));let y=t.concat(i.slice(0,h+1)),w=()=>{let v;return m?v=p:x?v=g:f.route.Component?v=E.createElement(f.route.Component,null):f.route.element?v=f.route.element:v=d,E.createElement(wj,{match:f,routeContext:{outlet:d,matches:y,isDataRoute:r!=null},children:v})};return r&&(f.route.ErrorBoundary||f.route.errorElement||h===0)?E.createElement(yj,{location:r.location,revalidation:r.revalidation,component:p,error:m,children:w(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):w()},null)}var Ib=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Ib||{}),Lb=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Lb||{});function bj(e){let t=E.useContext(O0);return t||Ot(!1),t}function kj(e){let t=E.useContext(Pb);return t||Ot(!1),t}function Sj(e){let t=E.useContext(qs);return t||Ot(!1),t}function Mb(e){let t=Sj(),r=t.matches[t.matches.length-1];return r.route.id||Ot(!1),r.route.id}function Ej(){var e;let t=E.useContext(Rb),r=kj(),n=Mb();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function Nj(){let{router:e}=bj(Ib.UseNavigateStable),t=Mb(Lb.UseNavigateStable),r=E.useRef(!1);return Ob(()=>{r.current=!0}),E.useCallback(function(s,a){a===void 0&&(a={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,bc({fromRouteId:t},a)))},[e,t])}const Y1={};function Tj(e,t,r){Y1[e]||(Y1[e]=!0)}function Cj(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function jj(e){let{to:t,replace:r,state:n,relative:s}=e;Zo()||Ot(!1);let{future:a,static:i}=E.useContext(Xs),{matches:o}=E.useContext(qs),{pathname:c}=Ra(),u=Oa(),d=lx(t,ox(o,a.v7_relativeSplatPath),c,s==="path"),f=JSON.stringify(d);return E.useEffect(()=>u(JSON.parse(f),{replace:r,state:n,relative:s}),[u,f,s,r,n]),null}function rr(e){Ot(!1)}function Aj(e){let{basename:t="/",children:r=null,location:n,navigationType:s=da.Pop,navigator:a,static:i=!1,future:o}=e;Zo()&&Ot(!1);let c=t.replace(/^\/*/,"/"),u=E.useMemo(()=>({basename:c,navigator:a,static:i,future:bc({v7_relativeSplatPath:!1},o)}),[c,o,a,i]);typeof n=="string"&&(n=Qo(n));let{pathname:d="/",search:f="",hash:h="",state:m=null,key:x="default"}=n,p=E.useMemo(()=>{let g=Bo(d,c);return g==null?null:{location:{pathname:g,search:f,hash:h,state:m,key:x},navigationType:s}},[c,d,f,h,m,x,s]);return p==null?null:E.createElement(Xs.Provider,{value:u},E.createElement(D0.Provider,{children:r,value:p}))}function Fj(e){let{children:t,location:r}=e;return pj(ym(t),r)}new Promise(()=>{});function ym(e,t){t===void 0&&(t=[]);let r=[];return E.Children.forEach(e,(n,s)=>{if(!E.isValidElement(n))return;let a=[...t,s];if(n.type===E.Fragment){r.push.apply(r,ym(n.props.children,a));return}n.type!==rr&&Ot(!1),!n.props.index||!n.props.children||Ot(!1);let i={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=ym(n.props.children,a)),r.push(i)}),r}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Md(){return Md=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Md.apply(this,arguments)}function Bb(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,a;for(a=0;a<n.length;a++)s=n[a],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function Pj(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Rj(e,t){return e.button===0&&(!t||t==="_self")&&!Pj(e)}function wm(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(s=>[r,s]):[[r,n]])},[]))}function Oj(e,t){let r=wm(e);return t&&t.forEach((n,s)=>{r.has(s)||t.getAll(s).forEach(a=>{r.append(s,a)})}),r}const Dj=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Ij=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],Lj="6";try{window.__reactRouterVersion=Lj}catch{}const Mj=E.createContext({isTransitioning:!1}),Bj="startTransition",J1=jT[Bj];function Uj(e){let{basename:t,children:r,future:n,window:s}=e,a=E.useRef();a.current==null&&(a.current=VC({window:s,v5Compat:!0}));let i=a.current,[o,c]=E.useState({action:i.action,location:i.location}),{v7_startTransition:u}=n||{},d=E.useCallback(f=>{u&&J1?J1(()=>c(f)):c(f)},[c,u]);return E.useLayoutEffect(()=>i.listen(d),[i,d]),E.useEffect(()=>Cj(n),[n]),E.createElement(Aj,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:i,future:n})}const Vj=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",$j=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,un=E.forwardRef(function(t,r){let{onClick:n,relative:s,reloadDocument:a,replace:i,state:o,target:c,to:u,preventScrollReset:d,viewTransition:f}=t,h=Bb(t,Dj),{basename:m}=E.useContext(Xs),x,p=!1;if(typeof u=="string"&&$j.test(u)&&(x=u,Vj))try{let v=new URL(window.location.href),_=u.startsWith("//")?new URL(v.protocol+u):new URL(u),S=Bo(_.pathname,m);_.origin===v.origin&&S!=null?u=S+_.search+_.hash:p=!0}catch{}let g=hj(u,{relative:s}),y=Wj(u,{replace:i,state:o,target:c,preventScrollReset:d,relative:s,viewTransition:f});function w(v){n&&n(v),v.defaultPrevented||y(v)}return E.createElement("a",Md({},h,{href:x||g,onClick:p||a?n:w,ref:r,target:c}))}),Q1=E.forwardRef(function(t,r){let{"aria-current":n="page",caseSensitive:s=!1,className:a="",end:i=!1,style:o,to:c,viewTransition:u,children:d}=t,f=Bb(t,Ij),h=I0(c,{relative:f.relative}),m=Ra(),x=E.useContext(Pb),{navigator:p,basename:g}=E.useContext(Xs),y=x!=null&&Gj(h)&&u===!0,w=p.encodeLocation?p.encodeLocation(h).pathname:h.pathname,v=m.pathname,_=x&&x.navigation&&x.navigation.location?x.navigation.location.pathname:null;s||(v=v.toLowerCase(),_=_?_.toLowerCase():null,w=w.toLowerCase()),_&&g&&(_=Bo(_,g)||_);const S=w!=="/"&&w.endsWith("/")?w.length-1:w.length;let b=v===w||!i&&v.startsWith(w)&&v.charAt(S)==="/",k=_!=null&&(_===w||!i&&_.startsWith(w)&&_.charAt(w.length)==="/"),T={isActive:b,isPending:k,isTransitioning:y},j=b?n:void 0,V;typeof a=="function"?V=a(T):V=[a,b?"active":null,k?"pending":null,y?"transitioning":null].filter(Boolean).join(" ");let C=typeof o=="function"?o(T):o;return E.createElement(un,Md({},f,{"aria-current":j,className:V,ref:r,style:C,to:c,viewTransition:u}),typeof d=="function"?d(T):d)});var _m;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(_m||(_m={}));var Z1;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Z1||(Z1={}));function zj(e){let t=E.useContext(O0);return t||Ot(!1),t}function Wj(e,t){let{target:r,replace:n,state:s,preventScrollReset:a,relative:i,viewTransition:o}=t===void 0?{}:t,c=Oa(),u=Ra(),d=I0(e,{relative:i});return E.useCallback(f=>{if(Rj(f,r)){f.preventDefault();let h=n!==void 0?n:Ld(u)===Ld(d);c(e,{replace:h,state:s,preventScrollReset:a,relative:i,viewTransition:o})}},[u,c,d,n,s,r,e,a,i,o])}function Hj(e){let t=E.useRef(wm(e)),r=E.useRef(!1),n=Ra(),s=E.useMemo(()=>Oj(n.search,r.current?null:t.current),[n.search]),a=Oa(),i=E.useCallback((o,c)=>{const u=wm(typeof o=="function"?o(s):o);r.current=!0,a("?"+u,c)},[a,s]);return[s,i]}function Gj(e,t){t===void 0&&(t={});let r=E.useContext(Mj);r==null&&Ot(!1);let{basename:n}=zj(_m.useViewTransitionState),s=I0(e,{relative:t.relative});if(!r.isTransitioning)return!1;let a=Bo(r.currentLocation.pathname,n)||r.currentLocation.pathname,i=Bo(r.nextLocation.pathname,n)||r.nextLocation.pathname;return vm(s.pathname,i)!=null||vm(s.pathname,a)!=null}function L0(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r}function Kj(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(d){try{u(n.next(d))}catch(f){i(f)}}function c(d){try{u(n.throw(d))}catch(f){i(f)}}function u(d){d.done?a(d.value):s(d.value).then(o,c)}u((n=n.apply(e,t||[])).next())})}const Xj=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class cx extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class qj extends cx{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class ev extends cx{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class tv extends cx{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var bm;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(bm||(bm={}));class Yj{constructor(t,{headers:r={},customFetch:n,region:s=bm.Any}={}){this.url=t,this.headers=r,this.region=s,this.fetch=Xj(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return Kj(this,arguments,void 0,function*(r,n={}){var s;let a,i;try{const{headers:o,method:c,body:u,signal:d,timeout:f}=n;let h={},{region:m}=n;m||(m=this.region);const x=new URL(`${this.url}/${r}`);m&&m!=="any"&&(h["x-region"]=m,x.searchParams.set("forceFunctionRegion",m));let p;u&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",p=u):typeof u=="string"?(h["Content-Type"]="text/plain",p=u):typeof FormData<"u"&&u instanceof FormData?p=u:(h["Content-Type"]="application/json",p=JSON.stringify(u)):p=u;let g=d;f&&(i=new AbortController,a=setTimeout(()=>i.abort(),f),d?(g=i.signal,d.addEventListener("abort",()=>i.abort())):g=i.signal);const y=yield this.fetch(x.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),o),body:p,signal:g}).catch(S=>{throw new qj(S)}),w=y.headers.get("x-relay-error");if(w&&w==="true")throw new ev(y);if(!y.ok)throw new tv(y);let v=((s=y.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),_;return v==="application/json"?_=yield y.json():v==="application/octet-stream"||v==="application/pdf"?_=yield y.blob():v==="text/event-stream"?_=y:v==="multipart/form-data"?_=yield y.formData():_=yield y.text(),{data:_,error:null,response:y}}catch(o){return{data:null,error:o,response:o instanceof tv||o instanceof ev?o.context:void 0}}finally{a&&clearTimeout(a)}})}}var Jj=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},Qj=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{let i=null,o=null,c=null,u=a.status,d=a.statusText;if(a.ok){var f,h;if(r.method!=="HEAD"){var m;const y=await a.text();y===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((m=r.headers.get("Accept"))===null||m===void 0)&&m.includes("application/vnd.pgrst.plan+text"))?o=y:o=JSON.parse(y))}const p=(f=r.headers.get("Prefer"))===null||f===void 0?void 0:f.match(/count=(exact|planned|estimated)/),g=(h=a.headers.get("content-range"))===null||h===void 0?void 0:h.split("/");p&&g&&g.length>1&&(c=parseInt(g[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(o)&&(o.length>1?(i={code:"PGRST116",details:`Results contain ${o.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,c=null,u=406,d="Not Acceptable"):o.length===1?o=o[0]:o=null)}else{var x;const p=await a.text();try{i=JSON.parse(p),Array.isArray(i)&&a.status===404&&(o=[],i=null,u=200,d="OK")}catch{a.status===404&&p===""?(u=204,d="No Content"):i={message:p}}if(i&&r.isMaybeSingle&&(!(i==null||(x=i.details)===null||x===void 0)&&x.includes("0 rows"))&&(i=null,u=200,d="OK"),i&&r.shouldThrowOnError)throw new Jj(i)}return{error:i,data:o,count:c,status:u,statusText:d}});return this.shouldThrowOnError||(s=s.catch(a=>{var i;let o="";const c=a==null?void 0:a.cause;if(c){var u,d,f,h;const x=(u=c==null?void 0:c.message)!==null&&u!==void 0?u:"",p=(d=c==null?void 0:c.code)!==null&&d!==void 0?d:"";o=`${(f=a==null?void 0:a.name)!==null&&f!==void 0?f:"FetchError"}: ${a==null?void 0:a.message}`,o+=`

Caused by: ${(h=c==null?void 0:c.name)!==null&&h!==void 0?h:"Error"}: ${x}`,p&&(o+=` (${p})`),c!=null&&c.stack&&(o+=`
${c.stack}`)}else{var m;o=(m=a==null?void 0:a.stack)!==null&&m!==void 0?m:""}return{error:{message:`${(i=a==null?void 0:a.name)!==null&&i!==void 0?i:"FetchError"}: ${a==null?void 0:a.message}`,details:o,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),s.then(e,t)}returns(){return this}overrideTypes(){return this}},Zj=class extends Qj{select(e){let t=!1;const r=(e??"*").split("").map(n=>/\s/.test(n)&&!t?"":(n==='"'&&(t=!t),n)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:s=n}={}){const a=s?`${s}.order`:"order",i=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${i?`${i},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const n=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:n=r}={}){const s=typeof n>"u"?"offset":`${n}.offset`,a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(a,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:s=!1,format:a="text"}={}){var i;const o=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,s?"wal":null].filter(Boolean).join("|"),c=(i=this.headers.get("Accept"))!==null&&i!==void 0?i:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${a}; for="${c}"; options=${o};`),a==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const rv=new RegExp("[,()]");var qi=class extends Zj{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&rv.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&rv.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:n}={}){let s="";n==="plain"?s="pl":n==="phrase"?s="ph":n==="websearch"&&(s="w");const a=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${s}fts${a}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},e3=class{constructor(e,{headers:t={},schema:r,fetch:n}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=n}select(e,t){const{head:r=!1,count:n}=t??{},s=r?"HEAD":"GET";let a=!1;const i=(e??"*").split("").map(o=>/\s/.test(o)&&!a?"":(o==='"'&&(a=!a),o)).join("");return this.url.searchParams.set("select",i),n&&this.headers.append("Prefer",`count=${n}`),new qi({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var n;const s="POST";if(t&&this.headers.append("Prefer",`count=${t}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const a=e.reduce((i,o)=>i.concat(Object.keys(o)),[]);if(a.length>0){const i=[...new Set(a)].map(o=>`"${o}"`);this.url.searchParams.set("columns",i.join(","))}}return new qi({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:s=!0}={}){var a;const i="POST";if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&this.url.searchParams.set("on_conflict",t),n&&this.headers.append("Prefer",`count=${n}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const o=e.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(o.length>0){const c=[...new Set(o)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new qi({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}update(e,{count:t}={}){var r;const n="PATCH";return t&&this.headers.append("Prefer",`count=${t}`),new qi({method:n,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var t;const r="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new qi({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},t3=class Ub{constructor(t,{headers:r={},schema:n,fetch:s}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=s}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new e3(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new Ub(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:s=!1,count:a}={}){var i;let o;const c=new URL(`${this.url}/rpc/${t}`);let u;n||s?(o=n?"HEAD":"GET",Object.entries(r).filter(([f,h])=>h!==void 0).map(([f,h])=>[f,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([f,h])=>{c.searchParams.append(f,h)})):(o="POST",u=r);const d=new Headers(this.headers);return a&&d.set("Prefer",`count=${a}`),new qi({method:o,url:c,headers:d,schema:this.schemaName,body:u,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}};class r3{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,s=parseInt(n.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const n3="2.88.0",s3=`realtime-js/${n3}`,Vb="1.0.0",a3="2.0.0",nv=Vb,km=1e4,i3=1e3,o3=100;var aa;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(aa||(aa={}));var nr;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(nr||(nr={}));var Zn;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Zn||(Zn={}));var Sm;(function(e){e.websocket="websocket"})(Sm||(Sm={}));var qa;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(qa||(qa={}));class l3{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let n=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,n;const s=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,s)}_encodeJsonUserBroadcastPush(t){var r,n;const s=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:{},i=new TextEncoder().encode(JSON.stringify(s)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,i)}_encodeUserBroadcastPush(t,r,n){var s,a;const i=t.topic,o=(s=t.ref)!==null&&s!==void 0?s:"",c=(a=t.join_ref)!==null&&a!==void 0?a:"",u=t.payload.event,d=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},f=Object.keys(d).length===0?"":JSON.stringify(d);if(c.length>255)throw new Error(`joinRef length ${c.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`ref length ${o.length} exceeds maximum of 255`);if(i.length>255)throw new Error(`topic length ${i.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`userEvent length ${u.length} exceeds maximum of 255`);if(f.length>255)throw new Error(`metadata length ${f.length} exceeds maximum of 255`);const h=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+o.length+i.length+u.length+f.length,m=new ArrayBuffer(this.HEADER_LENGTH+h);let x=new DataView(m),p=0;x.setUint8(p++,this.KINDS.userBroadcastPush),x.setUint8(p++,c.length),x.setUint8(p++,o.length),x.setUint8(p++,i.length),x.setUint8(p++,u.length),x.setUint8(p++,f.length),x.setUint8(p++,r),Array.from(c,y=>x.setUint8(p++,y.charCodeAt(0))),Array.from(o,y=>x.setUint8(p++,y.charCodeAt(0))),Array.from(i,y=>x.setUint8(p++,y.charCodeAt(0))),Array.from(u,y=>x.setUint8(p++,y.charCodeAt(0))),Array.from(f,y=>x.setUint8(p++,y.charCodeAt(0)));var g=new Uint8Array(m.byteLength+n.byteLength);return g.set(new Uint8Array(m),0),g.set(new Uint8Array(n),m.byteLength),g.buffer}decode(t,r){if(this._isArrayBuffer(t)){let n=this._binaryDecode(t);return r(n)}if(typeof t=="string"){const n=JSON.parse(t),[s,a,i,o,c]=n;return r({join_ref:s,ref:a,topic:i,event:o,payload:c})}return r({})}_binaryDecode(t){const r=new DataView(t),n=r.getUint8(0),s=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,s)}}_decodeUserBroadcast(t,r,n){const s=r.getUint8(1),a=r.getUint8(2),i=r.getUint8(3),o=r.getUint8(4);let c=this.HEADER_LENGTH+4;const u=n.decode(t.slice(c,c+s));c=c+s;const d=n.decode(t.slice(c,c+a));c=c+a;const f=n.decode(t.slice(c,c+i));c=c+i;const h=t.slice(c,t.byteLength),m=o===this.JSON_ENCODING?JSON.parse(n.decode(h)):h,x={type:this.BROADCAST_EVENT,event:d,payload:m};return i>0&&(x.meta=JSON.parse(f)),{join_ref:null,ref:null,topic:u,event:this.BROADCAST_EVENT,payload:x}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([n])=>r.includes(n)))}}class $b{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var xt;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(xt||(xt={}));const sv=(e,t,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((a,i)=>(a[i]=c3(i,e,t,s),a),{}):{}},c3=(e,t,r,n)=>{const s=t.find(o=>o.name===e),a=s==null?void 0:s.type,i=r[e];return a&&!n.includes(a)?zb(a,i):Em(i)},zb=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return h3(t,r)}switch(e){case xt.bool:return u3(t);case xt.float4:case xt.float8:case xt.int2:case xt.int4:case xt.int8:case xt.numeric:case xt.oid:return d3(t);case xt.json:case xt.jsonb:return f3(t);case xt.timestamp:return m3(t);case xt.abstime:case xt.date:case xt.daterange:case xt.int4range:case xt.int8range:case xt.money:case xt.reltime:case xt.text:case xt.time:case xt.timestamptz:case xt.timetz:case xt.tsrange:case xt.tstzrange:return Em(t);default:return Em(t)}},Em=e=>e,u3=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},d3=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},f3=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},h3=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let a;const i=e.slice(1,r);try{a=JSON.parse("["+i+"]")}catch{a=i?i.split(","):[]}return a.map(o=>zb(t,o))}return e},m3=e=>typeof e=="string"?e.replace(" ","T"):e,Wb=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class Mf{constructor(t,r,n={},s=km){this.channel=t,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var av;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(av||(av={}));class Ul{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:a,onLeave:i,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ul.syncState(this.state,s,a,i),this.pendingDiffs.forEach(c=>{this.state=Ul.syncDiff(this.state,c,a,i)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},s=>{const{onJoin:a,onLeave:i,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Ul.syncDiff(this.state,s,a,i),o())}),this.onJoin((s,a,i)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:a,newPresences:i})}),this.onLeave((s,a,i)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:a,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,s){const a=this.cloneDeep(t),i=this.transformState(r),o={},c={};return this.map(a,(u,d)=>{i[u]||(c[u]=d)}),this.map(i,(u,d)=>{const f=a[u];if(f){const h=d.map(g=>g.presence_ref),m=f.map(g=>g.presence_ref),x=d.filter(g=>m.indexOf(g.presence_ref)<0),p=f.filter(g=>h.indexOf(g.presence_ref)<0);x.length>0&&(o[u]=x),p.length>0&&(c[u]=p)}else o[u]=d}),this.syncDiff(a,{joins:o,leaves:c},n,s)}static syncDiff(t,r,n,s){const{joins:a,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(a,(o,c)=>{var u;const d=(u=t[o])!==null&&u!==void 0?u:[];if(t[o]=this.cloneDeep(c),d.length>0){const f=t[o].map(m=>m.presence_ref),h=d.filter(m=>f.indexOf(m.presence_ref)<0);t[o].unshift(...h)}n(o,d,c)}),this.map(i,(o,c)=>{let u=t[o];if(!u)return;const d=c.map(f=>f.presence_ref);u=u.filter(f=>d.indexOf(f.presence_ref)<0),t[o]=u,s(o,u,c),u.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const s=t[n];return"metas"in s?r[n]=s.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):r[n]=s,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var iv;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(iv||(iv={}));var Vl;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Vl||(Vl={}));var Ns;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Ns||(Ns={}));class fo{constructor(t,r={config:{}},n){var s,a;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=nr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Mf(this,Zn.join,this.params,this.timeout),this.rejoinTimer=new $b(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=nr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=nr.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=nr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=nr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=nr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Zn.reply,{},(i,o)=>{this._trigger(this._replyEventName(o),i)}),this.presence=new Ul(this),this.broadcastEndpointURL=Wb(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((a=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||a===void 0)&&a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,s,a;if(this.socket.isConnected()||this.socket.connect(),this.state==nr.closed){const{config:{broadcast:i,presence:o,private:c}}=this.params,u=(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(m=>m.filter))!==null&&s!==void 0?s:[],d=!!this.bindings[Vl.PRESENCE]&&this.bindings[Vl.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,f={},h={broadcast:i,presence:Object.assign(Object.assign({},o),{enabled:d}),postgres_changes:u,private:c};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(m=>t==null?void 0:t(Ns.CHANNEL_ERROR,m)),this._onClose(()=>t==null?void 0:t(Ns.CLOSED)),this.updateJoinPayload(Object.assign({config:h},f)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:m})=>{var x;if(this.socket._isManualToken()||this.socket.setAuth(),m===void 0){t==null||t(Ns.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,g=(x=p==null?void 0:p.length)!==null&&x!==void 0?x:0,y=[];for(let w=0;w<g;w++){const v=p[w],{filter:{event:_,schema:S,table:b,filter:k}}=v,T=m&&m[w];if(T&&T.event===_&&fo.isFilterValueEqual(T.schema,S)&&fo.isFilterValueEqual(T.table,b)&&fo.isFilterValueEqual(T.filter,k))y.push(Object.assign(Object.assign({},v),{id:T.id}));else{this.unsubscribe(),this.state=nr.errored,t==null||t(Ns.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,t&&t(Ns.SUBSCRIBED);return}}).receive("error",m=>{this.state=nr.errored,t==null||t(Ns.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(m).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Ns.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===nr.joined&&t===Vl.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var s;if(r==null)return Promise.reject("Payload is required for httpSend()");const a={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(a.Authorization=`Bearer ${this.socket.accessTokenValue}`);const i={method:"POST",headers:a,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},o=await this._fetchWithTimeout(this.broadcastEndpointURL,i,(s=n.timeout)!==null&&s!==void 0?s:this.timeout);if(o.status===202)return{success:!0};let c=o.statusText;try{const u=await o.json();c=u.error||u.message||c}catch{}return Promise.reject(new Error(c))}async send(t,r={}){var n,s;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:a,payload:i}=t,o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const c={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:i,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=u.body)===null||s===void 0?void 0:s.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var i,o,c;const u=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(o=(i=this.params)===null||i===void 0?void 0:i.config)===null||o===void 0?void 0:o.broadcast)===null||c===void 0)&&c.ack)&&a("ok"),u.receive("ok",()=>a("ok")),u.receive("error",()=>a("error")),u.receive("timeout",()=>a("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=nr.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Zn.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new Mf(this,Zn.leave,{},t),n.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=nr.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const s=new AbortController,a=setTimeout(()=>s.abort(),n),i=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(a),i}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Mf(this,t,r,n);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>o3){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var s,a;const i=t.toLocaleLowerCase(),{close:o,error:c,leave:u,join:d}=Zn;if(n&&[o,c,u,d].indexOf(i)>=0&&n!==this._joinRef())return;let h=this._onMessage(i,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(m=>{var x,p,g;return((x=m.filter)===null||x===void 0?void 0:x.event)==="*"||((g=(p=m.filter)===null||p===void 0?void 0:p.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===i}).map(m=>m.callback(h,n)):(a=this.bindings[i])===null||a===void 0||a.filter(m=>{var x,p,g,y,w,v;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in m){const _=m.id,S=(x=m.filter)===null||x===void 0?void 0:x.event;return _&&((p=r.ids)===null||p===void 0?void 0:p.includes(_))&&(S==="*"||(S==null?void 0:S.toLocaleLowerCase())===((g=r.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const _=(w=(y=m==null?void 0:m.filter)===null||y===void 0?void 0:y.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return _==="*"||_===((v=r==null?void 0:r.event)===null||v===void 0?void 0:v.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===i}).map(m=>{if(typeof h=="object"&&"ids"in h){const x=h.data,{schema:p,table:g,commit_timestamp:y,type:w,errors:v}=x;h=Object.assign(Object.assign({},{schema:p,table:g,commit_timestamp:y,eventType:w,new:{},old:{},errors:v}),this._getPayloadRecords(x))}m.callback(h,n)})}_isClosed(){return this.state===nr.closed}_isJoined(){return this.state===nr.joined}_isJoining(){return this.state===nr.joining}_isLeaving(){return this.state===nr.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const s=t.toLocaleLowerCase(),a={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(a):this.bindings[s]=[a],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(s=>{var a;return!(((a=s.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===n&&fo.isEqual(s.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Zn.close,{},t)}_onError(t){this._on(Zn.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=nr.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=sv(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=sv(t.columns,t.old_record)),r}}const Bf=()=>{},Fu={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},p3=[1e3,2e3,5e3,1e4],x3=1e4,g3=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class v3{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=km,this.transport=null,this.heartbeatIntervalMs=Fu.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Bf,this.ref=0,this.reconnectTimer=null,this.vsn=nv,this.logger=Bf,this.conn=null,this.sendBuffer=[],this.serializer=new l3,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>s?(...a)=>s(...a):(...a)=>fetch(...a),!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Sm.websocket}`,this.httpEndpoint=Wb(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=r3.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case aa.connecting:return qa.Connecting;case aa.open:return qa.Open;case aa.closing:return qa.Closing;default:return qa.Closed}}isConnected(){return this.connectionState()===qa.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,s=this.getChannels().find(a=>a.topic===n);if(s)return s;{const a=new fo(`realtime:${t}`,r,this);return this.channels.push(a),a}}push(t){const{topic:r,event:n,payload:s,ref:a}=t,i=()=>{this.encode(t,o=>{var c;(c=this.conn)===null||c===void 0||c.send(o)})};this.log("push",`${r} ${n} (${a})`,s),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(i3,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Fu.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:s,payload:a,ref:i}=r,o=i?`(${i})`:"",c=a.status||"";this.log("receive",`${c} ${n} ${s} ${o}`.trim(),a),this.channels.filter(u=>u._isMember(n)).forEach(u=>u._trigger(s,a,i)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===aa.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===aa.open||this.conn.readyState===aa.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Zn.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${t}${n}${s}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([g3],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,n=!1;if(t)r=t,n=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(s){this.log("error","Error fetching access token from callback",s),r=this.accessTokenValue}else r=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(s=>{const a={access_token:r,version:s3};r&&s.updateJoinPayload(a),s.joinedOnce&&s._isJoined()&&s._push(Zn.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(s){this.log("error",`error in ${t} callback`,s)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new $b(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Fu.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,s,a,i,o,c,u,d,f,h,m;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:km,this.heartbeatIntervalMs=(s=t==null?void 0:t.heartbeatIntervalMs)!==null&&s!==void 0?s:Fu.HEARTBEAT_INTERVAL,this.worker=(a=t==null?void 0:t.worker)!==null&&a!==void 0?a:!1,this.accessToken=(i=t==null?void 0:t.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(o=t==null?void 0:t.heartbeatCallback)!==null&&o!==void 0?o:Bf,this.vsn=(c=t==null?void 0:t.vsn)!==null&&c!==void 0?c:nv,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=t==null?void 0:t.reconnectAfterMs)!==null&&u!==void 0?u:x=>p3[x-1]||x3,this.vsn){case Vb:this.encode=(d=t==null?void 0:t.encode)!==null&&d!==void 0?d:(x,p)=>p(JSON.stringify(x)),this.decode=(f=t==null?void 0:t.decode)!==null&&f!==void 0?f:(x,p)=>p(JSON.parse(x));break;case a3:this.encode=(h=t==null?void 0:t.encode)!==null&&h!==void 0?h:this.serializer.encode.bind(this.serializer),this.decode=(m=t==null?void 0:t.decode)!==null&&m!==void 0?m:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}var kc=class extends Error{constructor(e,t){var r;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&((r=t.icebergType)==null?void 0:r.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function y3(e,t,r){const n=new URL(t,e);if(r)for(const[s,a]of Object.entries(r))a!==void 0&&n.searchParams.set(s,a);return n.toString()}async function w3(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function _3(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:n,query:s,body:a,headers:i}){const o=y3(e.baseUrl,n,s),c=await w3(e.auth),u=await t(o,{method:r,headers:{...a?{"Content-Type":"application/json"}:{},...c,...i},body:a?JSON.stringify(a):void 0}),d=await u.text(),f=(u.headers.get("content-type")||"").includes("application/json"),h=f&&d?JSON.parse(d):d;if(!u.ok){const m=f?h:void 0,x=m==null?void 0:m.error;throw new kc((x==null?void 0:x.message)??`Request failed with status ${u.status}`,{status:u.status,icebergType:x==null?void 0:x.type,icebergCode:x==null?void 0:x.code,details:m})}return{status:u.status,headers:u.headers,data:h}}}}function Pu(e){return e.join("")}var b3=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:Pu(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t==null?void 0:t.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Pu(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Pu(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Pu(e.namespace)}`}),!0}catch(t){if(t instanceof kc&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof kc&&r.status===409)return;throw r}}};function Ui(e){return e.join("")}var k3=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ui(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ui(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ui(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Ui(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String((t==null?void 0:t.purge)??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ui(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Ui(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof kc&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof kc&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},S3=class{constructor(e){var n;let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=_3({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=(n=e.accessDelegation)==null?void 0:n.join(","),this.namespaceOps=new b3(this.client,t),this.tableOps=new k3(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},M0=class extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}};function Ct(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var E3=class extends M0{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Nm=class extends M0{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}};const ux=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),N3=()=>Response,Tm=e=>{if(Array.isArray(e))return e.map(r=>Tm(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));t[s]=Tm(n)}),t},T3=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},C3=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function Sc(e){"@babel/helpers - typeof";return Sc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sc(e)}function j3(e,t){if(Sc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Sc(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function A3(e){var t=j3(e,"string");return Sc(t)=="symbol"?t:t+""}function F3(e,t,r){return(t=A3(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ov(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function We(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ov(Object(r),!0).forEach(function(n){F3(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ov(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const Uf=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},P3=async(e,t,r)=>{e instanceof await N3()&&!(r!=null&&r.noResolveJson)?e.json().then(n=>{const s=e.status||500,a=(n==null?void 0:n.statusCode)||s+"";t(new E3(Uf(n),s,a))}).catch(n=>{t(new Nm(Uf(n),n))}):t(new Nm(Uf(e),e))},R3=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?s:(T3(n)?(s.headers=We({"Content-Type":"application/json"},t==null?void 0:t.headers),s.body=JSON.stringify(n)):s.body=n,t!=null&&t.duplex&&(s.duplex=t.duplex),We(We({},s),r))};async function eu(e,t,r,n,s,a){return new Promise((i,o)=>{e(r,R3(t,n,s,a)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>i(c)).catch(c=>P3(c,o,n))})}async function Ec(e,t,r,n){return eu(e,"GET",t,r,n)}async function Jn(e,t,r,n,s){return eu(e,"POST",t,n,s,r)}async function Cm(e,t,r,n,s){return eu(e,"PUT",t,n,s,r)}async function O3(e,t,r,n){return eu(e,"HEAD",t,We(We({},r),{},{noResolveJson:!0}),n)}async function dx(e,t,r,n,s){return eu(e,"DELETE",t,n,s,r)}var D3=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Ct(t))return{data:null,error:t};throw t}}};let Hb;Hb=Symbol.toStringTag;var I3=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[Hb]="BlobDownloadBuilder",this.promise=null}asStream(){return new D3(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Ct(t))return{data:null,error:t};throw t}}};const L3={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},lv={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var M3=class{constructor(e,t={},r,n){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=ux(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(e,t,r,n){var s=this;try{let a;const i=We(We({},lv),n);let o=We(We({},s.headers),e==="POST"&&{"x-upsert":String(i.upsert)});const c=i.metadata;typeof Blob<"u"&&r instanceof Blob?(a=new FormData,a.append("cacheControl",i.cacheControl),c&&a.append("metadata",s.encodeMetadata(c)),a.append("",r)):typeof FormData<"u"&&r instanceof FormData?(a=r,a.has("cacheControl")||a.append("cacheControl",i.cacheControl),c&&!a.has("metadata")&&a.append("metadata",s.encodeMetadata(c))):(a=r,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,c&&(o["x-metadata"]=s.toBase64(s.encodeMetadata(c))),(typeof ReadableStream<"u"&&a instanceof ReadableStream||a&&typeof a=="object"&&"pipe"in a&&typeof a.pipe=="function")&&!i.duplex&&(i.duplex="half")),n!=null&&n.headers&&(o=We(We({},o),n.headers));const u=s._removeEmptyFolders(t),d=s._getFinalPath(u),f=await(e=="PUT"?Cm:Jn)(s.fetch,`${s.url}/object/${d}`,a,We({headers:o},i!=null&&i.duplex?{duplex:i.duplex}:{}));return{data:{path:u,id:f.Id,fullPath:f.Key},error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(Ct(a))return{data:null,error:a};throw a}}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,n){var s=this;const a=s._removeEmptyFolders(e),i=s._getFinalPath(a),o=new URL(s.url+`/object/upload/sign/${i}`);o.searchParams.set("token",t);try{let c;const u=We({upsert:lv.upsert},n),d=We(We({},s.headers),{"x-upsert":String(u.upsert)});return typeof Blob<"u"&&r instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",r)):typeof FormData<"u"&&r instanceof FormData?(c=r,c.append("cacheControl",u.cacheControl)):(c=r,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType),{data:{path:a,fullPath:(await Cm(s.fetch,o.toString(),c,{headers:d})).Key},error:null}}catch(c){if(s.shouldThrowOnError)throw c;if(Ct(c))return{data:null,error:c};throw c}}async createSignedUploadUrl(e,t){var r=this;try{let n=r._getFinalPath(e);const s=We({},r.headers);t!=null&&t.upsert&&(s["x-upsert"]="true");const a=await Jn(r.fetch,`${r.url}/object/upload/sign/${n}`,{},{headers:s}),i=new URL(r.url+a.url),o=i.searchParams.get("token");if(!o)throw new M0("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:o},error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Ct(n))return{data:null,error:n};throw n}}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var n=this;try{return{data:await Jn(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers}),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(Ct(s))return{data:null,error:s};throw s}}async copy(e,t,r){var n=this;try{return{data:{path:(await Jn(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers})).Key},error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(Ct(s))return{data:null,error:s};throw s}}async createSignedUrl(e,t,r){var n=this;try{let s=n._getFinalPath(e),a=await Jn(n.fetch,`${n.url}/object/sign/${s}`,We({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:n.headers});const i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return a={signedUrl:encodeURI(`${n.url}${a.signedURL}${i}`)},{data:a,error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(Ct(s))return{data:null,error:s};throw s}}async createSignedUrls(e,t,r){var n=this;try{const s=await Jn(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:t,paths:e},{headers:n.headers}),a=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(i=>We(We({},i),{},{signedUrl:i.signedURL?encodeURI(`${n.url}${i.signedURL}${a}`):null})),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(Ct(s))return{data:null,error:s};throw s}}download(e,t){const r=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),s=n?`?${n}`:"",a=this._getFinalPath(e),i=()=>Ec(this.fetch,`${this.url}/${r}/${a}${s}`,{headers:this.headers,noResolveJson:!0});return new I3(i,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);try{return{data:Tm(await Ec(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Ct(n))return{data:null,error:n};throw n}}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await O3(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Ct(n)&&n instanceof Nm){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}}getPublicUrl(e,t){const r=this._getFinalPath(e),n=[],s=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";s!==""&&n.push(s);const a=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});i!==""&&n.push(i);let o=n.join("&");return o!==""&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${r}${o}`)}}}async remove(e){var t=this;try{return{data:await dx(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ct(r))return{data:null,error:r};throw r}}async list(e,t,r){var n=this;try{const s=We(We(We({},L3),t),{},{prefix:e||""});return{data:await Jn(n.fetch,`${n.url}/object/list/${n.bucketId}`,s,{headers:n.headers},r),error:null}}catch(s){if(n.shouldThrowOnError)throw s;if(Ct(s))return{data:null,error:s};throw s}}async listV2(e,t){var r=this;try{const n=We({},e);return{data:await Jn(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,n,{headers:r.headers},t),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Ct(n))return{data:null,error:n};throw n}}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const Gb="2.88.0",Kb={"X-Client-Info":`storage-js/${Gb}`};var B3=class{constructor(e,t={},r,n){this.shouldThrowOnError=!1;const s=new URL(e);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href.replace(/\/$/,""),this.headers=We(We({},Kb),t),this.fetch=ux(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(e){var t=this;try{const r=t.listBucketOptionsToQueryString(e);return{data:await Ec(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ct(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await Ec(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ct(r))return{data:null,error:r};throw r}}async createBucket(e,t={public:!1}){var r=this;try{return{data:await Jn(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Ct(n))return{data:null,error:n};throw n}}async updateBucket(e,t){var r=this;try{return{data:await Cm(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(Ct(n))return{data:null,error:n};throw n}}async emptyBucket(e){var t=this;try{return{data:await Jn(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ct(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await dx(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ct(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},U3=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=We(We({},Kb),t),this.fetch=ux(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await Jn(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ct(r))return{data:null,error:r};throw r}}async listBuckets(e){var t=this;try{const r=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&r.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&r.set("sortOrder",e.sortOrder),e!=null&&e.search&&r.set("search",e.search);const n=r.toString(),s=n?`${t.url}/bucket?${n}`:`${t.url}/bucket`;return{data:await Ec(t.fetch,s,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ct(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await dx(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Ct(r))return{data:null,error:r};throw r}}from(e){var t=this;if(!C3(e))throw new M0("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new S3({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(r,{get(s,a){const i=s[a];return typeof i!="function"?i:async(...o)=>{try{return{data:await i.apply(s,o),error:null}}catch(c){if(n)throw c;return{data:null,error:c}}}}})}};const fx={"X-Client-Info":`storage-js/${Gb}`,"Content-Type":"application/json"};var Xb=class extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function hn(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}var Vf=class extends Xb{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},V3=class extends Xb{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}};const hx=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),$3=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},cv=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),z3=async(e,t,r)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const n=e.status||500,s=e;if(typeof s.json=="function")s.json().then(a=>{const i=(a==null?void 0:a.statusCode)||(a==null?void 0:a.code)||n+"";t(new Vf(cv(a),n,i))}).catch(()=>{const a=n+"";t(new Vf(s.statusText||`HTTP ${n} error`,n,a))});else{const a=n+"";t(new Vf(s.statusText||`HTTP ${n} error`,n,a))}}else t(new V3(cv(e),e))},W3=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return n?($3(n)?(s.headers=We({"Content-Type":"application/json"},t==null?void 0:t.headers),s.body=JSON.stringify(n)):s.body=n,We(We({},s),r)):s};async function H3(e,t,r,n,s,a){return new Promise((i,o)=>{e(r,W3(t,n,s,a)).then(c=>{if(!c.ok)throw c;if(n!=null&&n.noResolveJson)return c;const u=c.headers.get("content-type");return!u||!u.includes("application/json")?{}:c.json()}).then(c=>i(c)).catch(c=>z3(c,o,n))})}async function mn(e,t,r,n,s){return H3(e,"POST",t,n,s,r)}var G3=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=We(We({},fx),t),this.fetch=hx(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(e){var t=this;try{return{data:await mn(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(hn(r))return{data:null,error:r};throw r}}async getIndex(e,t){var r=this;try{return{data:await mn(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(hn(n))return{data:null,error:n};throw n}}async listIndexes(e){var t=this;try{return{data:await mn(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(hn(r))return{data:null,error:r};throw r}}async deleteIndex(e,t){var r=this;try{return{data:await mn(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{},error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(hn(n))return{data:null,error:n};throw n}}},K3=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=We(We({},fx),t),this.fetch=hx(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(e){var t=this;try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await mn(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(hn(r))return{data:null,error:r};throw r}}async getVectors(e){var t=this;try{return{data:await mn(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(hn(r))return{data:null,error:r};throw r}}async listVectors(e){var t=this;try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:await mn(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(hn(r))return{data:null,error:r};throw r}}async queryVectors(e){var t=this;try{return{data:await mn(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(hn(r))return{data:null,error:r};throw r}}async deleteVectors(e){var t=this;try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await mn(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(hn(r))return{data:null,error:r};throw r}}},X3=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=We(We({},fx),t),this.fetch=hx(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await mn(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(hn(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await mn(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(hn(r))return{data:null,error:r};throw r}}async listBuckets(e={}){var t=this;try{return{data:await mn(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(hn(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await mn(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(hn(r))return{data:null,error:r};throw r}}},q3=class extends X3{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new Y3(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},Y3=class extends G3{constructor(e,t,r,n){super(e,t,n),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,We(We({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,We(We({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new J3(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},J3=class extends K3{constructor(e,t,r,n,s){super(e,t,s),this.vectorBucketName=r,this.indexName=n}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,We(We({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,We(We({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,We(We({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,We(We({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,We(We({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},Q3=class extends B3{constructor(e,t={},r,n){super(e,t,r,n)}from(e){return new M3(this.url,this.headers,e,this.fetch)}get vectors(){return new q3(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new U3(this.url+"/iceberg",this.headers,this.fetch)}};const qb="2.88.0",Yi=30*1e3,jm=3,$f=jm*Yi,Z3="http://localhost:9999",eA="supabase.auth.token",tA={"X-Client-Info":`gotrue-js/${qb}`},Am="X-Supabase-Api-Version",Yb={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},rA=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,nA=10*60*1e3;class Nc extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function De(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class sA extends Nc{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function aA(e){return De(e)&&e.name==="AuthApiError"}class Ya extends Nc{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Ys extends Nc{constructor(t,r,n,s){super(t,n,s),this.name=r,this.status=n}}class ln extends Ys{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function iA(e){return De(e)&&e.name==="AuthSessionMissingError"}class Vi extends Ys{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ru extends Ys{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Ou extends Ys{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function oA(e){return De(e)&&e.name==="AuthImplicitGrantRedirectError"}class uv extends Ys{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class lA extends Ys{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Fm extends Ys{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function zf(e){return De(e)&&e.name==="AuthRetryableFetchError"}class dv extends Ys{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Pm extends Ys{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Bd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),fv=` 	
\r=`.split(""),cA=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<fv.length;t+=1)e[fv[t].charCodeAt(0)]=-2;for(let t=0;t<Bd.length;t+=1)e[Bd[t].charCodeAt(0)]=t;return e})();function hv(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Bd[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Bd[n]),t.queuedBits-=6}}function Jb(e,t,r){const n=cA[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function mv(e){const t=[],r=i=>{t.push(String.fromCodePoint(i))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},a=i=>{fA(i,n,r)};for(let i=0;i<e.length;i+=1)Jb(e.charCodeAt(i),s,a);return t.join("")}function uA(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function dA(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}uA(n,t)}}function fA(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function No(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)Jb(e.charCodeAt(s),r,n);return new Uint8Array(t)}function hA(e){const t=[];return dA(e,r=>t.push(r)),new Uint8Array(t)}function ti(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};return e.forEach(s=>hv(s,r,n)),hv(null,r,n),t.join("")}function mA(e){return Math.round(Date.now()/1e3)+e}function pA(){return Symbol("auth-callback")}const pr=()=>typeof window<"u"&&typeof document<"u",Va={tested:!1,writable:!1},Qb=()=>{if(!pr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Va.tested)return Va.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Va.tested=!0,Va.writable=!0}catch{Va.tested=!0,Va.writable=!1}return Va.writable};function xA(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,a)=>{t[a]=s})}catch{}return r.searchParams.forEach((n,s)=>{t[s]=n}),t}const Zb=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),gA=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Ji=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},$a=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},mr=async(e,t)=>{await e.removeItem(t)};class B0{constructor(){this.promise=new B0.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}B0.promiseConstructor=Promise;function Wf(e){const t=e.split(".");if(t.length!==3)throw new Pm("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!rA.test(t[n]))throw new Pm("JWT not in base64url format");return{header:JSON.parse(mv(t[0])),payload:JSON.parse(mv(t[1])),signature:No(t[2]),raw:{header:t[0],payload:t[1]}}}async function vA(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function yA(e,t){return new Promise((n,s)=>{(async()=>{for(let a=0;a<1/0;a++)try{const i=await e(a);if(!t(a,null,i)){n(i);return}}catch(i){if(!t(a,i)){s(i);return}}})()})}function wA(e){return("0"+e.toString(16)).substr(-2)}function _A(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let a=0;a<56;a++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(t),Array.from(t,wA).join("")}async function bA(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(a=>String.fromCharCode(a)).join("")}async function kA(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await bA(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function $i(e,t,r=!1){const n=_A();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await Ji(e,`${t}-code-verifier`,s);const a=await kA(n);return[a,n===a?"plain":"s256"]}const SA=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function EA(e){const t=e.headers.get(Am);if(!t||!t.match(SA))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function NA(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function TA(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const CA=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function zi(e){if(!CA.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Hf(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function jA(e,t){return new Proxy(e,{get:(r,n,s)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const a=n.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)"||a==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,s)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,n,s)}})}function pv(e){return JSON.parse(JSON.stringify(e))}const Ga=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),AA=[502,503,504];async function xv(e){var t;if(!gA(e))throw new Fm(Ga(e),0);if(AA.includes(e.status))throw new Fm(Ga(e),e.status);let r;try{r=await e.json()}catch(a){throw new Ya(Ga(a),a)}let n;const s=EA(e);if(s&&s.getTime()>=Yb["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new dv(Ga(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new ln}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((a,i)=>a&&typeof i=="string",!0))throw new dv(Ga(r),e.status,r.weak_password.reasons);throw new sA(Ga(r),e.status||500,n)}const FA=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function $e(e,t,r,n){var s;const a=Object.assign({},n==null?void 0:n.headers);a[Am]||(a[Am]=Yb["2024-01-01"].name),n!=null&&n.jwt&&(a.Authorization=`Bearer ${n.jwt}`);const i=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(i.redirect_to=n.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",c=await PA(e,t,r+o,{headers:a,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}}async function PA(e,t,r,n,s,a){const i=FA(t,n,s,a);let o;try{o=await e(r,Object.assign({},i))}catch(c){throw console.error(c),new Fm(Ga(c),0)}if(o.ok||await xv(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(c){await xv(c)}}function Xn(e){var t;let r=null;DA(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=mA(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function gv(e){const t=Xn(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function la(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function RA(e){return{data:e,error:null}}function OA(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:a}=e,i=L0(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:a},c=Object.assign({},i);return{data:{properties:o,user:c},error:null}}function vv(e){return e}function DA(e){return e.access_token&&e.refresh_token&&e.expires_in}const Gf=["global","local","others"];class IA{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=Zb(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=Gf[0]){if(Gf.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Gf.join(", ")}`);try{return await $e(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(De(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await $e(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:la})}catch(n){if(De(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=L0(t,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await $e(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:OA,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(De(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await $e(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:la})}catch(r){if(De(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,s,a,i,o,c;try{const u={nextPage:null,lastPage:0,total:0},d=await $e(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(a=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:vv});if(d.error)throw d.error;const f=await d.json(),h=(i=d.headers.get("x-total-count"))!==null&&i!==void 0?i:0,m=(c=(o=d.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&c!==void 0?c:[];return m.length>0&&(m.forEach(x=>{const p=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(x.split(";")[1].split("=")[1]);u[`${g}Page`]=p}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},f),u),error:null}}catch(u){if(De(u))return{data:{users:[]},error:u};throw u}}async getUserById(t){zi(t);try{return await $e(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:la})}catch(r){if(De(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){zi(t);try{return await $e(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:la})}catch(n){if(De(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){zi(t);try{return await $e(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:la})}catch(n){if(De(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){zi(t.userId);try{const{data:r,error:n}=await $e(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(De(r))return{data:null,error:r};throw r}}async _deleteFactor(t){zi(t.userId),zi(t.id);try{return{data:await $e(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(De(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,s,a,i,o,c;try{const u={nextPage:null,lastPage:0,total:0},d=await $e(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(a=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:vv});if(d.error)throw d.error;const f=await d.json(),h=(i=d.headers.get("x-total-count"))!==null&&i!==void 0?i:0,m=(c=(o=d.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&c!==void 0?c:[];return m.length>0&&(m.forEach(x=>{const p=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(x.split(";")[1].split("=")[1]);u[`${g}Page`]=p}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},f),u),error:null}}catch(u){if(De(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(t){try{return await $e(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(De(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await $e(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(De(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await $e(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(De(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await $e(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(De(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await $e(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(De(r))return{data:null,error:r};throw r}}}function yv(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const Wi={debug:!!(globalThis&&Qb()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class ek extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class LA extends ek{}async function MA(e,t,r){Wi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Wi.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){Wi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{Wi.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw Wi.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new LA(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Wi.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function BA(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function tk(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function UA(e){return parseInt(e,16)}function VA(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function $A(e){var t;const{chainId:r,domain:n,expirationTime:s,issuedAt:a=new Date,nonce:i,notBefore:o,requestId:c,resources:u,scheme:d,uri:f,version:h}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(i&&i.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${i}`);if(!f)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(h!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const m=tk(e.address),x=d?`${d}://${n}`:n,p=e.statement?`${e.statement}
`:"",g=`${x} wants you to sign in with your Ethereum account:
${m}

${p}`;let y=`URI: ${f}
Version: ${h}
Chain ID: ${r}${i?`
Nonce: ${i}`:""}
Issued At: ${a.toISOString()}`;if(s&&(y+=`
Expiration Time: ${s.toISOString()}`),o&&(y+=`
Not Before: ${o.toISOString()}`),c&&(y+=`
Request ID: ${c}`),u){let w=`
Resources:`;for(const v of u){if(!v||typeof v!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${v}`);w+=`
- ${v}`}y+=w}return`${g}
${y}`}class er extends Error{constructor({message:t,code:r,cause:n,name:s}){var a;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(a=s??(n instanceof Error?n.name:void 0))!==null&&a!==void 0?a:"Unknown Error",this.code=r}}class Ud extends er{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function zA({error:e,options:t}){var r,n,s;const{publicKey:a}=t;if(!a)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new er({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=a.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new er({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=a.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new er({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((s=a.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new er({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new er({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new er({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return a.pubKeyCredParams.filter(o=>o.type==="public-key").length===0?new er({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new er({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const i=window.location.hostname;if(rk(i)){if(a.rp.id!==i)return new er({message:`The RP ID "${a.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new er({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(a.user.id.byteLength<1||a.user.id.byteLength>64)return new er({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new er({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new er({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function WA({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new er({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new er({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(rk(n)){if(r.rpId!==n)return new er({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new er({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new er({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new er({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class HA{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const GA=new HA;function KA(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,s=L0(e,["challenge","user","excludeCredentials"]),a=No(t).buffer,i=Object.assign(Object.assign({},r),{id:No(r.id).buffer}),o=Object.assign(Object.assign({},s),{challenge:a,user:i});if(n&&n.length>0){o.excludeCredentials=new Array(n.length);for(let c=0;c<n.length;c++){const u=n[c];o.excludeCredentials[c]=Object.assign(Object.assign({},u),{id:No(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return o}function XA(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=L0(e,["challenge","allowCredentials"]),s=No(t).buffer,a=Object.assign(Object.assign({},n),{challenge:s});if(r&&r.length>0){a.allowCredentials=new Array(r.length);for(let i=0;i<r.length;i++){const o=r[i];a.allowCredentials[i]=Object.assign(Object.assign({},o),{id:No(o.id).buffer,type:o.type||"public-key",transports:o.transports})}}return a}function qA(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:ti(new Uint8Array(e.response.attestationObject)),clientDataJSON:ti(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function YA(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),s=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:ti(new Uint8Array(s.authenticatorData)),clientDataJSON:ti(new Uint8Array(s.clientDataJSON)),signature:ti(new Uint8Array(s.signature)),userHandle:s.userHandle?ti(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function rk(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function wv(){var e,t;return!!(pr()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function JA(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Ud("Browser returned unexpected credential type",t)}:{data:null,error:new Ud("Empty credential response",t)}}catch(t){return{data:null,error:zA({error:t,options:e})}}}async function QA(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Ud("Browser returned unexpected credential type",t)}:{data:null,error:new Ud("Empty credential response",t)}}catch(t){return{data:null,error:WA({error:t,options:e})}}}const ZA={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},e5={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Vd(...e){const t=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),r=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),n={};for(const s of e)if(s)for(const a in s){const i=s[a];if(i!==void 0)if(Array.isArray(i))n[a]=i;else if(r(i))n[a]=i;else if(t(i)){const o=n[a];t(o)?n[a]=Vd(o,i):n[a]=Vd(i)}else n[a]=i}return n}function t5(e,t){return Vd(ZA,e,t||{})}function r5(e,t){return Vd(e5,e,t||{})}class n5{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:s},a){try{const{data:i,error:o}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!i)return{data:null,error:o};const c=s??GA.createNewAbortSignal();if(i.webauthn.type==="create"){const{user:u}=i.webauthn.credential_options.publicKey;u.name||(u.name=`${u.id}:${n}`),u.displayName||(u.displayName=u.name)}switch(i.webauthn.type){case"create":{const u=t5(i.webauthn.credential_options.publicKey,a==null?void 0:a.create),{data:d,error:f}=await JA({publicKey:u,signal:c});return d?{data:{factorId:t,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:d}},error:null}:{data:null,error:f}}case"request":{const u=r5(i.webauthn.credential_options.publicKey,a==null?void 0:a.request),{data:d,error:f}=await QA(Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:u,signal:c}));return d?{data:{factorId:t,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:d}},error:null}:{data:null,error:f}}}}catch(i){return De(i)?{data:null,error:i}:{data:null,error:new Ya("Unexpected error in challenge",i)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},a){if(!r)return{data:null,error:new Nc("rpId is required for WebAuthn authentication")};try{if(!wv())return{data:null,error:new Ya("Browser does not support WebAuthn",null)};const{data:i,error:o}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:s},{request:a});if(!i)return{data:null,error:o};const{webauthn:c}=i;return this._verify({factorId:t,challengeId:i.challengeId,webauthn:{type:c.type,rpId:r,rpOrigins:n,credential_response:c.credential_response}})}catch(i){return De(i)?{data:null,error:i}:{data:null,error:new Ya("Unexpected error in authenticate",i)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},a){if(!r)return{data:null,error:new Nc("rpId is required for WebAuthn registration")};try{if(!wv())return{data:null,error:new Ya("Browser does not support WebAuthn",null)};const{data:i,error:o}=await this._enroll({friendlyName:t});if(!i)return await this.client.mfa.listFactors().then(d=>{var f;return(f=d.data)===null||f===void 0?void 0:f.all.find(h=>h.factor_type==="webauthn"&&h.friendly_name===t&&h.status!=="unverified")}).then(d=>d?this.client.mfa.unenroll({factorId:d==null?void 0:d.id}):void 0),{data:null,error:o};const{data:c,error:u}=await this._challenge({factorId:i.id,friendlyName:i.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:s},{create:a});return c?this._verify({factorId:i.id,challengeId:c.challengeId,webauthn:{rpId:r,rpOrigins:n,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:u}}catch(i){return De(i)?{data:null,error:i}:{data:null,error:new Ya("Unexpected error in register",i)}}}}BA();const s5={url:Z3,storageKey:eA,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:tA,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function _v(e,t,r){return await r()}const Hi={};class Tc{get jwks(){var t,r;return(r=(t=Hi[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Hi[this.storageKey]=Object.assign(Object.assign({},Hi[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Hi[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Hi[this.storageKey]=Object.assign(Object.assign({},Hi[this.storageKey]),{cachedAt:t})}constructor(t){var r,n,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const a=Object.assign(Object.assign({},s5),t);if(this.storageKey=a.storageKey,this.instanceID=(r=Tc.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,Tc.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.instanceID>0&&pr()){const i=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(i),this.logDebugMessages&&console.trace(i)}if(this.persistSession=a.persistSession,this.autoRefreshToken=a.autoRefreshToken,this.admin=new IA({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=Zb(a.fetch),this.lock=a.lock||_v,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,a.lock?this.lock=a.lock:this.persistSession&&pr()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=MA:this.lock=_v,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new n5(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:Qb()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=yv(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=yv(this.memoryStorage)),pr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${qb}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},n="none";if(pr()&&(r=xA(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),pr()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:a}=await this._getSessionFromURL(r,n);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),oA(a)){const c=(t=a.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:i,redirectType:o}=s;return this._debug("#_initialize()","detected session in URL",i,"redirect type",o),await this._saveSession(i),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return De(r)?this._returnResult({error:r}):this._returnResult({error:new Ya("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,s;try{const a=await $e(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.captchaToken}},xform:Xn}),{data:i,error:o}=a;if(o||!i)return this._returnResult({data:{user:null,session:null},error:o});const c=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(a){if(De(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signUp(t){var r,n,s;try{let a;if("email"in t){const{email:d,password:f,options:h}=t;let m=null,x=null;this.flowType==="pkce"&&([m,x]=await $i(this.storage,this.storageKey)),a=await $e(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:d,password:f,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:m,code_challenge_method:x},xform:Xn})}else if("phone"in t){const{phone:d,password:f,options:h}=t;a=await $e(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:f,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},channel:(s=h==null?void 0:h.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:Xn})}else throw new Ru("You must provide either an email or phone number and a password");const{data:i,error:o}=a;if(o||!i)return await mr(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:o});const c=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(a){if(await mr(this.storage,`${this.storageKey}-code-verifier`),De(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithPassword(t){try{let r;if("email"in t){const{email:a,password:i,options:o}=t;r=await $e(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:gv})}else if("phone"in t){const{phone:a,password:i,options:o}=t;r=await $e(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:gv})}else throw new Ru("You must provide either an email or phone number and a password");const{data:n,error:s}=r;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!n||!n.session||!n.user){const a=new Vi;return this._returnResult({data:{user:null,session:null},error:a})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(De(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,n,s,a;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(a=t.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,s,a,i,o,c,u,d,f,h;let m,x;if("message"in t)m=t.message,x=t.signature;else{const{chain:p,wallet:g,statement:y,options:w}=t;let v;if(pr())if(typeof g=="object")v=g;else{const j=window;if("ethereum"in j&&typeof j.ethereum=="object"&&"request"in j.ethereum&&typeof j.ethereum.request=="function")v=j.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");v=g}const _=new URL((r=w==null?void 0:w.url)!==null&&r!==void 0?r:window.location.href),S=await v.request({method:"eth_requestAccounts"}).then(j=>j).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!S||S.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const b=tk(S[0]);let k=(n=w==null?void 0:w.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!k){const j=await v.request({method:"eth_chainId"});k=UA(j)}const T={domain:_.host,address:b,statement:y,uri:_.href,version:"1",chainId:k,nonce:(s=w==null?void 0:w.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(i=(a=w==null?void 0:w.signInWithEthereum)===null||a===void 0?void 0:a.issuedAt)!==null&&i!==void 0?i:new Date,expirationTime:(o=w==null?void 0:w.signInWithEthereum)===null||o===void 0?void 0:o.expirationTime,notBefore:(c=w==null?void 0:w.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(u=w==null?void 0:w.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(d=w==null?void 0:w.signInWithEthereum)===null||d===void 0?void 0:d.resources};m=$A(T),x=await v.request({method:"personal_sign",params:[VA(m),b]})}try{const{data:p,error:g}=await $e(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:m,signature:x},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:Xn});if(g)throw g;if(!p||!p.session||!p.user){const y=new Vi;return this._returnResult({data:{user:null,session:null},error:y})}return p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),this._returnResult({data:Object.assign({},p),error:g})}catch(p){if(De(p))return this._returnResult({data:{user:null,session:null},error:p});throw p}}async signInWithSolana(t){var r,n,s,a,i,o,c,u,d,f,h,m;let x,p;if("message"in t)x=t.message,p=t.signature;else{const{chain:g,wallet:y,statement:w,options:v}=t;let _;if(pr())if(typeof y=="object")_=y;else{const b=window;if("solana"in b&&typeof b.solana=="object"&&("signIn"in b.solana&&typeof b.solana.signIn=="function"||"signMessage"in b.solana&&typeof b.solana.signMessage=="function"))_=b.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(v!=null&&v.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");_=y}const S=new URL((r=v==null?void 0:v.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in _&&_.signIn){const b=await _.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},v==null?void 0:v.signInWithSolana),{version:"1",domain:S.host,uri:S.href}),w?{statement:w}:null));let k;if(Array.isArray(b)&&b[0]&&typeof b[0]=="object")k=b[0];else if(b&&typeof b=="object"&&"signedMessage"in b&&"signature"in b)k=b;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in k&&"signature"in k&&(typeof k.signedMessage=="string"||k.signedMessage instanceof Uint8Array)&&k.signature instanceof Uint8Array)x=typeof k.signedMessage=="string"?k.signedMessage:new TextDecoder().decode(k.signedMessage),p=k.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in _)||typeof _.signMessage!="function"||!("publicKey"in _)||typeof _!="object"||!_.publicKey||!("toBase58"in _.publicKey)||typeof _.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");x=[`${S.host} wants you to sign in with your Solana account:`,_.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${S.href}`,`Issued At: ${(s=(n=v==null?void 0:v.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((a=v==null?void 0:v.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${v.signInWithSolana.notBefore}`]:[],...!((i=v==null?void 0:v.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${v.signInWithSolana.expirationTime}`]:[],...!((o=v==null?void 0:v.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${v.signInWithSolana.chainId}`]:[],...!((c=v==null?void 0:v.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${v.signInWithSolana.nonce}`]:[],...!((u=v==null?void 0:v.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${v.signInWithSolana.requestId}`]:[],...!((f=(d=v==null?void 0:v.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||f===void 0)&&f.length?["Resources",...v.signInWithSolana.resources.map(k=>`- ${k}`)]:[]].join(`
`);const b=await _.signMessage(new TextEncoder().encode(x),"utf8");if(!b||!(b instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=b}}try{const{data:g,error:y}=await $e(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:x,signature:ti(p)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(m=t.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:Xn});if(y)throw y;if(!g||!g.session||!g.user){const w=new Vi;return this._returnResult({data:{user:null,session:null},error:w})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:Object.assign({},g),error:y})}catch(g){if(De(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async _exchangeCodeForSession(t){const r=await $a(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{if(!n&&this.flowType==="pkce")throw new lA;const{data:a,error:i}=await $e(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Xn});if(await mr(this.storage,`${this.storageKey}-code-verifier`),i)throw i;if(!a||!a.session||!a.user){const o=new Vi;return this._returnResult({data:{user:null,session:null,redirectType:null},error:o})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign(Object.assign({},a),{redirectType:s??null}),error:i})}catch(a){if(await mr(this.storage,`${this.storageKey}-code-verifier`),De(a))return this._returnResult({data:{user:null,session:null,redirectType:null},error:a});throw a}}async signInWithIdToken(t){try{const{options:r,provider:n,token:s,access_token:a,nonce:i}=t,o=await $e(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:a,nonce:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Xn}),{data:c,error:u}=o;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!c||!c.session||!c.user){const d=new Vi;return this._returnResult({data:{user:null,session:null},error:d})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:u})}catch(r){if(De(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,n,s,a,i;try{if("email"in t){const{email:o,options:c}=t;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await $i(this.storage,this.storageKey));const{error:f}=await $e(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:f})}if("phone"in t){const{phone:o,options:c}=t,{data:u,error:d}=await $e(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(s=c==null?void 0:c.data)!==null&&s!==void 0?s:{},create_user:(a=c==null?void 0:c.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(i=c==null?void 0:c.channel)!==null&&i!==void 0?i:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d})}throw new Ru("You must provide either an email or phone number.")}catch(o){if(await mr(this.storage,`${this.storageKey}-code-verifier`),De(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async verifyOtp(t){var r,n;try{let s,a;"options"in t&&(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo,a=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:i,error:o}=await $e(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:a}}),redirectTo:s,xform:Xn});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const c=i.session,u=i.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(s){if(De(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(t){var r,n,s,a,i;try{let o=null,c=null;this.flowType==="pkce"&&([o,c]=await $i(this.storage,this.storageKey));const u=await $e(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=t==null?void 0:t.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:c}),headers:this.headers,xform:RA});return!((a=u.data)===null||a===void 0)&&a.url&&pr()&&!(!((i=t.options)===null||i===void 0)&&i.skipBrowserRedirect)&&window.location.assign(u.data.url),this._returnResult(u)}catch(o){if(await mr(this.storage,`${this.storageKey}-code-verifier`),De(o))return this._returnResult({data:null,error:o});throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new ln;const{error:s}=await $e(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(t){if(De(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:s,options:a}=t,{error:i}=await $e(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:i})}else if("phone"in t){const{phone:n,type:s,options:a}=t,{data:i,error:o}=await $e(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:o})}throw new Ru("You must provide either an email or phone number and a type")}catch(r){if(De(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await $a(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<$f:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const i=await $a(this.userStorage,this.storageKey+"-user");i!=null&&i.user?t.user=i.user:t.user=Hf()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const i={value:this.suppressGetSessionWarning};t.user=jA(t.user,i),i.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:s,error:a}=await this._callRefreshToken(t.refresh_token);return a?this._returnResult({data:{session:null},error:a}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(-1,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await $e(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:la}):await this._useSession(async r=>{var n,s,a;const{data:i,error:o}=r;if(o)throw o;return!(!((n=i.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ln}:await $e(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0,xform:la})})}catch(r){if(De(r))return iA(r)&&(await this._removeSession(),await mr(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:s,error:a}=n;if(a)throw a;if(!s.session)throw new ln;const i=s.session;let o=null,c=null;this.flowType==="pkce"&&t.email!=null&&([o,c]=await $i(this.storage,this.storageKey));const{data:u,error:d}=await $e(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:c}),jwt:i.access_token,xform:la});if(d)throw d;return i.user=u.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),this._returnResult({data:{user:i.user},error:null})})}catch(n){if(await mr(this.storage,`${this.storageKey}-code-verifier`),De(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new ln;const r=Date.now()/1e3;let n=r,s=!0,a=null;const{payload:i}=Wf(t.access_token);if(i.exp&&(n=i.exp,s=n<=r),s){const{data:o,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!o)return{data:{user:null,session:null},error:null};a=o}else{const{data:o,error:c}=await this._getUser(t.access_token);if(c)throw c;a={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return this._returnResult({data:{user:a.user,session:a},error:null})}catch(r){if(De(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:i,error:o}=r;if(o)throw o;t=(n=i.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new ln;const{data:s,error:a}=await this._callRefreshToken(t.refresh_token);return a?this._returnResult({data:{user:null,session:null},error:a}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(De(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!pr())throw new Ou("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Ou(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new uv("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ou("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new uv("No code detected.");const{data:w,error:v}=await this._exchangeCodeForSession(t.code);if(v)throw v;const _=new URL(window.location.href);return _.searchParams.delete("code"),window.history.replaceState(window.history.state,"",_.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:a,refresh_token:i,expires_in:o,expires_at:c,token_type:u}=t;if(!a||!o||!i||!u)throw new Ou("No session defined in URL");const d=Math.round(Date.now()/1e3),f=parseInt(o);let h=d+f;c&&(h=parseInt(c));const m=h-d;m*1e3<=Yi&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${f}s`);const x=h-f;d-x>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",x,h,d):d-x<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",x,h,d);const{data:p,error:g}=await this._getUser(a);if(g)throw g;const y={provider_token:n,provider_refresh_token:s,access_token:a,expires_in:f,expires_at:h,refresh_token:i,token_type:u,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:y,redirectType:t.type},error:null})}catch(n){if(De(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await $a(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:a}=r;if(a)return this._returnResult({error:a});const i=(n=s.session)===null||n===void 0?void 0:n.access_token;if(i){const{error:o}=await this.admin.signOut(i,t);if(o&&!(aA(o)&&(o.status===404||o.status===401||o.status===403)))return this._returnResult({error:o})}return t!=="others"&&(await this._removeSession(),await mr(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=pA(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,s;try{const{data:{session:a},error:i}=r;if(i)throw i;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",t,"session",a)}catch(a){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",a),console.error(a)}})}async resetPasswordForEmail(t,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await $i(this.storage,this.storageKey,!0));try{return await $e(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(a){if(await mr(this.storage,`${this.storageKey}-code-verifier`),De(a))return this._returnResult({data:null,error:a});throw a}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(De(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:s}=await this._useSession(async a=>{var i,o,c,u,d;const{data:f,error:h}=a;if(h)throw h;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(i=t.options)===null||i===void 0?void 0:i.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await $e(this.fetch,"GET",m,{headers:this.headers,jwt:(d=(u=f.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(s)throw s;return pr()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:t.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(De(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:s,data:{session:a}}=r;if(s)throw s;const{options:i,provider:o,token:c,access_token:u,nonce:d}=t,f=await $e(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=a==null?void 0:a.access_token)!==null&&n!==void 0?n:void 0,body:{provider:o,id_token:c,access_token:u,nonce:d,link_identity:!0,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:Xn}),{data:h,error:m}=f;return m?this._returnResult({data:{user:null,session:null},error:m}):!h||!h.session||!h.user?this._returnResult({data:{user:null,session:null},error:new Vi}):(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("USER_UPDATED",h.session)),this._returnResult({data:h,error:m}))}catch(s){if(await mr(this.storage,`${this.storageKey}-code-verifier`),De(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,s;const{data:a,error:i}=r;if(i)throw i;return await $e(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(De(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await yA(async s=>(s>0&&await vA(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await $e(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Xn})),(s,a)=>{const i=200*Math.pow(2,s);return a&&zf(a)&&Date.now()+i-n<Yi})}catch(n){if(this._debug(r,"error",n),De(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),pr()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await $a(this.storage,this.storageKey);if(s&&this.userStorage){let i=await $a(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:s.user},await Ji(this.userStorage,this.storageKey+"-user",i)),s.user=(t=i==null?void 0:i.user)!==null&&t!==void 0?t:Hf()}else if(s&&!s.user&&!s.user){const i=await $a(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(s.user=i.user,await mr(this.storage,this.storageKey+"-user"),await Ji(this.storage,this.storageKey,s)):s.user=Hf()}if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const a=((r=s.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<$f;if(this._debug(n,`session has${a?"":" not"} expired with margin of ${$f}s`),a){if(this.autoRefreshToken&&s.refresh_token){const{error:i}=await this._callRefreshToken(s.refresh_token);i&&(console.error(i),zf(i)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:o}=await this._getUser(s.access_token);!o&&(i!=null&&i.user)?(s.user=i.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(n,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new ln;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new B0;const{data:a,error:i}=await this._refreshAccessToken(t);if(i)throw i;if(!a.session)throw new ln;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const o={data:a.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(a){if(this._debug(s,"error",a),De(a)){const i={data:null,error:a};return zf(a)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(a),a}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,r,n=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const a=[],i=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(c){a.push(c)}});if(await Promise.all(i),a.length>0){for(let o=0;o<a.length;o+=1)console.error(a[o]);throw a[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await mr(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Ji(this.userStorage,this.storageKey+"-user",{user:r.user});const s=Object.assign({},r);delete s.user;const a=pv(s);await Ji(this.storage,this.storageKey,a)}else{const s=pv(r);await Ji(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await mr(this.storage,this.storageKey),await mr(this.storage,this.storageKey+"-code-verifier"),await mr(this.storage,this.storageKey+"-user"),this.userStorage&&await mr(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&pr()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Yi);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-t)/Yi);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Yi}ms, refresh threshold is ${jm} ticks`),s<=jm&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof ek)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!pr()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[a,i]=await $i(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(i)}`});s.push(o.toString())}if(n!=null&&n.queryParams){const a=new URLSearchParams(n.queryParams);s.push(a.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;return a?this._returnResult({data:null,error:a}):await $e(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(De(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,s;const{data:a,error:i}=r;if(i)return this._returnResult({data:null,error:i});const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:c,error:u}=await $e(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return u?this._returnResult({data:null,error:u}):(t.factorType==="totp"&&c.type==="totp"&&(!((s=c==null?void 0:c.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(r){if(De(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;if(a)return this._returnResult({data:null,error:a});const i=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?qA(t.webauthn.credential_response):YA(t.webauthn.credential_response)})}:{code:t.code}),{data:o,error:c}=await $e(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:i,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),this._returnResult({data:o,error:c}))})}catch(r){if(De(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;if(a)return this._returnResult({data:null,error:a});const i=await $e(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});if(i.error)return i;const{data:o}=i;if(o.type!=="webauthn")return{data:o,error:null};switch(o.webauthn.type){case"create":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:KA(o.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:XA(o.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(De(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const s={all:[],phone:[],totp:[],webauthn:[]};for(const a of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])s.all.push(a),a.status==="verified"&&s[a.factor_type].push(a);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:n},error:s}=await this.getSession();if(s)return this._returnResult({data:null,error:s});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=Wf(n.access_token);let i=null;a.aal&&(i=a.aal);let o=i;((r=(t=n.user.factors)===null||t===void 0?void 0:t.filter(d=>d.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(o="aal2");const u=a.amr||[];return{data:{currentLevel:i,nextLevel:o,currentAuthenticationMethods:u},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:n},error:s}=r;return s?this._returnResult({data:null,error:s}):n?await $e(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new ln})})}catch(r){if(De(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:s},error:a}=n;if(a)return this._returnResult({data:null,error:a});if(!s)return this._returnResult({data:null,error:new ln});const i=await $e(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:o=>({data:o,error:null})});return i.data&&i.data.redirect_url&&pr()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(n){if(De(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:s},error:a}=n;if(a)return this._returnResult({data:null,error:a});if(!s)return this._returnResult({data:null,error:new ln});const i=await $e(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:o=>({data:o,error:null})});return i.data&&i.data.redirect_url&&pr()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(n){if(De(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;return n?this._returnResult({data:null,error:n}):r?await $e(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new ln})})}catch(t){if(De(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:n},error:s}=r;return s?this._returnResult({data:null,error:s}):n?(await $e(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new ln})})}catch(r){if(De(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(o=>o.kid===t);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+nA>s)return n;const{data:a,error:i}=await $e(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=s,n=a.keys.find(o=>o.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:m,error:x}=await this.getSession();if(x||!m.session)return this._returnResult({data:null,error:x});n=m.session.access_token}const{header:s,payload:a,signature:i,raw:{header:o,payload:c}}=Wf(n);r!=null&&r.allowExpired||NA(a.exp);const u=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:m}=await this.getUser(n);if(m)throw m;return{data:{claims:a,header:s,signature:i},error:null}}const d=TA(s.alg),f=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,f,i,hA(`${o}.${c}`)))throw new Pm("Invalid JWT signature");return{data:{claims:a,header:s,signature:i},error:null}}catch(n){if(De(n))return this._returnResult({data:null,error:n});throw n}}}Tc.nextInstanceID={};const a5=Tc,i5="2.88.0";let Sl="";typeof Deno<"u"?Sl="deno":typeof document<"u"?Sl="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Sl="react-native":Sl="node";const o5={"X-Client-Info":`supabase-js-${Sl}/${i5}`},l5={headers:o5},c5={schema:"public"},u5={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},d5={};function Cc(e){"@babel/helpers - typeof";return Cc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cc(e)}function f5(e,t){if(Cc(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Cc(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function h5(e){var t=f5(e,"string");return Cc(t)=="symbol"?t:t+""}function m5(e,t,r){return(t=h5(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Lt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bv(Object(r),!0).forEach(function(n){m5(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bv(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const p5=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),x5=()=>Headers,g5=(e,t,r)=>{const n=p5(r),s=x5();return async(a,i)=>{var o;const c=(o=await t())!==null&&o!==void 0?o:e;let u=new s(i==null?void 0:i.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),n(a,Lt(Lt({},i),{},{headers:u}))}};function v5(e){return e.endsWith("/")?e:e+"/"}function y5(e,t){var r,n;const{db:s,auth:a,realtime:i,global:o}=e,{db:c,auth:u,realtime:d,global:f}=t,h={db:Lt(Lt({},c),s),auth:Lt(Lt({},u),a),realtime:Lt(Lt({},d),i),storage:{},global:Lt(Lt(Lt({},f),o),{},{headers:Lt(Lt({},(r=f==null?void 0:f.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}function w5(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(v5(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var _5=class extends a5{constructor(e){super(e)}},b5=class{constructor(e,t,r){var n,s;this.supabaseUrl=e,this.supabaseKey=t;const a=w5(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",a),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",a),this.storageUrl=new URL("storage/v1",a),this.functionsUrl=new URL("functions/v1",a);const i=`sb-${a.hostname.split(".")[0]}-auth-token`,o={db:c5,realtime:d5,auth:Lt(Lt({},u5),{},{storageKey:i}),global:l5},c=y5(r??{},o);if(this.storageKey=(n=c.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(s=c.global.headers)!==null&&s!==void 0?s:{},c.accessToken)this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(d,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}});else{var u;this.auth=this._initSupabaseAuthClient((u=c.auth)!==null&&u!==void 0?u:{},this.headers,c.global.fetch)}this.fetch=g5(t,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(Lt({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.accessToken&&this.accessToken().then(d=>this.realtime.setAuth(d)).catch(d=>console.warn("Failed to set initial Realtime auth token:",d)),this.rest=new t3(new URL("rest/v1",a).href,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),this.storage=new Q3(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),c.accessToken||this._listenForAuthEvents()}get functions(){return new Yj(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:n}=await e.auth.getSession();return(t=(r=n.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:s,storageKey:a,flowType:i,lock:o,debug:c,throwOnError:u},d,f){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new _5({url:this.authUrl.href,headers:Lt(Lt({},h),d),storageKey:a,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:s,flowType:i,lock:o,debug:c,throwOnError:u,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(m=>m.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new v3(this.realtimeUrl.href,Lt(Lt({},e),{},{params:Lt(Lt({},{apikey:this.supabaseKey}),e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t==null?void 0:t.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const nk=(e,t,r)=>new b5(e,t,r);function k5(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}k5()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const sk="https://ihwtjdujflbcuorldeir.supabase.co",S5="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imlod3RqZHVqZmxiY3VvcmxkZWlyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU5ODcyNDUsImV4cCI6MjA4MTU2MzI0NX0.RyWMKLeY26zpdHtSIwEzup5p3xdECJJsSqfiWbMTUg0",E5="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imlod3RqZHVqZmxiY3VvcmxkZWlyIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc2NTk4NzI0NSwiZXhwIjoyMDgxNTYzMjQ1fQ.aDZ-umZDl-g3gWWmMbhEvK0Uc-6VxhKkWEvo4JS2x7I",Be=nk(sk,S5),$d=nk(sk,E5,{auth:{autoRefreshToken:!1,persistSession:!1,detectSessionInUrl:!1,storageKey:"sb-admin-auth"}});function U0(e){return e?e.includes("@")?e:`${e.trim().toLowerCase()}@system.local`:""}function cd(e){return e?e.endsWith("@system.local")?e.replace("@system.local",""):e:""}function zs(e){if(!e||e.length===0)return null;const t=["husband","widower","widow","divorced","abandoned","second_wife","guardian","other","father","head","head_of_household","","","","",""," ","","","",""," "," "];let r=e.find(n=>n.role&&t.includes(n.role.toLowerCase().trim()));return r||(r=e.find(n=>{var s;return n.role===""&&((s=n.role_description)==null?void 0:s.includes(""))})),r||(r=[...e].sort((n,s)=>{const a=n.dob?new Date(n.dob).getTime():1/0,i=s.dob?new Date(s.dob).getTime():1/0;return a-i})[0]),r}function Ti(){return typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.random()*16|0,r=e=="x"?t:t&3|8;return r.toString(16)})}async function mx(e){let t=[],r=0;const n=1e3;for(;;){const{data:s,error:a}=await e.range(r*n,(r+1)*n-1);if(a)throw a;if(!s||s.length===0||(t=t.concat(s),s.length<n))break;r++}return t}async function rn(e=null){let t=Be.from("families").select("*",{count:"exact"});e&&(t=t.eq("camp_id",e));const r=await mx(t);return r.sort((n,s)=>(parseInt(n.family_number)||0)-(parseInt(s.family_number)||0)),r}async function ak(e){const{data:t,error:r}=await Be.from("families").select("*").eq("family_id",e).single();if(r)throw r;return t}async function N5(e){const{data:t,error:r}=await Be.from("individuals").select("*, health_records(*)").eq("family_id",e);if(r)throw r;return t.map(n=>{const s=Array.isArray(n.health_records)?n.health_records[0]:n.health_records;return{...n,is_pregnant:(s==null?void 0:s.is_pregnant)||!1,is_nursing:(s==null?void 0:s.is_nursing)||!1,notes:(s==null?void 0:s.notes)||""}})}async function zn(e=null){let t=Be.from("individuals").select(`
        *,
        families!inner (*),
        health_records (*)
    `);return e&&(t=t.eq("families.camp_id",e)),(await mx(t)).map(n=>{const s=n.families,a=Array.isArray(n.health_records)?n.health_records[0]:n.health_records;return{...n,family_number:s==null?void 0:s.family_number,family_contact:s==null?void 0:s.contact,family_delegate:s==null?void 0:s.delegate,family_address:s==null?void 0:s.address,is_departed:(s==null?void 0:s.is_departed)||!1,is_pregnant:(a==null?void 0:a.is_pregnant)||!1,is_nursing:(a==null?void 0:a.is_nursing)||!1,health_notes:(a==null?void 0:a.notes)||""}})}async function zd(e){if(!e)return!1;const{count:t,error:r}=await Be.from("individuals").select("*",{count:"exact",head:!0}).eq("nid",e);return r?(console.error("Error checking NID:",r),!1):t>0}async function Wd(e){const t={individual_id:e.individual_id||Ti(),family_id:e.family_id,name:e.name,nid:e.nid||null,dob:e.dob||null,gender:e.gender,role:e.role,role_description:e.role_description||null,deceased_husband_name:e.deceased_husband_name||null,husband_death_date:e.husband_death_date||null,shoe_size:e.shoe_size||null,clothes_size:e.clothes_size||null,created_at:new Date().toISOString()},{error:r}=await Be.from("individuals").insert(t);if(r)throw r;if(e.is_pregnant||e.is_nursing||e.notes){const n={individual_id:t.individual_id,is_pregnant:e.is_pregnant||!1,is_nursing:e.is_nursing||!1,notes:e.notes||null},{error:s}=await Be.from("health_records").insert(n);if(s)throw s}return t}async function T5(e){const{error:t}=await Be.from("individuals").delete().eq("family_id",e);if(t)throw t}async function C5(e){const{data:t,error:r}=await Be.from("aid_deliveries").select("*").eq("family_id",e);if(r)throw r;return t}async function ik(){const e=Be.from("aid_deliveries").select("*");return await mx(e)}async function kv(e){if(e.parcel_id){const{data:s}=await Be.from("aid_deliveries").select("*").eq("family_id",e.family_id).eq("parcel_id",e.parcel_id).maybeSingle();if(s)return console.log(`Duplicate parcel ignored: ${e.parcel_id} for family ${e.family_id}`),s}const t={delivery_id:e.delivery_id||Ti(),...e,created_at:new Date().toISOString()},{data:r,error:n}=await Be.from("aid_deliveries").insert(t).select().single();if(n)throw n;return r}async function j5(e){const{error:t}=await Be.from("aid_deliveries").delete().eq("delivery_id",e);if(t)throw t}async function Sv(e,t,r=null){let n;if(e.family_id){const{data:s}=await Be.from("families").select("*").eq("family_id",e.family_id).maybeSingle();s?n=await W5(e.family_id,{family_number:e.family_number,address:e.address,contact:e.contact,alternative_mobile:e.alternative_mobile,housing_status:e.housing_status,family_needs:e.family_needs,delegate:e.delegate,camp_id:e.camp_id||s.camp_id,is_departed:e.is_departed}):n=await jc(e)}else e.camp_id=e.camp_id||"default",n=await jc(e);await T5(n.family_id);for(const s of t)await Wd({...s,family_id:n.family_id});return await ck(n.family_id,n.camp_id,t,r),n}async function ok(e){var c,u,d,f;const{email:t,password:r,assigned_camps:n,...s}=e,a=U0(e.username||t),{data:i,error:o}=await Be.auth.signUp({email:a,password:r,options:{data:s}});if(o)throw new Error(o.message);if(e.role==="supervisor"&&n&&n.length>0){const{error:h}=await Be.from("user_permissions").insert({user_id:i.user.id,assigned_camps:n});h&&console.error("Error saving user permissions:",h)}return{user_id:i.user.id,email:i.user.email,username:(c=i.user.user_metadata)==null?void 0:c.username,fullName:(u=i.user.user_metadata)==null?void 0:u.fullName,role:(d=i.user.user_metadata)==null?void 0:d.role,camp_id:(f=i.user.user_metadata)==null?void 0:f.camp_id,assigned_camps:n||[]}}async function A5(e,t){var i,o,c,u,d;const r=U0(e),{data:n,error:s}=await Be.auth.signInWithPassword({email:r,password:t});if(s)throw new Error(s.message);let a=[];if(((i=n.user.user_metadata)==null?void 0:i.role)==="supervisor"){const{data:f}=await Be.from("user_permissions").select("assigned_camps").eq("user_id",n.user.id).single();a=(f==null?void 0:f.assigned_camps)||[]}return{user_id:n.user.id,email:n.user.email,username:(o=n.user.user_metadata)==null?void 0:o.username,fullName:(c=n.user.user_metadata)==null?void 0:c.fullName,role:(u=n.user.user_metadata)==null?void 0:u.role,camp_id:(d=n.user.user_metadata)==null?void 0:d.camp_id,assigned_camps:a}}async function F5(){try{const{data:e,error:t}=await $d.auth.admin.listUsers();if(t)throw new Error(t.message);const{data:r}=await Be.from("user_permissions").select("*"),n={};return r&&r.forEach(s=>{n[s.user_id]=s.assigned_camps||[]}),e.users.map(s=>{var a,i,o,c;return{user_id:s.id,email:s.email,username:((a=s.user_metadata)==null?void 0:a.username)||" ",fullName:((i=s.user_metadata)==null?void 0:i.fullName)||"",role:((o=s.user_metadata)==null?void 0:o.role)||"user",camp_id:((c=s.user_metadata)==null?void 0:c.camp_id)||null,assigned_camps:n[s.id]||[],user_metadata:s.user_metadata,created_at:s.created_at,last_sign_in_at:s.last_sign_in_at}})}catch(e){throw console.error("Error fetching users:",e),e}}async function P5(e,t){var r,n,s,a;try{const{data:i}=await $d.auth.admin.getUserById(e),{assigned_camps:o,...c}=t,d={user_metadata:{...i.user.user_metadata,...c},...t.username&&{email:U0(t.username)},...t.email&&{email:t.email},...t.password&&{password:t.password}},{data:f,error:h}=await $d.auth.admin.updateUserById(e,d);if(h)throw new Error(h.message);if(t.role==="supervisor"&&o!==void 0){const{error:m}=await Be.from("user_permissions").upsert({user_id:e,assigned_camps:o,updated_at:new Date().toISOString()},{onConflict:"user_id"});m&&console.error("Error updating user permissions:",m)}else t.role&&t.role!=="supervisor"&&await Be.from("user_permissions").delete().eq("user_id",e);return{user_id:f.user.id,email:f.user.email,username:(r=f.user.user_metadata)==null?void 0:r.username,fullName:(n=f.user.user_metadata)==null?void 0:n.fullName,role:(s=f.user.user_metadata)==null?void 0:s.role,camp_id:(a=f.user.user_metadata)==null?void 0:a.camp_id,assigned_camps:o}}catch(i){throw console.error("Error updating user:",i),i}}async function R5(e){try{const{error:t}=await $d.auth.admin.deleteUser(e);if(t)throw new Error(t.message);return!0}catch(t){throw console.error("Error deleting user:",t),t}}async function Hd(e){const t={notification_id:Ti(),...e,is_read:0,created_at:new Date().toISOString()},{data:r,error:n}=await Be.from("notifications").insert(t).select().single();if(n)throw n;return r}async function lk(){const{data:e,error:t}=await Be.from("notifications").select("*").eq("is_read",0).order("created_at",{ascending:!1});if(t)throw t;return e}async function Ev(e){await Be.from("notifications").update({is_read:1}).eq("notification_id",e)}async function O5(){const{error:e}=await Be.from("notifications").delete().neq("notification_id","00000000-0000-0000-0000-000000000000");if(e)throw e}async function ck(e,t,r,n=null){try{const s=r.map(h=>h.nid).filter(h=>h&&h.trim()!=="");if(s.length===0)return;const{data:a,error:i}=await Be.from("individuals").select(`
                individual_id,
                nid,
                name,
                role,
                family_id,
                families!inner (
                    family_id,
                    family_number,
                    camp_id,
                    is_departed,
                    camps!inner (
                        name
                    )
                )
            `).in("nid",s).neq("families.camp_id",t);if(i){console.error("Error checking cross-camp duplicates:",i);return}if(!a||a.length===0)return;const{data:o}=await Be.from("families").select(`
                family_number,
                is_departed,
                camps!inner (
                    name
                )
            `).eq("family_id",e).single();if(!o||o.is_departed)return;const c={};for(const h of a){const m=h.families;if(m.is_departed)continue;const x=m.family_id;c[x]||(c[x]={family_number:m.family_number,camp_name:m.camps.name,individuals:[]}),c[x].individuals.push({name:h.name,nid:h.nid,role:h.role})}const u={husband:1,wife:2,widow:3,widower:4,divorced:5,abandoned:6,guardian:7};let d=" ",f=99;for(const h of r){const m=u[h.role]||99;m<f&&(f=m,d=h.name)}for(const[h,m]of Object.entries(c)){const x=m.individuals.length;if(x===0)continue;let p=" ";try{const{data:y}=await Be.from("individuals").select("name, role").eq("family_id",h);if(y){let w=99;for(const v of y){const _=u[v.role]||99;_<w&&(w=_,p=v.name)}}}catch(y){console.error("Error fetching other head name:",y)}const g=` :   ${o.family_number} (${d})   ${o.camps.name}         ${m.family_number} (${p})   ${m.camp_name}. (  : ${x})`;await Hd({user_name:(n==null?void 0:n.username)||"",message:g,type:"alert"})}}catch(s){console.error("Error in checkCrossCampDuplicates:",s)}}async function D5(e=null){var t,r;try{console.log("   ...");const{data:n,error:s}=await Be.from("individuals").select(`
                individual_id,
                nid,
                name,
                role,
                family_id,
                families!inner (
                    family_id,
                    family_number,
                    camp_id,
                    is_departed
                )
            `).not("nid","is",null);if(s)throw console.error("Error fetching individuals:",s),s;const a=n.filter(p=>!p.families.is_departed);console.log(`  ${a.length}    `);const i={},o={husband:1,wife:2,widow:3,widower:4,divorced:5,abandoned:6,guardian:7};for(const p of a){const g=p.family_id,y=o[p.role]||99;(!i[g]||y<i[g].priority)&&(i[g]={name:p.name,priority:y})}const{data:c}=await Be.from("camps").select("camp_id, name"),u={};c&&c.forEach(p=>{u[p.camp_id]=p.name});const d={};for(const p of a)!p.nid||p.nid.trim()===""||u[p.families.camp_id]&&(d[p.nid]||(d[p.nid]=[]),d[p.nid].push(p));const f=[];for(const[p,g]of Object.entries(d)){if(g.length<2)continue;new Set(g.map(w=>w.families.camp_id)).size>1&&f.push({nid:p,individuals:g})}console.log(`   ${f.length}     `);const h={};for(const p of f){const g=p.individuals;for(let y=0;y<g.length;y++)for(let w=y+1;w<g.length;w++){const v=g[y],_=g[w];if(v.families.camp_id!==_.families.camp_id){const S=[v.families,_.families].sort((k,T)=>k.family_id.localeCompare(T.family_id)),b=`${S[0].family_id}_${S[1].family_id}`;h[b]||(h[b]={f1:S[0],f2:S[1],sharedNids:new Set}),h[b].sharedNids.add(p.nid)}}}let m=0;const x=Object.values(h);for(const p of x){const g=p.sharedNids.size;if(g===0)continue;const y=u[p.f1.camp_id],w=u[p.f2.camp_id],v=((t=i[p.f1.family_id])==null?void 0:t.name)||" ",_=((r=i[p.f2.family_id])==null?void 0:r.name)||" ",S=`  :   ${p.f1.family_number} (${v})   ${y}         ${p.f2.family_number} (${_})   ${w}. (  : ${g})`;await Hd({user_name:(e==null?void 0:e.username)||"",message:S,type:"alert"}),m++}return console.log(`  ${m}  `),{success:!0,totalDuplicates:f.length,notificationsSent:m}}catch(n){throw console.error("Error in scanExistingFamiliesForDuplicates:",n),n}}async function Uo(e){let t=Be.from("delegates").select("*");e&&(t=t.eq("camp_id",e));const{data:r,error:n}=await t;if(n)throw n;return r}async function I5(e){let t,r={};typeof e=="string"?(t=e,r={name:t}):(t=e.name,r=e);const n={delegate_id:Ti(),...r,created_at:new Date().toISOString()},{data:s,error:a}=await Be.from("delegates").insert(n).select().single();if(a)throw a;return s}async function L5(e,t){const{data:r,error:n}=await Be.from("delegates").update(t).eq("delegate_id",e).select().single();if(n)throw n;return r}async function M5(e){const{error:t}=await Be.from("delegates").delete().eq("delegate_id",e);if(t)throw t}async function B5(e){const{count:t,error:r}=await Be.from("delegates").update({camp_id:e}).is("camp_id",null).select("*",{count:"exact"});if(r)throw r;return t}async function U5(){const{count:e,error:t}=await Be.from("delegates").select("*",{count:"exact",head:!0}).is("camp_id",null);if(t)throw t;return e}async function uk(){const{data:e,error:t}=await Be.from("camps").select("*");if(t)throw t;return e}async function V5(e){const t={camp_id:Ti(),name:typeof e=="string"?e:e.name,is_default:!1,created_at:new Date().toISOString()},{data:r,error:n}=await Be.from("camps").insert(t).select().single();if(n)throw n;return r}async function $5(e,t){const{data:r,error:n}=await Be.from("camps").update(t).eq("camp_id",e).select().single();if(n)throw n;return r}async function z5(e){const{error:t}=await Be.from("camps").delete().eq("camp_id",e);if(t)throw t}async function jc(e){const t={family_id:e.family_id||Ti(),...e,created_at:new Date().toISOString()},{data:r,error:n}=await Be.from("families").insert(t).select().single();if(n)throw n;return r}async function W5(e,t){const{data:r,error:n}=await Be.from("families").update(t).eq("family_id",e).select().single();if(n)throw n;return r}async function dk(e){const{error:t}=await Be.from("families").delete().eq("family_id",e);if(t)throw t}async function H5(e){let t=Be.from("parcels").select("*").order("created_at",{ascending:!1});e&&(t=t.eq("camp_id",e));const{data:r,error:n}=await t;return n?(console.warn("Parcels table might not exist yet:",n.message),[]):r}async function G5(e){const{data:t}=await Be.from("parcels").select("display_id").eq("camp_id",e.camp_id).order("display_id",{ascending:!1}).limit(1).maybeSingle();let r=1;t&&t.display_id&&(r=t.display_id+1);const n={parcel_id:e.parcel_id||Ti(),...e,display_id:r,created_at:new Date().toISOString()},{data:s,error:a}=await Be.from("parcels").insert(n).select().single();if(a)throw a;return s}async function K5(e,t){const{data:r,error:n}=await Be.from("parcels").update(t).eq("parcel_id",e).select().single();if(n)throw n;return r}async function X5(e){await Be.from("aid_deliveries").delete().eq("parcel_id",e);const{error:t}=await Be.from("parcels").delete().eq("parcel_id",e);if(t)throw t}const fk=E.createContext(null),q5=({children:e})=>{const[t,r]=E.useState(null),[n,s]=E.useState(!0);E.useEffect(()=>{const c=localStorage.getItem("local_user");if(c)try{r(JSON.parse(c))}catch(d){console.error("Failed to parse user session",d),localStorage.removeItem("local_user")}Be.auth.getSession().then(({data:{session:d},error:f})=>{f&&(console.warn("Session check error:",f.message),(f.message.includes("Invalid Refresh Token")||f.message.includes("Refresh Token Not Found"))&&(console.log("Forcing logout due to invalid token"),o())),s(!1)}).catch(d=>{console.error("Unexpected session error:",d),s(!1)});const{data:{subscription:u}}=Be.auth.onAuthStateChange(async(d,f)=>{if(d==="SIGNED_OUT")r(null),localStorage.removeItem("local_user");else if(d==="SIGNED_IN"&&f){const h=f.user.user_metadata;let m=[];if((h==null?void 0:h.role)==="supervisor"){const{data:p}=await Be.from("user_permissions").select("assigned_camps").eq("user_id",f.user.id).single();m=(p==null?void 0:p.assigned_camps)||[]}const x={user_id:f.user.id,email:cd(f.user.email),username:h==null?void 0:h.username,fullName:h==null?void 0:h.fullName,role:h==null?void 0:h.role,camp_id:h==null?void 0:h.camp_id,assigned_camps:m};r(x),localStorage.setItem("local_user",JSON.stringify(x))}});return()=>u.unsubscribe()},[]);const a=async(c,u)=>{try{const d=await A5(c,u);return d.email=cd(d.email),localStorage.setItem("local_user",JSON.stringify(d)),r(d),d}catch(d){throw d}},i=async(c,u,d={})=>{try{const f=await ok({email:c,password:u,role:d.role||"user",username:d.username});return f.email=cd(f.email),localStorage.setItem("local_user",JSON.stringify(f)),r(f),f}catch(f){throw f}},o=async()=>{await Be.auth.signOut(),localStorage.removeItem("local_user"),localStorage.removeItem("selected_camp_id"),r(null)};return l.jsx(fk.Provider,{value:{user:t,login:a,logout:o,register:i,loading:n},children:e})},on=()=>E.useContext(fk),hk=E.createContext();function Nn(){return E.useContext(hk)}function Y5({children:e}){const[t,r]=E.useState(null),[n,s]=E.useState([]),[a,i]=E.useState(!0),{user:o,loading:c}=on();E.useEffect(()=>{c||(o===null?(r(null),s([]),localStorage.removeItem("selected_camp_id"),i(!1)):o&&u())},[o,c]);const u=async()=>{try{let m=[];try{if(navigator.onLine)m=await uk(),m.length>0&&localStorage.setItem("cached_camps",JSON.stringify(m));else throw new Error("Offline")}catch(p){console.log("Fetching camps failed (offline/error), attempting to load cache...",p);const g=localStorage.getItem("cached_camps");g&&(m=JSON.parse(g))}if(o&&o.camp_id&&o.role==="manager")m=m.filter(p=>p.camp_id===o.camp_id);else if(o&&o.role==="supervisor"&&o.assigned_camps){const p=o.assigned_camps||[];m=m.filter(g=>p.includes(g.camp_id))}s(m);const x=localStorage.getItem("selected_camp_id");if(o&&o.camp_id&&o.role==="manager"){const p=m.find(g=>g.camp_id===o.camp_id);p&&(r(p),localStorage.setItem("selected_camp_id",p.camp_id))}else if(o&&o.role==="supervisor"&&o.assigned_camps)if(x){const p=m.find(g=>g.camp_id===x);p?r(p):m.length>0&&(r(m[0]),localStorage.setItem("selected_camp_id",m[0].camp_id))}else(m.length===1||m.length>1)&&(r(m[0]),localStorage.setItem("selected_camp_id",m[0].camp_id));else if(x){const p=m.find(g=>g.camp_id===x);p?r(p):m.length>0&&m.length===1&&(r(m[0]),localStorage.setItem("selected_camp_id",m[0].camp_id))}else m.length===1&&(r(m[0]),localStorage.setItem("selected_camp_id",m[0].camp_id))}catch(m){console.error("Failed to load camps",m)}finally{i(!1)}},h={selectedCamp:t,camps:n,loading:a,changeCamp:m=>{r(m),m?localStorage.setItem("selected_camp_id",m.camp_id):localStorage.removeItem("selected_camp_id")},refreshCamps:async()=>{await u()}};return l.jsx(hk.Provider,{value:h,children:e})}const px=E.createContext({});function Ci(e){const t=E.useRef(null);return t.current===null&&(t.current=e()),t.current}const V0=E.createContext(null),$0=E.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class J5 extends E.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const n=this.props.sizeRef.current;n.height=r.offsetHeight||0,n.width=r.offsetWidth||0,n.top=r.offsetTop,n.left=r.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function Q5({children:e,isPresent:t}){const r=E.useId(),n=E.useRef(null),s=E.useRef({width:0,height:0,top:0,left:0}),{nonce:a}=E.useContext($0);return E.useInsertionEffect(()=>{const{width:i,height:o,top:c,left:u}=s.current;if(t||!n.current||!i||!o)return;n.current.dataset.motionPopId=r;const d=document.createElement("style");return a&&(d.nonce=a),document.head.appendChild(d),d.sheet&&d.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${o}px !important;
            top: ${c}px !important;
            left: ${u}px !important;
          }
        `),()=>{document.head.removeChild(d)}},[t]),l.jsx(J5,{isPresent:t,childRef:n,sizeRef:s,children:E.cloneElement(e,{ref:n})})}const Z5=({children:e,initial:t,isPresent:r,onExitComplete:n,custom:s,presenceAffectsLayout:a,mode:i})=>{const o=Ci(eF),c=E.useId(),u=E.useCallback(f=>{o.set(f,!0);for(const h of o.values())if(!h)return;n&&n()},[o,n]),d=E.useMemo(()=>({id:c,initial:t,isPresent:r,custom:s,onExitComplete:u,register:f=>(o.set(f,!1),()=>o.delete(f))}),a?[Math.random(),u]:[r,u]);return E.useMemo(()=>{o.forEach((f,h)=>o.set(h,!1))},[r]),E.useEffect(()=>{!r&&!o.size&&n&&n()},[r]),i==="popLayout"&&(e=l.jsx(Q5,{isPresent:r,children:e})),l.jsx(V0.Provider,{value:d,children:e})};function eF(){return new Map}function mk(e=!0){const t=E.useContext(V0);if(t===null)return[!0,null];const{isPresent:r,onExitComplete:n,register:s}=t,a=E.useId();E.useEffect(()=>{e&&s(a)},[e]);const i=E.useCallback(()=>e&&n&&n(a),[a,n,e]);return!r&&n?[!1,i]:[!0]}const Du=e=>e.key||"";function Nv(e){const t=[];return E.Children.forEach(e,r=>{E.isValidElement(r)&&t.push(r)}),t}const xx=typeof window<"u",gx=xx?E.useLayoutEffect:E.useEffect,Ar=({children:e,custom:t,initial:r=!0,onExitComplete:n,presenceAffectsLayout:s=!0,mode:a="sync",propagate:i=!1})=>{const[o,c]=mk(i),u=E.useMemo(()=>Nv(e),[e]),d=i&&!o?[]:u.map(Du),f=E.useRef(!0),h=E.useRef(u),m=Ci(()=>new Map),[x,p]=E.useState(u),[g,y]=E.useState(u);gx(()=>{f.current=!1,h.current=u;for(let _=0;_<g.length;_++){const S=Du(g[_]);d.includes(S)?m.delete(S):m.get(S)!==!0&&m.set(S,!1)}},[g,d.length,d.join("-")]);const w=[];if(u!==x){let _=[...u];for(let S=0;S<g.length;S++){const b=g[S],k=Du(b);d.includes(k)||(_.splice(S,0,b),w.push(b))}a==="wait"&&w.length&&(_=w),y(Nv(_)),p(u);return}const{forceRender:v}=E.useContext(px);return l.jsx(l.Fragment,{children:g.map(_=>{const S=Du(_),b=i&&!o?!1:u===g||d.includes(S),k=()=>{if(m.has(S))m.set(S,!0);else return;let T=!0;m.forEach(j=>{j||(T=!1)}),T&&(v==null||v(),y(h.current),i&&(c==null||c()),n&&n())};return l.jsx(Z5,{isPresent:b,initial:!f.current||r?void 0:!1,custom:b?void 0:t,presenceAffectsLayout:s,mode:a,onExitComplete:b?void 0:k,children:_},S)})})},wn=e=>e;let pk=wn;function vx(e){let t;return()=>(t===void 0&&(t=e()),t)}const Vo=(e,t,r)=>{const n=t-e;return n===0?1:(r-e)/n},Os=e=>e*1e3,Ds=e=>e/1e3,tF={useManualTiming:!1};function rF(e){let t=new Set,r=new Set,n=!1,s=!1;const a=new WeakSet;let i={delta:0,timestamp:0,isProcessing:!1};function o(u){a.has(u)&&(c.schedule(u),e()),u(i)}const c={schedule:(u,d=!1,f=!1)=>{const m=f&&n?t:r;return d&&a.add(u),m.has(u)||m.add(u),u},cancel:u=>{r.delete(u),a.delete(u)},process:u=>{if(i=u,n){s=!0;return}n=!0,[t,r]=[r,t],t.forEach(o),t.clear(),n=!1,s&&(s=!1,c.process(u))}};return c}const Iu=["read","resolveKeyframes","update","preRender","render","postRender"],nF=40;function xk(e,t){let r=!1,n=!0;const s={delta:0,timestamp:0,isProcessing:!1},a=()=>r=!0,i=Iu.reduce((y,w)=>(y[w]=rF(a),y),{}),{read:o,resolveKeyframes:c,update:u,preRender:d,render:f,postRender:h}=i,m=()=>{const y=performance.now();r=!1,s.delta=n?1e3/60:Math.max(Math.min(y-s.timestamp,nF),1),s.timestamp=y,s.isProcessing=!0,o.process(s),c.process(s),u.process(s),d.process(s),f.process(s),h.process(s),s.isProcessing=!1,r&&t&&(n=!1,e(m))},x=()=>{r=!0,n=!0,s.isProcessing||e(m)};return{schedule:Iu.reduce((y,w)=>{const v=i[w];return y[w]=(_,S=!1,b=!1)=>(r||x(),v.schedule(_,S,b)),y},{}),cancel:y=>{for(let w=0;w<Iu.length;w++)i[Iu[w]].cancel(y)},state:s,steps:i}}const{schedule:vt,cancel:Ws,state:vr,steps:Kf}=xk(typeof requestAnimationFrame<"u"?requestAnimationFrame:wn,!0),gk=E.createContext({strict:!1}),Tv={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},$o={};for(const e in Tv)$o[e]={isEnabled:t=>Tv[e].some(r=>!!t[r])};function sF(e){for(const t in e)$o[t]={...$o[t],...e[t]}}const aF=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Gd(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||aF.has(e)}let vk=e=>!Gd(e);function iF(e){e&&(vk=t=>t.startsWith("on")?!Gd(t):e(t))}try{iF(require("@emotion/is-prop-valid").default)}catch{}function oF(e,t,r){const n={};for(const s in e)s==="values"&&typeof e.values=="object"||(vk(s)||r===!0&&Gd(s)||!t&&!Gd(s)||e.draggable&&s.startsWith("onDrag"))&&(n[s]=e[s]);return n}function lF(e){if(typeof Proxy>"u")return e;const t=new Map,r=(...n)=>e(...n);return new Proxy(r,{get:(n,s)=>s==="create"?e:(t.has(s)||t.set(s,e(s)),t.get(s))})}const z0=E.createContext({});function Ac(e){return typeof e=="string"||Array.isArray(e)}function W0(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const yx=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],wx=["initial",...yx];function H0(e){return W0(e.animate)||wx.some(t=>Ac(e[t]))}function yk(e){return!!(H0(e)||e.variants)}function cF(e,t){if(H0(e)){const{initial:r,animate:n}=e;return{initial:r===!1||Ac(r)?r:void 0,animate:Ac(n)?n:void 0}}return e.inherit!==!1?t:{}}function uF(e){const{initial:t,animate:r}=cF(e,E.useContext(z0));return E.useMemo(()=>({initial:t,animate:r}),[Cv(t),Cv(r)])}function Cv(e){return Array.isArray(e)?e.join(" "):e}const dF=Symbol.for("motionComponentSymbol");function ho(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function fF(e,t,r){return E.useCallback(n=>{n&&e.onMount&&e.onMount(n),t&&(n?t.mount(n):t.unmount()),r&&(typeof r=="function"?r(n):ho(r)&&(r.current=n))},[t])}const _x=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),hF="framerAppearId",wk="data-"+_x(hF),{schedule:bx}=xk(queueMicrotask,!1),_k=E.createContext({});function mF(e,t,r,n,s){var a,i;const{visualElement:o}=E.useContext(z0),c=E.useContext(gk),u=E.useContext(V0),d=E.useContext($0).reducedMotion,f=E.useRef(null);n=n||c.renderer,!f.current&&n&&(f.current=n(e,{visualState:t,parent:o,props:r,presenceContext:u,blockInitialAnimation:u?u.initial===!1:!1,reducedMotionConfig:d}));const h=f.current,m=E.useContext(_k);h&&!h.projection&&s&&(h.type==="html"||h.type==="svg")&&pF(f.current,r,s,m);const x=E.useRef(!1);E.useInsertionEffect(()=>{h&&x.current&&h.update(r,u)});const p=r[wk],g=E.useRef(!!p&&!(!((a=window.MotionHandoffIsComplete)===null||a===void 0)&&a.call(window,p))&&((i=window.MotionHasOptimisedAnimation)===null||i===void 0?void 0:i.call(window,p)));return gx(()=>{h&&(x.current=!0,window.MotionIsMounted=!0,h.updateFeatures(),bx.render(h.render),g.current&&h.animationState&&h.animationState.animateChanges())}),E.useEffect(()=>{h&&(!g.current&&h.animationState&&h.animationState.animateChanges(),g.current&&(queueMicrotask(()=>{var y;(y=window.MotionHandoffMarkAsComplete)===null||y===void 0||y.call(window,p)}),g.current=!1))}),h}function pF(e,t,r,n){const{layoutId:s,layout:a,drag:i,dragConstraints:o,layoutScroll:c,layoutRoot:u}=t;e.projection=new r(e.latestValues,t["data-framer-portal-id"]?void 0:bk(e.parent)),e.projection.setOptions({layoutId:s,layout:a,alwaysMeasureLayout:!!i||o&&ho(o),visualElement:e,animationType:typeof a=="string"?a:"both",initialPromotionConfig:n,layoutScroll:c,layoutRoot:u})}function bk(e){if(e)return e.options.allowProjection!==!1?e.projection:bk(e.parent)}function xF({preloadedFeatures:e,createVisualElement:t,useRender:r,useVisualState:n,Component:s}){var a,i;e&&sF(e);function o(u,d){let f;const h={...E.useContext($0),...u,layoutId:gF(u)},{isStatic:m}=h,x=uF(u),p=n(u,m);if(!m&&xx){vF();const g=yF(h);f=g.MeasureLayout,x.visualElement=mF(s,p,h,t,g.ProjectionNode)}return l.jsxs(z0.Provider,{value:x,children:[f&&x.visualElement?l.jsx(f,{visualElement:x.visualElement,...h}):null,r(s,u,fF(p,x.visualElement,d),p,m,x.visualElement)]})}o.displayName=`motion.${typeof s=="string"?s:`create(${(i=(a=s.displayName)!==null&&a!==void 0?a:s.name)!==null&&i!==void 0?i:""})`}`;const c=E.forwardRef(o);return c[dF]=s,c}function gF({layoutId:e}){const t=E.useContext(px).id;return t&&e!==void 0?t+"-"+e:e}function vF(e,t){E.useContext(gk).strict}function yF(e){const{drag:t,layout:r}=$o;if(!t&&!r)return{};const n={...t,...r};return{MeasureLayout:t!=null&&t.isEnabled(e)||r!=null&&r.isEnabled(e)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}const wF=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function kx(e){return typeof e!="string"||e.includes("-")?!1:!!(wF.indexOf(e)>-1||/[A-Z]/u.test(e))}function jv(e){const t=[{},{}];return e==null||e.values.forEach((r,n)=>{t[0][n]=r.get(),t[1][n]=r.getVelocity()}),t}function Sx(e,t,r,n){if(typeof t=="function"){const[s,a]=jv(n);t=t(r!==void 0?r:e.custom,s,a)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[s,a]=jv(n);t=t(r!==void 0?r:e.custom,s,a)}return t}const Rm=e=>Array.isArray(e),_F=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),bF=e=>Rm(e)?e[e.length-1]||0:e,_r=e=>!!(e&&e.getVelocity);function ud(e){const t=_r(e)?e.get():e;return _F(t)?t.toValue():t}function kF({scrapeMotionValuesFromProps:e,createRenderState:t,onUpdate:r},n,s,a){const i={latestValues:SF(n,s,a,e),renderState:t()};return r&&(i.onMount=o=>r({props:n,current:o,...i}),i.onUpdate=o=>r(o)),i}const kk=e=>(t,r)=>{const n=E.useContext(z0),s=E.useContext(V0),a=()=>kF(e,t,n,s);return r?a():Ci(a)};function SF(e,t,r,n){const s={},a=n(e,{});for(const h in a)s[h]=ud(a[h]);let{initial:i,animate:o}=e;const c=H0(e),u=yk(e);t&&u&&!c&&e.inherit!==!1&&(i===void 0&&(i=t.initial),o===void 0&&(o=t.animate));let d=r?r.initial===!1:!1;d=d||i===!1;const f=d?o:i;if(f&&typeof f!="boolean"&&!W0(f)){const h=Array.isArray(f)?f:[f];for(let m=0;m<h.length;m++){const x=Sx(e,h[m]);if(x){const{transitionEnd:p,transition:g,...y}=x;for(const w in y){let v=y[w];if(Array.isArray(v)){const _=d?v.length-1:0;v=v[_]}v!==null&&(s[w]=v)}for(const w in p)s[w]=p[w]}}}return s}const el=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],ji=new Set(el),Sk=e=>t=>typeof t=="string"&&t.startsWith(e),Ek=Sk("--"),EF=Sk("var(--"),Ex=e=>EF(e)?NF.test(e.split("/*")[0].trim()):!1,NF=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Nk=(e,t)=>t&&typeof e=="number"?t.transform(e):e,Hs=(e,t,r)=>r>t?t:r<e?e:r,tl={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Fc={...tl,transform:e=>Hs(0,1,e)},Lu={...tl,default:1},tu=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),ra=tu("deg"),ys=tu("%"),ze=tu("px"),TF=tu("vh"),CF=tu("vw"),Av={...ys,parse:e=>ys.parse(e)/100,transform:e=>ys.transform(e*100)},jF={borderWidth:ze,borderTopWidth:ze,borderRightWidth:ze,borderBottomWidth:ze,borderLeftWidth:ze,borderRadius:ze,radius:ze,borderTopLeftRadius:ze,borderTopRightRadius:ze,borderBottomRightRadius:ze,borderBottomLeftRadius:ze,width:ze,maxWidth:ze,height:ze,maxHeight:ze,top:ze,right:ze,bottom:ze,left:ze,padding:ze,paddingTop:ze,paddingRight:ze,paddingBottom:ze,paddingLeft:ze,margin:ze,marginTop:ze,marginRight:ze,marginBottom:ze,marginLeft:ze,backgroundPositionX:ze,backgroundPositionY:ze},AF={rotate:ra,rotateX:ra,rotateY:ra,rotateZ:ra,scale:Lu,scaleX:Lu,scaleY:Lu,scaleZ:Lu,skew:ra,skewX:ra,skewY:ra,distance:ze,translateX:ze,translateY:ze,translateZ:ze,x:ze,y:ze,z:ze,perspective:ze,transformPerspective:ze,opacity:Fc,originX:Av,originY:Av,originZ:ze},Fv={...tl,transform:Math.round},Nx={...jF,...AF,zIndex:Fv,size:ze,fillOpacity:Fc,strokeOpacity:Fc,numOctaves:Fv},FF={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},PF=el.length;function RF(e,t,r){let n="",s=!0;for(let a=0;a<PF;a++){const i=el[a],o=e[i];if(o===void 0)continue;let c=!0;if(typeof o=="number"?c=o===(i.startsWith("scale")?1:0):c=parseFloat(o)===0,!c||r){const u=Nk(o,Nx[i]);if(!c){s=!1;const d=FF[i]||i;n+=`${d}(${u}) `}r&&(t[i]=u)}}return n=n.trim(),r?n=r(t,s?"":n):s&&(n="none"),n}function Tx(e,t,r){const{style:n,vars:s,transformOrigin:a}=e;let i=!1,o=!1;for(const c in t){const u=t[c];if(ji.has(c)){i=!0;continue}else if(Ek(c)){s[c]=u;continue}else{const d=Nk(u,Nx[c]);c.startsWith("origin")?(o=!0,a[c]=d):n[c]=d}}if(t.transform||(i||r?n.transform=RF(t,e.transform,r):n.transform&&(n.transform="none")),o){const{originX:c="50%",originY:u="50%",originZ:d=0}=a;n.transformOrigin=`${c} ${u} ${d}`}}const OF={offset:"stroke-dashoffset",array:"stroke-dasharray"},DF={offset:"strokeDashoffset",array:"strokeDasharray"};function IF(e,t,r=1,n=0,s=!0){e.pathLength=1;const a=s?OF:DF;e[a.offset]=ze.transform(-n);const i=ze.transform(t),o=ze.transform(r);e[a.array]=`${i} ${o}`}function Pv(e,t,r){return typeof e=="string"?e:ze.transform(t+r*e)}function LF(e,t,r){const n=Pv(t,e.x,e.width),s=Pv(r,e.y,e.height);return`${n} ${s}`}function Cx(e,{attrX:t,attrY:r,attrScale:n,originX:s,originY:a,pathLength:i,pathSpacing:o=1,pathOffset:c=0,...u},d,f){if(Tx(e,u,f),d){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:h,style:m,dimensions:x}=e;h.transform&&(x&&(m.transform=h.transform),delete h.transform),x&&(s!==void 0||a!==void 0||m.transform)&&(m.transformOrigin=LF(x,s!==void 0?s:.5,a!==void 0?a:.5)),t!==void 0&&(h.x=t),r!==void 0&&(h.y=r),n!==void 0&&(h.scale=n),i!==void 0&&IF(h,i,o,c,!1)}const jx=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),Tk=()=>({...jx(),attrs:{}}),Ax=e=>typeof e=="string"&&e.toLowerCase()==="svg";function Ck(e,{style:t,vars:r},n,s){Object.assign(e.style,t,s&&s.getProjectionStyles(n));for(const a in r)e.style.setProperty(a,r[a])}const jk=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function Ak(e,t,r,n){Ck(e,t,void 0,n);for(const s in t.attrs)e.setAttribute(jk.has(s)?s:_x(s),t.attrs[s])}const Kd={};function MF(e){Object.assign(Kd,e)}function Fk(e,{layout:t,layoutId:r}){return ji.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!Kd[e]||e==="opacity")}function Fx(e,t,r){var n;const{style:s}=e,a={};for(const i in s)(_r(s[i])||t.style&&_r(t.style[i])||Fk(i,e)||((n=r==null?void 0:r.getValue(i))===null||n===void 0?void 0:n.liveStyle)!==void 0)&&(a[i]=s[i]);return a}function Pk(e,t,r){const n=Fx(e,t,r);for(const s in e)if(_r(e[s])||_r(t[s])){const a=el.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;n[a]=e[s]}return n}function BF(e,t){try{t.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{t.dimensions={x:0,y:0,width:0,height:0}}}const Rv=["x","y","width","height","cx","cy","r"],UF={useVisualState:kk({scrapeMotionValuesFromProps:Pk,createRenderState:Tk,onUpdate:({props:e,prevProps:t,current:r,renderState:n,latestValues:s})=>{if(!r)return;let a=!!e.drag;if(!a){for(const o in s)if(ji.has(o)){a=!0;break}}if(!a)return;let i=!t;if(t)for(let o=0;o<Rv.length;o++){const c=Rv[o];e[c]!==t[c]&&(i=!0)}i&&vt.read(()=>{BF(r,n),vt.render(()=>{Cx(n,s,Ax(r.tagName),e.transformTemplate),Ak(r,n)})})}})},VF={useVisualState:kk({scrapeMotionValuesFromProps:Fx,createRenderState:jx})};function Rk(e,t,r){for(const n in t)!_r(t[n])&&!Fk(n,r)&&(e[n]=t[n])}function $F({transformTemplate:e},t){return E.useMemo(()=>{const r=jx();return Tx(r,t,e),Object.assign({},r.vars,r.style)},[t])}function zF(e,t){const r=e.style||{},n={};return Rk(n,r,e),Object.assign(n,$F(e,t)),n}function WF(e,t){const r={},n=zF(e,t);return e.drag&&e.dragListener!==!1&&(r.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(r.tabIndex=0),r.style=n,r}function HF(e,t,r,n){const s=E.useMemo(()=>{const a=Tk();return Cx(a,t,Ax(n),e.transformTemplate),{...a.attrs,style:{...a.style}}},[t]);if(e.style){const a={};Rk(a,e.style,e),s.style={...a,...s.style}}return s}function GF(e=!1){return(r,n,s,{latestValues:a},i)=>{const c=(kx(r)?HF:WF)(n,a,i,r),u=oF(n,typeof r=="string",e),d=r!==E.Fragment?{...u,...c,ref:s}:{},{children:f}=n,h=E.useMemo(()=>_r(f)?f.get():f,[f]);return E.createElement(r,{...d,children:h})}}function KF(e,t){return function(n,{forwardMotionProps:s}={forwardMotionProps:!1}){const i={...kx(n)?UF:VF,preloadedFeatures:e,useRender:GF(s),createVisualElement:t,Component:n};return xF(i)}}function Ok(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}function G0(e,t,r){const n=e.getProps();return Sx(n,t,r!==void 0?r:n.custom,e)}const XF=vx(()=>window.ScrollTimeline!==void 0);class qF{constructor(t){this.stop=()=>this.runAll("stop"),this.animations=t.filter(Boolean)}get finished(){return Promise.all(this.animations.map(t=>"finished"in t?t.finished:t))}getAll(t){return this.animations[0][t]}setAll(t,r){for(let n=0;n<this.animations.length;n++)this.animations[n][t]=r}attachTimeline(t,r){const n=this.animations.map(s=>{if(XF()&&s.attachTimeline)return s.attachTimeline(t);if(typeof r=="function")return r(s)});return()=>{n.forEach((s,a)=>{s&&s(),this.animations[a].stop()})}}get time(){return this.getAll("time")}set time(t){this.setAll("time",t)}get speed(){return this.getAll("speed")}set speed(t){this.setAll("speed",t)}get startTime(){return this.getAll("startTime")}get duration(){let t=0;for(let r=0;r<this.animations.length;r++)t=Math.max(t,this.animations[r].duration);return t}runAll(t){this.animations.forEach(r=>r[t]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class YF extends qF{then(t,r){return Promise.all(this.animations).then(t).catch(r)}}function Px(e,t){return e?e[t]||e.default||e:void 0}const Om=2e4;function Dk(e){let t=0;const r=50;let n=e.next(t);for(;!n.done&&t<Om;)t+=r,n=e.next(t);return t>=Om?1/0:t}function Rx(e){return typeof e=="function"}function Ov(e,t){e.timeline=t,e.onfinish=null}const Ox=e=>Array.isArray(e)&&typeof e[0]=="number",JF={linearEasing:void 0};function QF(e,t){const r=vx(e);return()=>{var n;return(n=JF[t])!==null&&n!==void 0?n:r()}}const Xd=QF(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),Ik=(e,t,r=10)=>{let n="";const s=Math.max(Math.round(t/r),2);for(let a=0;a<s;a++)n+=e(Vo(0,s-1,a))+", ";return`linear(${n.substring(0,n.length-2)})`};function Lk(e){return!!(typeof e=="function"&&Xd()||!e||typeof e=="string"&&(e in Dm||Xd())||Ox(e)||Array.isArray(e)&&e.every(Lk))}const El=([e,t,r,n])=>`cubic-bezier(${e}, ${t}, ${r}, ${n})`,Dm={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:El([0,.65,.55,1]),circOut:El([.55,0,1,.45]),backIn:El([.31,.01,.66,-.59]),backOut:El([.33,1.53,.69,.99])};function Mk(e,t){if(e)return typeof e=="function"&&Xd()?Ik(e,t):Ox(e)?El(e):Array.isArray(e)?e.map(r=>Mk(r,t)||Dm.easeOut):Dm[e]}const qn={x:!1,y:!1};function Bk(){return qn.x||qn.y}function ZF(e,t,r){var n;if(e instanceof Element)return[e];if(typeof e=="string"){let s=document;const a=(n=void 0)!==null&&n!==void 0?n:s.querySelectorAll(e);return a?Array.from(a):[]}return Array.from(e)}function Uk(e,t){const r=ZF(e),n=new AbortController,s={passive:!0,...t,signal:n.signal};return[r,s,()=>n.abort()]}function Dv(e){return t=>{t.pointerType==="touch"||Bk()||e(t)}}function e6(e,t,r={}){const[n,s,a]=Uk(e,r),i=Dv(o=>{const{target:c}=o,u=t(o);if(typeof u!="function"||!c)return;const d=Dv(f=>{u(f),c.removeEventListener("pointerleave",d)});c.addEventListener("pointerleave",d,s)});return n.forEach(o=>{o.addEventListener("pointerenter",i,s)}),a}const Vk=(e,t)=>t?e===t?!0:Vk(e,t.parentElement):!1,Dx=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,t6=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function r6(e){return t6.has(e.tagName)||e.tabIndex!==-1}const Nl=new WeakSet;function Iv(e){return t=>{t.key==="Enter"&&e(t)}}function Xf(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const n6=(e,t)=>{const r=e.currentTarget;if(!r)return;const n=Iv(()=>{if(Nl.has(r))return;Xf(r,"down");const s=Iv(()=>{Xf(r,"up")}),a=()=>Xf(r,"cancel");r.addEventListener("keyup",s,t),r.addEventListener("blur",a,t)});r.addEventListener("keydown",n,t),r.addEventListener("blur",()=>r.removeEventListener("keydown",n),t)};function Lv(e){return Dx(e)&&!Bk()}function s6(e,t,r={}){const[n,s,a]=Uk(e,r),i=o=>{const c=o.currentTarget;if(!Lv(o)||Nl.has(c))return;Nl.add(c);const u=t(o),d=(m,x)=>{window.removeEventListener("pointerup",f),window.removeEventListener("pointercancel",h),!(!Lv(m)||!Nl.has(c))&&(Nl.delete(c),typeof u=="function"&&u(m,{success:x}))},f=m=>{d(m,r.useGlobalTarget||Vk(c,m.target))},h=m=>{d(m,!1)};window.addEventListener("pointerup",f,s),window.addEventListener("pointercancel",h,s)};return n.forEach(o=>{!r6(o)&&o.getAttribute("tabindex")===null&&(o.tabIndex=0),(r.useGlobalTarget?window:o).addEventListener("pointerdown",i,s),o.addEventListener("focus",u=>n6(u,s),s)}),a}function a6(e){return e==="x"||e==="y"?qn[e]?null:(qn[e]=!0,()=>{qn[e]=!1}):qn.x||qn.y?null:(qn.x=qn.y=!0,()=>{qn.x=qn.y=!1})}const $k=new Set(["width","height","top","left","right","bottom",...el]);let dd;function i6(){dd=void 0}const ws={now:()=>(dd===void 0&&ws.set(vr.isProcessing||tF.useManualTiming?vr.timestamp:performance.now()),dd),set:e=>{dd=e,queueMicrotask(i6)}};function Ix(e,t){e.indexOf(t)===-1&&e.push(t)}function Lx(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}function o6([...e],t,r){const n=t<0?e.length+t:t;if(n>=0&&n<e.length){const s=r<0?e.length+r:r,[a]=e.splice(t,1);e.splice(s,0,a)}return e}class Mx{constructor(){this.subscriptions=[]}add(t){return Ix(this.subscriptions,t),()=>Lx(this.subscriptions,t)}notify(t,r,n){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](t,r,n);else for(let a=0;a<s;a++){const i=this.subscriptions[a];i&&i(t,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function zk(e,t){return t?e*(1e3/t):0}const Mv=30,l6=e=>!isNaN(parseFloat(e)),$l={current:void 0};class c6{constructor(t,r={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(n,s=!0)=>{const a=ws.now();this.updatedAt!==a&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),s&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(t),this.owner=r.owner}setCurrent(t){this.current=t,this.updatedAt=ws.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=l6(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new Mx);const n=this.events[t].add(r);return t==="change"?()=>{n(),vt.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t,r=!0){!r||!this.passiveEffect?this.updateAndNotify(t,r):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,r,n){this.set(r),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-n}jump(t,r=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return $l.current&&$l.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const t=ws.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>Mv)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,Mv);return zk(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function zo(e,t){return new c6(e,t)}function u6(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,zo(r))}function d6(e,t){const r=G0(e,t);let{transitionEnd:n={},transition:s={},...a}=r||{};a={...a,...n};for(const i in a){const o=bF(a[i]);u6(e,i,o)}}function f6(e){return!!(_r(e)&&e.add)}function Im(e,t){const r=e.getValue("willChange");if(f6(r))return r.add(t)}function Wk(e){return e.props[wk]}const Hk=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,h6=1e-7,m6=12;function p6(e,t,r,n,s){let a,i,o=0;do i=t+(r-t)/2,a=Hk(i,n,s)-e,a>0?r=i:t=i;while(Math.abs(a)>h6&&++o<m6);return i}function ru(e,t,r,n){if(e===t&&r===n)return wn;const s=a=>p6(a,0,1,e,r);return a=>a===0||a===1?a:Hk(s(a),t,n)}const Gk=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,Kk=e=>t=>1-e(1-t),Xk=ru(.33,1.53,.69,.99),Bx=Kk(Xk),qk=Gk(Bx),Yk=e=>(e*=2)<1?.5*Bx(e):.5*(2-Math.pow(2,-10*(e-1))),Ux=e=>1-Math.sin(Math.acos(e)),Jk=Kk(Ux),Qk=Gk(Ux),Zk=e=>/^0[^.\s]+$/u.test(e);function x6(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||Zk(e):!0}const zl=e=>Math.round(e*1e5)/1e5,Vx=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function g6(e){return e==null}const v6=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,$x=(e,t)=>r=>!!(typeof r=="string"&&v6.test(r)&&r.startsWith(e)||t&&!g6(r)&&Object.prototype.hasOwnProperty.call(r,t)),eS=(e,t,r)=>n=>{if(typeof n!="string")return n;const[s,a,i,o]=n.match(Vx);return{[e]:parseFloat(s),[t]:parseFloat(a),[r]:parseFloat(i),alpha:o!==void 0?parseFloat(o):1}},y6=e=>Hs(0,255,e),qf={...tl,transform:e=>Math.round(y6(e))},ri={test:$x("rgb","red"),parse:eS("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:n=1})=>"rgba("+qf.transform(e)+", "+qf.transform(t)+", "+qf.transform(r)+", "+zl(Fc.transform(n))+")"};function w6(e){let t="",r="",n="",s="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),n=e.substring(5,7),s=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),n=e.substring(3,4),s=e.substring(4,5),t+=t,r+=r,n+=n,s+=s),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:s?parseInt(s,16)/255:1}}const Lm={test:$x("#"),parse:w6,transform:ri.transform},mo={test:$x("hsl","hue"),parse:eS("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:n=1})=>"hsla("+Math.round(e)+", "+ys.transform(zl(t))+", "+ys.transform(zl(r))+", "+zl(Fc.transform(n))+")"},jr={test:e=>ri.test(e)||Lm.test(e)||mo.test(e),parse:e=>ri.test(e)?ri.parse(e):mo.test(e)?mo.parse(e):Lm.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?ri.transform(e):mo.transform(e)},_6=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function b6(e){var t,r;return isNaN(e)&&typeof e=="string"&&(((t=e.match(Vx))===null||t===void 0?void 0:t.length)||0)+(((r=e.match(_6))===null||r===void 0?void 0:r.length)||0)>0}const tS="number",rS="color",k6="var",S6="var(",Bv="${}",E6=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Pc(e){const t=e.toString(),r=[],n={color:[],number:[],var:[]},s=[];let a=0;const o=t.replace(E6,c=>(jr.test(c)?(n.color.push(a),s.push(rS),r.push(jr.parse(c))):c.startsWith(S6)?(n.var.push(a),s.push(k6),r.push(c)):(n.number.push(a),s.push(tS),r.push(parseFloat(c))),++a,Bv)).split(Bv);return{values:r,split:o,indexes:n,types:s}}function nS(e){return Pc(e).values}function sS(e){const{split:t,types:r}=Pc(e),n=t.length;return s=>{let a="";for(let i=0;i<n;i++)if(a+=t[i],s[i]!==void 0){const o=r[i];o===tS?a+=zl(s[i]):o===rS?a+=jr.transform(s[i]):a+=s[i]}return a}}const N6=e=>typeof e=="number"?0:e;function T6(e){const t=nS(e);return sS(e)(t.map(N6))}const Ea={test:b6,parse:nS,createTransformer:sS,getAnimatableNone:T6},C6=new Set(["brightness","contrast","saturate","opacity"]);function j6(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=r.match(Vx)||[];if(!n)return e;const s=r.replace(n,"");let a=C6.has(t)?1:0;return n!==r&&(a*=100),t+"("+a+s+")"}const A6=/\b([a-z-]*)\(.*?\)/gu,Mm={...Ea,getAnimatableNone:e=>{const t=e.match(A6);return t?t.map(j6).join(" "):e}},F6={...Nx,color:jr,backgroundColor:jr,outlineColor:jr,fill:jr,stroke:jr,borderColor:jr,borderTopColor:jr,borderRightColor:jr,borderBottomColor:jr,borderLeftColor:jr,filter:Mm,WebkitFilter:Mm},zx=e=>F6[e];function aS(e,t){let r=zx(e);return r!==Mm&&(r=Ea),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const P6=new Set(["auto","none","0"]);function R6(e,t,r){let n=0,s;for(;n<e.length&&!s;){const a=e[n];typeof a=="string"&&!P6.has(a)&&Pc(a).values.length&&(s=e[n]),n++}if(s&&r)for(const a of t)e[a]=aS(r,s)}const Uv=e=>e===tl||e===ze,Vv=(e,t)=>parseFloat(e.split(", ")[t]),$v=(e,t)=>(r,{transform:n})=>{if(n==="none"||!n)return 0;const s=n.match(/^matrix3d\((.+)\)$/u);if(s)return Vv(s[1],t);{const a=n.match(/^matrix\((.+)\)$/u);return a?Vv(a[1],e):0}},O6=new Set(["x","y","z"]),D6=el.filter(e=>!O6.has(e));function I6(e){const t=[];return D6.forEach(r=>{const n=e.getValue(r);n!==void 0&&(t.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),t}const Wo={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:$v(4,13),y:$v(5,14)};Wo.translateX=Wo.x;Wo.translateY=Wo.y;const ii=new Set;let Bm=!1,Um=!1;function iS(){if(Um){const e=Array.from(ii).filter(n=>n.needsMeasurement),t=new Set(e.map(n=>n.element)),r=new Map;t.forEach(n=>{const s=I6(n);s.length&&(r.set(n,s),n.render())}),e.forEach(n=>n.measureInitialState()),t.forEach(n=>{n.render();const s=r.get(n);s&&s.forEach(([a,i])=>{var o;(o=n.getValue(a))===null||o===void 0||o.set(i)})}),e.forEach(n=>n.measureEndState()),e.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}Um=!1,Bm=!1,ii.forEach(e=>e.complete()),ii.clear()}function oS(){ii.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(Um=!0)})}function L6(){oS(),iS()}class Wx{constructor(t,r,n,s,a,i=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...t],this.onComplete=r,this.name=n,this.motionValue=s,this.element=a,this.isAsync=i}scheduleResolve(){this.isScheduled=!0,this.isAsync?(ii.add(this),Bm||(Bm=!0,vt.read(oS),vt.resolveKeyframes(iS))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:r,element:n,motionValue:s}=this;for(let a=0;a<t.length;a++)if(t[a]===null)if(a===0){const i=s==null?void 0:s.get(),o=t[t.length-1];if(i!==void 0)t[0]=i;else if(n&&r){const c=n.readValue(r,o);c!=null&&(t[0]=c)}t[0]===void 0&&(t[0]=o),s&&i===void 0&&s.set(t[0])}else t[a]=t[a-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),ii.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,ii.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const lS=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),M6=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function B6(e){const t=M6.exec(e);if(!t)return[,];const[,r,n,s]=t;return[`--${r??n}`,s]}function cS(e,t,r=1){const[n,s]=B6(e);if(!n)return;const a=window.getComputedStyle(t).getPropertyValue(n);if(a){const i=a.trim();return lS(i)?parseFloat(i):i}return Ex(s)?cS(s,t,r+1):s}const uS=e=>t=>t.test(e),U6={test:e=>e==="auto",parse:e=>e},dS=[tl,ze,ys,ra,CF,TF,U6],zv=e=>dS.find(uS(e));class fS extends Wx{constructor(t,r,n,s,a){super(t,r,n,s,a,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:r,name:n}=this;if(!r||!r.current)return;super.readKeyframes();for(let c=0;c<t.length;c++){let u=t[c];if(typeof u=="string"&&(u=u.trim(),Ex(u))){const d=cS(u,r.current);d!==void 0&&(t[c]=d),c===t.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!$k.has(n)||t.length!==2)return;const[s,a]=t,i=zv(s),o=zv(a);if(i!==o)if(Uv(i)&&Uv(o))for(let c=0;c<t.length;c++){const u=t[c];typeof u=="string"&&(t[c]=parseFloat(u))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:r}=this,n=[];for(let s=0;s<t.length;s++)x6(t[s])&&n.push(s);n.length&&R6(t,n,r)}measureInitialState(){const{element:t,unresolvedKeyframes:r,name:n}=this;if(!t||!t.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Wo[n](t.measureViewportBox(),window.getComputedStyle(t.current)),r[0]=this.measuredOrigin;const s=r[r.length-1];s!==void 0&&t.getValue(n,s).jump(s,!1)}measureEndState(){var t;const{element:r,name:n,unresolvedKeyframes:s}=this;if(!r||!r.current)return;const a=r.getValue(n);a&&a.jump(this.measuredOrigin,!1);const i=s.length-1,o=s[i];s[i]=Wo[n](r.measureViewportBox(),window.getComputedStyle(r.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),!((t=this.removedTransforms)===null||t===void 0)&&t.length&&this.removedTransforms.forEach(([c,u])=>{r.getValue(c).set(u)}),this.resolveNoneKeyframes()}}const Wv=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Ea.test(e)||e==="0")&&!e.startsWith("url("));function V6(e){const t=e[0];if(e.length===1)return!0;for(let r=0;r<e.length;r++)if(e[r]!==t)return!0}function $6(e,t,r,n){const s=e[0];if(s===null)return!1;if(t==="display"||t==="visibility")return!0;const a=e[e.length-1],i=Wv(s,t),o=Wv(a,t);return!i||!o?!1:V6(e)||(r==="spring"||Rx(r))&&n}const z6=e=>e!==null;function K0(e,{repeat:t,repeatType:r="loop"},n){const s=e.filter(z6),a=t&&r!=="loop"&&t%2===1?0:s.length-1;return!a||n===void 0?s[a]:n}const W6=40;class hS{constructor({autoplay:t=!0,delay:r=0,type:n="keyframes",repeat:s=0,repeatDelay:a=0,repeatType:i="loop",...o}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=ws.now(),this.options={autoplay:t,delay:r,type:n,repeat:s,repeatDelay:a,repeatType:i,...o},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>W6?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&L6(),this._resolved}onKeyframesResolved(t,r){this.resolvedAt=ws.now(),this.hasAttemptedResolve=!0;const{name:n,type:s,velocity:a,delay:i,onComplete:o,onUpdate:c,isGenerator:u}=this.options;if(!u&&!$6(t,n,s,a))if(i)this.options.duration=0;else{c&&c(K0(t,this.options,r)),o&&o(),this.resolveFinishedPromise();return}const d=this.initPlayback(t,r);d!==!1&&(this._resolved={keyframes:t,finalKeyframe:r,...d},this.onPostResolved())}onPostResolved(){}then(t,r){return this.currentFinishedPromise.then(t,r)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(t=>{this.resolveFinishedPromise=t})}}const Et=(e,t,r)=>e+(t-e)*r;function Yf(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function H6({hue:e,saturation:t,lightness:r,alpha:n}){e/=360,t/=100,r/=100;let s=0,a=0,i=0;if(!t)s=a=i=r;else{const o=r<.5?r*(1+t):r+t-r*t,c=2*r-o;s=Yf(c,o,e+1/3),a=Yf(c,o,e),i=Yf(c,o,e-1/3)}return{red:Math.round(s*255),green:Math.round(a*255),blue:Math.round(i*255),alpha:n}}function qd(e,t){return r=>r>0?t:e}const Jf=(e,t,r)=>{const n=e*e,s=r*(t*t-n)+n;return s<0?0:Math.sqrt(s)},G6=[Lm,ri,mo],K6=e=>G6.find(t=>t.test(e));function Hv(e){const t=K6(e);if(!t)return!1;let r=t.parse(e);return t===mo&&(r=H6(r)),r}const Gv=(e,t)=>{const r=Hv(e),n=Hv(t);if(!r||!n)return qd(e,t);const s={...r};return a=>(s.red=Jf(r.red,n.red,a),s.green=Jf(r.green,n.green,a),s.blue=Jf(r.blue,n.blue,a),s.alpha=Et(r.alpha,n.alpha,a),ri.transform(s))},X6=(e,t)=>r=>t(e(r)),nu=(...e)=>e.reduce(X6),Vm=new Set(["none","hidden"]);function q6(e,t){return Vm.has(e)?r=>r<=0?e:t:r=>r>=1?t:e}function Y6(e,t){return r=>Et(e,t,r)}function Hx(e){return typeof e=="number"?Y6:typeof e=="string"?Ex(e)?qd:jr.test(e)?Gv:Z6:Array.isArray(e)?mS:typeof e=="object"?jr.test(e)?Gv:J6:qd}function mS(e,t){const r=[...e],n=r.length,s=e.map((a,i)=>Hx(a)(a,t[i]));return a=>{for(let i=0;i<n;i++)r[i]=s[i](a);return r}}function J6(e,t){const r={...e,...t},n={};for(const s in r)e[s]!==void 0&&t[s]!==void 0&&(n[s]=Hx(e[s])(e[s],t[s]));return s=>{for(const a in n)r[a]=n[a](s);return r}}function Q6(e,t){var r;const n=[],s={color:0,var:0,number:0};for(let a=0;a<t.values.length;a++){const i=t.types[a],o=e.indexes[i][s[i]],c=(r=e.values[o])!==null&&r!==void 0?r:0;n[a]=c,s[i]++}return n}const Z6=(e,t)=>{const r=Ea.createTransformer(t),n=Pc(e),s=Pc(t);return n.indexes.var.length===s.indexes.var.length&&n.indexes.color.length===s.indexes.color.length&&n.indexes.number.length>=s.indexes.number.length?Vm.has(e)&&!s.values.length||Vm.has(t)&&!n.values.length?q6(e,t):nu(mS(Q6(n,s),s.values),r):qd(e,t)};function pS(e,t,r){return typeof e=="number"&&typeof t=="number"&&typeof r=="number"?Et(e,t,r):Hx(e)(e,t)}const eP=5;function xS(e,t,r){const n=Math.max(t-eP,0);return zk(r-e(n),t-n)}const Mt={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Qf=.001;function tP({duration:e=Mt.duration,bounce:t=Mt.bounce,velocity:r=Mt.velocity,mass:n=Mt.mass}){let s,a,i=1-t;i=Hs(Mt.minDamping,Mt.maxDamping,i),e=Hs(Mt.minDuration,Mt.maxDuration,Ds(e)),i<1?(s=u=>{const d=u*i,f=d*e,h=d-r,m=$m(u,i),x=Math.exp(-f);return Qf-h/m*x},a=u=>{const f=u*i*e,h=f*r+r,m=Math.pow(i,2)*Math.pow(u,2)*e,x=Math.exp(-f),p=$m(Math.pow(u,2),i);return(-s(u)+Qf>0?-1:1)*((h-m)*x)/p}):(s=u=>{const d=Math.exp(-u*e),f=(u-r)*e+1;return-Qf+d*f},a=u=>{const d=Math.exp(-u*e),f=(r-u)*(e*e);return d*f});const o=5/e,c=nP(s,a,o);if(e=Os(e),isNaN(c))return{stiffness:Mt.stiffness,damping:Mt.damping,duration:e};{const u=Math.pow(c,2)*n;return{stiffness:u,damping:i*2*Math.sqrt(n*u),duration:e}}}const rP=12;function nP(e,t,r){let n=r;for(let s=1;s<rP;s++)n=n-e(n)/t(n);return n}function $m(e,t){return e*Math.sqrt(1-t*t)}const sP=["duration","bounce"],aP=["stiffness","damping","mass"];function Kv(e,t){return t.some(r=>e[r]!==void 0)}function iP(e){let t={velocity:Mt.velocity,stiffness:Mt.stiffness,damping:Mt.damping,mass:Mt.mass,isResolvedFromDuration:!1,...e};if(!Kv(e,aP)&&Kv(e,sP))if(e.visualDuration){const r=e.visualDuration,n=2*Math.PI/(r*1.2),s=n*n,a=2*Hs(.05,1,1-(e.bounce||0))*Math.sqrt(s);t={...t,mass:Mt.mass,stiffness:s,damping:a}}else{const r=tP(e);t={...t,...r,mass:Mt.mass},t.isResolvedFromDuration=!0}return t}function gS(e=Mt.visualDuration,t=Mt.bounce){const r=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:n,restDelta:s}=r;const a=r.keyframes[0],i=r.keyframes[r.keyframes.length-1],o={done:!1,value:a},{stiffness:c,damping:u,mass:d,duration:f,velocity:h,isResolvedFromDuration:m}=iP({...r,velocity:-Ds(r.velocity||0)}),x=h||0,p=u/(2*Math.sqrt(c*d)),g=i-a,y=Ds(Math.sqrt(c/d)),w=Math.abs(g)<5;n||(n=w?Mt.restSpeed.granular:Mt.restSpeed.default),s||(s=w?Mt.restDelta.granular:Mt.restDelta.default);let v;if(p<1){const S=$m(y,p);v=b=>{const k=Math.exp(-p*y*b);return i-k*((x+p*y*g)/S*Math.sin(S*b)+g*Math.cos(S*b))}}else if(p===1)v=S=>i-Math.exp(-y*S)*(g+(x+y*g)*S);else{const S=y*Math.sqrt(p*p-1);v=b=>{const k=Math.exp(-p*y*b),T=Math.min(S*b,300);return i-k*((x+p*y*g)*Math.sinh(T)+S*g*Math.cosh(T))/S}}const _={calculatedDuration:m&&f||null,next:S=>{const b=v(S);if(m)o.done=S>=f;else{let k=0;p<1&&(k=S===0?Os(x):xS(v,S,b));const T=Math.abs(k)<=n,j=Math.abs(i-b)<=s;o.done=T&&j}return o.value=o.done?i:b,o},toString:()=>{const S=Math.min(Dk(_),Om),b=Ik(k=>_.next(S*k).value,S,30);return S+"ms "+b}};return _}function Xv({keyframes:e,velocity:t=0,power:r=.8,timeConstant:n=325,bounceDamping:s=10,bounceStiffness:a=500,modifyTarget:i,min:o,max:c,restDelta:u=.5,restSpeed:d}){const f=e[0],h={done:!1,value:f},m=T=>o!==void 0&&T<o||c!==void 0&&T>c,x=T=>o===void 0?c:c===void 0||Math.abs(o-T)<Math.abs(c-T)?o:c;let p=r*t;const g=f+p,y=i===void 0?g:i(g);y!==g&&(p=y-f);const w=T=>-p*Math.exp(-T/n),v=T=>y+w(T),_=T=>{const j=w(T),V=v(T);h.done=Math.abs(j)<=u,h.value=h.done?y:V};let S,b;const k=T=>{m(h.value)&&(S=T,b=gS({keyframes:[h.value,x(h.value)],velocity:xS(v,T,h.value),damping:s,stiffness:a,restDelta:u,restSpeed:d}))};return k(0),{calculatedDuration:null,next:T=>{let j=!1;return!b&&S===void 0&&(j=!0,_(T),k(T)),S!==void 0&&T>=S?b.next(T-S):(!j&&_(T),h)}}}const oP=ru(.42,0,1,1),lP=ru(0,0,.58,1),vS=ru(.42,0,.58,1),cP=e=>Array.isArray(e)&&typeof e[0]!="number",uP={linear:wn,easeIn:oP,easeInOut:vS,easeOut:lP,circIn:Ux,circInOut:Qk,circOut:Jk,backIn:Bx,backInOut:qk,backOut:Xk,anticipate:Yk},qv=e=>{if(Ox(e)){pk(e.length===4);const[t,r,n,s]=e;return ru(t,r,n,s)}else if(typeof e=="string")return uP[e];return e};function dP(e,t,r){const n=[],s=r||pS,a=e.length-1;for(let i=0;i<a;i++){let o=s(e[i],e[i+1]);if(t){const c=Array.isArray(t)?t[i]||wn:t;o=nu(c,o)}n.push(o)}return n}function yS(e,t,{clamp:r=!0,ease:n,mixer:s}={}){const a=e.length;if(pk(a===t.length),a===1)return()=>t[0];if(a===2&&t[0]===t[1])return()=>t[1];const i=e[0]===e[1];e[0]>e[a-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=dP(t,n,s),c=o.length,u=d=>{if(i&&d<e[0])return t[0];let f=0;if(c>1)for(;f<e.length-2&&!(d<e[f+1]);f++);const h=Vo(e[f],e[f+1],d);return o[f](h)};return r?d=>u(Hs(e[0],e[a-1],d)):u}function fP(e,t){const r=e[e.length-1];for(let n=1;n<=t;n++){const s=Vo(0,t,n);e.push(Et(r,1,s))}}function hP(e){const t=[0];return fP(t,e.length-1),t}function mP(e,t){return e.map(r=>r*t)}function pP(e,t){return e.map(()=>t||vS).splice(0,e.length-1)}function Yd({duration:e=300,keyframes:t,times:r,ease:n="easeInOut"}){const s=cP(n)?n.map(qv):qv(n),a={done:!1,value:t[0]},i=mP(r&&r.length===t.length?r:hP(t),e),o=yS(i,t,{ease:Array.isArray(s)?s:pP(t,s)});return{calculatedDuration:e,next:c=>(a.value=o(c),a.done=c>=e,a)}}const xP=e=>{const t=({timestamp:r})=>e(r);return{start:()=>vt.update(t,!0),stop:()=>Ws(t),now:()=>vr.isProcessing?vr.timestamp:ws.now()}},gP={decay:Xv,inertia:Xv,tween:Yd,keyframes:Yd,spring:gS},vP=e=>e/100;class Gx extends hS{constructor(t){super(t),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:c}=this.options;c&&c()};const{name:r,motionValue:n,element:s,keyframes:a}=this.options,i=(s==null?void 0:s.KeyframeResolver)||Wx,o=(c,u)=>this.onKeyframesResolved(c,u);this.resolver=new i(a,o,r,n,s),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(t){const{type:r="keyframes",repeat:n=0,repeatDelay:s=0,repeatType:a,velocity:i=0}=this.options,o=Rx(r)?r:gP[r]||Yd;let c,u;o!==Yd&&typeof t[0]!="number"&&(c=nu(vP,pS(t[0],t[1])),t=[0,100]);const d=o({...this.options,keyframes:t});a==="mirror"&&(u=o({...this.options,keyframes:[...t].reverse(),velocity:-i})),d.calculatedDuration===null&&(d.calculatedDuration=Dk(d));const{calculatedDuration:f}=d,h=f+s,m=h*(n+1)-s;return{generator:d,mirroredGenerator:u,mapPercentToKeyframes:c,calculatedDuration:f,resolvedDuration:h,totalDuration:m}}onPostResolved(){const{autoplay:t=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!t?this.pause():this.state=this.pendingPlayState}tick(t,r=!1){const{resolved:n}=this;if(!n){const{keyframes:T}=this.options;return{done:!0,value:T[T.length-1]}}const{finalKeyframe:s,generator:a,mirroredGenerator:i,mapPercentToKeyframes:o,keyframes:c,calculatedDuration:u,totalDuration:d,resolvedDuration:f}=n;if(this.startTime===null)return a.next(0);const{delay:h,repeat:m,repeatType:x,repeatDelay:p,onUpdate:g}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-d/this.speed,this.startTime)),r?this.currentTime=t:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(t-this.startTime)*this.speed;const y=this.currentTime-h*(this.speed>=0?1:-1),w=this.speed>=0?y<0:y>d;this.currentTime=Math.max(y,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=d);let v=this.currentTime,_=a;if(m){const T=Math.min(this.currentTime,d)/f;let j=Math.floor(T),V=T%1;!V&&T>=1&&(V=1),V===1&&j--,j=Math.min(j,m+1),!!(j%2)&&(x==="reverse"?(V=1-V,p&&(V-=p/f)):x==="mirror"&&(_=i)),v=Hs(0,1,V)*f}const S=w?{done:!1,value:c[0]}:_.next(v);o&&(S.value=o(S.value));let{done:b}=S;!w&&u!==null&&(b=this.speed>=0?this.currentTime>=d:this.currentTime<=0);const k=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&b);return k&&s!==void 0&&(S.value=K0(c,this.options,s)),g&&g(S.value),k&&this.finish(),S}get duration(){const{resolved:t}=this;return t?Ds(t.calculatedDuration):0}get time(){return Ds(this.currentTime)}set time(t){t=Os(t),this.currentTime=t,this.holdTime!==null||this.speed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.speed)}get speed(){return this.playbackSpeed}set speed(t){const r=this.playbackSpeed!==t;this.playbackSpeed=t,r&&(this.time=Ds(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:t=xP,onPlay:r,startTime:n}=this.options;this.driver||(this.driver=t(a=>this.tick(a))),r&&r();const s=this.driver.now();this.holdTime!==null?this.startTime=s-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=s):this.startTime=n??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var t;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(t=this.currentTime)!==null&&t!==void 0?t:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:t}=this.options;t&&t()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}}const yP=new Set(["opacity","clipPath","filter","transform"]);function wP(e,t,r,{delay:n=0,duration:s=300,repeat:a=0,repeatType:i="loop",ease:o="easeInOut",times:c}={}){const u={[t]:r};c&&(u.offset=c);const d=Mk(o,s);return Array.isArray(d)&&(u.easing=d),e.animate(u,{delay:n,duration:s,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:a+1,direction:i==="reverse"?"alternate":"normal"})}const _P=vx(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Jd=10,bP=2e4;function kP(e){return Rx(e.type)||e.type==="spring"||!Lk(e.ease)}function SP(e,t){const r=new Gx({...t,keyframes:e,repeat:0,delay:0,isGenerator:!0});let n={done:!1,value:e[0]};const s=[];let a=0;for(;!n.done&&a<bP;)n=r.sample(a),s.push(n.value),a+=Jd;return{times:void 0,keyframes:s,duration:a-Jd,ease:"linear"}}const wS={anticipate:Yk,backInOut:qk,circInOut:Qk};function EP(e){return e in wS}class Yv extends hS{constructor(t){super(t);const{name:r,motionValue:n,element:s,keyframes:a}=this.options;this.resolver=new fS(a,(i,o)=>this.onKeyframesResolved(i,o),r,n,s),this.resolver.scheduleResolve()}initPlayback(t,r){let{duration:n=300,times:s,ease:a,type:i,motionValue:o,name:c,startTime:u}=this.options;if(!o.owner||!o.owner.current)return!1;if(typeof a=="string"&&Xd()&&EP(a)&&(a=wS[a]),kP(this.options)){const{onComplete:f,onUpdate:h,motionValue:m,element:x,...p}=this.options,g=SP(t,p);t=g.keyframes,t.length===1&&(t[1]=t[0]),n=g.duration,s=g.times,a=g.ease,i="keyframes"}const d=wP(o.owner.current,c,t,{...this.options,duration:n,times:s,ease:a});return d.startTime=u??this.calcStartTime(),this.pendingTimeline?(Ov(d,this.pendingTimeline),this.pendingTimeline=void 0):d.onfinish=()=>{const{onComplete:f}=this.options;o.set(K0(t,this.options,r)),f&&f(),this.cancel(),this.resolveFinishedPromise()},{animation:d,duration:n,times:s,type:i,ease:a,keyframes:t}}get duration(){const{resolved:t}=this;if(!t)return 0;const{duration:r}=t;return Ds(r)}get time(){const{resolved:t}=this;if(!t)return 0;const{animation:r}=t;return Ds(r.currentTime||0)}set time(t){const{resolved:r}=this;if(!r)return;const{animation:n}=r;n.currentTime=Os(t)}get speed(){const{resolved:t}=this;if(!t)return 1;const{animation:r}=t;return r.playbackRate}set speed(t){const{resolved:r}=this;if(!r)return;const{animation:n}=r;n.playbackRate=t}get state(){const{resolved:t}=this;if(!t)return"idle";const{animation:r}=t;return r.playState}get startTime(){const{resolved:t}=this;if(!t)return null;const{animation:r}=t;return r.startTime}attachTimeline(t){if(!this._resolved)this.pendingTimeline=t;else{const{resolved:r}=this;if(!r)return wn;const{animation:n}=r;Ov(n,t)}return wn}play(){if(this.isStopped)return;const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.playState==="finished"&&this.updateFinishedPromise(),r.play()}pause(){const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:t}=this;if(!t)return;const{animation:r,keyframes:n,duration:s,type:a,ease:i,times:o}=t;if(r.playState==="idle"||r.playState==="finished")return;if(this.time){const{motionValue:u,onUpdate:d,onComplete:f,element:h,...m}=this.options,x=new Gx({...m,keyframes:n,duration:s,type:a,ease:i,times:o,isGenerator:!0}),p=Os(this.time);u.setWithVelocity(x.sample(p-Jd).value,x.sample(p).value,Jd)}const{onStop:c}=this.options;c&&c(),this.cancel()}complete(){const{resolved:t}=this;t&&t.animation.finish()}cancel(){const{resolved:t}=this;t&&t.animation.cancel()}static supports(t){const{motionValue:r,name:n,repeatDelay:s,repeatType:a,damping:i,type:o}=t;if(!r||!r.owner||!(r.owner.current instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:u}=r.owner.getProps();return _P()&&n&&yP.has(n)&&!c&&!u&&!s&&a!=="mirror"&&i!==0&&o!=="inertia"}}const NP={type:"spring",stiffness:500,damping:25,restSpeed:10},TP=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),CP={type:"keyframes",duration:.8},jP={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},AP=(e,{keyframes:t})=>t.length>2?CP:ji.has(e)?e.startsWith("scale")?TP(t[1]):NP:jP;function FP({when:e,delay:t,delayChildren:r,staggerChildren:n,staggerDirection:s,repeat:a,repeatType:i,repeatDelay:o,from:c,elapsed:u,...d}){return!!Object.keys(d).length}const Kx=(e,t,r,n={},s,a)=>i=>{const o=Px(n,e)||{},c=o.delay||n.delay||0;let{elapsed:u=0}=n;u=u-Os(c);let d={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity(),...o,delay:-u,onUpdate:h=>{t.set(h),o.onUpdate&&o.onUpdate(h)},onComplete:()=>{i(),o.onComplete&&o.onComplete()},name:e,motionValue:t,element:a?void 0:s};FP(o)||(d={...d,...AP(e,d)}),d.duration&&(d.duration=Os(d.duration)),d.repeatDelay&&(d.repeatDelay=Os(d.repeatDelay)),d.from!==void 0&&(d.keyframes[0]=d.from);let f=!1;if((d.type===!1||d.duration===0&&!d.repeatDelay)&&(d.duration=0,d.delay===0&&(f=!0)),f&&!a&&t.get()!==void 0){const h=K0(d.keyframes,o);if(h!==void 0)return vt.update(()=>{d.onUpdate(h),d.onComplete()}),new YF([])}return!a&&Yv.supports(d)?new Yv(d):new Gx(d)};function PP({protectedKeys:e,needsAnimating:t},r){const n=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,n}function _S(e,t,{delay:r=0,transitionOverride:n,type:s}={}){var a;let{transition:i=e.getDefaultTransition(),transitionEnd:o,...c}=t;n&&(i=n);const u=[],d=s&&e.animationState&&e.animationState.getState()[s];for(const f in c){const h=e.getValue(f,(a=e.latestValues[f])!==null&&a!==void 0?a:null),m=c[f];if(m===void 0||d&&PP(d,f))continue;const x={delay:r,...Px(i||{},f)};let p=!1;if(window.MotionHandoffAnimation){const y=Wk(e);if(y){const w=window.MotionHandoffAnimation(y,f,vt);w!==null&&(x.startTime=w,p=!0)}}Im(e,f),h.start(Kx(f,h,m,e.shouldReduceMotion&&$k.has(f)?{type:!1}:x,e,p));const g=h.animation;g&&u.push(g)}return o&&Promise.all(u).then(()=>{vt.update(()=>{o&&d6(e,o)})}),u}function zm(e,t,r={}){var n;const s=G0(e,t,r.type==="exit"?(n=e.presenceContext)===null||n===void 0?void 0:n.custom:void 0);let{transition:a=e.getDefaultTransition()||{}}=s||{};r.transitionOverride&&(a=r.transitionOverride);const i=s?()=>Promise.all(_S(e,s,r)):()=>Promise.resolve(),o=e.variantChildren&&e.variantChildren.size?(u=0)=>{const{delayChildren:d=0,staggerChildren:f,staggerDirection:h}=a;return RP(e,t,d+u,f,h,r)}:()=>Promise.resolve(),{when:c}=a;if(c){const[u,d]=c==="beforeChildren"?[i,o]:[o,i];return u().then(()=>d())}else return Promise.all([i(),o(r.delay)])}function RP(e,t,r=0,n=0,s=1,a){const i=[],o=(e.variantChildren.size-1)*n,c=s===1?(u=0)=>u*n:(u=0)=>o-u*n;return Array.from(e.variantChildren).sort(OP).forEach((u,d)=>{u.notify("AnimationStart",t),i.push(zm(u,t,{...a,delay:r+c(d)}).then(()=>u.notify("AnimationComplete",t)))}),Promise.all(i)}function OP(e,t){return e.sortNodePosition(t)}function DP(e,t,r={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const s=t.map(a=>zm(e,a,r));n=Promise.all(s)}else if(typeof t=="string")n=zm(e,t,r);else{const s=typeof t=="function"?G0(e,t,r.custom):t;n=Promise.all(_S(e,s,r))}return n.then(()=>{e.notify("AnimationComplete",t)})}const IP=wx.length;function bS(e){if(!e)return;if(!e.isControllingVariants){const r=e.parent?bS(e.parent)||{}:{};return e.props.initial!==void 0&&(r.initial=e.props.initial),r}const t={};for(let r=0;r<IP;r++){const n=wx[r],s=e.props[n];(Ac(s)||s===!1)&&(t[n]=s)}return t}const LP=[...yx].reverse(),MP=yx.length;function BP(e){return t=>Promise.all(t.map(({animation:r,options:n})=>DP(e,r,n)))}function UP(e){let t=BP(e),r=Jv(),n=!0;const s=c=>(u,d)=>{var f;const h=G0(e,d,c==="exit"?(f=e.presenceContext)===null||f===void 0?void 0:f.custom:void 0);if(h){const{transition:m,transitionEnd:x,...p}=h;u={...u,...p,...x}}return u};function a(c){t=c(e)}function i(c){const{props:u}=e,d=bS(e.parent)||{},f=[],h=new Set;let m={},x=1/0;for(let g=0;g<MP;g++){const y=LP[g],w=r[y],v=u[y]!==void 0?u[y]:d[y],_=Ac(v),S=y===c?w.isActive:null;S===!1&&(x=g);let b=v===d[y]&&v!==u[y]&&_;if(b&&n&&e.manuallyAnimateOnMount&&(b=!1),w.protectedKeys={...m},!w.isActive&&S===null||!v&&!w.prevProp||W0(v)||typeof v=="boolean")continue;const k=VP(w.prevProp,v);let T=k||y===c&&w.isActive&&!b&&_||g>x&&_,j=!1;const V=Array.isArray(v)?v:[v];let C=V.reduce(s(y),{});S===!1&&(C={});const{prevResolvedValues:R={}}=w,X={...R,...C},G=ie=>{T=!0,h.has(ie)&&(j=!0,h.delete(ie)),w.needsAnimating[ie]=!0;const oe=e.getValue(ie);oe&&(oe.liveStyle=!1)};for(const ie in X){const oe=C[ie],W=R[ie];if(m.hasOwnProperty(ie))continue;let ue=!1;Rm(oe)&&Rm(W)?ue=!Ok(oe,W):ue=oe!==W,ue?oe!=null?G(ie):h.add(ie):oe!==void 0&&h.has(ie)?G(ie):w.protectedKeys[ie]=!0}w.prevProp=v,w.prevResolvedValues=C,w.isActive&&(m={...m,...C}),n&&e.blockInitialAnimation&&(T=!1),T&&(!(b&&k)||j)&&f.push(...V.map(ie=>({animation:ie,options:{type:y}})))}if(h.size){const g={};h.forEach(y=>{const w=e.getBaseTarget(y),v=e.getValue(y);v&&(v.liveStyle=!0),g[y]=w??null}),f.push({animation:g})}let p=!!f.length;return n&&(u.initial===!1||u.initial===u.animate)&&!e.manuallyAnimateOnMount&&(p=!1),n=!1,p?t(f):Promise.resolve()}function o(c,u){var d;if(r[c].isActive===u)return Promise.resolve();(d=e.variantChildren)===null||d===void 0||d.forEach(h=>{var m;return(m=h.animationState)===null||m===void 0?void 0:m.setActive(c,u)}),r[c].isActive=u;const f=i(c);for(const h in r)r[h].protectedKeys={};return f}return{animateChanges:i,setActive:o,setAnimateFunction:a,getState:()=>r,reset:()=>{r=Jv(),n=!0}}}function VP(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!Ok(t,e):!1}function za(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Jv(){return{animate:za(!0),whileInView:za(),whileHover:za(),whileTap:za(),whileDrag:za(),whileFocus:za(),exit:za()}}class Da{constructor(t){this.isMounted=!1,this.node=t}update(){}}class $P extends Da{constructor(t){super(t),t.animationState||(t.animationState=UP(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();W0(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)===null||t===void 0||t.call(this)}}let zP=0;class WP extends Da{constructor(){super(...arguments),this.id=zP++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===n)return;const s=this.node.animationState.setActive("exit",!t);r&&!t&&s.then(()=>r(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const HP={animation:{Feature:$P},exit:{Feature:WP}};function Rc(e,t,r,n={passive:!0}){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r)}function su(e){return{point:{x:e.pageX,y:e.pageY}}}const GP=e=>t=>Dx(t)&&e(t,su(t));function Wl(e,t,r,n){return Rc(e,t,GP(r),n)}const Qv=(e,t)=>Math.abs(e-t);function KP(e,t){const r=Qv(e.x,t.x),n=Qv(e.y,t.y);return Math.sqrt(r**2+n**2)}class kS{constructor(t,r,{transformPagePoint:n,contextWindow:s,dragSnapToOrigin:a=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const f=eh(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,m=KP(f.offset,{x:0,y:0})>=3;if(!h&&!m)return;const{point:x}=f,{timestamp:p}=vr;this.history.push({...x,timestamp:p});const{onStart:g,onMove:y}=this.handlers;h||(g&&g(this.lastMoveEvent,f),this.startEvent=this.lastMoveEvent),y&&y(this.lastMoveEvent,f)},this.handlePointerMove=(f,h)=>{this.lastMoveEvent=f,this.lastMoveEventInfo=Zf(h,this.transformPagePoint),vt.update(this.updatePoint,!0)},this.handlePointerUp=(f,h)=>{this.end();const{onEnd:m,onSessionEnd:x,resumeAnimation:p}=this.handlers;if(this.dragSnapToOrigin&&p&&p(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const g=eh(f.type==="pointercancel"?this.lastMoveEventInfo:Zf(h,this.transformPagePoint),this.history);this.startEvent&&m&&m(f,g),x&&x(f,g)},!Dx(t))return;this.dragSnapToOrigin=a,this.handlers=r,this.transformPagePoint=n,this.contextWindow=s||window;const i=su(t),o=Zf(i,this.transformPagePoint),{point:c}=o,{timestamp:u}=vr;this.history=[{...c,timestamp:u}];const{onSessionStart:d}=r;d&&d(t,eh(o,this.history)),this.removeListeners=nu(Wl(this.contextWindow,"pointermove",this.handlePointerMove),Wl(this.contextWindow,"pointerup",this.handlePointerUp),Wl(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Ws(this.updatePoint)}}function Zf(e,t){return t?{point:t(e.point)}:e}function Zv(e,t){return{x:e.x-t.x,y:e.y-t.y}}function eh({point:e},t){return{point:e,delta:Zv(e,SS(t)),offset:Zv(e,XP(t)),velocity:qP(t,.1)}}function XP(e){return e[0]}function SS(e){return e[e.length-1]}function qP(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,n=null;const s=SS(e);for(;r>=0&&(n=e[r],!(s.timestamp-n.timestamp>Os(t)));)r--;if(!n)return{x:0,y:0};const a=Ds(s.timestamp-n.timestamp);if(a===0)return{x:0,y:0};const i={x:(s.x-n.x)/a,y:(s.y-n.y)/a};return i.x===1/0&&(i.x=0),i.y===1/0&&(i.y=0),i}const ES=1e-4,YP=1-ES,JP=1+ES,NS=.01,QP=0-NS,ZP=0+NS;function bn(e){return e.max-e.min}function eR(e,t,r){return Math.abs(e-t)<=r}function ey(e,t,r,n=.5){e.origin=n,e.originPoint=Et(t.min,t.max,e.origin),e.scale=bn(r)/bn(t),e.translate=Et(r.min,r.max,e.origin)-e.originPoint,(e.scale>=YP&&e.scale<=JP||isNaN(e.scale))&&(e.scale=1),(e.translate>=QP&&e.translate<=ZP||isNaN(e.translate))&&(e.translate=0)}function Hl(e,t,r,n){ey(e.x,t.x,r.x,n?n.originX:void 0),ey(e.y,t.y,r.y,n?n.originY:void 0)}function ty(e,t,r){e.min=r.min+t.min,e.max=e.min+bn(t)}function tR(e,t,r){ty(e.x,t.x,r.x),ty(e.y,t.y,r.y)}function ry(e,t,r){e.min=t.min-r.min,e.max=e.min+bn(t)}function Gl(e,t,r){ry(e.x,t.x,r.x),ry(e.y,t.y,r.y)}function rR(e,{min:t,max:r},n){return t!==void 0&&e<t?e=n?Et(t,e,n.min):Math.max(e,t):r!==void 0&&e>r&&(e=n?Et(r,e,n.max):Math.min(e,r)),e}function ny(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function nR(e,{top:t,left:r,bottom:n,right:s}){return{x:ny(e.x,r,s),y:ny(e.y,t,n)}}function sy(e,t){let r=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,n]=[n,r]),{min:r,max:n}}function sR(e,t){return{x:sy(e.x,t.x),y:sy(e.y,t.y)}}function aR(e,t){let r=.5;const n=bn(e),s=bn(t);return s>n?r=Vo(t.min,t.max-n,e.min):n>s&&(r=Vo(e.min,e.max-s,t.min)),Hs(0,1,r)}function iR(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const Wm=.35;function oR(e=Wm){return e===!1?e=0:e===!0&&(e=Wm),{x:ay(e,"left","right"),y:ay(e,"top","bottom")}}function ay(e,t,r){return{min:iy(e,t),max:iy(e,r)}}function iy(e,t){return typeof e=="number"?e:e[t]||0}const oy=()=>({translate:0,scale:1,origin:0,originPoint:0}),po=()=>({x:oy(),y:oy()}),ly=()=>({min:0,max:0}),Gt=()=>({x:ly(),y:ly()});function Rn(e){return[e("x"),e("y")]}function TS({top:e,left:t,right:r,bottom:n}){return{x:{min:t,max:r},y:{min:e,max:n}}}function lR({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function cR(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function th(e){return e===void 0||e===1}function Hm({scale:e,scaleX:t,scaleY:r}){return!th(e)||!th(t)||!th(r)}function Ka(e){return Hm(e)||CS(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function CS(e){return cy(e.x)||cy(e.y)}function cy(e){return e&&e!=="0%"}function Qd(e,t,r){const n=e-r,s=t*n;return r+s}function uy(e,t,r,n,s){return s!==void 0&&(e=Qd(e,s,n)),Qd(e,r,n)+t}function Gm(e,t=0,r=1,n,s){e.min=uy(e.min,t,r,n,s),e.max=uy(e.max,t,r,n,s)}function jS(e,{x:t,y:r}){Gm(e.x,t.translate,t.scale,t.originPoint),Gm(e.y,r.translate,r.scale,r.originPoint)}const dy=.999999999999,fy=1.0000000000001;function uR(e,t,r,n=!1){const s=r.length;if(!s)return;t.x=t.y=1;let a,i;for(let o=0;o<s;o++){a=r[o],i=a.projectionDelta;const{visualElement:c}=a.options;c&&c.props.style&&c.props.style.display==="contents"||(n&&a.options.layoutScroll&&a.scroll&&a!==a.root&&go(e,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),i&&(t.x*=i.x.scale,t.y*=i.y.scale,jS(e,i)),n&&Ka(a.latestValues)&&go(e,a.latestValues))}t.x<fy&&t.x>dy&&(t.x=1),t.y<fy&&t.y>dy&&(t.y=1)}function xo(e,t){e.min=e.min+t,e.max=e.max+t}function hy(e,t,r,n,s=.5){const a=Et(e.min,e.max,s);Gm(e,t,r,a,n)}function go(e,t){hy(e.x,t.x,t.scaleX,t.scale,t.originX),hy(e.y,t.y,t.scaleY,t.scale,t.originY)}function AS(e,t){return TS(cR(e.getBoundingClientRect(),t))}function dR(e,t,r){const n=AS(e,r),{scroll:s}=t;return s&&(xo(n.x,s.offset.x),xo(n.y,s.offset.y)),n}const FS=({current:e})=>e?e.ownerDocument.defaultView:null,fR=new WeakMap;class hR{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Gt(),this.visualElement=t}start(t,{snapToCursor:r=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const s=d=>{const{dragSnapToOrigin:f}=this.getProps();f?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(su(d).point)},a=(d,f)=>{const{drag:h,dragPropagation:m,onDragStart:x}=this.getProps();if(h&&!m&&(this.openDragLock&&this.openDragLock(),this.openDragLock=a6(h),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Rn(g=>{let y=this.getAxisMotionValue(g).get()||0;if(ys.test(y)){const{projection:w}=this.visualElement;if(w&&w.layout){const v=w.layout.layoutBox[g];v&&(y=bn(v)*(parseFloat(y)/100))}}this.originPoint[g]=y}),x&&vt.postRender(()=>x(d,f)),Im(this.visualElement,"transform");const{animationState:p}=this.visualElement;p&&p.setActive("whileDrag",!0)},i=(d,f)=>{const{dragPropagation:h,dragDirectionLock:m,onDirectionLock:x,onDrag:p}=this.getProps();if(!h&&!this.openDragLock)return;const{offset:g}=f;if(m&&this.currentDirection===null){this.currentDirection=mR(g),this.currentDirection!==null&&x&&x(this.currentDirection);return}this.updateAxis("x",f.point,g),this.updateAxis("y",f.point,g),this.visualElement.render(),p&&p(d,f)},o=(d,f)=>this.stop(d,f),c=()=>Rn(d=>{var f;return this.getAnimationState(d)==="paused"&&((f=this.getAxisMotionValue(d).animation)===null||f===void 0?void 0:f.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new kS(t,{onSessionStart:s,onStart:a,onMove:i,onSessionEnd:o,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,contextWindow:FS(this.visualElement)})}stop(t,r){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:s}=r;this.startAnimation(s);const{onDragEnd:a}=this.getProps();a&&vt.postRender(()=>a(t,r))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,n){const{drag:s}=this.getProps();if(!n||!Mu(t,s,this.currentDirection))return;const a=this.getAxisMotionValue(t);let i=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(i=rR(i,this.constraints[t],this.elastic[t])),a.set(i)}resolveConstraints(){var t;const{dragConstraints:r,dragElastic:n}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,a=this.constraints;r&&ho(r)?this.constraints||(this.constraints=this.resolveRefConstraints()):r&&s?this.constraints=nR(s.layoutBox,r):this.constraints=!1,this.elastic=oR(n),a!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&Rn(i=>{this.constraints!==!1&&this.getAxisMotionValue(i)&&(this.constraints[i]=iR(s.layoutBox[i],this.constraints[i]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!ho(t))return!1;const n=t.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const a=dR(n,s.root,this.visualElement.getTransformPagePoint());let i=sR(s.layout.layoutBox,a);if(r){const o=r(lR(i));this.hasMutatedConstraints=!!o,o&&(i=TS(o))}return i}startAnimation(t){const{drag:r,dragMomentum:n,dragElastic:s,dragTransition:a,dragSnapToOrigin:i,onDragTransitionEnd:o}=this.getProps(),c=this.constraints||{},u=Rn(d=>{if(!Mu(d,r,this.currentDirection))return;let f=c&&c[d]||{};i&&(f={min:0,max:0});const h=s?200:1e6,m=s?40:1e7,x={type:"inertia",velocity:n?t[d]:0,bounceStiffness:h,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...a,...f};return this.startAxisValueAnimation(d,x)});return Promise.all(u).then(o)}startAxisValueAnimation(t,r){const n=this.getAxisMotionValue(t);return Im(this.visualElement,t),n.start(Kx(t,n,0,r,this.visualElement,!1))}stopAnimation(){Rn(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Rn(t=>{var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.pause()})}getAnimationState(t){var r;return(r=this.getAxisMotionValue(t).animation)===null||r===void 0?void 0:r.state}getAxisMotionValue(t){const r=`_drag${t.toUpperCase()}`,n=this.visualElement.getProps(),s=n[r];return s||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){Rn(r=>{const{drag:n}=this.getProps();if(!Mu(r,n,this.currentDirection))return;const{projection:s}=this.visualElement,a=this.getAxisMotionValue(r);if(s&&s.layout){const{min:i,max:o}=s.layout.layoutBox[r];a.set(t[r]-Et(i,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!ho(r)||!n||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};Rn(i=>{const o=this.getAxisMotionValue(i);if(o&&this.constraints!==!1){const c=o.get();s[i]=aR({min:c,max:c},this.constraints[i])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),Rn(i=>{if(!Mu(i,t,null))return;const o=this.getAxisMotionValue(i),{min:c,max:u}=this.constraints[i];o.set(Et(c,u,s[i]))})}addListeners(){if(!this.visualElement.current)return;fR.set(this.visualElement,this);const t=this.visualElement.current,r=Wl(t,"pointerdown",c=>{const{drag:u,dragListener:d=!0}=this.getProps();u&&d&&this.start(c)}),n=()=>{const{dragConstraints:c}=this.getProps();ho(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,a=s.addEventListener("measure",n);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),vt.read(n);const i=Rc(window,"resize",()=>this.scalePositionWithinConstraints()),o=s.addEventListener("didUpdate",({delta:c,hasLayoutChanged:u})=>{this.isDragging&&u&&(Rn(d=>{const f=this.getAxisMotionValue(d);f&&(this.originPoint[d]+=c[d].translate,f.set(f.get()+c[d].translate))}),this.visualElement.render())});return()=>{i(),r(),a(),o&&o()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:s=!1,dragConstraints:a=!1,dragElastic:i=Wm,dragMomentum:o=!0}=t;return{...t,drag:r,dragDirectionLock:n,dragPropagation:s,dragConstraints:a,dragElastic:i,dragMomentum:o}}}function Mu(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function mR(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class pR extends Da{constructor(t){super(t),this.removeGroupControls=wn,this.removeListeners=wn,this.controls=new hR(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||wn}unmount(){this.removeGroupControls(),this.removeListeners()}}const my=e=>(t,r)=>{e&&vt.postRender(()=>e(t,r))};class xR extends Da{constructor(){super(...arguments),this.removePointerDownListener=wn}onPointerDown(t){this.session=new kS(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:FS(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:n,onPanEnd:s}=this.node.getProps();return{onSessionStart:my(t),onStart:my(r),onMove:n,onEnd:(a,i)=>{delete this.session,s&&vt.postRender(()=>s(a,i))}}}mount(){this.removePointerDownListener=Wl(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const fd={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function py(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const vl={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(ze.test(e))e=parseFloat(e);else return e;const r=py(e,t.target.x),n=py(e,t.target.y);return`${r}% ${n}%`}},gR={correct:(e,{treeScale:t,projectionDelta:r})=>{const n=e,s=Ea.parse(e);if(s.length>5)return n;const a=Ea.createTransformer(e),i=typeof s[0]!="number"?1:0,o=r.x.scale*t.x,c=r.y.scale*t.y;s[0+i]/=o,s[1+i]/=c;const u=Et(o,c,.5);return typeof s[2+i]=="number"&&(s[2+i]/=u),typeof s[3+i]=="number"&&(s[3+i]/=u),a(s)}};class vR extends E.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n,layoutId:s}=this.props,{projection:a}=t;MF(yR),a&&(r.group&&r.group.add(a),n&&n.register&&s&&n.register(a),a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),fd.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:n,drag:s,isPresent:a}=this.props,i=n.projection;return i&&(i.isPresent=a,s||t.layoutDependency!==r||r===void 0?i.willUpdate():this.safeToRemove(),t.isPresent!==a&&(a?i.promote():i.relegate()||vt.postRender(()=>{const o=i.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),bx.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:s}=t;s&&(s.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(s),n&&n.deregister&&n.deregister(s))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function PS(e){const[t,r]=mk(),n=E.useContext(px);return l.jsx(vR,{...e,layoutGroup:n,switchLayoutGroup:E.useContext(_k),isPresent:t,safeToRemove:r})}const yR={borderRadius:{...vl,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:vl,borderTopRightRadius:vl,borderBottomLeftRadius:vl,borderBottomRightRadius:vl,boxShadow:gR};function wR(e,t,r){const n=_r(e)?e:zo(e);return n.start(Kx("",n,t,r)),n.animation}function _R(e){return e instanceof SVGElement&&e.tagName!=="svg"}const bR=(e,t)=>e.depth-t.depth;class kR{constructor(){this.children=[],this.isDirty=!1}add(t){Ix(this.children,t),this.isDirty=!0}remove(t){Lx(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(bR),this.isDirty=!1,this.children.forEach(t)}}function SR(e,t){const r=ws.now(),n=({timestamp:s})=>{const a=s-r;a>=t&&(Ws(n),e(a-t))};return vt.read(n,!0),()=>Ws(n)}const RS=["TopLeft","TopRight","BottomLeft","BottomRight"],ER=RS.length,xy=e=>typeof e=="string"?parseFloat(e):e,gy=e=>typeof e=="number"||ze.test(e);function NR(e,t,r,n,s,a){s?(e.opacity=Et(0,r.opacity!==void 0?r.opacity:1,TR(n)),e.opacityExit=Et(t.opacity!==void 0?t.opacity:1,0,CR(n))):a&&(e.opacity=Et(t.opacity!==void 0?t.opacity:1,r.opacity!==void 0?r.opacity:1,n));for(let i=0;i<ER;i++){const o=`border${RS[i]}Radius`;let c=vy(t,o),u=vy(r,o);if(c===void 0&&u===void 0)continue;c||(c=0),u||(u=0),c===0||u===0||gy(c)===gy(u)?(e[o]=Math.max(Et(xy(c),xy(u),n),0),(ys.test(u)||ys.test(c))&&(e[o]+="%")):e[o]=u}(t.rotate||r.rotate)&&(e.rotate=Et(t.rotate||0,r.rotate||0,n))}function vy(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const TR=OS(0,.5,Jk),CR=OS(.5,.95,wn);function OS(e,t,r){return n=>n<e?0:n>t?1:r(Vo(e,t,n))}function yy(e,t){e.min=t.min,e.max=t.max}function Cn(e,t){yy(e.x,t.x),yy(e.y,t.y)}function wy(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function _y(e,t,r,n,s){return e-=t,e=Qd(e,1/r,n),s!==void 0&&(e=Qd(e,1/s,n)),e}function jR(e,t=0,r=1,n=.5,s,a=e,i=e){if(ys.test(t)&&(t=parseFloat(t),t=Et(i.min,i.max,t/100)-i.min),typeof t!="number")return;let o=Et(a.min,a.max,n);e===a&&(o-=t),e.min=_y(e.min,t,r,o,s),e.max=_y(e.max,t,r,o,s)}function by(e,t,[r,n,s],a,i){jR(e,t[r],t[n],t[s],t.scale,a,i)}const AR=["x","scaleX","originX"],FR=["y","scaleY","originY"];function ky(e,t,r,n){by(e.x,t,AR,r?r.x:void 0,n?n.x:void 0),by(e.y,t,FR,r?r.y:void 0,n?n.y:void 0)}function Sy(e){return e.translate===0&&e.scale===1}function DS(e){return Sy(e.x)&&Sy(e.y)}function Ey(e,t){return e.min===t.min&&e.max===t.max}function PR(e,t){return Ey(e.x,t.x)&&Ey(e.y,t.y)}function Ny(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function IS(e,t){return Ny(e.x,t.x)&&Ny(e.y,t.y)}function Ty(e){return bn(e.x)/bn(e.y)}function Cy(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class RR{constructor(){this.members=[]}add(t){Ix(this.members,t),t.scheduleRender()}remove(t){if(Lx(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(s=>t===s);if(r===0)return!1;let n;for(let s=r;s>=0;s--){const a=this.members[s];if(a.isPresent!==!1){n=a;break}}return n?(this.promote(n),!0):!1}promote(t,r){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,r&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:s}=t.options;s===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:n}=t;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function OR(e,t,r){let n="";const s=e.x.translate/t.x,a=e.y.translate/t.y,i=(r==null?void 0:r.z)||0;if((s||a||i)&&(n=`translate3d(${s}px, ${a}px, ${i}px) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),r){const{transformPerspective:u,rotate:d,rotateX:f,rotateY:h,skewX:m,skewY:x}=r;u&&(n=`perspective(${u}px) ${n}`),d&&(n+=`rotate(${d}deg) `),f&&(n+=`rotateX(${f}deg) `),h&&(n+=`rotateY(${h}deg) `),m&&(n+=`skewX(${m}deg) `),x&&(n+=`skewY(${x}deg) `)}const o=e.x.scale*t.x,c=e.y.scale*t.y;return(o!==1||c!==1)&&(n+=`scale(${o}, ${c})`),n||"none"}const Xa={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},Tl=typeof window<"u"&&window.MotionDebug!==void 0,rh=["","X","Y","Z"],DR={visibility:"hidden"},jy=1e3;let IR=0;function nh(e,t,r,n){const{latestValues:s}=t;s[e]&&(r[e]=s[e],t.setStaticValue(e,0),n&&(n[e]=0))}function LS(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const r=Wk(t);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:s,layoutId:a}=e.options;window.MotionCancelOptimisedAnimation(r,"transform",vt,!(s||a))}const{parent:n}=e;n&&!n.hasCheckedOptimisedAppear&&LS(n)}function MS({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:n,resetTransform:s}){return class{constructor(i={},o=t==null?void 0:t()){this.id=IR++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Tl&&(Xa.totalNodes=Xa.resolvedTargetDeltas=Xa.recalculatedProjection=0),this.nodes.forEach(BR),this.nodes.forEach(WR),this.nodes.forEach(HR),this.nodes.forEach(UR),Tl&&window.MotionDebug.record(Xa)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=i,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new kR)}addEventListener(i,o){return this.eventHandlers.has(i)||this.eventHandlers.set(i,new Mx),this.eventHandlers.get(i).add(o)}notifyListeners(i,...o){const c=this.eventHandlers.get(i);c&&c.notify(...o)}hasListeners(i){return this.eventHandlers.has(i)}mount(i,o=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=_R(i),this.instance=i;const{layoutId:c,layout:u,visualElement:d}=this.options;if(d&&!d.current&&d.mount(i),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),o&&(u||c)&&(this.isLayoutDirty=!0),e){let f;const h=()=>this.root.updateBlockedByResize=!1;e(i,()=>{this.root.updateBlockedByResize=!0,f&&f(),f=SR(h,250),fd.hasAnimatedSinceResize&&(fd.hasAnimatedSinceResize=!1,this.nodes.forEach(Fy))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&d&&(c||u)&&this.addEventListener("didUpdate",({delta:f,hasLayoutChanged:h,hasRelativeTargetChanged:m,layout:x})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const p=this.options.transition||d.getDefaultTransition()||YR,{onLayoutAnimationStart:g,onLayoutAnimationComplete:y}=d.getProps(),w=!this.targetLayout||!IS(this.targetLayout,x)||m,v=!h&&m;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||v||h&&(w||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(f,v);const _={...Px(p,"layout"),onPlay:g,onComplete:y};(d.shouldReduceMotion||this.options.layoutRoot)&&(_.delay=0,_.type=!1),this.startAnimation(_)}else h||Fy(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=x})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const i=this.getStack();i&&i.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Ws(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(GR),this.animationId++)}getTransformTemplate(){const{visualElement:i}=this.options;return i&&i.getProps().transformTemplate}willUpdate(i=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&LS(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const f=this.path[d];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:o,layout:c}=this.options;if(o===void 0&&!c)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),i&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(Ay);return}this.isUpdating||this.nodes.forEach($R),this.isUpdating=!1,this.nodes.forEach(zR),this.nodes.forEach(LR),this.nodes.forEach(MR),this.clearAllSnapshots();const o=ws.now();vr.delta=Hs(0,1e3/60,o-vr.timestamp),vr.timestamp=o,vr.isProcessing=!0,Kf.update.process(vr),Kf.preRender.process(vr),Kf.render.process(vr),vr.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,bx.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(VR),this.sharedNodes.forEach(KR)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,vt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){vt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const i=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Gt(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,i?i.layoutBox:void 0)}updateScroll(i="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===i&&(o=!1),o){const c=n(this.instance);this.scroll={animationId:this.root.animationId,phase:i,isRoot:c,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!s)return;const i=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!DS(this.projectionDelta),c=this.getTransformTemplate(),u=c?c(this.latestValues,""):void 0,d=u!==this.prevTransformTemplateValue;i&&(o||Ka(this.latestValues)||d)&&(s(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(i=!0){const o=this.measurePageBox();let c=this.removeElementScroll(o);return i&&(c=this.removeTransform(c)),JR(c),{animationId:this.root.animationId,measuredBox:o,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){var i;const{visualElement:o}=this.options;if(!o)return Gt();const c=o.measureViewportBox();if(!(((i=this.scroll)===null||i===void 0?void 0:i.wasRoot)||this.path.some(QR))){const{scroll:d}=this.root;d&&(xo(c.x,d.offset.x),xo(c.y,d.offset.y))}return c}removeElementScroll(i){var o;const c=Gt();if(Cn(c,i),!((o=this.scroll)===null||o===void 0)&&o.wasRoot)return c;for(let u=0;u<this.path.length;u++){const d=this.path[u],{scroll:f,options:h}=d;d!==this.root&&f&&h.layoutScroll&&(f.wasRoot&&Cn(c,i),xo(c.x,f.offset.x),xo(c.y,f.offset.y))}return c}applyTransform(i,o=!1){const c=Gt();Cn(c,i);for(let u=0;u<this.path.length;u++){const d=this.path[u];!o&&d.options.layoutScroll&&d.scroll&&d!==d.root&&go(c,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),Ka(d.latestValues)&&go(c,d.latestValues)}return Ka(this.latestValues)&&go(c,this.latestValues),c}removeTransform(i){const o=Gt();Cn(o,i);for(let c=0;c<this.path.length;c++){const u=this.path[c];if(!u.instance||!Ka(u.latestValues))continue;Hm(u.latestValues)&&u.updateSnapshot();const d=Gt(),f=u.measurePageBox();Cn(d,f),ky(o,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,d)}return Ka(this.latestValues)&&ky(o,this.latestValues),o}setTargetDelta(i){this.targetDelta=i,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(i){this.options={...this.options,...i,crossfade:i.crossfade!==void 0?i.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==vr.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(i=!1){var o;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==c;if(!(i||u&&this.isSharedProjectionDirty||this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:f,layoutId:h}=this.options;if(!(!this.layout||!(f||h))){if(this.resolvedRelativeTargetAt=vr.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Gt(),this.relativeTargetOrigin=Gt(),Gl(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),Cn(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Gt(),this.targetWithTransforms=Gt()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),tR(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Cn(this.target,this.layout.layoutBox),jS(this.target,this.targetDelta)):Cn(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Gt(),this.relativeTargetOrigin=Gt(),Gl(this.relativeTargetOrigin,this.target,m.target),Cn(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Tl&&Xa.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||Hm(this.parent.latestValues)||CS(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var i;const o=this.getLead(),c=!!this.resumingFrom||this!==o;let u=!0;if((this.isProjectionDirty||!((i=this.parent)===null||i===void 0)&&i.isProjectionDirty)&&(u=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===vr.timestamp&&(u=!1),u)return;const{layout:d,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||f))return;Cn(this.layoutCorrected,this.layout.layoutBox);const h=this.treeScale.x,m=this.treeScale.y;uR(this.layoutCorrected,this.treeScale,this.path,c),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=Gt());const{target:x}=o;if(!x){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(wy(this.prevProjectionDelta.x,this.projectionDelta.x),wy(this.prevProjectionDelta.y,this.projectionDelta.y)),Hl(this.projectionDelta,this.layoutCorrected,x,this.latestValues),(this.treeScale.x!==h||this.treeScale.y!==m||!Cy(this.projectionDelta.x,this.prevProjectionDelta.x)||!Cy(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",x)),Tl&&Xa.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(i=!0){var o;if((o=this.options.visualElement)===null||o===void 0||o.scheduleRender(),i){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=po(),this.projectionDelta=po(),this.projectionDeltaWithTransform=po()}setAnimationOrigin(i,o=!1){const c=this.snapshot,u=c?c.latestValues:{},d={...this.latestValues},f=po();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const h=Gt(),m=c?c.source:void 0,x=this.layout?this.layout.source:void 0,p=m!==x,g=this.getStack(),y=!g||g.members.length<=1,w=!!(p&&!y&&this.options.crossfade===!0&&!this.path.some(qR));this.animationProgress=0;let v;this.mixTargetDelta=_=>{const S=_/1e3;Py(f.x,i.x,S),Py(f.y,i.y,S),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Gl(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),XR(this.relativeTarget,this.relativeTargetOrigin,h,S),v&&PR(this.relativeTarget,v)&&(this.isProjectionDirty=!1),v||(v=Gt()),Cn(v,this.relativeTarget)),p&&(this.animationValues=d,NR(d,u,this.latestValues,S,w,y)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=S},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(i){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Ws(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=vt.update(()=>{fd.hasAnimatedSinceResize=!0,this.currentAnimation=wR(0,jy,{...i,onUpdate:o=>{this.mixTargetDelta(o),i.onUpdate&&i.onUpdate(o)},onComplete:()=>{i.onComplete&&i.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const i=this.getStack();i&&i.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(jy),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const i=this.getLead();let{targetWithTransforms:o,target:c,layout:u,latestValues:d}=i;if(!(!o||!c||!u)){if(this!==i&&this.layout&&u&&BS(this.options.animationType,this.layout.layoutBox,u.layoutBox)){c=this.target||Gt();const f=bn(this.layout.layoutBox.x);c.x.min=i.target.x.min,c.x.max=c.x.min+f;const h=bn(this.layout.layoutBox.y);c.y.min=i.target.y.min,c.y.max=c.y.min+h}Cn(o,c),go(o,d),Hl(this.projectionDeltaWithTransform,this.layoutCorrected,o,d)}}registerSharedNode(i,o){this.sharedNodes.has(i)||this.sharedNodes.set(i,new RR),this.sharedNodes.get(i).add(o);const u=o.options.initialPromotionConfig;o.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(o):void 0})}isLead(){const i=this.getStack();return i?i.lead===this:!0}getLead(){var i;const{layoutId:o}=this.options;return o?((i=this.getStack())===null||i===void 0?void 0:i.lead)||this:this}getPrevLead(){var i;const{layoutId:o}=this.options;return o?(i=this.getStack())===null||i===void 0?void 0:i.prevLead:void 0}getStack(){const{layoutId:i}=this.options;if(i)return this.root.sharedNodes.get(i)}promote({needsReset:i,transition:o,preserveFollowOpacity:c}={}){const u=this.getStack();u&&u.promote(this,c),i&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const i=this.getStack();return i?i.relegate(this):!1}resetSkewAndRotation(){const{visualElement:i}=this.options;if(!i)return;let o=!1;const{latestValues:c}=i;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(o=!0),!o)return;const u={};c.z&&nh("z",i,u,this.animationValues);for(let d=0;d<rh.length;d++)nh(`rotate${rh[d]}`,i,u,this.animationValues),nh(`skew${rh[d]}`,i,u,this.animationValues);i.render();for(const d in u)i.setStaticValue(d,u[d]),this.animationValues&&(this.animationValues[d]=u[d]);i.scheduleRender()}getProjectionStyles(i){var o,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return DR;const u={visibility:""},d=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,u.opacity="",u.pointerEvents=ud(i==null?void 0:i.pointerEvents)||"",u.transform=d?d(this.latestValues,""):"none",u;const f=this.getLead();if(!this.projectionDelta||!this.layout||!f.target){const p={};return this.options.layoutId&&(p.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,p.pointerEvents=ud(i==null?void 0:i.pointerEvents)||""),this.hasProjected&&!Ka(this.latestValues)&&(p.transform=d?d({},""):"none",this.hasProjected=!1),p}const h=f.animationValues||f.latestValues;this.applyTransformsToTarget(),u.transform=OR(this.projectionDeltaWithTransform,this.treeScale,h),d&&(u.transform=d(h,u.transform));const{x:m,y:x}=this.projectionDelta;u.transformOrigin=`${m.origin*100}% ${x.origin*100}% 0`,f.animationValues?u.opacity=f===this?(c=(o=h.opacity)!==null&&o!==void 0?o:this.latestValues.opacity)!==null&&c!==void 0?c:1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:u.opacity=f===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const p in Kd){if(h[p]===void 0)continue;const{correct:g,applyTo:y}=Kd[p],w=u.transform==="none"?h[p]:g(h[p],f);if(y){const v=y.length;for(let _=0;_<v;_++)u[y[_]]=w}else u[p]=w}return this.options.layoutId&&(u.pointerEvents=f===this?ud(i==null?void 0:i.pointerEvents)||"":"none"),u}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(i=>{var o;return(o=i.currentAnimation)===null||o===void 0?void 0:o.stop()}),this.root.nodes.forEach(Ay),this.root.sharedNodes.clear()}}}function LR(e){e.updateLayout()}function MR(e){var t;const r=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&r&&e.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:s}=e.layout,{animationType:a}=e.options,i=r.source!==e.layout.source;a==="size"?Rn(f=>{const h=i?r.measuredBox[f]:r.layoutBox[f],m=bn(h);h.min=n[f].min,h.max=h.min+m}):BS(a,r.layoutBox,n)&&Rn(f=>{const h=i?r.measuredBox[f]:r.layoutBox[f],m=bn(n[f]);h.max=h.min+m,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[f].max=e.relativeTarget[f].min+m)});const o=po();Hl(o,n,r.layoutBox);const c=po();i?Hl(c,e.applyTransform(s,!0),r.measuredBox):Hl(c,n,r.layoutBox);const u=!DS(o);let d=!1;if(!e.resumeFrom){const f=e.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:h,layout:m}=f;if(h&&m){const x=Gt();Gl(x,r.layoutBox,h.layoutBox);const p=Gt();Gl(p,n,m.layoutBox),IS(x,p)||(d=!0),f.options.layoutRoot&&(e.relativeTarget=p,e.relativeTargetOrigin=x,e.relativeParent=f)}}}e.notifyListeners("didUpdate",{layout:n,snapshot:r,delta:c,layoutDelta:o,hasLayoutChanged:u,hasRelativeTargetChanged:d})}else if(e.isLead()){const{onExitComplete:n}=e.options;n&&n()}e.options.transition=void 0}function BR(e){Tl&&Xa.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function UR(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function VR(e){e.clearSnapshot()}function Ay(e){e.clearMeasurements()}function $R(e){e.isLayoutDirty=!1}function zR(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function Fy(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function WR(e){e.resolveTargetDelta()}function HR(e){e.calcProjection()}function GR(e){e.resetSkewAndRotation()}function KR(e){e.removeLeadSnapshot()}function Py(e,t,r){e.translate=Et(t.translate,0,r),e.scale=Et(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function Ry(e,t,r,n){e.min=Et(t.min,r.min,n),e.max=Et(t.max,r.max,n)}function XR(e,t,r,n){Ry(e.x,t.x,r.x,n),Ry(e.y,t.y,r.y,n)}function qR(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const YR={duration:.45,ease:[.4,0,.1,1]},Oy=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),Dy=Oy("applewebkit/")&&!Oy("chrome/")?Math.round:wn;function Iy(e){e.min=Dy(e.min),e.max=Dy(e.max)}function JR(e){Iy(e.x),Iy(e.y)}function BS(e,t,r){return e==="position"||e==="preserve-aspect"&&!eR(Ty(t),Ty(r),.2)}function QR(e){var t;return e!==e.root&&((t=e.scroll)===null||t===void 0?void 0:t.wasRoot)}const ZR=MS({attachResizeListener:(e,t)=>Rc(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),sh={current:void 0},US=MS({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!sh.current){const e=new ZR({});e.mount(window),e.setOptions({layoutScroll:!0}),sh.current=e}return sh.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),e8={pan:{Feature:xR},drag:{Feature:pR,ProjectionNode:US,MeasureLayout:PS}};function Ly(e,t,r){const{props:n}=e;e.animationState&&n.whileHover&&e.animationState.setActive("whileHover",r==="Start");const s="onHover"+r,a=n[s];a&&vt.postRender(()=>a(t,su(t)))}class t8 extends Da{mount(){const{current:t}=this.node;t&&(this.unmount=e6(t,r=>(Ly(this.node,r,"Start"),n=>Ly(this.node,n,"End"))))}unmount(){}}class r8 extends Da{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=nu(Rc(this.node.current,"focus",()=>this.onFocus()),Rc(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function My(e,t,r){const{props:n}=e;e.animationState&&n.whileTap&&e.animationState.setActive("whileTap",r==="Start");const s="onTap"+(r==="End"?"":r),a=n[s];a&&vt.postRender(()=>a(t,su(t)))}class n8 extends Da{mount(){const{current:t}=this.node;t&&(this.unmount=s6(t,r=>(My(this.node,r,"Start"),(n,{success:s})=>My(this.node,n,s?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Km=new WeakMap,ah=new WeakMap,s8=e=>{const t=Km.get(e.target);t&&t(e)},a8=e=>{e.forEach(s8)};function i8({root:e,...t}){const r=e||document;ah.has(r)||ah.set(r,{});const n=ah.get(r),s=JSON.stringify(t);return n[s]||(n[s]=new IntersectionObserver(a8,{root:e,...t})),n[s]}function o8(e,t,r){const n=i8(t);return Km.set(e,r),n.observe(e),()=>{Km.delete(e),n.unobserve(e)}}const l8={some:0,all:1};class c8 extends Da{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:n,amount:s="some",once:a}=t,i={root:r?r.current:void 0,rootMargin:n,threshold:typeof s=="number"?s:l8[s]},o=c=>{const{isIntersecting:u}=c;if(this.isInView===u||(this.isInView=u,a&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:d,onViewportLeave:f}=this.node.getProps(),h=u?d:f;h&&h(c)};return o8(this.node.current,i,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(u8(t,r))&&this.startObserver()}unmount(){}}function u8({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const d8={inView:{Feature:c8},tap:{Feature:n8},focus:{Feature:r8},hover:{Feature:t8}},f8={layout:{ProjectionNode:US,MeasureLayout:PS}},Xm={current:null},VS={current:!1};function h8(){if(VS.current=!0,!!xx)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>Xm.current=e.matches;e.addListener(t),t()}else Xm.current=!1}const m8=[...dS,jr,Ea],p8=e=>m8.find(uS(e)),By=new WeakMap;function x8(e,t,r){for(const n in t){const s=t[n],a=r[n];if(_r(s))e.addValue(n,s);else if(_r(a))e.addValue(n,zo(s,{owner:e}));else if(a!==s)if(e.hasValue(n)){const i=e.getValue(n);i.liveStyle===!0?i.jump(s):i.hasAnimated||i.set(s)}else{const i=e.getStaticValue(n);e.addValue(n,zo(i!==void 0?i:s,{owner:e}))}}for(const n in r)t[n]===void 0&&e.removeValue(n);return t}const Uy=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class g8{scrapeMotionValuesFromProps(t,r,n){return{}}constructor({parent:t,props:r,presenceContext:n,reducedMotionConfig:s,blockInitialAnimation:a,visualState:i},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Wx,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const m=ws.now();this.renderScheduledAt<m&&(this.renderScheduledAt=m,vt.render(this.render,!1,!0))};const{latestValues:c,renderState:u,onUpdate:d}=i;this.onUpdate=d,this.latestValues=c,this.baseTarget={...c},this.initialValues=r.initial?{...c}:{},this.renderState=u,this.parent=t,this.props=r,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=s,this.options=o,this.blockInitialAnimation=!!a,this.isControllingVariants=H0(r),this.isVariantNode=yk(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:f,...h}=this.scrapeMotionValuesFromProps(r,{},this);for(const m in h){const x=h[m];c[m]!==void 0&&_r(x)&&x.set(c[m],!1)}}mount(t){this.current=t,By.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),VS.current||h8(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Xm.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){By.delete(this.current),this.projection&&this.projection.unmount(),Ws(this.notifyUpdate),Ws(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const r=this.features[t];r&&(r.unmount(),r.isMounted=!1)}this.current=null}bindToMotionValue(t,r){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const n=ji.has(t),s=r.on("change",o=>{this.latestValues[t]=o,this.props.onUpdate&&vt.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0)}),a=r.on("renderRequest",this.scheduleRender);let i;window.MotionCheckAppearSync&&(i=window.MotionCheckAppearSync(this,t,r)),this.valueSubscriptions.set(t,()=>{s(),a(),i&&i(),r.owner&&r.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in $o){const r=$o[t];if(!r)continue;const{isEnabled:n,Feature:s}=r;if(!this.features[t]&&s&&n(this.props)&&(this.features[t]=new s(this)),this.features[t]){const a=this.features[t];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Gt()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<Uy.length;n++){const s=Uy[n];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const a="on"+s,i=t[a];i&&(this.propEventSubscriptions[s]=this.on(s,i))}this.prevMotionValues=x8(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){const n=this.values.get(t);r!==n&&(n&&this.removeValue(t),this.bindToMotionValue(t,r),this.values.set(t,r),this.latestValues[t]=r.get())}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&r!==void 0&&(n=zo(r===null?void 0:r,{owner:this}),this.addValue(t,n)),n}readValue(t,r){var n;let s=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(n=this.getBaseTargetFromProps(this.props,t))!==null&&n!==void 0?n:this.readValueFromInstance(this.current,t,this.options);return s!=null&&(typeof s=="string"&&(lS(s)||Zk(s))?s=parseFloat(s):!p8(s)&&Ea.test(r)&&(s=aS(t,r)),this.setBaseTarget(t,_r(s)?s.get():s)),_r(s)?s.get():s}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var r;const{initial:n}=this.props;let s;if(typeof n=="string"||typeof n=="object"){const i=Sx(this.props,n,(r=this.presenceContext)===null||r===void 0?void 0:r.custom);i&&(s=i[t])}if(n&&s!==void 0)return s;const a=this.getBaseTargetFromProps(this.props,t);return a!==void 0&&!_r(a)?a:this.initialValues[t]!==void 0&&s===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new Mx),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}}class $S extends g8{constructor(){super(...arguments),this.KeyframeResolver=fS}sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:n}){delete r[t],delete n[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;_r(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function v8(e){return window.getComputedStyle(e)}class y8 extends $S{constructor(){super(...arguments),this.type="html",this.renderInstance=Ck}readValueFromInstance(t,r){if(ji.has(r)){const n=zx(r);return n&&n.default||0}else{const n=v8(t),s=(Ek(r)?n.getPropertyValue(r):n[r])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(t,{transformPagePoint:r}){return AS(t,r)}build(t,r,n){Tx(t,r,n.transformTemplate)}scrapeMotionValuesFromProps(t,r,n){return Fx(t,r,n)}}class w8 extends $S{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Gt}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(ji.has(r)){const n=zx(r);return n&&n.default||0}return r=jk.has(r)?r:_x(r),t.getAttribute(r)}scrapeMotionValuesFromProps(t,r,n){return Pk(t,r,n)}build(t,r,n){Cx(t,r,this.isSVGTag,n.transformTemplate)}renderInstance(t,r,n,s){Ak(t,r,n,s)}mount(t){this.isSVGTag=Ax(t.tagName),super.mount(t)}}const _8=(e,t)=>kx(e)?new w8(t):new y8(t,{allowProjection:e!==E.Fragment}),b8=KF({...HP,...d8,...e8,...f8},_8),Ze=lF(b8);function zS(e){const t=Ci(()=>zo(e)),{isStatic:r}=E.useContext($0);if(r){const[,n]=E.useState(e);E.useEffect(()=>t.on("change",n),[])}return t}function WS(e,t){const r=zS(t()),n=()=>r.set(t());return n(),gx(()=>{const s=()=>vt.preRender(n,!1,!0),a=e.map(i=>i.on("change",s));return()=>{a.forEach(i=>i()),Ws(n)}}),r}const k8=e=>e&&typeof e=="object"&&e.mix,S8=e=>k8(e)?e.mix:void 0;function E8(...e){const t=!Array.isArray(e[0]),r=t?0:-1,n=e[0+r],s=e[1+r],a=e[2+r],i=e[3+r],o=yS(s,a,{mixer:S8(a[0]),...i});return t?o(n):o}function N8(e){$l.current=[],e();const t=WS($l.current,e);return $l.current=void 0,t}function T8(e,t,r,n){if(typeof e=="function")return N8(e);const s=typeof t=="function"?t:E8(t,r,n);return Array.isArray(e)?Vy(e,s):Vy([e],([a])=>s(a))}function Vy(e,t){const r=Ci(()=>[]);return WS(e,()=>{r.length=0;const n=e.length;for(let s=0;s<n;s++)r[s]=e[s].get();return t(r)})}const HS=E.createContext(null);function C8(e,t,r,n){if(!n)return e;const s=e.findIndex(d=>d.value===t);if(s===-1)return e;const a=n>0?1:-1,i=e[s+a];if(!i)return e;const o=e[s],c=i.layout,u=Et(c.min,c.max,.5);return a===1&&o.layout.max+r>u||a===-1&&o.layout.min+r<u?o6(e,s,s+a):e}function j8({children:e,as:t="ul",axis:r="y",onReorder:n,values:s,...a},i){const o=Ci(()=>Ze[t]),c=[],u=E.useRef(!1),d={axis:r,registerItem:(f,h)=>{const m=c.findIndex(x=>f===x.value);m!==-1?c[m].layout=h[r]:c.push({value:f,layout:h[r]}),c.sort(P8)},updateOrder:(f,h,m)=>{if(u.current)return;const x=C8(c,f,h,m);c!==x&&(u.current=!0,n(x.map(F8).filter(p=>s.indexOf(p)!==-1)))}};return E.useEffect(()=>{u.current=!1}),l.jsx(o,{...a,ref:i,ignoreStrict:!0,children:l.jsx(HS.Provider,{value:d,children:e})})}const A8=E.forwardRef(j8);function F8(e){return e.value}function P8(e,t){return e.layout.min-t.layout.min}function $y(e,t=0){return _r(e)?e:zS(t)}function R8({children:e,style:t={},value:r,as:n="li",onDrag:s,layout:a=!0,...i},o){const c=Ci(()=>Ze[n]),u=E.useContext(HS),d={x:$y(t.x),y:$y(t.y)},f=T8([d.x,d.y],([p,g])=>p||g?1:"unset"),{axis:h,registerItem:m,updateOrder:x}=u;return l.jsx(c,{drag:h,...i,dragSnapToOrigin:!0,style:{...t,x:d.x,y:d.y,zIndex:f},layout:a,onDrag:(p,g)=>{const{velocity:y}=g;y[h]&&x(r,d[h].get(),y[h]),s&&s(p,g)},onLayoutMeasure:p=>m(r,p),ref:o,ignoreStrict:!0,children:e})}const O8=E.forwardRef(R8);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var D8={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I8=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Me=(e,t)=>{const r=E.forwardRef(({color:n="currentColor",size:s=24,strokeWidth:a=2,absoluteStrokeWidth:i,className:o="",children:c,...u},d)=>E.createElement("svg",{ref:d,...D8,width:s,height:s,stroke:n,strokeWidth:i?Number(a)*24/Number(s):a,className:["lucide",`lucide-${I8(e)}`,o].join(" "),...u},[...t.map(([f,h])=>E.createElement(f,h)),...Array.isArray(c)?c:[c]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ho=Me("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qm=Me("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X0=Me("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L8=Me("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M8=Me("Baby",[["path",{d:"M9 12h.01",key:"157uk2"}],["path",{d:"M15 12h.01",key:"1k8ypt"}],["path",{d:"M10 16c.5.3 1.2.5 2 .5s1.5-.2 2-.5",key:"1u7htd"}],["path",{d:"M19 6.3a9 9 0 0 1 1.8 3.9 2 2 0 0 1 0 3.6 9 9 0 0 1-17.6 0 2 2 0 0 1 0-3.6A9 9 0 0 1 12 3c2 0 3.5 1.1 3.5 2.5s-.9 2.5-2 2.5c-.8 0-1.5-.4-1.5-1",key:"5yv0yz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ym=Me("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GS=Me("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KS=Me("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B8=Me("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kl=Me("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U8=Me("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zd=Me("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zy=Me("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V8=Me("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $8=Me("Construction",[["rect",{x:"2",y:"6",width:"20",height:"8",rx:"1",key:"1estib"}],["path",{d:"M17 14v7",key:"7m2elx"}],["path",{d:"M7 14v7",key:"1cm7wv"}],["path",{d:"M17 3v3",key:"1v4jwn"}],["path",{d:"M7 3v3",key:"7o6guu"}],["path",{d:"M10 14 2.3 6.3",key:"1023jk"}],["path",{d:"m14 6 7.7 7.7",key:"1s8pl2"}],["path",{d:"m8 6 8 8",key:"hl96qh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XS=Me("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=Me("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z8=Me("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e0=Me("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ih=Me("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xl=Me("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W8=Me("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wy=Me("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qS=Me("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YS=Me("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JS=Me("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H8=Me("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q0=Me("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G8=Me("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fs=Me("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oi=Me("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xx=Me("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gi=Me("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QS=Me("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K8=Me("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oc=Me("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ai=Me("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vo=Me("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X8=Me("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZS=Me("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hy=Me("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t0=Me("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q8=Me("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jm=Me("Tent",[["path",{d:"M3.5 21 14 3",key:"1szst5"}],["path",{d:"M20.5 21 10 3",key:"1310c3"}],["path",{d:"M15.5 21 12 15l-3.5 6",key:"1ddtfw"}],["path",{d:"M2 21h20",key:"1nyx9w"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nn=Me("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eE=Me("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qm=Me("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r0=Me("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n0=Me("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const To=Me("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vn=Me("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zm=Me("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y8=Me("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tE=Me("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cs=Me("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function J8(){const[e,t]=E.useState(!0),[r,n]=E.useState(""),[s,a]=E.useState(""),[i,o]=E.useState(""),[c,u]=E.useState("user"),[d,f]=E.useState(""),[h,m]=E.useState(!1),{login:x,register:p}=on(),g=Oa(),y=async w=>{w.preventDefault(),f(""),m(!0);try{if(e)await x(r,s),g("/");else{if(s!==i){f("   "),m(!1);return}if(s.length<6){f("     6   "),m(!1);return}await p(r,s,{role:c}),alert("   !    ."),t(!0),a(""),o("")}}catch(v){console.error("Login Error Full Object:",v),f(v.message||v.error_description||"   .    (Console).")}finally{m(!1)}};return l.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-indigo-500 via-purple-500 to-pink-500 p-4 relative overflow-hidden",children:[l.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[l.jsx(Ze.div,{animate:{x:[0,150,0],y:[0,-100,0],scale:[1,1.4,1],rotate:[0,180,0]},transition:{duration:20,repeat:1/0,ease:"linear"},className:"absolute -top-10 -right-10 w-[400px] h-[400px] bg-white/20 rounded-full blur-[80px]"}),l.jsx(Ze.div,{animate:{x:[0,-200,0],y:[0,150,0],scale:[1,1.8,1]},transition:{duration:25,repeat:1/0,ease:"linear"},className:"absolute -bottom-20 -left-20 w-[600px] h-[600px] bg-indigo-300/30 rounded-full blur-[100px]"}),l.jsx(Ze.div,{animate:{scale:[1,1.5,1],opacity:[.4,.7,.4]},transition:{duration:15,repeat:1/0,ease:"easeInOut"},className:"absolute top-1/3 left-1/4 w-80 h-80 bg-purple-300/30 rounded-full blur-[70px]"}),l.jsx(Ze.div,{animate:{y:[0,-150,0],x:[0,100,0]},transition:{duration:18,repeat:1/0,ease:"easeInOut"},className:"absolute bottom-1/3 right-1/4 w-72 h-72 bg-pink-300/30 rounded-full blur-[90px]"})]}),l.jsxs(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white/95 backdrop-blur-lg p-8 rounded-2xl shadow-2xl w-full max-w-md relative z-10",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("div",{className:"flex justify-center mb-4",children:l.jsx("div",{className:"bg-white p-2 rounded-2xl shadow-sm border border-gray-100",children:l.jsx("img",{src:"/favicon.png",alt:"Logo",className:"h-16 w-16 object-contain"})})}),l.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"  "}),l.jsx("p",{className:"text-gray-500 text-sm",children:e?"     ":"  "})]}),d&&l.jsxs("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-xl flex items-start gap-3",children:[l.jsx(Ho,{className:"h-5 w-5 text-red-600 mt-0.5 shrink-0"}),l.jsx("p",{className:"text-red-800 text-sm",children:d})]}),l.jsxs("form",{onSubmit:y,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"  / "}),l.jsxs("div",{className:"relative",children:[l.jsx(To,{className:"absolute right-3 top-3 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"text",value:r,onChange:w=>n(w.target.value),className:"w-full pr-10 pl-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none transition-all",placeholder:"   ...",required:!0})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),l.jsxs("div",{className:"relative",children:[l.jsx(JS,{className:"absolute right-3 top-3 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"password",value:s,onChange:w=>a(w.target.value),className:"w-full pr-10 pl-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none transition-all",placeholder:"",required:!0,minLength:6})]})]}),l.jsx("button",{type:"submit",disabled:h,className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 px-4 rounded-lg shadow-md transition-all flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:h?l.jsx("span",{children:" ..."}):l.jsx(l.Fragment,{children:l.jsxs(l.Fragment,{children:["  ",l.jsx(X0,{className:"h-5 w-5"})]})})}),l.jsxs("div",{className:"relative my-4",children:[l.jsx("div",{className:"absolute inset-0 flex items-center",children:l.jsx("div",{className:"w-full border-t border-gray-300"})}),l.jsx("div",{className:"relative flex justify-center text-sm",children:l.jsx("span",{className:"px-2 bg-white/95 text-gray-500",children:""})})]}),l.jsxs("button",{type:"button",onClick:()=>g("/check"),className:"w-full bg-white border border-indigo-200 text-indigo-700 hover:bg-indigo-50 font-semibold py-3 px-4 rounded-lg transition-all flex items-center justify-center gap-2",children:[l.jsx(Ho,{className:"h-5 w-5"}),"   ()"]})]}),l.jsx("div",{className:"mt-6 text-center text-sm text-gray-500",children:l.jsx("p",{children:"         ."})}),l.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-200",children:[l.jsx("p",{className:"text-center text-sm text-gray-500 mb-4",children:" "}),l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("a",{href:"https://wa.me/972595090192",target:"_blank",rel:"noopener noreferrer",className:"flex flex-col items-center justify-center p-3 bg-green-50 hover:bg-green-100 border border-green-200 rounded-xl transition-colors group",children:[l.jsx("div",{className:"bg-green-500 text-white p-2 rounded-full mb-2 group-hover:scale-110 transition-transform",children:l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:l.jsx("path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"})})}),l.jsx("span",{className:"text-xs font-bold text-green-800",children:" "})]}),l.jsxs("a",{href:"https://chat.whatsapp.com/LJxPetZJsrBGpqHD6u7zCU",target:"_blank",rel:"noopener noreferrer",className:"flex flex-col items-center justify-center p-3 bg-blue-50 hover:bg-blue-100 border border-blue-200 rounded-xl transition-colors group",children:[l.jsx("div",{className:"bg-blue-500 text-white p-2 rounded-full mb-2 group-hover:scale-110 transition-transform",children:l.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[l.jsx("path",{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"}),l.jsx("circle",{cx:"9",cy:"7",r:"4"}),l.jsx("path",{d:"M23 21v-2a4 4 0 0 0-3-3.87"}),l.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]})}),l.jsx("span",{className:"text-xs font-bold text-blue-800",children:" "})]})]}),l.jsx("div",{className:"mt-6 text-center text-xs text-gray-400",children:l.jsx("p",{children:" 1.2.0 |    "})})]})]})]})}function Q8(){const{selectedCamp:e}=Nn(),[t,r]=E.useState({active:{families:0,individuals:0,males:0,females:0,pregnant:0,nursing:0,infants:0},departed:{families:0,individuals:0,males:0,females:0,pregnant:0,nursing:0,infants:0}}),[n,s]=E.useState(!0);async function a(){if(e)try{s(!0);const o=await rn(e.camp_id),c=await zn(e.camp_id),u={active:{families:0,individuals:0,males:0,females:0,pregnant:0,nursing:0,infants:0},departed:{families:0,individuals:0,males:0,females:0,pregnant:0,nursing:0,infants:0}},d=new Set,f=new Set,h=new Map;o.forEach(x=>{h.set(x.family_id,x.is_departed),x.is_departed?u.departed.families++:u.active.families++});const m=x=>{if(!x)return 100;const p=Date.now()-new Date(x).getTime(),g=new Date(p);return Math.abs(g.getUTCFullYear()-1970)};c.forEach(x=>{const p=h.get(x.family_id),g=p?u.departed:u.active,y=p?f:d;g.individuals++,x.gender==="male"?g.males++:x.gender==="female"&&g.females++,x.is_pregnant&&g.pregnant++,m(x.dob)<2&&(g.infants++,y.add(x.family_id))}),u.active.nursing=d.size,u.departed.nursing=f.size,r(u)}catch(o){console.error("Error fetching stats:",o)}finally{s(!1)}}E.useEffect(()=>{e?a():s(!1)},[e]);const i=[{title:" ",desc:"   ",icon:vn,link:"/families",color:"bg-blue-600"},{title:" ",desc:"   ",icon:r0,link:"/entry",color:"bg-indigo-500"},{title:" ",desc:"   ",icon:Ai,link:"/search",color:"bg-emerald-500"}];return n?l.jsx("div",{className:"flex items-center justify-center min-h-[50vh]",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500",children:"  ..."})]})}):l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-8",children:" "}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-3 gap-3 md:gap-6 mb-12",children:[l.jsx(Ze.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-blue-500 to-blue-600 text-white p-4 md:p-6 rounded-2xl shadow-lg border border-white/10",children:l.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-2",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-blue-100 text-[10px] md:text-sm mb-1",children:" ()"}),l.jsx("h3",{className:"text-2xl md:text-4xl font-black",children:t.active.families}),t.departed.families>0&&l.jsxs("p",{className:"text-[9px] bg-white/20 px-1.5 py-0.5 rounded-full inline-block mt-1 font-bold",children:["+ ",t.departed.families," "]})]}),l.jsx("div",{className:"p-2 md:p-3 bg-white/20 rounded-xl backdrop-blur-md self-end md:self-center",children:l.jsx(vn,{className:"h-5 w-5 md:h-8 md:w-8"})})]})}),l.jsx(Ze.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-gradient-to-br from-purple-500 to-purple-600 text-white p-4 md:p-6 rounded-2xl shadow-lg border border-white/10",children:l.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-2",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-purple-100 text-[10px] md:text-sm mb-1",children:" ()"}),l.jsx("h3",{className:"text-2xl md:text-4xl font-black",children:t.active.individuals}),t.departed.individuals>0&&l.jsxs("p",{className:"text-[9px] bg-white/20 px-1.5 py-0.5 rounded-full inline-block mt-1 font-bold",children:["+ ",t.departed.individuals," "]})]}),l.jsx("div",{className:"p-2 md:p-3 bg-white/20 rounded-xl backdrop-blur-md self-end md:self-center",children:l.jsx(vn,{className:"h-5 w-5 md:h-8 md:w-8"})})]})}),l.jsx(Ze.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-gradient-to-br from-emerald-500 to-emerald-600 text-white p-4 md:p-6 rounded-2xl shadow-lg border border-white/10",children:l.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-2",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-emerald-100 text-[10px] md:text-sm mb-1",children:" / "}),l.jsxs("h3",{className:"text-xl md:text-4xl font-black",children:[t.active.males," / ",t.active.females]}),l.jsx("p",{className:"text-[9px] text-emerald-100 mt-1 font-bold opacity-80",children:" "})]}),l.jsx("div",{className:"p-2 md:p-3 bg-white/20 rounded-xl backdrop-blur-md self-end md:self-center",children:l.jsx("div",{className:"flex",children:l.jsx(vn,{className:"h-5 w-5 md:h-8 md:w-8"})})})]})}),l.jsx(Ze.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-gradient-to-br from-rose-500 to-rose-600 text-white p-4 md:p-6 rounded-2xl shadow-lg border border-white/10",children:l.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-2",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-rose-100 text-[10px] md:text-sm mb-1",children:" ()"}),l.jsx("h3",{className:"text-2xl md:text-4xl font-black",children:t.active.pregnant})]}),l.jsx("div",{className:"p-2 md:p-3 bg-white/20 rounded-xl backdrop-blur-md self-end md:self-center",children:l.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 md:h-8 md:w-8",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[l.jsx("path",{d:"M9 12h.01"}),l.jsx("path",{d:"M15 12h.01"}),l.jsx("path",{d:"M10 16c.5.3 1.2.5 2 .5s1.5-.2 2-.5"}),l.jsx("path",{d:"M19 6.3a9 9 0 0 1 1.8 3.9 2 2 0 0 1 0 3.7 9 9 0 0 1-1.8 3.9"}),l.jsx("path",{d:"M5 6.3a9 9 0 0 0-1.8 3.9 2 2 0 0 0 0 3.7 9 9 0 0 0 1.8 3.9"})]})})]})}),l.jsx(Ze.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-gradient-to-br from-amber-500 to-amber-600 text-white p-4 md:p-6 rounded-2xl shadow-lg border border-white/10",children:l.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-2",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-amber-100 text-[10px] md:text-sm mb-1",children:" ()"}),l.jsx("h3",{className:"text-2xl md:text-4xl font-black",children:t.active.nursing})]}),l.jsx("div",{className:"p-2 md:p-3 bg-white/20 rounded-xl backdrop-blur-md self-end md:self-center",children:l.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 md:h-8 md:w-8",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[l.jsx("path",{d:"M8 2h8"}),l.jsx("path",{d:"M9 2v2.7a3 3 0 0 1-2.2 2.9C5.4 8.2 5 9.3 5 10.4V22h14v-9.6c0-1.2.6-2.3 1.7-2.9A3 3 0 0 1 15 4.7V2"}),l.jsx("path",{d:"M7 15h10"})]})})]})}),l.jsx(Ze.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5},className:"bg-gradient-to-br from-cyan-500 to-cyan-600 text-white p-4 md:p-6 rounded-2xl shadow-lg border border-white/10",children:l.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-2",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-cyan-100 text-[10px] md:text-sm mb-1",children:" (  )"}),l.jsx("h3",{className:"text-2xl md:text-4xl font-black",children:t.active.infants})]}),l.jsx("div",{className:"p-2 md:p-3 bg-white/20 rounded-xl backdrop-blur-md self-end md:self-center",children:l.jsx(M8,{className:"h-5 w-5 md:h-8 md:w-8"})})]})})]}),l.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-6",children:" "}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:i.map((o,c)=>l.jsx(un,{to:o.link,children:l.jsxs(Ze.div,{whileHover:{scale:1.02},className:`${o.color} text-white p-8 rounded-2xl shadow-lg relative overflow-hidden group cursor-pointer`,children:[l.jsxs("div",{className:"relative z-10",children:[l.jsx(o.icon,{className:"h-10 w-10 mb-4 opacity-90"}),l.jsx("h3",{className:"text-2xl font-bold mb-2",children:o.title}),l.jsx("p",{className:"opacity-80",children:o.desc})]}),l.jsx("div",{className:"absolute -bottom-4 -right-4 bg-white opacity-10 rounded-full w-32 h-32 blur-2xl group-hover:scale-150 transition-transform duration-500"})]})},c))})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var s0={};s0.version="0.18.5";var rE=1252,Z8=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],qx={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Yx=function(e){Z8.indexOf(e)!=-1&&(rE=qx[0]=e)};function eO(){Yx(1252)}var ts=function(e){Yx(e)};function Jx(){ts(1200),eO()}function Gy(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function tO(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function nE(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Cl=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?tO(e.slice(2)):t==254&&r==255?nE(e.slice(2)):t==65279?e.slice(1):e},Bu=function(t){return String.fromCharCode(t)},Ky=function(t){return String.fromCharCode(t)},Dc,fa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ic(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),a=r>>2,n=e.charCodeAt(u++),i=(r&3)<<4|n>>4,s=e.charCodeAt(u++),o=(n&15)<<2|s>>6,c=s&63,isNaN(n)?o=c=64:isNaN(s)&&(c=64),t+=fa.charAt(a)+fa.charAt(i)+fa.charAt(o)+fa.charAt(c);return t}function kn(e){var t="",r=0,n=0,s=0,a=0,i=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)a=fa.indexOf(e.charAt(u++)),i=fa.indexOf(e.charAt(u++)),r=a<<2|i>>4,t+=String.fromCharCode(r),o=fa.indexOf(e.charAt(u++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),c=fa.indexOf(e.charAt(u++)),s=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(s));return t}var tt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Js=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Na(e){return tt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Xy(e){return tt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var pn=function(t){return tt?Js(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Y0(e){if(typeof ArrayBuffer>"u")return pn(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Ia(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function rO(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Qx(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Qx(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var ur=tt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Js(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function nO(e){for(var t=[],r=0,n=e.length+250,s=Na(e.length+255),a=0;a<e.length;++a){var i=e.charCodeAt(a);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++a)&1023;s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|o>>6&15|(i&3)<<4,s[r++]=128|o&63}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|i&63;r>n&&(t.push(s.slice(0,r)),r=0,s=Na(65535),n=65530)}return t.push(s.slice(0,r)),ur(t)}var Wr=/\u0000/g,jl=/[\u0001-\u0006]/g;function Co(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function rs(e,t){var r=""+e;return r.length>=t?r:Ut("0",t-r.length)+r}function Zx(e,t){var r=""+e;return r.length>=t?r:Ut(" ",t-r.length)+r}function a0(e,t){var r=""+e;return r.length>=t?r:r+Ut(" ",t-r.length)}function sO(e,t){var r=""+Math.round(e);return r.length>=t?r:Ut("0",t-r.length)+r}function aO(e,t){var r=""+e;return r.length>=t?r:Ut("0",t-r.length)+r}var qy=Math.pow(2,32);function Gi(e,t){if(e>qy||e<-qy)return sO(e,t);var r=Math.round(e);return aO(r,t)}function i0(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Yy=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],oh=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function iO(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var He={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Jy={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},oO={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function o0(e,t,r){for(var n=e<0?-1:1,s=e*n,a=0,i=1,o=0,c=1,u=0,d=0,f=Math.floor(s);u<t&&(f=Math.floor(s),o=f*i+a,d=f*u+c,!(s-f<5e-8));)s=1/(s-f),a=i,i=o,c=u,u=d;if(d>t&&(u>t?(d=c,o=a):(d=u,o=i)),!r)return[0,n*o,d];var h=Math.floor(n*o/d);return[h,n*o-h*d,d]}function ni(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),a=0,i=[],o={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),i=[c.getFullYear(),c.getMonth()+1,c.getDate()],a=c.getDay(),n<60&&(a=(a+6)%7),r&&(a=hO(c,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=a,o}var sE=new Date(1899,11,31,0,0,0),lO=sE.getTime(),cO=new Date(1900,2,1,0,0,0);function aE(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=cO&&(r+=24*60*60*1e3),(r-(lO+(e.getTimezoneOffset()-sE.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function eg(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function uO(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function dO(e){var t=e<0?12:11,r=eg(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function fO(e){var t=eg(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Lc(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=dO(e):t===10?r=e.toFixed(10).substr(0,12):r=fO(e),eg(uO(r.toUpperCase()))}function vi(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Lc(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Wn(14,aE(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function hO(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function mO(e,t,r,n){var s="",a=0,i=0,o=r.y,c,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,u=2;break;default:c=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return oh[r.m-1][1];case 5:return oh[r.m-1][0];default:return oh[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return Yy[r.q][0];default:return Yy[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?rs(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),t==="s"?a===0?"0":""+a/i:(s=rs(a,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=o,u=1;break}var d=u>0?rs(c,u):"";return d}function ha(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var iE=/%/g;function pO(e,t,r){var n=t.replace(iE,""),s=t.length-n.length;return Is(e,n,r*Math.pow(10,2*s))+Ut("%",s)}function xO(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Is(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function oE(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+oE(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(s+a)%s)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var lE=/# (\?+)( ?)\/( ?)(\d+)/;function gO(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),a=Math.floor(s/n),i=s-a*n,o=n;return r+(a===0?"":""+a)+" "+(i===0?Ut(" ",e[1].length+1+e[4].length):Zx(i,e[1].length)+e[2]+"/"+e[3]+rs(o,e[4].length))}function vO(e,t,r){return r+(t===0?"":""+t)+Ut(" ",e[1].length+2+e[4].length)}var cE=/^#*0*\.([0#]+)/,uE=/\).*[0#]/,dE=/\(###\) ###\\?-####/;function Vr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function Qy(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Zy(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function yO(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function wO(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function An(e,t,r){if(e.charCodeAt(0)===40&&!t.match(uE)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?An("n",n,r):"("+An("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return xO(e,t,r);if(t.indexOf("%")!==-1)return pO(e,t,r);if(t.indexOf("E")!==-1)return oE(t,r);if(t.charCodeAt(0)===36)return"$"+An(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Gi(c,t.length);if(t.match(/^[#?]+$/))return s=Gi(r,0),s==="0"&&(s=""),s.length>t.length?s:Vr(t.substr(0,t.length-s.length))+s;if(a=t.match(lE))return gO(a,c,u);if(t.match(/^#+0+$/))return u+Gi(c,t.length-t.indexOf("0"));if(a=t.match(cE))return s=Qy(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Vr(a[1])).replace(/\.$/,"."+Vr(a[1])).replace(/\.(\d*)$/,function(x,p){return"."+p+Ut("0",Vr(a[1]).length-p.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+Qy(c,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+ha(Gi(c,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+An(e,t,-r):ha(""+(Math.floor(r)+yO(r,a[1].length)))+"."+rs(Zy(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return An(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Co(An(e,t.replace(/[\\-]/g,""),r)),i=0,Co(Co(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<s.length?s.charAt(i++):x==="0"?"0":""}));if(t.match(dE))return s=An(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=o0(c,Math.pow(10,i)-1,!1),s=""+u,d=Is("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+a[2]+"/"+a[3],d=a0(o[2],i),d.length<a[4].length&&(d=Vr(a[4].substr(a[4].length-d.length))+d),s+=d,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=o0(c,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Zx(o[1],i)+a[2]+"/"+a[3]+a0(o[2],i):Ut(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=Gi(r,0),t.length<=s.length?s:Vr(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var f=t.indexOf(".")-i,h=t.length-s.length-f;return Vr(t.substr(0,f)+s+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return i=Zy(r,a[1].length),r<0?"-"+An(e,t,-r):ha(wO(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?rs(0,3-x.length):"")+x})+"."+rs(i,a[1].length);switch(t){case"###,##0.00":return An(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=ha(Gi(c,0));return m!=="0"?u+m:"";case"###,###.00":return An(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return An(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function _O(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Is(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function bO(e,t,r){var n=t.replace(iE,""),s=t.length-n.length;return Is(e,n,r*Math.pow(10,2*s))+Ut("%",s)}function fE(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+fE(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(s+a)%s)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ds(e,t,r){if(e.charCodeAt(0)===40&&!t.match(uE)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ds("n",n,r):"("+ds("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return _O(e,t,r);if(t.indexOf("%")!==-1)return bO(e,t,r);if(t.indexOf("E")!==-1)return fE(t,r);if(t.charCodeAt(0)===36)return"$"+ds(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+rs(c,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:Vr(t.substr(0,t.length-s.length))+s;if(a=t.match(lE))return vO(a,c,u);if(t.match(/^#+0+$/))return u+rs(c,t.length-t.indexOf("0"));if(a=t.match(cE))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Vr(a[1])).replace(/\.$/,"."+Vr(a[1])),s=s.replace(/\.(\d*)$/,function(x,p){return"."+p+Ut("0",Vr(a[1]).length-p.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+ha(""+c);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ds(e,t,-r):ha(""+r)+"."+Ut("0",a[1].length);if(a=t.match(/^#,#*,#0/))return ds(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Co(ds(e,t.replace(/[\\-]/g,""),r)),i=0,Co(Co(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<s.length?s.charAt(i++):x==="0"?"0":""}));if(t.match(dE))return s=ds(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=o0(c,Math.pow(10,i)-1,!1),s=""+u,d=Is("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+a[2]+"/"+a[3],d=a0(o[2],i),d.length<a[4].length&&(d=Vr(a[4].substr(a[4].length-d.length))+d),s+=d,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=o0(c,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Zx(o[1],i)+a[2]+"/"+a[3]+a0(o[2],i):Ut(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:Vr(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var f=t.indexOf(".")-i,h=t.length-s.length-f;return Vr(t.substr(0,f)+s+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ds(e,t,-r):ha(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?rs(0,3-x.length):"")+x})+"."+rs(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var m=ha(""+c);return m!=="0"?u+m:"";default:if(t.match(/\.[0#?]*$/))return ds(e,t.slice(0,t.lastIndexOf(".")),r)+Vr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Is(e,t,r){return(r|0)===r?ds(e,t,r):An(e,t,r)}function kO(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var hE=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function rl(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":i0(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(hE))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function SO(e,t,r,n){for(var s=[],a="",i=0,o="",c="t",u,d,f,h="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!i0(e,i))throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(f=e.charCodeAt(++i))!==34&&i<e.length;)a+=String.fromCharCode(f);s[s.length]={t:"t",v:a},++i;break;case"\\":var m=e.charAt(++i),x=m==="("||m===")"?m:"t";s[s.length]={t:x,v:m},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(u==null&&(u=ni(t,r,e.charAt(i+1)==="2"),u==null))return"";s[s.length]={t:"X",v:e.substr(i,2)},c=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=ni(t,r),u==null))return"";for(a=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)a+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),s[s.length]={t:o,v:a},c=o;break;case"A":case"a":case"":var p={t:o,v:o};if(u==null&&(u=ni(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(u!=null&&(p.v=u.H>=12?"P":"A"),p.t="T",h="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(u!=null&&(p.v=u.H>=12?"PM":"AM"),p.t="T",i+=5,h="h"):e.substr(i,5).toUpperCase()==="/"?(u!=null&&(p.v=u.H>=12?"":""),p.t="T",i+=5,h="h"):(p.t="t",++i),u==null&&p.t==="T")return"";s[s.length]=p,c=o;break;case"[":for(a=o;e.charAt(i++)!=="]"&&i<e.length;)a+=e.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(hE)){if(u==null&&(u=ni(t,r),u==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},c=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",rl(e)||(s[s.length]={t:"t",v:a}));break;case".":if(u!=null){for(a=o;++i<e.length&&(o=e.charAt(i))==="0";)a+=o;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)a+=o;s[s.length]={t:"n",v:a};break;case"?":for(a=o;e.charAt(++i)===o;)a+=o;s[s.length]={t:o,v:a},c=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)a+=e.charAt(i);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:o,v:o},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"t",v:o},++i;break}var g=0,y=0,w;for(i=s.length-1,c="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=h,c="h",g<1&&(g=1);break;case"s":(w=s[i].v.match(/\.0+$/))&&(y=Math.max(y,w[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=s[i].t;break;case"m":c==="s"&&(s[i].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&s[i].v.match(/[Hh]/)&&(g=1),g<2&&s[i].v.match(/[Mm]/)&&(g=2),g<3&&s[i].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var v="",_;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=mO(s[i].t.charCodeAt(0),s[i].v,u,y),s[i].t="t";break;case"n":case"?":for(_=i+1;s[_]!=null&&((o=s[_].t)==="?"||o==="D"||(o===" "||o==="t")&&s[_+1]!=null&&(s[_+1].t==="?"||s[_+1].t==="t"&&s[_+1].v==="/")||s[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[_].v==="/"||s[_].v===" "&&s[_+1]!=null&&s[_+1].t=="?"));)s[i].v+=s[_].v,s[_]={v:"",t:";"},++_;v+=s[i].v,i=_-1;break;case"G":s[i].t="t",s[i].v=vi(t,r);break}var S="",b,k;if(v.length>0){v.charCodeAt(0)==40?(b=t<0&&v.charCodeAt(0)===45?-t:t,k=Is("n",v,b)):(b=t<0&&n>1?-t:t,k=Is("n",v,b),b<0&&s[0]&&s[0].t=="t"&&(k=k.substr(1),s[0].v="-"+s[0].v)),_=k.length-1;var T=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){T=i;break}var j=s.length;if(T===s.length&&k.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(_>=s[i].v.length-1?(_-=s[i].v.length,s[i].v=k.substr(_+1,s[i].v.length)):_<0?s[i].v="":(s[i].v=k.substr(0,_+1),_=-1),s[i].t="t",j=i);_>=0&&j<s.length&&(s[j].v=k.substr(0,_+1)+s[j].v)}else if(T!==s.length&&k.indexOf("E")===-1){for(_=k.indexOf(".")-1,i=T;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(d=s[i].v.indexOf(".")>-1&&i===T?s[i].v.indexOf(".")-1:s[i].v.length-1,S=s[i].v.substr(d+1);d>=0;--d)_>=0&&(s[i].v.charAt(d)==="0"||s[i].v.charAt(d)==="#")&&(S=k.charAt(_--)+S);s[i].v=S,s[i].t="t",j=i}for(_>=0&&j<s.length&&(s[j].v=k.substr(0,_+1)+s[j].v),_=k.indexOf(".")+1,i=T;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==T)){for(d=s[i].v.indexOf(".")>-1&&i===T?s[i].v.indexOf(".")+1:0,S=s[i].v.substr(0,d);d<s[i].v.length;++d)_<k.length&&(S+=k.charAt(_++));s[i].v=S,s[i].t="t",j=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(b=n>1&&t<0&&i>0&&s[i-1].v==="-"?-t:t,s[i].v=Is(s[i].t,s[i].v,b),s[i].t="t");var V="";for(i=0;i!==s.length;++i)s[i]!=null&&(V+=s[i].v);return V}var ew=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function tw(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function EO(e,t){var r=kO(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(ew),o=r[1].match(ew);return tw(t,i)?[n,r[0]]:tw(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,a]}function Wn(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:He)[e],n==null&&(n=r.table&&r.table[Jy[e]]||He[Jy[e]]),n==null&&(n=oO[e]||"General");break}if(i0(n,0))return vi(t,r);t instanceof Date&&(t=aE(t,r.date1904));var s=EO(n,t);if(i0(s[1]))return vi(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return SO(s[1],t,r,s[0])}function Ls(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(He[r]==null){t<0&&(t=r);continue}if(He[r]==e){t=r;break}}t<0&&(t=391)}return He[t]=e,t}function J0(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Ls(e[t],t)}function nl(){He=iO()}var NO={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},mE=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function TO(e){var t=typeof e=="number"?He[e]:e;return t=t.replace(mE,"(\\d+)"),new RegExp("^"+t+"$")}function CO(e,t,r){var n=-1,s=-1,a=-1,i=-1,o=-1,c=-1;(t.match(mE)||[]).forEach(function(f,h){var m=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=m;break;case"d":a=m;break;case"h":i=m;break;case"s":c=m;break;case"m":i>=0?o=m:s=m;break}}),c>=0&&o==-1&&s>=0&&(o=s,s=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return i==-1&&o==-1&&c==-1?u:n==-1&&s==-1&&a==-1?d:u+"T"+d}var jO=function(){var e={};e.version="1.2.0";function t(){for(var k=0,T=new Array(256),j=0;j!=256;++j)k=j,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,T[j]=k;return typeof Int32Array<"u"?new Int32Array(T):T}var r=t();function n(k){var T=0,j=0,V=0,C=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(V=0;V!=256;++V)C[V]=k[V];for(V=0;V!=256;++V)for(j=k[V],T=256+V;T<4096;T+=256)j=C[T]=j>>>8^k[j&255];var R=[];for(V=1;V!=16;++V)R[V-1]=typeof Int32Array<"u"?C.subarray(V*256,V*256+256):C.slice(V*256,V*256+256);return R}var s=n(r),a=s[0],i=s[1],o=s[2],c=s[3],u=s[4],d=s[5],f=s[6],h=s[7],m=s[8],x=s[9],p=s[10],g=s[11],y=s[12],w=s[13],v=s[14];function _(k,T){for(var j=T^-1,V=0,C=k.length;V<C;)j=j>>>8^r[(j^k.charCodeAt(V++))&255];return~j}function S(k,T){for(var j=T^-1,V=k.length-15,C=0;C<V;)j=v[k[C++]^j&255]^w[k[C++]^j>>8&255]^y[k[C++]^j>>16&255]^g[k[C++]^j>>>24]^p[k[C++]]^x[k[C++]]^m[k[C++]]^h[k[C++]]^f[k[C++]]^d[k[C++]]^u[k[C++]]^c[k[C++]]^o[k[C++]]^i[k[C++]]^a[k[C++]]^r[k[C++]];for(V+=15;C<V;)j=j>>>8^r[(j^k[C++])&255];return~j}function b(k,T){for(var j=T^-1,V=0,C=k.length,R=0,X=0;V<C;)R=k.charCodeAt(V++),R<128?j=j>>>8^r[(j^R)&255]:R<2048?(j=j>>>8^r[(j^(192|R>>6&31))&255],j=j>>>8^r[(j^(128|R&63))&255]):R>=55296&&R<57344?(R=(R&1023)+64,X=k.charCodeAt(V++)&1023,j=j>>>8^r[(j^(240|R>>8&7))&255],j=j>>>8^r[(j^(128|R>>2&63))&255],j=j>>>8^r[(j^(128|X>>6&15|(R&3)<<4))&255],j=j>>>8^r[(j^(128|X&63))&255]):(j=j>>>8^r[(j^(224|R>>12&15))&255],j=j>>>8^r[(j^(128|R>>6&63))&255],j=j>>>8^r[(j^(128|R&63))&255]);return~j}return e.table=r,e.bstr=_,e.buf=S,e.str=b,e}(),Le=function(){var t={};t.version="1.2.1";function r(N,I){for(var A=N.split("/"),P=I.split("/"),L=0,M=0,Z=Math.min(A.length,P.length);L<Z;++L){if(M=A[L].length-P[L].length)return M;if(A[L]!=P[L])return A[L]<P[L]?-1:1}return A.length-P.length}function n(N){if(N.charAt(N.length-1)=="/")return N.slice(0,-1).indexOf("/")===-1?N:n(N.slice(0,-1));var I=N.lastIndexOf("/");return I===-1?N:N.slice(0,I+1)}function s(N){if(N.charAt(N.length-1)=="/")return s(N.slice(0,-1));var I=N.lastIndexOf("/");return I===-1?N:N.slice(I+1)}function a(N,I){typeof I=="string"&&(I=new Date(I));var A=I.getHours();A=A<<6|I.getMinutes(),A=A<<5|I.getSeconds()>>>1,N.write_shift(2,A);var P=I.getFullYear()-1980;P=P<<4|I.getMonth()+1,P=P<<5|I.getDate(),N.write_shift(2,P)}function i(N){var I=N.read_shift(2)&65535,A=N.read_shift(2)&65535,P=new Date,L=A&31;A>>>=5;var M=A&15;A>>>=4,P.setMilliseconds(0),P.setFullYear(A+1980),P.setMonth(M-1),P.setDate(L);var Z=I&31;I>>>=5;var ce=I&63;return I>>>=6,P.setHours(I),P.setMinutes(ce),P.setSeconds(Z<<1),P}function o(N){yr(N,0);for(var I={},A=0;N.l<=N.length-4;){var P=N.read_shift(2),L=N.read_shift(2),M=N.l+L,Z={};switch(P){case 21589:A=N.read_shift(1),A&1&&(Z.mtime=N.read_shift(4)),L>5&&(A&2&&(Z.atime=N.read_shift(4)),A&4&&(Z.ctime=N.read_shift(4))),Z.mtime&&(Z.mt=new Date(Z.mtime*1e3));break}N.l=M,I[P]=Z}return I}var c;function u(){return c||(c={})}function d(N,I){if(N[0]==80&&N[1]==75)return Wt(N,I);if((N[0]|32)==109&&(N[1]|32)==105)return af(N,I);if(N.length<512)throw new Error("CFB file size "+N.length+" < 512");var A=3,P=512,L=0,M=0,Z=0,ce=0,Q=0,ee=[],te=N.slice(0,512);yr(te,0);var xe=f(te);switch(A=xe[0],A){case 3:P=512;break;case 4:P=4096;break;case 0:if(xe[1]==0)return Wt(N,I);default:throw new Error("Major Version: Expected 3 or 4 saw "+A)}P!==512&&(te=N.slice(0,P),yr(te,28));var ke=N.slice(0,P);h(te,A);var Ae=te.read_shift(4,"i");if(A===3&&Ae!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ae);te.l+=4,Z=te.read_shift(4,"i"),te.l+=4,te.chk("00100000","Mini Stream Cutoff Size: "),ce=te.read_shift(4,"i"),L=te.read_shift(4,"i"),Q=te.read_shift(4,"i"),M=te.read_shift(4,"i");for(var ye=-1,Ce=0;Ce<109&&(ye=te.read_shift(4,"i"),!(ye<0));++Ce)ee[Ce]=ye;var qe=m(N,P);g(Q,M,qe,P,ee);var Nt=w(qe,Z,ee,P);Nt[Z].name="!Directory",L>0&&ce!==X&&(Nt[ce].name="!MiniFAT"),Nt[ee[0]].name="!FAT",Nt.fat_addrs=ee,Nt.ssz=P;var Tt={},Sr=[],ol=[],ll=[];v(Z,Nt,qe,Sr,L,Tt,ol,ce),x(ol,ll,Sr),Sr.shift();var cl={FileIndex:ol,FullPaths:ll};return I&&I.raw&&(cl.raw={header:ke,sectors:qe}),cl}function f(N){if(N[N.l]==80&&N[N.l+1]==75)return[0,0];N.chk(G,"Header Signature: "),N.l+=16;var I=N.read_shift(2,"u");return[N.read_shift(2,"u"),I]}function h(N,I){var A=9;switch(N.l+=2,A=N.read_shift(2)){case 9:if(I!=3)throw new Error("Sector Shift: Expected 9 saw "+A);break;case 12:if(I!=4)throw new Error("Sector Shift: Expected 12 saw "+A);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+A)}N.chk("0600","Mini Sector Shift: "),N.chk("000000000000","Reserved: ")}function m(N,I){for(var A=Math.ceil(N.length/I)-1,P=[],L=1;L<A;++L)P[L-1]=N.slice(L*I,(L+1)*I);return P[A-1]=N.slice(A*I),P}function x(N,I,A){for(var P=0,L=0,M=0,Z=0,ce=0,Q=A.length,ee=[],te=[];P<Q;++P)ee[P]=te[P]=P,I[P]=A[P];for(;ce<te.length;++ce)P=te[ce],L=N[P].L,M=N[P].R,Z=N[P].C,ee[P]===P&&(L!==-1&&ee[L]!==L&&(ee[P]=ee[L]),M!==-1&&ee[M]!==M&&(ee[P]=ee[M])),Z!==-1&&(ee[Z]=P),L!==-1&&P!=ee[P]&&(ee[L]=ee[P],te.lastIndexOf(L)<ce&&te.push(L)),M!==-1&&P!=ee[P]&&(ee[M]=ee[P],te.lastIndexOf(M)<ce&&te.push(M));for(P=1;P<Q;++P)ee[P]===P&&(M!==-1&&ee[M]!==M?ee[P]=ee[M]:L!==-1&&ee[L]!==L&&(ee[P]=ee[L]));for(P=1;P<Q;++P)if(N[P].type!==0){if(ce=P,ce!=ee[ce])do ce=ee[ce],I[P]=I[ce]+"/"+I[P];while(ce!==0&&ee[ce]!==-1&&ce!=ee[ce]);ee[P]=-1}for(I[0]+="/",P=1;P<Q;++P)N[P].type!==2&&(I[P]+="/")}function p(N,I,A){for(var P=N.start,L=N.size,M=[],Z=P;A&&L>0&&Z>=0;)M.push(I.slice(Z*R,Z*R+R)),L-=R,Z=Ja(A,Z*4);return M.length===0?le(0):ur(M).slice(0,N.size)}function g(N,I,A,P,L){var M=X;if(N===X){if(I!==0)throw new Error("DIFAT chain shorter than expected")}else if(N!==-1){var Z=A[N],ce=(P>>>2)-1;if(!Z)return;for(var Q=0;Q<ce&&(M=Ja(Z,Q*4))!==X;++Q)L.push(M);g(Ja(Z,P-4),I-1,A,P,L)}}function y(N,I,A,P,L){var M=[],Z=[];L||(L=[]);var ce=P-1,Q=0,ee=0;for(Q=I;Q>=0;){L[Q]=!0,M[M.length]=Q,Z.push(N[Q]);var te=A[Math.floor(Q*4/P)];if(ee=Q*4&ce,P<4+ee)throw new Error("FAT boundary crossed: "+Q+" 4 "+P);if(!N[te])break;Q=Ja(N[te],ee)}return{nodes:M,data:hw([Z])}}function w(N,I,A,P){var L=N.length,M=[],Z=[],ce=[],Q=[],ee=P-1,te=0,xe=0,ke=0,Ae=0;for(te=0;te<L;++te)if(ce=[],ke=te+I,ke>=L&&(ke-=L),!Z[ke]){Q=[];var ye=[];for(xe=ke;xe>=0;){ye[xe]=!0,Z[xe]=!0,ce[ce.length]=xe,Q.push(N[xe]);var Ce=A[Math.floor(xe*4/P)];if(Ae=xe*4&ee,P<4+Ae)throw new Error("FAT boundary crossed: "+xe+" 4 "+P);if(!N[Ce]||(xe=Ja(N[Ce],Ae),ye[xe]))break}M[ke]={nodes:ce,data:hw([Q])}}return M}function v(N,I,A,P,L,M,Z,ce){for(var Q=0,ee=P.length?2:0,te=I[N].data,xe=0,ke=0,Ae;xe<te.length;xe+=128){var ye=te.slice(xe,xe+128);yr(ye,64),ke=ye.read_shift(2),Ae=og(ye,0,ke-ee),P.push(Ae);var Ce={name:Ae,type:ye.read_shift(1),color:ye.read_shift(1),L:ye.read_shift(4,"i"),R:ye.read_shift(4,"i"),C:ye.read_shift(4,"i"),clsid:ye.read_shift(16),state:ye.read_shift(4,"i"),start:0,size:0},qe=ye.read_shift(2)+ye.read_shift(2)+ye.read_shift(2)+ye.read_shift(2);qe!==0&&(Ce.ct=_(ye,ye.l-8));var Nt=ye.read_shift(2)+ye.read_shift(2)+ye.read_shift(2)+ye.read_shift(2);Nt!==0&&(Ce.mt=_(ye,ye.l-8)),Ce.start=ye.read_shift(4,"i"),Ce.size=ye.read_shift(4,"i"),Ce.size<0&&Ce.start<0&&(Ce.size=Ce.type=0,Ce.start=X,Ce.name=""),Ce.type===5?(Q=Ce.start,L>0&&Q!==X&&(I[Q].name="!StreamData")):Ce.size>=4096?(Ce.storage="fat",I[Ce.start]===void 0&&(I[Ce.start]=y(A,Ce.start,I.fat_addrs,I.ssz)),I[Ce.start].name=Ce.name,Ce.content=I[Ce.start].data.slice(0,Ce.size)):(Ce.storage="minifat",Ce.size<0?Ce.size=0:Q!==X&&Ce.start!==X&&I[Q]&&(Ce.content=p(Ce,I[Q].data,(I[ce]||{}).data))),Ce.content&&yr(Ce.content,0),M[Ae]=Ce,Z.push(Ce)}}function _(N,I){return new Date((fn(N,I+4)/1e7*Math.pow(2,32)+fn(N,I)/1e7-11644473600)*1e3)}function S(N,I){return u(),d(c.readFileSync(N),I)}function b(N,I){var A=I&&I.type;switch(A||tt&&Buffer.isBuffer(N)&&(A="buffer"),A||"base64"){case"file":return S(N,I);case"base64":return d(pn(kn(N)),I);case"binary":return d(pn(N),I)}return d(N,I)}function k(N,I){var A=I||{},P=A.root||"Root Entry";if(N.FullPaths||(N.FullPaths=[]),N.FileIndex||(N.FileIndex=[]),N.FullPaths.length!==N.FileIndex.length)throw new Error("inconsistent CFB structure");N.FullPaths.length===0&&(N.FullPaths[0]=P+"/",N.FileIndex[0]={name:P,type:5}),A.CLSID&&(N.FileIndex[0].clsid=A.CLSID),T(N)}function T(N){var I="Sh33tJ5";if(!Le.find(N,"/"+I)){var A=le(4);A[0]=55,A[1]=A[3]=50,A[2]=54,N.FileIndex.push({name:I,type:2,content:A,size:4,L:69,R:69,C:69}),N.FullPaths.push(N.FullPaths[0]+I),j(N)}}function j(N,I){k(N);for(var A=!1,P=!1,L=N.FullPaths.length-1;L>=0;--L){var M=N.FileIndex[L];switch(M.type){case 0:P?A=!0:(N.FileIndex.pop(),N.FullPaths.pop());break;case 1:case 2:case 5:P=!0,isNaN(M.R*M.L*M.C)&&(A=!0),M.R>-1&&M.L>-1&&M.R==M.L&&(A=!0);break;default:A=!0;break}}if(!(!A&&!I)){var Z=new Date(1987,1,19),ce=0,Q=Object.create?Object.create(null):{},ee=[];for(L=0;L<N.FullPaths.length;++L)Q[N.FullPaths[L]]=!0,N.FileIndex[L].type!==0&&ee.push([N.FullPaths[L],N.FileIndex[L]]);for(L=0;L<ee.length;++L){var te=n(ee[L][0]);P=Q[te],P||(ee.push([te,{name:s(te).replace("/",""),type:1,clsid:se,ct:Z,mt:Z,content:null}]),Q[te]=!0)}for(ee.sort(function(Ae,ye){return r(Ae[0],ye[0])}),N.FullPaths=[],N.FileIndex=[],L=0;L<ee.length;++L)N.FullPaths[L]=ee[L][0],N.FileIndex[L]=ee[L][1];for(L=0;L<ee.length;++L){var xe=N.FileIndex[L],ke=N.FullPaths[L];if(xe.name=s(ke).replace("/",""),xe.L=xe.R=xe.C=-(xe.color=1),xe.size=xe.content?xe.content.length:0,xe.start=0,xe.clsid=xe.clsid||se,L===0)xe.C=ee.length>1?1:-1,xe.size=0,xe.type=5;else if(ke.slice(-1)=="/"){for(ce=L+1;ce<ee.length&&n(N.FullPaths[ce])!=ke;++ce);for(xe.C=ce>=ee.length?-1:ce,ce=L+1;ce<ee.length&&n(N.FullPaths[ce])!=n(ke);++ce);xe.R=ce>=ee.length?-1:ce,xe.type=1}else n(N.FullPaths[L+1]||"")==n(ke)&&(xe.R=L+1),xe.type=2}}}function V(N,I){var A=I||{};if(A.fileType=="mad")return of(N,A);switch(j(N),A.fileType){case"zip":return mt(N,A)}var P=function(Ae){for(var ye=0,Ce=0,qe=0;qe<Ae.FileIndex.length;++qe){var Nt=Ae.FileIndex[qe];if(Nt.content){var Tt=Nt.content.length;Tt>0&&(Tt<4096?ye+=Tt+63>>6:Ce+=Tt+511>>9)}}for(var Sr=Ae.FullPaths.length+3>>2,ol=ye+7>>3,ll=ye+127>>7,cl=ol+Ce+Sr+ll,Ua=cl+127>>7,uf=Ua<=109?0:Math.ceil((Ua-109)/127);cl+Ua+uf+127>>7>Ua;)uf=++Ua<=109?0:Math.ceil((Ua-109)/127);var Ss=[1,uf,Ua,ll,Sr,Ce,ye,0];return Ae.FileIndex[0].size=ye<<6,Ss[7]=(Ae.FileIndex[0].start=Ss[0]+Ss[1]+Ss[2]+Ss[3]+Ss[4]+Ss[5])+(Ss[6]+7>>3),Ss}(N),L=le(P[7]<<9),M=0,Z=0;{for(M=0;M<8;++M)L.write_shift(1,Y[M]);for(M=0;M<8;++M)L.write_shift(2,0);for(L.write_shift(2,62),L.write_shift(2,3),L.write_shift(2,65534),L.write_shift(2,9),L.write_shift(2,6),M=0;M<3;++M)L.write_shift(2,0);for(L.write_shift(4,0),L.write_shift(4,P[2]),L.write_shift(4,P[0]+P[1]+P[2]+P[3]-1),L.write_shift(4,0),L.write_shift(4,4096),L.write_shift(4,P[3]?P[0]+P[1]+P[2]-1:X),L.write_shift(4,P[3]),L.write_shift(-4,P[1]?P[0]-1:X),L.write_shift(4,P[1]),M=0;M<109;++M)L.write_shift(-4,M<P[2]?P[1]+M:-1)}if(P[1])for(Z=0;Z<P[1];++Z){for(;M<236+Z*127;++M)L.write_shift(-4,M<P[2]?P[1]+M:-1);L.write_shift(-4,Z===P[1]-1?X:Z+1)}var ce=function(Ae){for(Z+=Ae;M<Z-1;++M)L.write_shift(-4,M+1);Ae&&(++M,L.write_shift(-4,X))};for(Z=M=0,Z+=P[1];M<Z;++M)L.write_shift(-4,ie.DIFSECT);for(Z+=P[2];M<Z;++M)L.write_shift(-4,ie.FATSECT);ce(P[3]),ce(P[4]);for(var Q=0,ee=0,te=N.FileIndex[0];Q<N.FileIndex.length;++Q)te=N.FileIndex[Q],te.content&&(ee=te.content.length,!(ee<4096)&&(te.start=Z,ce(ee+511>>9)));for(ce(P[6]+7>>3);L.l&511;)L.write_shift(-4,ie.ENDOFCHAIN);for(Z=M=0,Q=0;Q<N.FileIndex.length;++Q)te=N.FileIndex[Q],te.content&&(ee=te.content.length,!(!ee||ee>=4096)&&(te.start=Z,ce(ee+63>>6)));for(;L.l&511;)L.write_shift(-4,ie.ENDOFCHAIN);for(M=0;M<P[4]<<2;++M){var xe=N.FullPaths[M];if(!xe||xe.length===0){for(Q=0;Q<17;++Q)L.write_shift(4,0);for(Q=0;Q<3;++Q)L.write_shift(4,-1);for(Q=0;Q<12;++Q)L.write_shift(4,0);continue}te=N.FileIndex[M],M===0&&(te.start=te.size?te.start-1:X);var ke=M===0&&A.root||te.name;if(ee=2*(ke.length+1),L.write_shift(64,ke,"utf16le"),L.write_shift(2,ee),L.write_shift(1,te.type),L.write_shift(1,te.color),L.write_shift(-4,te.L),L.write_shift(-4,te.R),L.write_shift(-4,te.C),te.clsid)L.write_shift(16,te.clsid,"hex");else for(Q=0;Q<4;++Q)L.write_shift(4,0);L.write_shift(4,te.state||0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,te.start),L.write_shift(4,te.size),L.write_shift(4,0)}for(M=1;M<N.FileIndex.length;++M)if(te=N.FileIndex[M],te.size>=4096)if(L.l=te.start+1<<9,tt&&Buffer.isBuffer(te.content))te.content.copy(L,L.l,0,te.size),L.l+=te.size+511&-512;else{for(Q=0;Q<te.size;++Q)L.write_shift(1,te.content[Q]);for(;Q&511;++Q)L.write_shift(1,0)}for(M=1;M<N.FileIndex.length;++M)if(te=N.FileIndex[M],te.size>0&&te.size<4096)if(tt&&Buffer.isBuffer(te.content))te.content.copy(L,L.l,0,te.size),L.l+=te.size+63&-64;else{for(Q=0;Q<te.size;++Q)L.write_shift(1,te.content[Q]);for(;Q&63;++Q)L.write_shift(1,0)}if(tt)L.l=L.length;else for(;L.l<L.length;)L.write_shift(1,0);return L}function C(N,I){var A=N.FullPaths.map(function(Q){return Q.toUpperCase()}),P=A.map(function(Q){var ee=Q.split("/");return ee[ee.length-(Q.slice(-1)=="/"?2:1)]}),L=!1;I.charCodeAt(0)===47?(L=!0,I=A[0].slice(0,-1)+I):L=I.indexOf("/")!==-1;var M=I.toUpperCase(),Z=L===!0?A.indexOf(M):P.indexOf(M);if(Z!==-1)return N.FileIndex[Z];var ce=!M.match(jl);for(M=M.replace(Wr,""),ce&&(M=M.replace(jl,"!")),Z=0;Z<A.length;++Z)if((ce?A[Z].replace(jl,"!"):A[Z]).replace(Wr,"")==M||(ce?P[Z].replace(jl,"!"):P[Z]).replace(Wr,"")==M)return N.FileIndex[Z];return null}var R=64,X=-2,G="d0cf11e0a1b11ae1",Y=[208,207,17,224,161,177,26,225],se="00000000000000000000000000000000",ie={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:X,FREESECT:-1,HEADER_SIGNATURE:G,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:se,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function oe(N,I,A){u();var P=V(N,A);c.writeFileSync(I,P)}function W(N){for(var I=new Array(N.length),A=0;A<N.length;++A)I[A]=String.fromCharCode(N[A]);return I.join("")}function ue(N,I){var A=V(N,I);switch(I&&I.type||"buffer"){case"file":return u(),c.writeFileSync(I.filename,A),A;case"binary":return typeof A=="string"?A:W(A);case"base64":return Ic(typeof A=="string"?A:W(A));case"buffer":if(tt)return Buffer.isBuffer(A)?A:Js(A);case"array":return typeof A=="string"?pn(A):A}return A}var ve;function F(N){try{var I=N.InflateRaw,A=new I;if(A._processChunk(new Uint8Array([3,0]),A._finishFlushFlag),A.bytesRead)ve=N;else throw new Error("zlib does not expose bytesRead")}catch(P){console.error("cannot use native zlib: "+(P.message||P))}}function H(N,I){if(!ve)return hr(N,I);var A=ve.InflateRaw,P=new A,L=P._processChunk(N.slice(N.l),P._finishFlushFlag);return N.l+=P.bytesRead,L}function D(N){return ve?ve.deflateRawSync(N):je(N)}var z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],B=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ne=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function U(N){var I=(N<<1|N<<11)&139536|(N<<5|N<<15)&558144;return(I>>16|I>>8|I)&255}for(var J=typeof Uint8Array<"u",ae=J?new Uint8Array(256):[],q=0;q<256;++q)ae[q]=U(q);function O(N,I){var A=ae[N&255];return I<=8?A>>>8-I:(A=A<<8|ae[N>>8&255],I<=16?A>>>16-I:(A=A<<8|ae[N>>16&255],A>>>24-I))}function be(N,I){var A=I&7,P=I>>>3;return(N[P]|(A<=6?0:N[P+1]<<8))>>>A&3}function Ee(N,I){var A=I&7,P=I>>>3;return(N[P]|(A<=5?0:N[P+1]<<8))>>>A&7}function Ve(N,I){var A=I&7,P=I>>>3;return(N[P]|(A<=4?0:N[P+1]<<8))>>>A&15}function Ue(N,I){var A=I&7,P=I>>>3;return(N[P]|(A<=3?0:N[P+1]<<8))>>>A&31}function me(N,I){var A=I&7,P=I>>>3;return(N[P]|(A<=1?0:N[P+1]<<8))>>>A&127}function et(N,I,A){var P=I&7,L=I>>>3,M=(1<<A)-1,Z=N[L]>>>P;return A<8-P||(Z|=N[L+1]<<8-P,A<16-P)||(Z|=N[L+2]<<16-P,A<24-P)||(Z|=N[L+3]<<24-P),Z&M}function lt(N,I,A){var P=I&7,L=I>>>3;return P<=5?N[L]|=(A&7)<<P:(N[L]|=A<<P&255,N[L+1]=(A&7)>>8-P),I+3}function zt(N,I,A){var P=I&7,L=I>>>3;return A=(A&1)<<P,N[L]|=A,I+1}function Yt(N,I,A){var P=I&7,L=I>>>3;return A<<=P,N[L]|=A&255,A>>>=8,N[L+1]=A,I+8}function he(N,I,A){var P=I&7,L=I>>>3;return A<<=P,N[L]|=A&255,A>>>=8,N[L+1]=A&255,N[L+2]=A>>>8,I+16}function re(N,I){var A=N.length,P=2*A>I?2*A:I+5,L=0;if(A>=I)return N;if(tt){var M=Xy(P);if(N.copy)N.copy(M);else for(;L<N.length;++L)M[L]=N[L];return M}else if(J){var Z=new Uint8Array(P);if(Z.set)Z.set(N);else for(;L<A;++L)Z[L]=N[L];return Z}return N.length=P,N}function pe(N){for(var I=new Array(N),A=0;A<N;++A)I[A]=0;return I}function Re(N,I,A){var P=1,L=0,M=0,Z=0,ce=0,Q=N.length,ee=J?new Uint16Array(32):pe(32);for(M=0;M<32;++M)ee[M]=0;for(M=Q;M<A;++M)N[M]=0;Q=N.length;var te=J?new Uint16Array(Q):pe(Q);for(M=0;M<Q;++M)ee[L=N[M]]++,P<L&&(P=L),te[M]=0;for(ee[0]=0,M=1;M<=P;++M)ee[M+16]=ce=ce+ee[M-1]<<1;for(M=0;M<Q;++M)ce=N[M],ce!=0&&(te[M]=ee[ce+16]++);var xe=0;for(M=0;M<Q;++M)if(xe=N[M],xe!=0)for(ce=O(te[M],P)>>P-xe,Z=(1<<P+4-xe)-1;Z>=0;--Z)I[ce|Z<<xe]=xe&15|M<<4;return P}var K=J?new Uint16Array(512):pe(512),Se=J?new Uint16Array(32):pe(32);if(!J){for(var de=0;de<512;++de)K[de]=0;for(de=0;de<32;++de)Se[de]=0}(function(){for(var N=[],I=0;I<32;I++)N.push(5);Re(N,Se,32);var A=[];for(I=0;I<=143;I++)A.push(8);for(;I<=255;I++)A.push(9);for(;I<=279;I++)A.push(7);for(;I<=287;I++)A.push(8);Re(A,K,288)})();var Ne=function(){for(var I=J?new Uint8Array(32768):[],A=0,P=0;A<ne.length-1;++A)for(;P<ne[A+1];++P)I[P]=A;for(;P<32768;++P)I[P]=29;var L=J?new Uint8Array(259):[];for(A=0,P=0;A<B.length-1;++A)for(;P<B[A+1];++P)L[P]=A;function M(ce,Q){for(var ee=0;ee<ce.length;){var te=Math.min(65535,ce.length-ee),xe=ee+te==ce.length;for(Q.write_shift(1,+xe),Q.write_shift(2,te),Q.write_shift(2,~te&65535);te-- >0;)Q[Q.l++]=ce[ee++]}return Q.l}function Z(ce,Q){for(var ee=0,te=0,xe=J?new Uint16Array(32768):[];te<ce.length;){var ke=Math.min(65535,ce.length-te);if(ke<10){for(ee=lt(Q,ee,+(te+ke==ce.length)),ee&7&&(ee+=8-(ee&7)),Q.l=ee/8|0,Q.write_shift(2,ke),Q.write_shift(2,~ke&65535);ke-- >0;)Q[Q.l++]=ce[te++];ee=Q.l*8;continue}ee=lt(Q,ee,+(te+ke==ce.length)+2);for(var Ae=0;ke-- >0;){var ye=ce[te];Ae=(Ae<<5^ye)&32767;var Ce=-1,qe=0;if((Ce=xe[Ae])&&(Ce|=te&-32768,Ce>te&&(Ce-=32768),Ce<te))for(;ce[Ce+qe]==ce[te+qe]&&qe<250;)++qe;if(qe>2){ye=L[qe],ye<=22?ee=Yt(Q,ee,ae[ye+1]>>1)-1:(Yt(Q,ee,3),ee+=5,Yt(Q,ee,ae[ye-23]>>5),ee+=3);var Nt=ye<8?0:ye-4>>2;Nt>0&&(he(Q,ee,qe-B[ye]),ee+=Nt),ye=I[te-Ce],ee=Yt(Q,ee,ae[ye]>>3),ee-=3;var Tt=ye<4?0:ye-2>>1;Tt>0&&(he(Q,ee,te-Ce-ne[ye]),ee+=Tt);for(var Sr=0;Sr<qe;++Sr)xe[Ae]=te&32767,Ae=(Ae<<5^ce[te])&32767,++te;ke-=qe-1}else ye<=143?ye=ye+48:ee=zt(Q,ee,1),ee=Yt(Q,ee,ae[ye]),xe[Ae]=te&32767,++te}ee=Yt(Q,ee,0)-1}return Q.l=(ee+7)/8|0,Q.l}return function(Q,ee){return Q.length<8?M(Q,ee):Z(Q,ee)}}();function je(N){var I=le(50+Math.floor(N.length*1.1)),A=Ne(N,I);return I.slice(0,A)}var Ie=J?new Uint16Array(32768):pe(32768),Fe=J?new Uint16Array(32768):pe(32768),Xe=J?new Uint16Array(128):pe(128),Te=1,Oe=1;function Je(N,I){var A=Ue(N,I)+257;I+=5;var P=Ue(N,I)+1;I+=5;var L=Ve(N,I)+4;I+=4;for(var M=0,Z=J?new Uint8Array(19):pe(19),ce=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Q=1,ee=J?new Uint8Array(8):pe(8),te=J?new Uint8Array(8):pe(8),xe=Z.length,ke=0;ke<L;++ke)Z[z[ke]]=M=Ee(N,I),Q<M&&(Q=M),ee[M]++,I+=3;var Ae=0;for(ee[0]=0,ke=1;ke<=Q;++ke)te[ke]=Ae=Ae+ee[ke-1]<<1;for(ke=0;ke<xe;++ke)(Ae=Z[ke])!=0&&(ce[ke]=te[Ae]++);var ye=0;for(ke=0;ke<xe;++ke)if(ye=Z[ke],ye!=0){Ae=ae[ce[ke]]>>8-ye;for(var Ce=(1<<7-ye)-1;Ce>=0;--Ce)Xe[Ae|Ce<<ye]=ye&7|ke<<3}var qe=[];for(Q=1;qe.length<A+P;)switch(Ae=Xe[me(N,I)],I+=Ae&7,Ae>>>=3){case 16:for(M=3+be(N,I),I+=2,Ae=qe[qe.length-1];M-- >0;)qe.push(Ae);break;case 17:for(M=3+Ee(N,I),I+=3;M-- >0;)qe.push(0);break;case 18:for(M=11+me(N,I),I+=7;M-- >0;)qe.push(0);break;default:qe.push(Ae),Q<Ae&&(Q=Ae);break}var Nt=qe.slice(0,A),Tt=qe.slice(A);for(ke=A;ke<286;++ke)Nt[ke]=0;for(ke=P;ke<30;++ke)Tt[ke]=0;return Te=Re(Nt,Ie,286),Oe=Re(Tt,Fe,30),I}function It(N,I){if(N[0]==3&&!(N[1]&3))return[Na(I),2];for(var A=0,P=0,L=Xy(I||1<<18),M=0,Z=L.length>>>0,ce=0,Q=0;!(P&1);){if(P=Ee(N,A),A+=3,P>>>1)P>>1==1?(ce=9,Q=5):(A=Je(N,A),ce=Te,Q=Oe);else{A&7&&(A+=8-(A&7));var ee=N[A>>>3]|N[(A>>>3)+1]<<8;if(A+=32,ee>0)for(!I&&Z<M+ee&&(L=re(L,M+ee),Z=L.length);ee-- >0;)L[M++]=N[A>>>3],A+=8;continue}for(;;){!I&&Z<M+32767&&(L=re(L,M+32767),Z=L.length);var te=et(N,A,ce),xe=P>>>1==1?K[te]:Ie[te];if(A+=xe&15,xe>>>=4,!(xe>>>8&255))L[M++]=xe;else{if(xe==256)break;xe-=257;var ke=xe<8?0:xe-4>>2;ke>5&&(ke=0);var Ae=M+B[xe];ke>0&&(Ae+=et(N,A,ke),A+=ke),te=et(N,A,Q),xe=P>>>1==1?Se[te]:Fe[te],A+=xe&15,xe>>>=4;var ye=xe<4?0:xe-2>>1,Ce=ne[xe];for(ye>0&&(Ce+=et(N,A,ye),A+=ye),!I&&Z<Ae&&(L=re(L,Ae+100),Z=L.length);M<Ae;)L[M]=L[M-Ce],++M}}}return I?[L,A+7>>>3]:[L.slice(0,M),A+7>>>3]}function hr(N,I){var A=N.slice(N.l||0),P=It(A,I);return N.l+=P[1],P[0]}function ct(N,I){if(N)typeof console<"u"&&console.error(I);else throw new Error(I)}function Wt(N,I){var A=N;yr(A,0);var P=[],L=[],M={FileIndex:P,FullPaths:L};k(M,{root:I.root});for(var Z=A.length-4;(A[Z]!=80||A[Z+1]!=75||A[Z+2]!=5||A[Z+3]!=6)&&Z>=0;)--Z;A.l=Z+4,A.l+=4;var ce=A.read_shift(2);A.l+=6;var Q=A.read_shift(4);for(A.l=Q,Z=0;Z<ce;++Z){A.l+=20;var ee=A.read_shift(4),te=A.read_shift(4),xe=A.read_shift(2),ke=A.read_shift(2),Ae=A.read_shift(2);A.l+=8;var ye=A.read_shift(4),Ce=o(A.slice(A.l+xe,A.l+xe+ke));A.l+=xe+ke+Ae;var qe=A.l;A.l=ye+4,Kr(A,ee,te,M,Ce),A.l=qe}return M}function Kr(N,I,A,P,L){N.l+=2;var M=N.read_shift(2),Z=N.read_shift(2),ce=i(N);if(M&8257)throw new Error("Unsupported ZIP encryption");for(var Q=N.read_shift(4),ee=N.read_shift(4),te=N.read_shift(4),xe=N.read_shift(2),ke=N.read_shift(2),Ae="",ye=0;ye<xe;++ye)Ae+=String.fromCharCode(N[N.l++]);if(ke){var Ce=o(N.slice(N.l,N.l+ke));(Ce[21589]||{}).mt&&(ce=Ce[21589].mt),((L||{})[21589]||{}).mt&&(ce=L[21589].mt)}N.l+=ke;var qe=N.slice(N.l,N.l+ee);switch(Z){case 8:qe=H(N,te);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Z)}var Nt=!1;M&8&&(Q=N.read_shift(4),Q==134695760&&(Q=N.read_shift(4),Nt=!0),ee=N.read_shift(4),te=N.read_shift(4)),ee!=I&&ct(Nt,"Bad compressed size: "+I+" != "+ee),te!=A&&ct(Nt,"Bad uncompressed size: "+A+" != "+te),ls(P,Ae,qe,{unsafe:!0,mt:ce})}function mt(N,I){var A=I||{},P=[],L=[],M=le(1),Z=A.compression?8:0,ce=0,Q=0,ee=0,te=0,xe=0,ke=N.FullPaths[0],Ae=ke,ye=N.FileIndex[0],Ce=[],qe=0;for(Q=1;Q<N.FullPaths.length;++Q)if(Ae=N.FullPaths[Q].slice(ke.length),ye=N.FileIndex[Q],!(!ye.size||!ye.content||Ae=="Sh33tJ5")){var Nt=te,Tt=le(Ae.length);for(ee=0;ee<Ae.length;++ee)Tt.write_shift(1,Ae.charCodeAt(ee)&127);Tt=Tt.slice(0,Tt.l),Ce[xe]=jO.buf(ye.content,0);var Sr=ye.content;Z==8&&(Sr=D(Sr)),M=le(30),M.write_shift(4,67324752),M.write_shift(2,20),M.write_shift(2,ce),M.write_shift(2,Z),ye.mt?a(M,ye.mt):M.write_shift(4,0),M.write_shift(-4,Ce[xe]),M.write_shift(4,Sr.length),M.write_shift(4,ye.content.length),M.write_shift(2,Tt.length),M.write_shift(2,0),te+=M.length,P.push(M),te+=Tt.length,P.push(Tt),te+=Sr.length,P.push(Sr),M=le(46),M.write_shift(4,33639248),M.write_shift(2,0),M.write_shift(2,20),M.write_shift(2,ce),M.write_shift(2,Z),M.write_shift(4,0),M.write_shift(-4,Ce[xe]),M.write_shift(4,Sr.length),M.write_shift(4,ye.content.length),M.write_shift(2,Tt.length),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(4,0),M.write_shift(4,Nt),qe+=M.l,L.push(M),qe+=Tt.length,L.push(Tt),++xe}return M=le(22),M.write_shift(4,101010256),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,xe),M.write_shift(2,xe),M.write_shift(4,qe),M.write_shift(4,te),M.write_shift(2,0),ur([ur(P),ur(L),M])}var Tn={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Li(N,I){if(N.ctype)return N.ctype;var A=N.name||"",P=A.match(/\.([^\.]+)$/);return P&&Tn[P[1]]||I&&(P=(A=I).match(/[\.\\]([^\.\\])+$/),P&&Tn[P[1]])?Tn[P[1]]:"application/octet-stream"}function ks(N){for(var I=Ic(N),A=[],P=0;P<I.length;P+=76)A.push(I.slice(P,P+76));return A.join(`\r
`)+`\r
`}function Xr(N){var I=N.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ee){var te=ee.charCodeAt(0).toString(16).toUpperCase();return"="+(te.length==1?"0"+te:te)});I=I.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),I.charAt(0)==`
`&&(I="=0D"+I.slice(1)),I=I.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var A=[],P=I.split(`\r
`),L=0;L<P.length;++L){var M=P[L];if(M.length==0){A.push("");continue}for(var Z=0;Z<M.length;){var ce=76,Q=M.slice(Z,Z+ce);Q.charAt(ce-1)=="="?ce--:Q.charAt(ce-2)=="="?ce-=2:Q.charAt(ce-3)=="="&&(ce-=3),Q=M.slice(Z,Z+ce),Z+=ce,Z<M.length&&(Q+="="),A.push(Q)}}return A.join(`\r
`)}function Ba(N){for(var I=[],A=0;A<N.length;++A){for(var P=N[A];A<=N.length&&P.charAt(P.length-1)=="=";)P=P.slice(0,P.length-1)+N[++A];I.push(P)}for(var L=0;L<I.length;++L)I[L]=I[L].replace(/[=][0-9A-Fa-f]{2}/g,function(M){return String.fromCharCode(parseInt(M.slice(1),16))});return pn(I.join(`\r
`))}function Mi(N,I,A){for(var P="",L="",M="",Z,ce=0;ce<10;++ce){var Q=I[ce];if(!Q||Q.match(/^\s*$/))break;var ee=Q.match(/^(.*?):\s*([^\s].*)$/);if(ee)switch(ee[1].toLowerCase()){case"content-location":P=ee[2].trim();break;case"content-type":M=ee[2].trim();break;case"content-transfer-encoding":L=ee[2].trim();break}}switch(++ce,L.toLowerCase()){case"base64":Z=pn(kn(I.slice(ce).join("")));break;case"quoted-printable":Z=Ba(I.slice(ce));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+L)}var te=ls(N,P.slice(A.length),Z,{unsafe:!0});M&&(te.ctype=M)}function af(N,I){if(W(N.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var A=I&&I.root||"",P=(tt&&Buffer.isBuffer(N)?N.toString("binary"):W(N)).split(`\r
`),L=0,M="";for(L=0;L<P.length;++L)if(M=P[L],!!/^Content-Location:/i.test(M)&&(M=M.slice(M.indexOf("file")),A||(A=M.slice(0,M.lastIndexOf("/")+1)),M.slice(0,A.length)!=A))for(;A.length>0&&(A=A.slice(0,A.length-1),A=A.slice(0,A.lastIndexOf("/")+1),M.slice(0,A.length)!=A););var Z=(P[1]||"").match(/boundary="(.*?)"/);if(!Z)throw new Error("MAD cannot find boundary");var ce="--"+(Z[1]||""),Q=[],ee=[],te={FileIndex:Q,FullPaths:ee};k(te);var xe,ke=0;for(L=0;L<P.length;++L){var Ae=P[L];Ae!==ce&&Ae!==ce+"--"||(ke++&&Mi(te,P.slice(xe,L),A),xe=L)}return te}function of(N,I){var A=I||{},P=A.boundary||"SheetJS";P="------="+P;for(var L=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+P.slice(2)+'"',"","",""],M=N.FullPaths[0],Z=M,ce=N.FileIndex[0],Q=1;Q<N.FullPaths.length;++Q)if(Z=N.FullPaths[Q].slice(M.length),ce=N.FileIndex[Q],!(!ce.size||!ce.content||Z=="Sh33tJ5")){Z=Z.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(qe){return"_x"+qe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(qe){return"_u"+qe.charCodeAt(0).toString(16)+"_"});for(var ee=ce.content,te=tt&&Buffer.isBuffer(ee)?ee.toString("binary"):W(ee),xe=0,ke=Math.min(1024,te.length),Ae=0,ye=0;ye<=ke;++ye)(Ae=te.charCodeAt(ye))>=32&&Ae<128&&++xe;var Ce=xe>=ke*4/5;L.push(P),L.push("Content-Location: "+(A.root||"file:///C:/SheetJS/")+Z),L.push("Content-Transfer-Encoding: "+(Ce?"quoted-printable":"base64")),L.push("Content-Type: "+Li(ce,Z)),L.push(""),L.push(Ce?Xr(te):ks(te))}return L.push(P+`--\r
`),L.join(`\r
`)}function il(N){var I={};return k(I,N),I}function ls(N,I,A,P){var L=P&&P.unsafe;L||k(N);var M=!L&&Le.find(N,I);if(!M){var Z=N.FullPaths[0];I.slice(0,Z.length)==Z?Z=I:(Z.slice(-1)!="/"&&(Z+="/"),Z=(Z+I).replace("//","/")),M={name:s(I),type:2},N.FileIndex.push(M),N.FullPaths.push(Z),L||Le.utils.cfb_gc(N)}return M.content=A,M.size=A?A.length:0,P&&(P.CLSID&&(M.clsid=P.CLSID),P.mt&&(M.mt=P.mt),P.ct&&(M.ct=P.ct)),M}function hu(N,I){k(N);var A=Le.find(N,I);if(A){for(var P=0;P<N.FileIndex.length;++P)if(N.FileIndex[P]==A)return N.FileIndex.splice(P,1),N.FullPaths.splice(P,1),!0}return!1}function lf(N,I,A){k(N);var P=Le.find(N,I);if(P){for(var L=0;L<N.FileIndex.length;++L)if(N.FileIndex[L]==P)return N.FileIndex[L].name=s(A),N.FullPaths[L]=A,!0}return!1}function cf(N){j(N,!0)}return t.find=C,t.read=b,t.parse=d,t.write=ue,t.writeFile=oe,t.utils={cfb_new:il,cfb_add:ls,cfb_del:hu,cfb_mov:lf,cfb_gc:cf,ReadShift:ql,CheckField:IE,prep_blob:yr,bconcat:ur,use_zlib:F,_deflateRaw:je,_inflateRaw:hr,consts:ie},t}();function AO(e){return typeof e=="string"?Y0(e):Array.isArray(e)?rO(e):e}function au(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Y0(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?xs(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([AO(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=a,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Ia(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function FO(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function $t(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function rw(e,t){for(var r=[],n=$t(e),s=0;s!==n.length;++s)r[e[n[s]][t]]==null&&(r[e[n[s]][t]]=n[s]);return r}function Q0(e){for(var t=[],r=$t(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Z0(e){for(var t=[],r=$t(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function PO(e){for(var t=[],r=$t(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var l0=new Date(1899,11,30,0,0,0);function or(e,t){var r=e.getTime(),n=l0.getTime()+(e.getTimezoneOffset()-l0.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var pE=new Date,RO=l0.getTime()+(pE.getTimezoneOffset()-l0.getTimezoneOffset())*6e4,nw=pE.getTimezoneOffset();function ef(e){var t=new Date;return t.setTime(e*24*60*60*1e3+RO),t.getTimezoneOffset()!==nw&&t.setTime(t.getTime()+(t.getTimezoneOffset()-nw)*6e4),t}function OO(e){var t=0,r=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[a],10)}return t}var sw=new Date("2017-02-19T19:06:09.000Z"),xE=isNaN(sw.getFullYear())?new Date("2/19/17"):sw,DO=xE.getFullYear()==2017;function bt(e,t){var r=new Date(e);if(DO)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(xE.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function yi(e,t){if(tt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return xs(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return xs(nE(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return xs(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return xs(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function kt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=kt(e[r]));return t}function Ut(e,t){for(var r="";r.length<t;)r+=e;return r}function as(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var IO=["january","february","march","april","may","june","july","august","september","october","november","december"];function Go(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&IO.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var LO=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),i=[a[0]],o=1;o<a.length;++o)i.push(s),i.push(a[o]);return i}}();function gE(e){return e?e.content&&e.type?yi(e.content,!0):e.data?Cl(e.data):e.asNodeBuffer&&tt?Cl(e.asNodeBuffer().toString("binary")):e.asBinary?Cl(e.asBinary()):e._data&&e._data.getContent?Cl(yi(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function vE(e){if(!e)return null;if(e.data)return Gy(e.data);if(e.asNodeBuffer&&tt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Gy(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function MO(e){return e&&e.name.slice(-4)===".bin"?vE(e):gE(e)}function On(e,t){for(var r=e.FullPaths||$t(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var i=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||s==i)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function tg(e,t){var r=On(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Qt(e,t,r){if(!r)return MO(tg(e,t));if(!t)return null;try{return Qt(e,t)}catch{return null}}function xn(e,t,r){if(!r)return gE(tg(e,t));if(!t)return null;try{return xn(e,t)}catch{return null}}function BO(e,t,r){return vE(tg(e,t))}function aw(e){for(var t=e.FullPaths||$t(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Qe(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return tt?n=Js(r):n=nO(r),Le.utils.cfb_add(e,t,n)}Le.utils.cfb_add(e,t,r)}else e.file(t,r)}function rg(){return Le.utils.cfb_new()}function yE(e,t){switch(t.type){case"base64":return Le.read(e,{type:"base64"});case"binary":return Le.read(e,{type:"binary"});case"buffer":case"array":return Le.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Al(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var qt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,UO=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,iw=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,VO=/<[^>]*>/g,Br=qt.match(iw)?iw:VO,$O=/<\w*:/,zO=/<(\/?)\w+:/;function Ke(e,t,r){for(var n={},s=0,a=0;s!==e.length&&!((a=e.charCodeAt(s))===32||a===10||a===13);++s);if(t||(n[0]=e.slice(0,s)),s===e.length)return n;var i=e.match(UO),o=0,c="",u=0,d="",f="",h=1;if(i)for(u=0;u!=i.length;++u){for(f=i[u],a=0;a!=f.length&&f.charCodeAt(a)!==61;++a);for(d=f.slice(0,a).trim();f.charCodeAt(a+1)==32;)++a;for(h=(s=f.charCodeAt(a+1))==34||s==39?1:0,c=f.slice(a+1+h,f.length-h),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=c,n[d.toLowerCase()]=c;else{var m=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(n[m]&&d.slice(o-3,o)=="ext")continue;n[m]=c,n[m.toLowerCase()]=c}}return n}function _s(e){return e.replace(zO,"<$1")}var wE={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},ng=Q0(wE),at=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(e,function(o,c){return wE[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,c){return String.fromCharCode(parseInt(c,16))});var i=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,i)+r(s.slice(i+3))}}(),sg=/[&<>'"]/g,WO=/[\u0000-\u0008\u000b-\u001f]/g;function ft(e){var t=e+"";return t.replace(sg,function(r){return ng[r]}).replace(WO,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function ow(e){return ft(e).replace(/ /g,"_x0020_")}var _E=/[\u0000-\u001f]/g;function ag(e){var t=e+"";return t.replace(sg,function(r){return ng[r]}).replace(/\n/g,"<br/>").replace(_E,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function HO(e){var t=e+"";return t.replace(sg,function(r){return ng[r]}).replace(_E,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var lw=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function GO(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function wt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function lh(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=s&63,t+=String.fromCharCode(i);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(a&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function cw(e){var t=Na(2*e.length),r,n,s=1,a=0,i=0,o;for(n=0;n<e.length;n+=s)s=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[a++]=i&255,t[a++]=i>>>8,i=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function uw(e){return Js(e,"binary").toString("utf8")}var Uu="foo bar baz",pt=tt&&(uw(Uu)==lh(Uu)&&uw||cw(Uu)==lh(Uu)&&cw)||lh,xs=tt?function(e){return Js(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Mc=function(){var e={};return function(r,n){var s=r+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),bE=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),KO=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),XO=/<\/?(?:vt:)?variant>/g,qO=/<(?:vt:)([^>]*)>([\s\S]*)</;function dw(e,t){var r=Ke(e),n=e.match(KO(r.baseType))||[],s=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var i=a.replace(XO,"").match(qO);i&&s.push({v:pt(i[2]),t:i[1]})}),s}var kE=/(^\s|\s$|\n)/;function wr(e,t){return"<"+e+(t.match(kE)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Bc(e){return $t(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function we(e,t,r){return"<"+e+(r!=null?Bc(r):"")+(t!=null?(t.match(kE)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function ep(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function YO(e,t){switch(typeof e){case"string":var r=we("vt:lpwstr",ft(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return we((e|0)==e?"vt:i4":"vt:r8",ft(String(e)));case"boolean":return we("vt:bool",e?"true":"false")}if(e instanceof Date)return we("vt:filetime",ep(e));throw new Error("Unable to serialize "+e)}function ig(e){if(tt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return pt(Ia(Qx(e)));throw new Error("Bad input format: expected Buffer or string")}var Uc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,ar={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Fi=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],dn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function JO(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,a=5;a>=0;--a)s=s*256+e[t+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function QO(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,a=0,i=n?-t:t;isFinite(i)?i==0?s=a=0:(s=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[r+o]=a&255;e[r+6]=(s&15)<<4|a&15,e[r+7]=s>>4|n}var fw=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,a=e[0][n].length;s<a;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},hw=tt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Js(t)})):fw(e)}:fw,mw=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(Ps(e,s)));return n.join("").replace(Wr,"")},og=tt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Wr,""):mw(e,t,r)}:mw,pw=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},SE=tt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):pw(e,t,r)}:pw,xw=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(Qi(e,s)));return n.join("")},iu=tt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):xw(t,r,n)}:xw,EE=function(e,t){var r=fn(e,t);return r>0?iu(e,t+4,t+4+r-1):""},NE=EE,TE=function(e,t){var r=fn(e,t);return r>0?iu(e,t+4,t+4+r-1):""},CE=TE,jE=function(e,t){var r=2*fn(e,t);return r>0?iu(e,t+4,t+4+r-1):""},AE=jE,FE=function(t,r){var n=fn(t,r);return n>0?og(t,r+4,r+4+n):""},PE=FE,RE=function(e,t){var r=fn(e,t);return r>0?iu(e,t+4,t+4+r):""},OE=RE,DE=function(e,t){return JO(e,t)},c0=DE,lg=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};tt&&(NE=function(t,r){if(!Buffer.isBuffer(t))return EE(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},CE=function(t,r){if(!Buffer.isBuffer(t))return TE(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},AE=function(t,r){if(!Buffer.isBuffer(t))return jE(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},PE=function(t,r){if(!Buffer.isBuffer(t))return FE(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},OE=function(t,r){if(!Buffer.isBuffer(t))return RE(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},c0=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):DE(t,r)},lg=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Qi=function(e,t){return e[t]},Ps=function(e,t){return e[t+1]*256+e[t]},ZO=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},fn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ja=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},eD=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function ql(e,t){var r="",n,s,a=[],i,o,c,u;switch(t){case"dbcs":if(u=this.l,tt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Ps(this,u)),u+=2;e*=2;break;case"utf8":r=iu(this,this.l,this.l+e);break;case"utf16le":e*=2,r=og(this,this.l,this.l+e);break;case"wstr":return ql.call(this,e,"dbcs");case"lpstr-ansi":r=NE(this,this.l),e=4+fn(this,this.l);break;case"lpstr-cp":r=CE(this,this.l),e=4+fn(this,this.l);break;case"lpwstr":r=AE(this,this.l),e=4+2*fn(this,this.l);break;case"lpp4":e=4+fn(this,this.l),r=PE(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+fn(this,this.l),r=OE(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=Qi(this,this.l+e++))!==0;)a.push(Bu(i));r=a.join("");break;case"_wstr":for(e=0,r="";(i=Ps(this,this.l+e))!==0;)a.push(Bu(i)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Qi(this,u),this.l=u+1,o=ql.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Bu(Ps(this,u))),u+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Qi(this,u),this.l=u+1,o=ql.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Bu(Qi(this,u))),u+=1}r=a.join("");break;default:switch(e){case 1:return n=Qi(this,this.l),this.l++,n;case 2:return n=(t==="i"?ZO:Ps)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Ja:eD)(this,this.l),this.l+=4,n):(s=fn(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=c0(this,this.l):s=c0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=SE(this,this.l,e);break}}return this.l+=e,r}var tD=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},rD=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},nD=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function sD(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)nD(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var i=t.charCodeAt(s);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,tD(this,t,this.l);break;case 8:if(n=8,r==="f"){QO(this,t,this.l);break}case 16:break;case-4:n=4,rD(this,t,this.l);break}return this.l+=n,this}function IE(e,t){var r=SE(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function yr(e,t){e.l=t,e.read_shift=ql,e.chk=IE,e.write_shift=sD}function Mr(e,t){e.l+=t}function le(e){var t=Na(e);return yr(t,0),t}function Qs(e,t,r){if(e){var n,s,a;yr(e,e.l||0);for(var i=e.length,o=0,c=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var u=Gc[o]||Gc[65535];for(n=e.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=e.read_shift(1))&127)<<7*s;c=e.l+a;var d=u.f&&u.f(e,a,r);if(e.l=c,t(d,u,o))return}}}function sn(){var e=[],t=tt?256:2048,r=function(u){var d=le(u);return yr(d,0),d},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(u){return n&&u<n.length-n.l?n:(s(),n=r(Math.max(u+1,t)))},i=function(){return s(),ur(e)},o=function(u){s(),n=u,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:o,end:i,_bufs:e}}function fe(e,t,r,n){var s=+t,a;if(!isNaN(s)){n||(n=Gc[s].p||(r||[]).length||0),a=1+(s>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var i=e.next(a);s<=127?i.write_shift(1,s):(i.write_shift(1,(s&127)+128),i.write_shift(1,s>>7));for(var o=0;o!=4;++o)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&lg(r)&&e.push(r)}}function Yl(e,t,r){var n=kt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function gw(e,t,r){var n=kt(e);return n.s=Yl(n.s,t.s,r),n.e=Yl(n.e,t.s,r),n}function Jl(e,t){if(e.cRel&&e.c<0)for(e=kt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=kt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ge(e);return!e.cRel&&e.cRel!=null&&(r=oD(r)),!e.rRel&&e.rRel!=null&&(r=aD(r)),r}function ch(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Ft(e.s.c)+":"+(e.e.cRel?"":"$")+Ft(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Xt(e.s.r)+":"+(e.e.rRel?"":"$")+Xt(e.e.r):Jl(e.s,t.biff)+":"+Jl(e.e,t.biff)}function cg(e){return parseInt(iD(e),10)-1}function Xt(e){return""+(e+1)}function aD(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function iD(e){return e.replace(/\$(\d+)$/,"$1")}function ug(e){for(var t=lD(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Ft(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function oD(e){return e.replace(/^([A-Z])/,"$$$1")}function lD(e){return e.replace(/^\$([A-Z])/,"$1")}function cD(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Pt(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function Ge(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function an(e){var t=e.indexOf(":");return t==-1?{s:Pt(e),e:Pt(e)}:{s:Pt(e.slice(0,t)),e:Pt(e.slice(t+1))}}function Ye(e,t){return typeof t>"u"||typeof t=="number"?Ye(e.s,e.e):(typeof e!="string"&&(e=Ge(e)),typeof t!="string"&&(t=Ge(t)),e==t?e:e+":"+t)}function it(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=e.length;for(r=0;n<a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===a||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function vw(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Wn(e.z,r?or(t):t)}catch{}try{return e.w=Wn((e.XF||{}).numFmtId||(r?14:0),r?or(t):t)}catch{return""+t}}function Gs(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Zs[e.v]||e.v:t==null?vw(e,e.v):vw(e,t))}function La(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function LE(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,a=e||(s?[]:{}),i=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?Pt(n.origin):n.origin;i=c.r,o=c.c}a["!ref"]||(a["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=it(a["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),i==-1&&(u.e.r=i=d.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var m={v:t[f][h]},x=i+f,p=o+h;if(u.s.r>x&&(u.s.r=x),u.s.c>p&&(u.s.c=p),u.e.r<x&&(u.e.r=x),u.e.c<p&&(u.e.c=p),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))m=t[f][h];else if(Array.isArray(m.v)&&(m.f=t[f][h][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||He[14],n.cellDates?(m.t="d",m.w=Wn(m.z,or(m.v))):(m.t="n",m.v=or(m.v),m.w=Wn(m.z,m.v))):m.t="s";if(s)a[x]||(a[x]=[]),a[x][p]&&a[x][p].z&&(m.z=a[x][p].z),a[x][p]=m;else{var g=Ge({c:p,r:x});a[g]&&a[g].z&&(m.z=a[g].z),a[g]=m}}}return u.s.c<1e7&&(a["!ref"]=Ye(u)),a}function sl(e,t){return LE(null,e,t)}function uD(e){return e.read_shift(4,"i")}function is(e,t){return t||(t=le(4)),t.write_shift(4,e),t}function Ir(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function dr(e,t){var r=!1;return t==null&&(r=!0,t=le(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function dD(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function fD(e,t){return t||(t=le(4)),t.write_shift(2,0),t.write_shift(2,0),t}function dg(e,t){var r=e.l,n=e.read_shift(1),s=Ir(e),a=[],i={t:s,h:s};if(n&1){for(var o=e.read_shift(4),c=0;c!=o;++c)a.push(dD(e));i.r=a}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function hD(e,t){var r=!1;return t==null&&(r=!0,t=le(15+4*e.t.length)),t.write_shift(1,0),dr(e.t,t),r?t.slice(0,t.l):t}var mD=dg;function pD(e,t){var r=!1;return t==null&&(r=!0,t=le(23+4*e.t.length)),t.write_shift(1,1),dr(e.t,t),t.write_shift(4,1),fD({},t),r?t.slice(0,t.l):t}function Hn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Pi(e,t){return t==null&&(t=le(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Ri(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Oi(e,t){return t==null&&(t=le(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var xD=Ir,ME=dr;function fg(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function u0(e,t){var r=!1;return t==null&&(r=!0,t=le(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var gD=Ir,tp=fg,hg=u0;function mg(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?c0([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ja(t,0)>>2;return r?s/100:s}function BE(e,t){t==null&&(t=le(4));var r=0,n=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function UE(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function vD(e,t){return t||(t=le(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Di=UE,al=vD;function Dr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function wi(e,t){return(t||le(8)).write_shift(8,e,"f")}function yD(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var u=li[s];u&&(t.rgb=$c(u));break;case 2:t.rgb=$c([i,o,c]);break;case 3:t.theme=s;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function d0(e,t){if(t||(t=le(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function wD(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function _D(e,t){t||(t=le(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function VE(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function bD(e){return VE(e,1)}function kD(e){return VE(e,2)}var pg=2,Yr=3,Vu=11,yw=12,f0=19,$u=64,SD=65,ED=71,ND=4108,TD=4126,lr=80,$E=81,CD=[lr,$E],rp={1:{n:"CodePage",t:pg},2:{n:"Category",t:lr},3:{n:"PresentationFormat",t:lr},4:{n:"ByteCount",t:Yr},5:{n:"LineCount",t:Yr},6:{n:"ParagraphCount",t:Yr},7:{n:"SlideCount",t:Yr},8:{n:"NoteCount",t:Yr},9:{n:"HiddenCount",t:Yr},10:{n:"MultimediaClipCount",t:Yr},11:{n:"ScaleCrop",t:Vu},12:{n:"HeadingPairs",t:ND},13:{n:"TitlesOfParts",t:TD},14:{n:"Manager",t:lr},15:{n:"Company",t:lr},16:{n:"LinksUpToDate",t:Vu},17:{n:"CharacterCount",t:Yr},19:{n:"SharedDoc",t:Vu},22:{n:"HyperlinksChanged",t:Vu},23:{n:"AppVersion",t:Yr,p:"version"},24:{n:"DigSig",t:SD},26:{n:"ContentType",t:lr},27:{n:"ContentStatus",t:lr},28:{n:"Language",t:lr},29:{n:"Version",t:lr},255:{},2147483648:{n:"Locale",t:f0},2147483651:{n:"Behavior",t:f0},1919054434:{}},np={1:{n:"CodePage",t:pg},2:{n:"Title",t:lr},3:{n:"Subject",t:lr},4:{n:"Author",t:lr},5:{n:"Keywords",t:lr},6:{n:"Comments",t:lr},7:{n:"Template",t:lr},8:{n:"LastAuthor",t:lr},9:{n:"RevNumber",t:lr},10:{n:"EditTime",t:$u},11:{n:"LastPrinted",t:$u},12:{n:"CreatedDate",t:$u},13:{n:"ModifiedDate",t:$u},14:{n:"PageCount",t:Yr},15:{n:"WordCount",t:Yr},16:{n:"CharCount",t:Yr},17:{n:"Thumbnail",t:ED},18:{n:"Application",t:lr},19:{n:"DocSecurity",t:Yr},255:{},2147483648:{n:"Locale",t:f0},2147483651:{n:"Behavior",t:f0},1919054434:{}},ww={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},jD=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function AD(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var FD=AD([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),li=kt(FD),Zs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},zE={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},sp={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},zu={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function xg(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function PD(e){var t=xg();if(!e||!e.match)return t;var r={};if((e.match(Br)||[]).forEach(function(n){var s=Ke(n);switch(s[0].replace($O,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[sp[s.ContentType]]!==void 0&&t[sp[s.ContentType]].push(s.PartName);break}}),t.xmlns!==ar.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function WE(e,t){var r=PO(sp),n=[],s;n[n.length]=qt,n[n.length]=we("Types",null,{xmlns:ar.CT,"xmlns:xsd":ar.xsd,"xmlns:xsi":ar.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return we("Default",null,{Extension:c[0],ContentType:c[1]})}));var a=function(c){e[c]&&e[c].length>0&&(s=e[c][0],n[n.length]=we("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:zu[c][t.bookType]||zu[c].xlsx}))},i=function(c){(e[c]||[]).forEach(function(u){n[n.length]=we("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:zu[c][t.bookType]||zu[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(u){n[n.length]=we("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return a("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var rt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Vc(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ql(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Br)||[]).forEach(function(s){var a=Ke(s);if(a[0]==="<Relationship"){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:Al(a.Target,t);r[o]=i,n[a.Id]=i}}),r["!id"]=n,r}function jo(e){var t=[qt,we("Relationships",null,{xmlns:ar.RELS})];return $t(e["!id"]).forEach(function(r){t[t.length]=we("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function dt(e,t,r,n,s,a){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=n,s.Target=r,[rt.HLINK,rt.XPATH,rt.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var RD="application/vnd.oasis.opendocument.spreadsheet";function OD(e,t){for(var r=ig(e),n,s;n=Uc.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=Ke(n[0],!1),s.path=="/"&&s.type!==RD)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function DD(e){var t=[qt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function _w(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function ID(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function LD(e){var t=[qt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(_w(e[r][0],e[r][1])),t.push(ID("",e[r][0]));return t.push(_w("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function HE(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+s0.version+"</meta:generator></office:meta></office:document-meta>"}var Un=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],MD=function(){for(var e=new Array(Un.length),t=0;t<Un.length;++t){var r=Un[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function GE(e){var t={};e=pt(e);for(var r=0;r<Un.length;++r){var n=Un[r],s=e.match(MD[r]);s!=null&&s.length>0&&(t[n[1]]=at(s[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=bt(t[n[1]]))}return t}function uh(e,t,r,n,s){s[e]!=null||t==null||t===""||(s[e]=t,t=ft(t),n[n.length]=r?we(e,t,r):wr(e,t))}function KE(e,t){var r=t||{},n=[qt,we("cp:coreProperties",null,{"xmlns:cp":ar.CORE_PROPS,"xmlns:dc":ar.dc,"xmlns:dcterms":ar.dcterms,"xmlns:dcmitype":ar.dcmitype,"xmlns:xsi":ar.xsi})],s={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&uh("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:ep(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&uh("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:ep(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var a=0;a!=Un.length;++a){var i=Un[a],o=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:e?e[i[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&uh(i[0],o,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var ci=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],XE=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function qE(e,t,r,n){var s=[];if(typeof e=="string")s=dw(e,n);else for(var a=0;a<e.length;++a)s=s.concat(e[a].map(function(d){return{v:d}}));var i=typeof t=="string"?dw(t,n).map(function(d){return d.v}):t,o=0,c=0;if(i.length>0)for(var u=0;u!==s.length;u+=2){switch(c=+s[u+1].v,s[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=i.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=i.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=i.slice(o,o+c);break}o+=c}}function BD(e,t,r){var n={};return t||(t={}),e=pt(e),ci.forEach(function(s){var a=(e.match(Mc(s[0]))||[])[1];switch(s[2]){case"string":a&&(t[s[1]]=at(a));break;case"bool":t[s[1]]=a==="true";break;case"raw":var i=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));i&&i.length>0&&(n[s[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&qE(n.HeadingPairs,n.TitlesOfParts,t,r),t}function YE(e){var t=[],r=we;return e||(e={}),e.Application="SheetJS",t[t.length]=qt,t[t.length]=we("Properties",null,{xmlns:ar.EXT_PROPS,"xmlns:vt":ar.vt}),ci.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=ft(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(n[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+ft(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var UD=/<[^>]+>[^<]*/g;function VD(e,t){var r={},n="",s=e.match(UD);if(s)for(var a=0;a!=s.length;++a){var i=s[a],o=Ke(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=at(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var c=i.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=at(d);break;case"bool":r[n]=wt(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=bt(d);break;case"cy":case"error":r[n]=at(d);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,u,c)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}function JE(e){var t=[qt,we("Properties",null,{xmlns:ar.CUST_PROPS,"xmlns:vt":ar.vt})];if(!e)return t.join("");var r=1;return $t(e).forEach(function(s){++r,t[t.length]=we("property",YO(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:ft(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var ap={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},dh;function $D(e,t,r){dh||(dh=Q0(ap)),t=dh[t]||t,e[t]=r}function zD(e,t){var r=[];return $t(ap).map(function(n){for(var s=0;s<Un.length;++s)if(Un[s][1]==n)return Un[s];for(s=0;s<ci.length;++s)if(ci[s][1]==n)return ci[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(wr(ap[n[1]]||n[1],s))}}),we("DocumentProperties",r.join(""),{xmlns:dn.o})}function WD(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&$t(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var i=0;i<Un.length;++i)if(a==Un[i][1])return;for(i=0;i<ci.length;++i)if(a==ci[i][1])return;for(i=0;i<r.length;++i)if(a==r[i])return;var o=e[a],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),s.push(we(ow(a),o,{"dt:dt":c}))}}),t&&$t(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var i=t[a],o="string";typeof i=="number"?(o="float",i=String(i)):i===!0||i===!1?(o="boolean",i=i?"1":"0"):i instanceof Date?(o="dateTime.tz",i=i.toISOString()):i=String(i),s.push(we(ow(a),i,{"dt:dt":o}))}}),"<"+n+' xmlns="'+dn.o+'">'+s.join("")+"</"+n+">"}function gg(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function HD(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),s+=a);var i=le(8);return i.write_shift(4,n),i.write_shift(4,s),i}function QE(e,t,r){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return s}function ZE(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function eN(e,t,r){return t===31?ZE(e):QE(e,t,r)}function ip(e,t,r){return eN(e,t,r===!1?0:4)}function GD(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return eN(e,t,0)}function KD(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var s=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Wr,""),e.l-s&2&&(e.l+=2)}return r}function XD(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Wr,"");return r}function qD(e){var t=e.l,r=h0(e,$E);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=h0(e,Yr);return[r,n]}function YD(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(qD(e));return r}function bw(e,t){for(var r=e.read_shift(4),n={},s=0;s!=r;++s){var a=e.read_shift(4),i=e.read_shift(4);n[a]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(Wr,"").replace(jl,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function tN(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function JD(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function h0(e,t,r){var n=e.read_shift(2),s,a=r||{};if(e.l+=2,t!==yw&&n!==t&&CD.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===yw?n:t){case 2:return s=e.read_shift(2,"i"),a.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return QE(e,n,4).replace(Wr,"");case 31:return ZE(e);case 64:return gg(e);case 65:return tN(e);case 71:return JD(e);case 80:return ip(e,n,!a.raw).replace(Wr,"");case 81:return GD(e,n).replace(Wr,"");case 4108:return YD(e);case 4126:case 4127:return n==4127?KD(e):XD(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function kw(e,t){var r=le(4),n=le(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=le(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=HD(t);break;case 31:case 80:for(n=le(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return ur([r,n])}function Sw(e,t){var r=e.l,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0,o=0,c=-1,u={};for(i=0;i!=s;++i){var d=e.read_shift(4),f=e.read_shift(4);a[i]=[d,f+r]}a.sort(function(w,v){return w[1]-v[1]});var h={};for(i=0;i!=s;++i){if(e.l!==a[i][1]){var m=!0;if(i>0&&t)switch(t[a[i-1][0]].t){case 2:e.l+2===a[i][1]&&(e.l+=2,m=!1);break;case 80:e.l<=a[i][1]&&(e.l=a[i][1],m=!1);break;case 4108:e.l<=a[i][1]&&(e.l=a[i][1],m=!1);break}if((!t||i==0)&&e.l<=a[i][1]&&(m=!1,e.l=a[i][1]),m)throw new Error("Read Error: Expected address "+a[i][1]+" at "+e.l+" :"+i)}if(t){var x=t[a[i][0]];if(h[x.n]=h0(e,x.t,{raw:!0}),x.p==="version"&&(h[x.n]=String(h[x.n]>>16)+"."+("0000"+String(h[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(h[x.n]){case 0:h[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ts(o=h[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[x.n])}}else if(a[i][0]===1){if(o=h.CodePage=h0(e,pg),ts(o),c!==-1){var p=e.l;e.l=a[c][1],u=bw(e,o),e.l=p}}else if(a[i][0]===0){if(o===0){c=i,e.l=a[i+1][1];continue}u=bw(e,o)}else{var g=u[a[i][0]],y;switch(e[e.l]){case 65:e.l+=4,y=tN(e);break;case 30:e.l+=4,y=ip(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,y=ip(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,y=e.read_shift(4,"i");break;case 19:e.l+=4,y=e.read_shift(4);break;case 5:e.l+=4,y=e.read_shift(8,"f");break;case 11:e.l+=4,y=Ht(e,4);break;case 64:e.l+=4,y=bt(gg(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[g]=y}}return e.l=r+n,h}var rN=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function QD(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Ew(e,t,r){var n=le(8),s=[],a=[],i=8,o=0,c=le(8),u=le(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),a.push(c),s.push(u),i+=8+c.length,!t){u=le(8),u.write_shift(4,0),s.unshift(u);var d=[le(4)];for(d[0].write_shift(4,e.length),o=0;o<e.length;++o){var f=e[o][0];for(c=le(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=ur(d),a.unshift(c),i+=8+c.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(rN.indexOf(e[o][0])>-1||XE.indexOf(e[o][0])>-1)&&e[o][1]!=null){var h=e[o][1],m=0;if(t){m=+t[e[o][0]];var x=r[m];if(x.p=="version"&&typeof h=="string"){var p=h.split(".");h=(+p[0]<<16)+(+p[1]||0)}c=kw(x.t,h)}else{var g=QD(h);g==-1&&(g=31,h=String(h)),c=kw(g,h)}a.push(c),u=le(8),u.write_shift(4,t?m:2+o),s.push(u),i+=8+c.length}var y=8*(a.length+1);for(o=0;o<a.length;++o)s[o].write_shift(4,y),y+=a[o].length;return n.write_shift(4,i),n.write_shift(4,a.length),ur([n].concat(s).concat(a))}function Nw(e,t,r){var n=e.content;if(!n)return{};yr(n,0);var s,a,i,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),d=n.read_shift(16);if(d!==Le.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(i=n.read_shift(16),c=n.read_shift(4));var f=Sw(n,t),h={SystemIdentifier:u};for(var m in f)h[m]=f[m];if(h.FMTID=a,s===1)return h;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var x;try{x=Sw(n,null)}catch{}for(m in x)h[m]=x[m];return h.FMTID=[a,i],h}function Tw(e,t,r,n,s,a){var i=le(s?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,Le.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,s?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,s?68:48);var c=Ew(e,r,n);if(o.push(c),s){var u=Ew(s,null,null);i.write_shift(16,a,"hex"),i.write_shift(4,68+c.length),o.push(u)}return ur(o)}function ta(e,t){return e.read_shift(t),null}function ZD(e,t){t||(t=le(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function eI(e,t,r){for(var n=[],s=e.l+t;e.l<s;)n.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function Ht(e,t){return e.read_shift(t)===1}function $r(e,t){return t||(t=le(2)),t.write_shift(2,+!!e),t}function Zt(e){return e.read_shift(2,"u")}function Dn(e,t){return t||(t=le(2)),t.write_shift(2,e),t}function nN(e,t){return eI(e,t,Zt)}function tI(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function sN(e,t,r){return r||(r=le(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function ou(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var i=n?e.read_shift(n,s):"";return i}function rI(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,s=r&8,a=1+(r&1),i=0,o,c={};s&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var u=a==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,u);return s&&(e.l+=4*i),n&&(e.l+=o),c.t=d,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function nI(e){var t=e.t||"",r=le(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=le(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[r,n];return ur(s)}function _i(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function lu(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):_i(e,n,r)}function Ii(e,t,r){if(r.biff>5)return lu(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function aN(e,t,r){return r||(r=le(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function sI(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function aI(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var s=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Wr,"");return n&&(e.l+=24),s}function iI(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(a>>1,"utf16le").replace(Wr,"");return r+i}function oI(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return aI(e);case"0303000000000000c000000000000046":return iI(e);default:throw new Error("Unsupported Moniker "+r)}}function Wu(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Wr,""):"";return r}function Cw(e,t){t||(t=le(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function lI(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var a,i,o,c,u="",d,f;s&16&&(a=Wu(e,r-e.l)),s&128&&(i=Wu(e,r-e.l)),(s&257)===257&&(o=Wu(e,r-e.l)),(s&257)===1&&(c=oI(e,r-e.l)),s&8&&(u=Wu(e,r-e.l)),s&32&&(d=e.read_shift(16)),s&64&&(f=gg(e)),e.l=r;var h=i||o||c||"";h&&u&&(h+="#"+u),h||(h="#"+u),s&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var m={Target:h};return d&&(m.guid=d),f&&(m.time=f),a&&(m.Tooltip=a),m}function cI(e){var t=le(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),a=s>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(a==28)n=n.slice(1),Cw(n,t);else if(a&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var o=s>-1?n.slice(0,s):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),a&8&&Cw(s>-1?n.slice(s+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function iN(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[t,r,n,s]}function oN(e,t){var r=iN(e);return r[3]=0,r}function bs(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function bi(e,t,r,n){return n||(n=le(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function uI(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function dI(e,t,r){return t===0?"":Ii(e,t,r)}function fI(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),a=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[s,a,i]}function lN(e){var t=e.read_shift(2),r=mg(e);return[t,r]}function hI(e,t,r){e.l+=4,t-=4;var n=e.l+t,s=ou(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,s}function tf(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function cN(e,t){return t||(t=le(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function uN(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r:t},e:{c:s,r}}}var mI=uN;function dN(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function pI(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function xI(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Tr(e){e.l+=2,e.l+=e.read_shift(2)}var gI={0:Tr,4:Tr,5:Tr,6:Tr,7:xI,8:Tr,9:Tr,10:Tr,11:Tr,12:Tr,13:pI,14:Tr,15:Tr,16:Tr,17:Tr,18:Tr,19:Tr,20:Tr,21:dN};function vI(e,t){for(var r=e.l+t,n=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{n.push(gI[s](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Hu(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function vg(e,t,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=le(s);return a.write_shift(2,n),a.write_shift(2,t),s>4&&a.write_shift(2,29282),s>6&&a.write_shift(2,1997),s>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function yI(e,t){return t===0||e.read_shift(2),1200}function wI(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,s=Ii(e,0,r);return e.read_shift(t+n-e.l),s}function _I(e,t){var r=!t||t.biff==8,n=le(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function bI(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function kI(e,t,r){var n=e.read_shift(4),s=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var i=ou(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:s,dt:a,name:i}}function SI(e,t){var r=!t||t.biff>=8?2:1,n=le(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function EI(e,t){for(var r=e.l+t,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0;i!=s&&e.l<r;++i)a.push(rI(e));return a.Count=n,a.Unique=s,a}function NI(e,t){var r=le(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=nI(e[s]);var a=ur([r].concat(n));return a.parts=[r.length].concat(n.map(function(i){return i.length})),a}function TI(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function CI(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function jI(e){var t=uI(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function AI(e){return e.read_shift(2),e.read_shift(4)}function jw(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function FI(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,s],Flags:a,CurTab:i,FirstTab:o,Selected:c,TabRatio:u}}function PI(){var e=le(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function RI(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function OI(e){var t=le(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function DI(){}function II(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=ou(e,0,r),n}function LI(e,t){var r=e.name||"Arial",n=t&&t.biff==5,s=n?15+r.length:16+2*r.length,a=le(s);return a.write_shift(2,e.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function MI(e){var t=bs(e);return t.isst=e.read_shift(4),t}function BI(e,t,r,n){var s=le(10);return bi(e,t,n,s),s.write_shift(4,r),s}function UI(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,s=bs(e);r.biff==2&&e.l++;var a=lu(e,n-e.l,r);return s.val=a,s}function VI(e,t,r,n,s){var a=!s||s.biff==8,i=le(8+ +a+(1+a)*r.length);return bi(e,t,n,i),i.write_shift(2,r.length),a&&i.write_shift(1,1),i.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),i}function $I(e,t,r){var n=e.read_shift(2),s=Ii(e,0,r);return[n,s]}function zI(e,t,r,n){var s=r&&r.biff==5;n||(n=le(s?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(s?1:2,t.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}var WI=Ii;function Aw(e,t,r){var n=e.l+t,s=r.biff==8||!r.biff?4:2,a=e.read_shift(s),i=e.read_shift(s),o=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:a,c:o},e:{r:i,c}}}function HI(e,t){var r=t.biff==8||!t.biff?4:2,n=le(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function GI(e){var t=e.read_shift(2),r=e.read_shift(2),n=lN(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function KI(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(lN(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:i,rkrec:a}}function XI(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:i,ixfe:a}}function qI(e,t,r,n){var s={},a=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return s.patternType=jD[o>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=i&15,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function YI(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=qI(e,t,n.fStyle,r),n}function Fw(e,t,r,n){var s=r&&r.biff==5;n||(n=le(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&s&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function JI(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function QI(e){var t=le(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Pw(e,t,r){var n=bs(e);(r.biff==2||t==9)&&++e.l;var s=tI(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function ZI(e,t,r,n,s,a){var i=le(8);return bi(e,t,n,i),sN(r,a,i),i}function eL(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=bs(e),s=Dr(e);return n.val=s,n}function tL(e,t,r,n){var s=le(14);return bi(e,t,n,s),wi(r,s),s}var Rw=dI;function rL(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var i=_i(e,a),o=[];n>e.l;)o.push(lu(e));return[a,s,i,o]}function Ow(e,t,r){var n=e.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=hI(e,t-2,r)),a.body=s||e.read_shift(t-2),typeof s=="string"&&(a.Name=s),a}var nL=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Dw(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=_i(e,i,r);s&32&&(u=nL[u.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var f=n==e.l||o===0||!(d>0)?[]:vB(e,d,r,o);return{chKey:a,Name:u,itab:c,rgce:f}}function fN(e,t,r){if(r.biff<8)return sL(e,t,r);for(var n=[],s=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(fI(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function sL(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=ou(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function aL(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),s=e.read_shift(2),a=_i(e,n,r),i=_i(e,s,r);return[a,i]}function iL(e,t,r){var n=uN(e);e.l++;var s=e.read_shift(1);return t-=8,[yB(e,t,r),s,n]}function Iw(e,t,r){var n=mI(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,xB(e,t,r)]}function oL(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function lL(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=Ii(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:s},o,i,a]}}function cL(e,t,r){return lL(e,t,r)}function uL(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(tf(e));return r}function dL(e){var t=le(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)cN(e[r],t);return t}function fL(e,t,r){if(r&&r.biff<8)return mL(e,t,r);var n=dN(e),s=vI(e,t-22,n[1]);return{cmo:n,ft:s}}var hL={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:n}}};function mL(e,t,r){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((hL[n]||Mr)(e,t,r)),{cmo:[s,n,a],ft:i}}function pL(e,t,r){var n=e.l,s="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:i=sI(e,6,r);var o=e.read_shift(2);e.read_shift(2),Zt(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],f=_i(e,e.lens[u+1]-e.lens[u]-1);if(s+=f,s.length>=(d?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return e.l=n+t,{t:s}}catch{return e.l=n+t,{t:s}}}function xL(e,t){var r=tf(e);e.l+=16;var n=lI(e,t-24);return[r,n]}function gL(e){var t=le(24),r=Pt(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(n[s],16));return ur([t,cI(e[1])])}function vL(e,t){e.read_shift(2);var r=tf(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Wr,""),[r,n]}function yL(e){var t=e[1].Tooltip,r=le(10+2*(t.length+1));r.write_shift(2,2048);var n=Pt(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function wL(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=ww[r]||r,r=e.read_shift(2),t[1]=ww[r]||r,t}function _L(e){return e||(e=le(4)),e.write_shift(2,1),e.write_shift(2,1),e}function bL(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(oN(e));return r}function kL(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(oN(e));return r}function SL(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function hN(e,t,r){if(!r.cellStyles)return Mr(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s,e:a,w:i,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function EL(e,t){var r=le(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function NL(e,t){var r={};return t<32||(e.l+=16,r.header=Dr(e),r.footer=Dr(e),e.l+=2),r}function TL(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}function CL(e){for(var t=le(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var jL=bs,AL=nN,FL=lu;function PL(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function RL(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=bs(e);++e.l;var s=Ii(e,t-7,r);return n.t="str",n.val=s,n}function OL(e){var t=bs(e);++e.l;var r=Dr(e);return t.t="n",t.val=r,t}function DL(e,t,r){var n=le(15);return fu(n,e,t),n.write_shift(8,r,"f"),n}function IL(e){var t=bs(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function LL(e,t,r){var n=le(9);return fu(n,e,t),n.write_shift(2,r),n}function ML(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function BL(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function UL(e,t,r){var n=e.l+t,s=bs(e),a=e.read_shift(2),i=_i(e,a,r);return e.l=n,s.t="str",s.val=i,s}var VL=[2,3,48,49,131,139,140,245],op=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Q0({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var u=[],d=Na(1);switch(c.type){case"base64":d=pn(kn(o));break;case"binary":d=pn(o);break;case"buffer":case"array":d=o;break}yr(d,0);var f=d.read_shift(1),h=!!(f&136),m=!1,x=!1;switch(f){case 2:break;case 3:break;case 48:m=!0,h=!0;break;case 49:m=!0,h=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var p=0,g=521;f==2&&(p=d.read_shift(2)),d.l+=3,f!=2&&(p=d.read_shift(4)),p>1048576&&(p=1e6),f!=2&&(g=d.read_shift(2));var y=d.read_shift(2),w=c.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(w=e[d[d.l]]),d.l+=1,d.l+=2),x&&(d.l+=36);for(var v=[],_={},S=Math.min(d.length,f==2?521:g-10-(m?264:0)),b=x?32:11;d.l<S&&d[d.l]!=13;)switch(_={},_.name=Dc.utils.decode(w,d.slice(d.l,d.l+b)).replace(/[\u0000\r\n].*$/g,""),d.l+=b,_.type=String.fromCharCode(d.read_shift(1)),f!=2&&!x&&(_.offset=d.read_shift(4)),_.len=d.read_shift(1),f==2&&(_.offset=d.read_shift(2)),_.dec=d.read_shift(1),_.name.length&&v.push(_),f!=2&&(d.l+=x?13:14),_.type){case"B":(!m||_.len!=8)&&c.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+_.type)}if(d[d.l]!==13&&(d.l=g-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=g;var k=0,T=0;for(u[0]=[],T=0;T!=v.length;++T)u[0][T]=v[T].name;for(;p-- >0;){if(d[d.l]===42){d.l+=y;continue}for(++d.l,u[++k]=[],T=0,T=0;T!=v.length;++T){var j=d.slice(d.l,d.l+v[T].len);d.l+=v[T].len,yr(j,0);var V=Dc.utils.decode(w,j);switch(v[T].type){case"C":V.trim().length&&(u[k][T]=V.replace(/\s+$/,""));break;case"D":V.length===8?u[k][T]=new Date(+V.slice(0,4),+V.slice(4,6)-1,+V.slice(6,8)):u[k][T]=V;break;case"F":u[k][T]=parseFloat(V.trim());break;case"+":case"I":u[k][T]=x?j.read_shift(-4,"i")^2147483648:j.read_shift(4,"i");break;case"L":switch(V.trim().toUpperCase()){case"Y":case"T":u[k][T]=!0;break;case"N":case"F":u[k][T]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+V+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[k][T]="##MEMO##"+(x?parseInt(V.trim(),10):j.read_shift(4));break;case"N":V=V.replace(/\u0000/g,"").trim(),V&&V!="."&&(u[k][T]=+V||0);break;case"@":u[k][T]=new Date(j.read_shift(-8,"f")-621356832e5);break;case"T":u[k][T]=new Date((j.read_shift(4)-2440588)*864e5+j.read_shift(4));break;case"Y":u[k][T]=j.read_shift(4,"i")/1e4+j.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[k][T]=-j.read_shift(-8,"f");break;case"B":if(m&&v[T].len==8){u[k][T]=j.read_shift(8,"f");break}case"G":case"P":j.l+=v[T].len;break;case"0":if(v[T].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+v[T].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=v,u}function n(o,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=sl(r(o,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function s(o,c){try{return La(n(o,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,c){var u=c||{};if(+u.codepage>=0&&ts(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=sn(),f=g0(o,{header:1,raw:!0,cellDates:!0}),h=f[0],m=f.slice(1),x=o["!cols"]||[],p=0,g=0,y=0,w=1;for(p=0;p<h.length;++p){if(((x[p]||{}).DBF||{}).name){h[p]=x[p].DBF.name,++y;continue}if(h[p]!=null){if(++y,typeof h[p]=="number"&&(h[p]=h[p].toString(10)),typeof h[p]!="string")throw new Error("DBF Invalid column name "+h[p]+" |"+typeof h[p]+"|");if(h.indexOf(h[p])!==p){for(g=0;g<1024;++g)if(h.indexOf(h[p]+"_"+g)==-1){h[p]+="_"+g;break}}}}var v=it(o["!ref"]),_=[],S=[],b=[];for(p=0;p<=v.e.c-v.s.c;++p){var k="",T="",j=0,V=[];for(g=0;g<m.length;++g)m[g][p]!=null&&V.push(m[g][p]);if(V.length==0||h[p]==null){_[p]="?";continue}for(g=0;g<V.length;++g){switch(typeof V[g]){case"number":T="B";break;case"string":T="C";break;case"boolean":T="L";break;case"object":T=V[g]instanceof Date?"D":"C";break;default:T="C"}j=Math.max(j,String(V[g]).length),k=k&&k!=T?"C":T}j>250&&(j=250),T=((x[p]||{}).DBF||{}).type,T=="C"&&x[p].DBF.len>j&&(j=x[p].DBF.len),k=="B"&&T=="N"&&(k="N",b[p]=x[p].DBF.dec,j=x[p].DBF.len),S[p]=k=="C"||T=="N"?j:a[k]||0,w+=S[p],_[p]=k}var C=d.next(32);for(C.write_shift(4,318902576),C.write_shift(4,m.length),C.write_shift(2,296+32*y),C.write_shift(2,w),p=0;p<4;++p)C.write_shift(4,0);for(C.write_shift(4,0|(+t[rE]||3)<<8),p=0,g=0;p<h.length;++p)if(h[p]!=null){var R=d.next(32),X=(h[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);R.write_shift(1,X,"sbcs"),R.write_shift(1,_[p]=="?"?"C":_[p],"sbcs"),R.write_shift(4,g),R.write_shift(1,S[p]||a[_[p]]||0),R.write_shift(1,b[p]||0),R.write_shift(1,2),R.write_shift(4,0),R.write_shift(1,0),R.write_shift(4,0),R.write_shift(4,0),g+=S[p]||a[_[p]]||0}var G=d.next(264);for(G.write_shift(4,13),p=0;p<65;++p)G.write_shift(4,0);for(p=0;p<m.length;++p){var Y=d.next(w);for(Y.write_shift(1,0),g=0;g<h.length;++g)if(h[g]!=null)switch(_[g]){case"L":Y.write_shift(1,m[p][g]==null?63:m[p][g]?84:70);break;case"B":Y.write_shift(8,m[p][g]||0,"f");break;case"N":var se="0";for(typeof m[p][g]=="number"&&(se=m[p][g].toFixed(b[g]||0)),y=0;y<S[g]-se.length;++y)Y.write_shift(1,32);Y.write_shift(1,se,"sbcs");break;case"D":m[p][g]?(Y.write_shift(4,("0000"+m[p][g].getFullYear()).slice(-4),"sbcs"),Y.write_shift(2,("00"+(m[p][g].getMonth()+1)).slice(-2),"sbcs"),Y.write_shift(2,("00"+m[p][g].getDate()).slice(-2),"sbcs")):Y.write_shift(8,"00000000","sbcs");break;case"C":var ie=String(m[p][g]!=null?m[p][g]:"").slice(0,S[g]);for(Y.write_shift(1,ie,"sbcs"),y=0;y<S[g]-ie.length;++y)Y.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:s,to_sheet:n,from_sheet:i}}(),mN=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+$t(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,m){var x=e[m];return typeof x=="number"?Ky(x):x},n=function(h,m,x){var p=m.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return p==59?h:Ky(p)};e["|"]=254;function s(h,m){switch(m.type){case"base64":return a(kn(h),m);case"binary":return a(h,m);case"buffer":return a(tt&&Buffer.isBuffer(h)?h.toString("binary"):Ia(h),m);case"array":return a(yi(h),m)}throw new Error("Unrecognized type "+m.type)}function a(h,m){var x=h.split(/[\n\r]+/),p=-1,g=-1,y=0,w=0,v=[],_=[],S=null,b={},k=[],T=[],j=[],V=0,C;for(+m.codepage>=0&&ts(+m.codepage);y!==x.length;++y){V=0;var R=x[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),X=R.replace(/;;/g,"\0").split(";").map(function(z){return z.replace(/\u0000/g,";")}),G=X[0],Y;if(R.length>0)switch(G){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":X[1].charAt(0)=="P"&&_.push(R.slice(3).replace(/;;/g,";"));break;case"C":var se=!1,ie=!1,oe=!1,W=!1,ue=-1,ve=-1;for(w=1;w<X.length;++w)switch(X[w].charAt(0)){case"A":break;case"X":g=parseInt(X[w].slice(1))-1,ie=!0;break;case"Y":for(p=parseInt(X[w].slice(1))-1,ie||(g=0),C=v.length;C<=p;++C)v[C]=[];break;case"K":Y=X[w].slice(1),Y.charAt(0)==='"'?Y=Y.slice(1,Y.length-1):Y==="TRUE"?Y=!0:Y==="FALSE"?Y=!1:isNaN(as(Y))?isNaN(Go(Y).getDate())||(Y=bt(Y)):(Y=as(Y),S!==null&&rl(S)&&(Y=ef(Y))),se=!0;break;case"E":W=!0;var F=Ao(X[w].slice(1),{r:p,c:g});v[p][g]=[v[p][g],F];break;case"S":oe=!0,v[p][g]=[v[p][g],"S5S"];break;case"G":break;case"R":ue=parseInt(X[w].slice(1))-1;break;case"C":ve=parseInt(X[w].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+R)}if(se&&(v[p][g]&&v[p][g].length==2?v[p][g][0]=Y:v[p][g]=Y,S=null),oe){if(W)throw new Error("SYLK shared formula cannot have own formula");var H=ue>-1&&v[ue][ve];if(!H||!H[1])throw new Error("SYLK shared formula cannot find base");v[p][g][1]=PN(H[1],{r:p-ue,c:g-ve})}break;case"F":var D=0;for(w=1;w<X.length;++w)switch(X[w].charAt(0)){case"X":g=parseInt(X[w].slice(1))-1,++D;break;case"Y":for(p=parseInt(X[w].slice(1))-1,C=v.length;C<=p;++C)v[C]=[];break;case"M":V=parseInt(X[w].slice(1))/20;break;case"F":break;case"G":break;case"P":S=_[parseInt(X[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(j=X[w].slice(1).split(" "),C=parseInt(j[0],10);C<=parseInt(j[1],10);++C)V=parseInt(j[2],10),T[C-1]=V===0?{hidden:!0}:{wch:V},Ta(T[C-1]);break;case"C":g=parseInt(X[w].slice(1))-1,T[g]||(T[g]={});break;case"R":p=parseInt(X[w].slice(1))-1,k[p]||(k[p]={}),V>0?(k[p].hpt=V,k[p].hpx=Xo(V)):V===0&&(k[p].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+R)}D<1&&(S=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+R)}}return k.length>0&&(b["!rows"]=k),T.length>0&&(b["!cols"]=T),m&&m.sheetRows&&(v=v.slice(0,m.sheetRows)),[v,b]}function i(h,m){var x=s(h,m),p=x[0],g=x[1],y=sl(p,m);return $t(g).forEach(function(w){y[w]=g[w]}),y}function o(h,m){return La(i(h,m),m)}function c(h,m,x,p){var g="C;Y"+(x+1)+";X"+(p+1)+";K";switch(h.t){case"n":g+=h.v||0,h.f&&!h.F&&(g+=";E"+Sg(h.f,{r:x,c:p}));break;case"b":g+=h.v?"TRUE":"FALSE";break;case"e":g+=h.w||h.v;break;case"d":g+='"'+(h.w||h.v)+'"';break;case"s":g+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function u(h,m){m.forEach(function(x,p){var g="F;W"+(p+1)+" "+(p+1)+" ";x.hidden?g+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=zc(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=Wc(x.wpx)),typeof x.wch=="number"&&(g+=Math.round(x.wch))),g.charAt(g.length-1)!=" "&&h.push(g)})}function d(h,m){m.forEach(function(x,p){var g="F;";x.hidden?g+="M0;":x.hpt?g+="M"+20*x.hpt+";":x.hpx&&(g+="M"+20*Hc(x.hpx)+";"),g.length>2&&h.push(g+"R"+(p+1))})}function f(h,m){var x=["ID;PWXL;N;E"],p=[],g=it(h["!ref"]),y,w=Array.isArray(h),v=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),h["!cols"]&&u(x,h["!cols"]),h["!rows"]&&d(x,h["!rows"]),x.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var _=g.s.r;_<=g.e.r;++_)for(var S=g.s.c;S<=g.e.c;++S){var b=Ge({r:_,c:S});y=w?(h[_]||[])[S]:h[b],!(!y||y.v==null&&(!y.f||y.F))&&p.push(c(y,h,_,S))}return x.join(v)+v+p.join(v)+v+"E"+v}return{to_workbook:o,to_sheet:i,from_sheet:f}}(),pN=function(){function e(a,i){switch(i.type){case"base64":return t(kn(a),i);case"binary":return t(a,i);case"buffer":return t(tt&&Buffer.isBuffer(a)?a.toString("binary"):Ia(a),i);case"array":return t(yi(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){for(var o=a.split(`
`),c=-1,u=-1,d=0,f=[];d!==o.length;++d){if(o[d].trim()==="BOT"){f[++c]=[],u=0;continue}if(!(c<0)){var h=o[d].trim().split(","),m=h[0],x=h[1];++d;for(var p=o[d]||"";(p.match(/["]/g)||[]).length&1&&d<o.length-1;)p+=`
`+o[++d];switch(p=p.trim(),+m){case-1:if(p==="BOT"){f[++c]=[],u=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?f[c][u]=!0:p==="FALSE"?f[c][u]=!1:isNaN(as(x))?isNaN(Go(x).getDate())?f[c][u]=x:f[c][u]=bt(x):f[c][u]=as(x),++u;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),f[c][u++]=p!==""?p:null;break}if(p==="EOD")break}}return i&&i.sheetRows&&(f=f.slice(0,i.sheetRows)),f}function r(a,i){return sl(e(a,i),i)}function n(a,i){return La(r(a,i),i)}var s=function(){var a=function(c,u,d,f,h){c.push(u),c.push(d+","+f),c.push('"'+h.replace(/"/g,'""')+'"')},i=function(c,u,d,f){c.push(u+","+d),c.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var u=[],d=it(c["!ref"]),f,h=Array.isArray(c);a(u,"TABLE",0,1,"sheetjs"),a(u,"VECTORS",0,d.e.r-d.s.r+1,""),a(u,"TUPLES",0,d.e.c-d.s.c+1,""),a(u,"DATA",0,0,"");for(var m=d.s.r;m<=d.e.r;++m){i(u,-1,0,"BOT");for(var x=d.s.c;x<=d.e.c;++x){var p=Ge({r:m,c:x});if(f=h?(c[m]||[])[x]:c[p],!f){i(u,1,0,"");continue}switch(f.t){case"n":var g=f.w;!g&&f.v!=null&&(g=f.v),g==null?f.f&&!f.F?i(u,1,0,"="+f.f):i(u,1,0,""):i(u,0,g,"V");break;case"b":i(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":i(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Wn(f.z||He[14],or(bt(f.v)))),i(u,0,f.w,"V");break;default:i(u,1,0,"")}}}i(u,-1,0,"EOD");var y=`\r
`,w=u.join(y);return w}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),xN=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var m=f.split(`
`),x=-1,p=-1,g=0,y=[];g!==m.length;++g){var w=m[g].trim().split(":");if(w[0]==="cell"){var v=Pt(w[1]);if(y.length<=v.r)for(x=y.length;x<=v.r;++x)y[x]||(y[x]=[]);switch(x=v.r,p=v.c,w[2]){case"t":y[x][p]=e(w[3]);break;case"v":y[x][p]=+w[3];break;case"vtf":var _=w[w.length-1];case"vtc":switch(w[3]){case"nl":y[x][p]=!!+w[4];break;default:y[x][p]=+w[4];break}w[2]=="vtf"&&(y[x][p]=[y[x][p],_])}}}return h&&h.sheetRows&&(y=y.slice(0,h.sheetRows)),y}function n(f,h){return sl(r(f,h),h)}function s(f,h){return La(n(f,h),h)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var h=[],m=[],x,p="",g=an(f["!ref"]),y=Array.isArray(f),w=g.s.r;w<=g.e.r;++w)for(var v=g.s.c;v<=g.e.c;++v)if(p=Ge({r:w,c:v}),x=y?(f[w]||[])[v]:f[p],!(!x||x.v==null||x.t==="z")){switch(m=["cell",p,"t"],x.t){case"s":case"str":m.push(t(x.v));break;case"n":x.f?(m[2]="vtf",m[3]="n",m[4]=x.v,m[5]=t(x.f)):(m[2]="v",m[3]=x.v);break;case"b":m[2]="vt"+(x.f?"f":"c"),m[3]="nl",m[4]=x.v?"1":"0",m[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var _=or(bt(x.v));m[2]="vtc",m[3]="nd",m[4]=""+_,m[5]=x.w||Wn(x.z||He[14],_);break;case"e":continue}h.push(m.join(":"))}return h.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function d(f){return[a,i,o,i,u(f),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:d}}(),Ko=function(){function e(d,f,h,m,x){x.raw?f[h][m]=d:d===""||(d==="TRUE"?f[h][m]=!0:d==="FALSE"?f[h][m]=!1:isNaN(as(d))?isNaN(Go(d).getDate())?f[h][m]=d:f[h][m]=bt(d):f[h][m]=as(d))}function t(d,f){var h=f||{},m=[];if(!d||d.length===0)return m;for(var x=d.split(/[\r\n]/),p=x.length-1;p>=0&&x[p].length===0;)--p;for(var g=10,y=0,w=0;w<=p;++w)y=x[w].indexOf(" "),y==-1?y=x[w].length:y++,g=Math.max(g,y);for(w=0;w<=p;++w){m[w]=[];var v=0;for(e(x[w].slice(0,g).trim(),m,w,v,h),v=1;v<=(x[w].length-g)/10+1;++v)e(x[w].slice(g+(v-1)*10,g+v*10).trim(),m,w,v,h)}return h.sheetRows&&(m=m.slice(0,h.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(d){for(var f={},h=!1,m=0,x=0;m<d.length;++m)(x=d.charCodeAt(m))==34?h=!h:!h&&x in r&&(f[x]=(f[x]||0)+1);x=[];for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&x.push([f[m],m]);if(!x.length){f=n;for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&x.push([f[m],m])}return x.sort(function(p,g){return p[0]-g[0]||n[p[1]]-n[g[1]]}),r[x.pop()[1]]||44}function a(d,f){var h=f||{},m="",x=h.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(m=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(m=d.charAt(4),d=d.slice(6)):m=s(d.slice(0,1024)):h&&h.FS?m=h.FS:m=s(d.slice(0,1024));var g=0,y=0,w=0,v=0,_=0,S=m.charCodeAt(0),b=!1,k=0,T=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var j=h.dateNF!=null?TO(h.dateNF):null;function V(){var C=d.slice(v,_),R={};if(C.charAt(0)=='"'&&C.charAt(C.length-1)=='"'&&(C=C.slice(1,-1).replace(/""/g,'"')),C.length===0)R.t="z";else if(h.raw)R.t="s",R.v=C;else if(C.trim().length===0)R.t="s",R.v=C;else if(C.charCodeAt(0)==61)C.charCodeAt(1)==34&&C.charCodeAt(C.length-1)==34?(R.t="s",R.v=C.slice(2,-1).replace(/""/g,'"')):r9(C)?(R.t="n",R.f=C.slice(1)):(R.t="s",R.v=C);else if(C=="TRUE")R.t="b",R.v=!0;else if(C=="FALSE")R.t="b",R.v=!1;else if(!isNaN(w=as(C)))R.t="n",h.cellText!==!1&&(R.w=C),R.v=w;else if(!isNaN(Go(C).getDate())||j&&C.match(j)){R.z=h.dateNF||He[14];var X=0;j&&C.match(j)&&(C=CO(C,h.dateNF,C.match(j)||[]),X=1),h.cellDates?(R.t="d",R.v=bt(C,X)):(R.t="n",R.v=or(bt(C,X))),h.cellText!==!1&&(R.w=Wn(R.z,R.v instanceof Date?or(R.v):R.v)),h.cellNF||delete R.z}else R.t="s",R.v=C;if(R.t=="z"||(h.dense?(x[g]||(x[g]=[]),x[g][y]=R):x[Ge({c:y,r:g})]=R),v=_+1,T=d.charCodeAt(v),p.e.c<y&&(p.e.c=y),p.e.r<g&&(p.e.r=g),k==S)++y;else if(y=0,++g,h.sheetRows&&h.sheetRows<=g)return!0}e:for(;_<d.length;++_)switch(k=d.charCodeAt(_)){case 34:T===34&&(b=!b);break;case S:case 10:case 13:if(!b&&V())break e;break}return _-v>0&&V(),x["!ref"]=Ye(p),x}function i(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?a(d,f):sl(t(d,f),f)}function o(d,f){var h="",m=f.type=="string"?[0,0,0,0]:Pg(d,f);switch(f.type){case"base64":h=kn(d);break;case"binary":h=d;break;case"buffer":f.codepage==65001?h=d.toString("utf8"):f.codepage&&typeof Dc<"u"||(h=tt&&Buffer.isBuffer(d)?d.toString("binary"):Ia(d));break;case"array":h=yi(d);break;case"string":h=d;break;default:throw new Error("Unrecognized type "+f.type)}return m[0]==239&&m[1]==187&&m[2]==191?h=pt(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=pt(h):f.type=="binary"&&typeof Dc<"u",h.slice(0,19)=="socialcalc:version:"?xN.to_sheet(f.type=="string"?h:pt(h),f):i(h,f)}function c(d,f){return La(o(d,f),f)}function u(d){for(var f=[],h=it(d["!ref"]),m,x=Array.isArray(d),p=h.s.r;p<=h.e.r;++p){for(var g=[],y=h.s.c;y<=h.e.c;++y){var w=Ge({r:p,c:y});if(m=x?(d[p]||[])[y]:d[w],!m||m.v==null){g.push("          ");continue}for(var v=(m.w||(Gs(m),m.w)||"").slice(0,10);v.length<10;)v+=" ";g.push(v+(y===0?" ":""))}f.push(g.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:u}}();function $L(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var s=mN.to_workbook(e,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return Ko.to_workbook(e,t)}}var ui=function(){function e(F,H,D){if(F){yr(F,F.l||0);for(var z=D.Enum||ue;F.l<F.length;){var B=F.read_shift(2),ne=z[B]||z[65535],U=F.read_shift(2),J=F.l+U,ae=ne.f&&ne.f(F,U,D);if(F.l=J,H(ae,ne,B))return}}}function t(F,H){switch(H.type){case"base64":return r(pn(kn(F)),H);case"binary":return r(pn(F),H);case"buffer":case"array":return r(F,H)}throw"Unsupported type "+H.type}function r(F,H){if(!F)return F;var D=H||{},z=D.dense?[]:{},B="Sheet1",ne="",U=0,J={},ae=[],q=[],O={s:{r:0,c:0},e:{r:0,c:0}},be=D.sheetRows||0;if(F[2]==0&&(F[3]==8||F[3]==9)&&F.length>=16&&F[14]==5&&F[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(F[2]==2)D.Enum=ue,e(F,function(me,et,lt){switch(lt){case 0:D.vers=me,me>=4096&&(D.qpro=!0);break;case 6:O=me;break;case 204:me&&(ne=me);break;case 222:ne=me;break;case 15:case 51:D.qpro||(me[1].v=me[1].v.slice(1));case 13:case 14:case 16:lt==14&&(me[2]&112)==112&&(me[2]&15)>1&&(me[2]&15)<15&&(me[1].z=D.dateNF||He[14],D.cellDates&&(me[1].t="d",me[1].v=ef(me[1].v))),D.qpro&&me[3]>U&&(z["!ref"]=Ye(O),J[B]=z,ae.push(B),z=D.dense?[]:{},O={s:{r:0,c:0},e:{r:0,c:0}},U=me[3],B=ne||"Sheet"+(U+1),ne="");var zt=D.dense?(z[me[0].r]||[])[me[0].c]:z[Ge(me[0])];if(zt){zt.t=me[1].t,zt.v=me[1].v,me[1].z!=null&&(zt.z=me[1].z),me[1].f!=null&&(zt.f=me[1].f);break}D.dense?(z[me[0].r]||(z[me[0].r]=[]),z[me[0].r][me[0].c]=me[1]):z[Ge(me[0])]=me[1];break}},D);else if(F[2]==26||F[2]==14)D.Enum=ve,F[2]==14&&(D.qpro=!0,F.l=0),e(F,function(me,et,lt){switch(lt){case 204:B=me;break;case 22:me[1].v=me[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(me[3]>U&&(z["!ref"]=Ye(O),J[B]=z,ae.push(B),z=D.dense?[]:{},O={s:{r:0,c:0},e:{r:0,c:0}},U=me[3],B="Sheet"+(U+1)),be>0&&me[0].r>=be)break;D.dense?(z[me[0].r]||(z[me[0].r]=[]),z[me[0].r][me[0].c]=me[1]):z[Ge(me[0])]=me[1],O.e.c<me[0].c&&(O.e.c=me[0].c),O.e.r<me[0].r&&(O.e.r=me[0].r);break;case 27:me[14e3]&&(q[me[14e3][0]]=me[14e3][1]);break;case 1537:q[me[0]]=me[1],me[0]==U&&(B=me[1]);break}},D);else throw new Error("Unrecognized LOTUS BOF "+F[2]);if(z["!ref"]=Ye(O),J[ne||B]=z,ae.push(ne||B),!q.length)return{SheetNames:ae,Sheets:J};for(var Ee={},Ve=[],Ue=0;Ue<q.length;++Ue)J[ae[Ue]]?(Ve.push(q[Ue]||ae[Ue]),Ee[q[Ue]]=J[q[Ue]]||J[ae[Ue]]):(Ve.push(q[Ue]),Ee[q[Ue]]={"!ref":"A1"});return{SheetNames:Ve,Sheets:Ee}}function n(F,H){var D=H||{};if(+D.codepage>=0&&ts(+D.codepage),D.type=="string")throw new Error("Cannot write WK1 to JS string");var z=sn(),B=it(F["!ref"]),ne=Array.isArray(F),U=[];_e(z,0,a(1030)),_e(z,6,c(B));for(var J=Math.min(B.e.r,8191),ae=B.s.r;ae<=J;++ae)for(var q=Xt(ae),O=B.s.c;O<=B.e.c;++O){ae===B.s.r&&(U[O]=Ft(O));var be=U[O]+q,Ee=ne?(F[ae]||[])[O]:F[be];if(!(!Ee||Ee.t=="z"))if(Ee.t=="n")(Ee.v|0)==Ee.v&&Ee.v>=-32768&&Ee.v<=32767?_e(z,13,m(ae,O,Ee.v)):_e(z,14,p(ae,O,Ee.v));else{var Ve=Gs(Ee);_e(z,15,f(ae,O,Ve.slice(0,239)))}}return _e(z,1),z.end()}function s(F,H){var D=H||{};if(+D.codepage>=0&&ts(+D.codepage),D.type=="string")throw new Error("Cannot write WK3 to JS string");var z=sn();_e(z,0,i(F));for(var B=0,ne=0;B<F.SheetNames.length;++B)(F.Sheets[F.SheetNames[B]]||{})["!ref"]&&_e(z,27,W(F.SheetNames[B],ne++));var U=0;for(B=0;B<F.SheetNames.length;++B){var J=F.Sheets[F.SheetNames[B]];if(!(!J||!J["!ref"])){for(var ae=it(J["!ref"]),q=Array.isArray(J),O=[],be=Math.min(ae.e.r,8191),Ee=ae.s.r;Ee<=be;++Ee)for(var Ve=Xt(Ee),Ue=ae.s.c;Ue<=ae.e.c;++Ue){Ee===ae.s.r&&(O[Ue]=Ft(Ue));var me=O[Ue]+Ve,et=q?(J[Ee]||[])[Ue]:J[me];if(!(!et||et.t=="z"))if(et.t=="n")_e(z,23,V(Ee,Ue,U,et.v));else{var lt=Gs(et);_e(z,22,k(Ee,Ue,U,lt.slice(0,239)))}}++U}}return _e(z,1),z.end()}function a(F){var H=le(2);return H.write_shift(2,F),H}function i(F){var H=le(26);H.write_shift(2,4096),H.write_shift(2,4),H.write_shift(4,0);for(var D=0,z=0,B=0,ne=0;ne<F.SheetNames.length;++ne){var U=F.SheetNames[ne],J=F.Sheets[U];if(!(!J||!J["!ref"])){++B;var ae=an(J["!ref"]);D<ae.e.r&&(D=ae.e.r),z<ae.e.c&&(z=ae.e.c)}}return D>8191&&(D=8191),H.write_shift(2,D),H.write_shift(1,B),H.write_shift(1,z),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(1,1),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(4,0),H}function o(F,H,D){var z={s:{c:0,r:0},e:{c:0,r:0}};return H==8&&D.qpro?(z.s.c=F.read_shift(1),F.l++,z.s.r=F.read_shift(2),z.e.c=F.read_shift(1),F.l++,z.e.r=F.read_shift(2),z):(z.s.c=F.read_shift(2),z.s.r=F.read_shift(2),H==12&&D.qpro&&(F.l+=2),z.e.c=F.read_shift(2),z.e.r=F.read_shift(2),H==12&&D.qpro&&(F.l+=2),z.s.c==65535&&(z.s.c=z.e.c=z.s.r=z.e.r=0),z)}function c(F){var H=le(8);return H.write_shift(2,F.s.c),H.write_shift(2,F.s.r),H.write_shift(2,F.e.c),H.write_shift(2,F.e.r),H}function u(F,H,D){var z=[{c:0,r:0},{t:"n",v:0},0,0];return D.qpro&&D.vers!=20768?(z[0].c=F.read_shift(1),z[3]=F.read_shift(1),z[0].r=F.read_shift(2),F.l+=2):(z[2]=F.read_shift(1),z[0].c=F.read_shift(2),z[0].r=F.read_shift(2)),z}function d(F,H,D){var z=F.l+H,B=u(F,H,D);if(B[1].t="s",D.vers==20768){F.l++;var ne=F.read_shift(1);return B[1].v=F.read_shift(ne,"utf8"),B}return D.qpro&&F.l++,B[1].v=F.read_shift(z-F.l,"cstr"),B}function f(F,H,D){var z=le(7+D.length);z.write_shift(1,255),z.write_shift(2,H),z.write_shift(2,F),z.write_shift(1,39);for(var B=0;B<z.length;++B){var ne=D.charCodeAt(B);z.write_shift(1,ne>=128?95:ne)}return z.write_shift(1,0),z}function h(F,H,D){var z=u(F,H,D);return z[1].v=F.read_shift(2,"i"),z}function m(F,H,D){var z=le(7);return z.write_shift(1,255),z.write_shift(2,H),z.write_shift(2,F),z.write_shift(2,D,"i"),z}function x(F,H,D){var z=u(F,H,D);return z[1].v=F.read_shift(8,"f"),z}function p(F,H,D){var z=le(13);return z.write_shift(1,255),z.write_shift(2,H),z.write_shift(2,F),z.write_shift(8,D,"f"),z}function g(F,H,D){var z=F.l+H,B=u(F,H,D);if(B[1].v=F.read_shift(8,"f"),D.qpro)F.l=z;else{var ne=F.read_shift(2);_(F.slice(F.l,F.l+ne),B),F.l+=ne}return B}function y(F,H,D){var z=H&32768;return H&=-32769,H=(z?F:0)+(H>=8192?H-16384:H),(z?"":"$")+(D?Ft(H):Xt(H))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},v=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function _(F,H){yr(F,0);for(var D=[],z=0,B="",ne="",U="",J="";F.l<F.length;){var ae=F[F.l++];switch(ae){case 0:D.push(F.read_shift(8,"f"));break;case 1:ne=y(H[0].c,F.read_shift(2),!0),B=y(H[0].r,F.read_shift(2),!1),D.push(ne+B);break;case 2:{var q=y(H[0].c,F.read_shift(2),!0),O=y(H[0].r,F.read_shift(2),!1);ne=y(H[0].c,F.read_shift(2),!0),B=y(H[0].r,F.read_shift(2),!1),D.push(q+O+":"+ne+B)}break;case 3:if(F.l<F.length){console.error("WK1 premature formula end");return}break;case 4:D.push("("+D.pop()+")");break;case 5:D.push(F.read_shift(2));break;case 6:{for(var be="";ae=F[F.l++];)be+=String.fromCharCode(ae);D.push('"'+be.replace(/"/g,'""')+'"')}break;case 8:D.push("-"+D.pop());break;case 23:D.push("+"+D.pop());break;case 22:D.push("NOT("+D.pop()+")");break;case 20:case 21:J=D.pop(),U=D.pop(),D.push(["AND","OR"][ae-20]+"("+U+","+J+")");break;default:if(ae<32&&v[ae])J=D.pop(),U=D.pop(),D.push(U+v[ae]+J);else if(w[ae]){if(z=w[ae][1],z==69&&(z=F[F.l++]),z>D.length){console.error("WK1 bad formula parse 0x"+ae.toString(16)+":|"+D.join("|")+"|");return}var Ee=D.slice(-z);D.length-=z,D.push(w[ae][0]+"("+Ee.join(",")+")")}else return ae<=7?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=24?console.error("WK1 unsupported op "+ae.toString(16)):ae<=30?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=115?console.error("WK1 unsupported function opcode "+ae.toString(16)):console.error("WK1 unrecognized opcode "+ae.toString(16))}}D.length==1?H[1].f=""+D[0]:console.error("WK1 bad formula parse |"+D.join("|")+"|")}function S(F){var H=[{c:0,r:0},{t:"n",v:0},0];return H[0].r=F.read_shift(2),H[3]=F[F.l++],H[0].c=F[F.l++],H}function b(F,H){var D=S(F);return D[1].t="s",D[1].v=F.read_shift(H-4,"cstr"),D}function k(F,H,D,z){var B=le(6+z.length);B.write_shift(2,F),B.write_shift(1,D),B.write_shift(1,H),B.write_shift(1,39);for(var ne=0;ne<z.length;++ne){var U=z.charCodeAt(ne);B.write_shift(1,U>=128?95:U)}return B.write_shift(1,0),B}function T(F,H){var D=S(F);D[1].v=F.read_shift(2);var z=D[1].v>>1;if(D[1].v&1)switch(z&7){case 0:z=(z>>3)*5e3;break;case 1:z=(z>>3)*500;break;case 2:z=(z>>3)/20;break;case 3:z=(z>>3)/200;break;case 4:z=(z>>3)/2e3;break;case 5:z=(z>>3)/2e4;break;case 6:z=(z>>3)/16;break;case 7:z=(z>>3)/64;break}return D[1].v=z,D}function j(F,H){var D=S(F),z=F.read_shift(4),B=F.read_shift(4),ne=F.read_shift(2);if(ne==65535)return z===0&&B===3221225472?(D[1].t="e",D[1].v=15):z===0&&B===3489660928?(D[1].t="e",D[1].v=42):D[1].v=0,D;var U=ne&32768;return ne=(ne&32767)-16446,D[1].v=(1-U*2)*(B*Math.pow(2,ne+32)+z*Math.pow(2,ne)),D}function V(F,H,D,z){var B=le(14);if(B.write_shift(2,F),B.write_shift(1,D),B.write_shift(1,H),z==0)return B.write_shift(4,0),B.write_shift(4,0),B.write_shift(2,65535),B;var ne=0,U=0,J=0,ae=0;return z<0&&(ne=1,z=-z),U=Math.log2(z)|0,z/=Math.pow(2,U-31),ae=z>>>0,ae&2147483648||(z/=2,++U,ae=z>>>0),z-=ae,ae|=2147483648,ae>>>=0,z*=Math.pow(2,32),J=z>>>0,B.write_shift(4,J),B.write_shift(4,ae),U+=16383+(ne?32768:0),B.write_shift(2,U),B}function C(F,H){var D=j(F);return F.l+=H-14,D}function R(F,H){var D=S(F),z=F.read_shift(4);return D[1].v=z>>6,D}function X(F,H){var D=S(F),z=F.read_shift(8,"f");return D[1].v=z,D}function G(F,H){var D=X(F);return F.l+=H-10,D}function Y(F,H){return F[F.l+H-1]==0?F.read_shift(H,"cstr"):""}function se(F,H){var D=F[F.l++];D>H-1&&(D=H-1);for(var z="";z.length<D;)z+=String.fromCharCode(F[F.l++]);return z}function ie(F,H,D){if(!(!D.qpro||H<21)){var z=F.read_shift(1);F.l+=17,F.l+=1,F.l+=2;var B=F.read_shift(H-21,"cstr");return[z,B]}}function oe(F,H){for(var D={},z=F.l+H;F.l<z;){var B=F.read_shift(2);if(B==14e3){for(D[B]=[0,""],D[B][0]=F.read_shift(2);F[F.l];)D[B][1]+=String.fromCharCode(F[F.l]),F.l++;F.l++}}return D}function W(F,H){var D=le(5+F.length);D.write_shift(2,14e3),D.write_shift(2,H);for(var z=0;z<F.length;++z){var B=F.charCodeAt(z);D[D.l++]=B>127?95:B}return D[D.l++]=0,D}var ue={0:{n:"BOF",f:Zt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Y},222:{n:"SHEETNAMELP",f:se},65535:{n:""}},ve={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:b},23:{n:"NUMBER17",f:j},24:{n:"NUMBER18",f:T},25:{n:"FORMULA19",f:C},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:oe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:R},38:{n:"??"},39:{n:"NUMBER27",f:X},40:{n:"FORMULA28",f:G},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Y},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ie},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}}();function zL(e){var t={},r=e.match(Br),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=Ke(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=qx[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return t}var WL=function(){var e=Mc("t"),t=Mc("rPr");function r(a){var i=a.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:at(i[1])},c=a.match(t);return c&&(o.s=zL(c[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(s).map(r).filter(function(o){return o.v})}}(),HL=function(){var t=/(\r\n|\n)/g;function r(s,a,i){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),s.b&&(a.push("<b>"),i.push("</b>")),s.i&&(a.push("<i>"),i.push("</i>")),s.strike&&(a.push("<s>"),i.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(a.push("<"+c+">"),i.push("</"+c+">")),i.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),GL=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,KL=/<(?:\w+:)?r>/,XL=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function yg(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=at(pt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=pt(e),r&&(n.h=ag(n.t))):e.match(KL)&&(n.r=pt(e),n.t=at(pt((e.replace(XL,"").match(GL)||[]).join("").replace(Br,""))),r&&(n.h=HL(WL(n.r)))),n):{t:""}}var qL=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,YL=/<(?:\w+:)?(?:si|sstItem)>/g,JL=/<\/(?:\w+:)?(?:si|sstItem)>/;function QL(e,t){var r=[],n="";if(!e)return r;var s=e.match(qL);if(s){n=s[2].replace(YL,"").split(JL);for(var a=0;a!=n.length;++a){var i=yg(n[a].trim(),t);i!=null&&(r[r.length]=i)}s=Ke(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var ZL=/^\s|\s$|[\t\n\r]/;function gN(e,t){if(!t.bookSST)return"";var r=[qt];r[r.length]=we("sst",null,{xmlns:Fi[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],a="<si>";s.r?a+=s.r:(a+="<t",s.t||(s.t=""),s.t.match(ZL)&&(a+=' xml:space="preserve"'),a+=">"+ft(s.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function eM(e){return[e.read_shift(4),e.read_shift(4)]}function tM(e,t){var r=[],n=!1;return Qs(e,function(a,i,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function rM(e,t){return t||(t=le(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var nM=hD;function sM(e){var t=sn();fe(t,159,rM(e));for(var r=0;r<e.length;++r)fe(t,19,nM(e[r]));return fe(t,160),t.end()}function vN(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Ms(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function aM(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Ms(e,4),t.U=Ms(e,4),t.W=Ms(e,4),t}function iM(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},s=e.read_shift(4),a=[];s-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function oM(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(iM(e));return t}function lM(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function cM(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Ms(e,4),t.U=Ms(e,4),t.W=Ms(e,4),t}function uM(e){var t=cM(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function yN(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function wN(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function dM(e){var t=Ms(e);switch(t.Minor){case 2:return[t.Minor,fM(e)];case 3:return[t.Minor,hM()];case 4:return[t.Minor,mM(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function fM(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=yN(e,r),s=wN(e,e.length-e.l);return{t:"Std",h:n,v:s}}function hM(){throw new Error("File is password-protected: ECMA-376 Extensible")}function mM(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Br,function(a){var i=Ke(a);switch(_s(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function pM(e,t){var r={},n=r.EncryptionVersionInfo=Ms(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=yN(e,s),t-=s,r.EncryptionVerifier=wN(e,t),r}function xM(e){var t={},r=t.EncryptionVersionInfo=Ms(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function wg(e){var t=0,r,n=vN(e),s=n.length+1,a,i,o,c,u;for(r=Na(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)i=r[a],o=t&16384?1:0,c=t<<1&32767,u=o|c,t=u^i;return t^52811}var _N=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},s=function(i,o){return n(i^o)},a=function(i){for(var o=t[i.length-1],c=104,u=i.length-1;u>=0;--u)for(var d=i[u],f=0;f!=7;++f)d&64&&(o^=r[c]),d*=2,--c;return o};return function(i){for(var o=vN(i),c=a(o),u=o.length,d=Na(16),f=0;f!=16;++f)d[f]=0;var h,m,x;for((u&1)===1&&(h=c>>8,d[u]=s(e[0],h),--u,h=c&255,m=o[o.length-1],d[u]=s(m,h));u>0;)--u,h=c>>8,d[u]=s(o[u],h),--u,h=c&255,d[u]=s(o[u],h);for(u=15,x=15-o.length;x>0;)h=c>>8,d[u]=s(e[x],h),--u,--x,h=c&255,d[u]=s(o[u],h),--u,--x;return d}}(),gM=function(e,t,r,n,s){s||(s=t),n||(n=_N(e));var a,i;for(a=0;a!=t.length;++a)i=t[a],i^=n[r],i=(i>>5|i<<3)&255,s[a]=i,++r;return[s,r,n]},vM=function(e){var t=0,r=_N(e);return function(n){var s=gM("",n,t,r);return t=s[1],s[0]}};function yM(e,t,r,n){var s={key:Zt(e),verificationBytes:Zt(e)};return r.password&&(s.verifier=wg(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=vM(r.password)),s}function wM(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=xM(e):n.Data=pM(e,t),n}function _M(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?wM(e,t-2,n):yM(e,r.biff>=8?t:t-2,r,n),n}var bN=function(){function e(s,a){switch(a.type){case"base64":return t(kn(s),a);case"binary":return t(s,a);case"buffer":return t(tt&&Buffer.isBuffer(s)?s.toString("binary"):Ia(s),a);case"array":return t(yi(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){var i=a||{},o=i.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,f){Array.isArray(o)&&(o[f]=[]);for(var h=/\\\w+\b/g,m=0,x,p=-1;x=h.exec(d);){switch(x[0]){case"\\cell":var g=d.slice(m,h.lastIndex-x[0].length);if(g[0]==" "&&(g=g.slice(1)),++p,g.length){var y={v:g,t:"s"};Array.isArray(o)?o[f][p]=y:o[Ge({r:f,c:p})]=y}break}m=h.lastIndex}p>u.e.c&&(u.e.c=p)}),o["!ref"]=Ye(u),o}function r(s,a){return La(e(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],i=it(s["!ref"]),o,c=Array.isArray(s),u=i.s.r;u<=i.e.r;++u){a.push("\\trowd\\trautofit1");for(var d=i.s.c;d<=i.e.c;++d)a.push("\\cellx"+(d+1));for(a.push("\\pard\\intbl"),d=i.s.c;d<=i.e.c;++d){var f=Ge({r:u,c:d});o=c?(s[u]||[])[d]:s[f],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(Gs(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function bM(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function $c(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function kM(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.max(t,r,n),a=Math.min(t,r,n),i=s-a;if(i===0)return[0,0,t];var o=0,c=0,u=s+a;switch(c=i/(u>1?2-u:u),s){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,c,u/2]}function SM(e){var t=e[0],r=e[1],n=e[2],s=r*2*(n<.5?n:1-n),a=n-s/2,i=[a,a,a],o=6*t,c;if(r!==0)switch(o|0){case 0:case 6:c=s*o,i[0]+=s,i[1]+=c;break;case 1:c=s*(2-o),i[0]+=c,i[1]+=s;break;case 2:c=s*(o-2),i[1]+=s,i[2]+=c;break;case 3:c=s*(4-o),i[1]+=c,i[2]+=s;break;case 4:c=s*(o-4),i[2]+=s,i[0]+=c;break;case 5:c=s*(6-o),i[2]+=c,i[0]+=s;break}for(var u=0;u!=3;++u)i[u]=Math.round(i[u]*255);return i}function m0(e,t){if(t===0)return e;var r=kM(bM(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),$c(SM(r))}var kN=6,EM=15,NM=1,Or=kN;function zc(e){return Math.floor((e+Math.round(128/Or)/256)*Or)}function Wc(e){return Math.floor((e-5)/Or*100+.5)/100}function p0(e){return Math.round((e*Or+5)/Or*256)/256}function fh(e){return p0(Wc(zc(e)))}function _g(e){var t=Math.abs(e-fh(e)),r=Or;if(t>.005)for(Or=NM;Or<EM;++Or)Math.abs(e-fh(e))<=t&&(t=Math.abs(e-fh(e)),r=Or);Or=r}function Ta(e){e.width?(e.wpx=zc(e.width),e.wch=Wc(e.wpx),e.MDW=Or):e.wpx?(e.wch=Wc(e.wpx),e.width=p0(e.wch),e.MDW=Or):typeof e.wch=="number"&&(e.width=p0(e.wch),e.wpx=zc(e.width),e.MDW=Or),e.customWidth&&delete e.customWidth}var TM=96,SN=TM;function Hc(e){return e*96/SN}function Xo(e){return e*SN/96}var CM={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function jM(e,t,r,n){t.Borders=[];var s={},a=!1;(e[0].match(Br)||[]).forEach(function(i){var o=Ke(i);switch(_s(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=wt(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=wt(o.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function AM(e,t,r,n){t.Fills=[];var s={},a=!1;(e[0].match(Br)||[]).forEach(function(i){var o=Ke(i);switch(_s(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function FM(e,t,r,n){t.Fonts=[];var s={},a=!1;(e[0].match(Br)||[]).forEach(function(i){var o=Ke(i);switch(_s(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=pt(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?wt(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?wt(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?wt(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?wt(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?wt(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?wt(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?wt(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=qx[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=wt(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var c=li[s.color.index];s.color.index==81&&(c=li[1]),c||(c=li[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=m0(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function PM(e,t,r){t.NumberFmt=[];for(var n=$t(He),s=0;s<n.length;++s)t.NumberFmt[n[s]]=He[n[s]];var a=e[0].match(Br);if(a)for(s=0;s<a.length;++s){var i=Ke(a[s]);switch(_s(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=at(pt(i.formatCode)),c=parseInt(i.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=o}Ls(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function RM(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=we("numFmt",null,{numFmtId:n,formatCode:ft(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=we("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Gu=["numFmtId","fillId","fontId","borderId","xfId"],Ku=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function OM(e,t,r){t.CellXf=[];var n,s=!1;(e[0].match(Br)||[]).forEach(function(a){var i=Ke(a),o=0;switch(_s(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<Gu.length;++o)n[Gu[o]]&&(n[Gu[o]]=parseInt(n[Gu[o]],10));for(o=0;o<Ku.length;++o)n[Ku[o]]&&(n[Ku[o]]=wt(n[Ku[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};i.vertical&&(c.vertical=i.vertical),i.horizontal&&(c.horizontal=i.horizontal),i.textRotation!=null&&(c.textRotation=i.textRotation),i.indent&&(c.indent=i.indent),i.wrapText&&(c.wrapText=wt(i.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function DM(e){var t=[];return t[t.length]=we("cellXfs",null),e.forEach(function(r){t[t.length]=we("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=we("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var IM=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,u){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(t))&&PM(f,d,u),(f=o.match(s))&&FM(f,d,c,u),(f=o.match(n))&&AM(f,d,c,u),(f=o.match(a))&&jM(f,d,c,u),(f=o.match(r))&&OM(f,d,u),d}}();function EN(e,t){var r=[qt,we("styleSheet",null,{xmlns:Fi[0],"xmlns:vt":ar.vt})],n;return e.SSF&&(n=RM(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=DM(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function LM(e,t){var r=e.read_shift(2),n=Ir(e);return[r,n]}function MM(e,t,r){r||(r=le(6+4*t.length)),r.write_shift(2,e),dr(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function BM(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=wD(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=yD(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ir(e),n}function UM(e,t){t||(t=le(25+4*32)),t.write_shift(2,e.sz*20),_D(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),d0(e.color,t);var n=0;return n=2,t.write_shift(1,n),dr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var VM=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],hh,$M=Mr;function Lw(e,t){t||(t=le(4*3+8*7+16*1)),hh||(hh=Q0(VM));var r=hh[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(d0({auto:1},t),d0({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function zM(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}function NN(e,t,r){r||(r=le(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function yl(e,t){return t||(t=le(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var WM=Mr;function HM(e,t){return t||(t=le(51)),t.write_shift(1,0),yl(null,t),yl(null,t),yl(null,t),yl(null,t),yl(null,t),t.length>t.l?t.slice(0,t.l):t}function GM(e,t){return t||(t=le(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),u0(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function KM(e,t,r){var n=le(2052);return n.write_shift(4,e),u0(t,n),u0(r,n),n.length>n.l?n.slice(0,n.l):n}function XM(e,t,r){var n={};n.NumberFmt=[];for(var s in He)n.NumberFmt[s]=He[s];n.CellXf=[],n.Fonts=[];var a=[],i=!1;return Qs(e,function(c,u,d){switch(d){case 44:n.NumberFmt[c[0]]=c[1],Ls(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=m0(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:a.push(d),i=!0;break;case 38:a.pop(),i=!1;break;default:if(u.T>0)a.push(d);else if(u.T<0)a.pop();else if(!i||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function qM(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&++r}),r!=0&&(fe(e,615,is(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&fe(e,44,MM(s,t[s]))}),fe(e,616))}}function YM(e){var t=1;fe(e,611,is(t)),fe(e,43,UM({sz:12,color:{theme:1},name:"Calibri",family:2})),fe(e,612)}function JM(e){var t=2;fe(e,603,is(t)),fe(e,45,Lw({patternType:"none"})),fe(e,45,Lw({patternType:"gray125"})),fe(e,604)}function QM(e){var t=1;fe(e,613,is(t)),fe(e,46,HM()),fe(e,614)}function ZM(e){var t=1;fe(e,626,is(t)),fe(e,47,NN({numFmtId:0},65535)),fe(e,627)}function e7(e,t){fe(e,617,is(t.length)),t.forEach(function(r){fe(e,47,NN(r,0))}),fe(e,618)}function t7(e){var t=1;fe(e,619,is(t)),fe(e,48,GM({xfId:0,name:"Normal"})),fe(e,620)}function r7(e){var t=0;fe(e,505,is(t)),fe(e,506)}function n7(e){var t=0;fe(e,508,KM(t,"TableStyleMedium9","PivotStyleMedium4")),fe(e,509)}function s7(e,t){var r=sn();return fe(r,278),qM(r,e.SSF),YM(r),JM(r),QM(r),ZM(r),e7(r,t.cellXfs),t7(r),r7(r),n7(r),fe(r,279),r.end()}var a7=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function i7(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Br)||[]).forEach(function(s){var a=Ke(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[a7.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function o7(){}function l7(){}var c7=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,u7=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,d7=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function f7(e,t,r){t.themeElements={};var n;[["clrScheme",c7,i7],["fontScheme",u7,o7],["fmtScheme",d7,l7]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,t,r)})}var h7=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function TN(e,t){(!e||e.length===0)&&(e=bg());var r,n={};if(!(r=e.match(h7)))throw new Error("themeElements not found in theme");return f7(r[0],n,t),n.raw=e,n}function bg(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[qt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function m7(e,t,r){var n=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var i;try{i=yE(a,{type:"array"})}catch{return}var o=xn(i,"theme/theme/theme1.xml",!0);if(o)return TN(o,r)}}function p7(e){return e.read_shift(4)}function x7(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=g7(e,4);break;case 2:t.xclrValue=iN(e);break;case 3:t.xclrValue=p7(e);break;case 4:e.l+=4;break}return e.l+=8,t}function g7(e,t){return Mr(e,t)}function v7(e,t){return Mr(e,t)}function y7(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=x7(e);break;case 6:n[1]=v7(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function w7(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),a=[];s-- >0;)a.push(y7(e,r-e.l));return{ixfe:n,ext:a}}function _7(e,t){t.forEach(function(r){switch(r[0]){}})}function b7(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ir(e)}}function k7(e){var t=le(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),dr(e.name,t),t.slice(0,t.l)}function S7(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function E7(e){var t=le(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function N7(e,t){var r=le(8+2*t.length);return r.write_shift(4,e),dr(t,r),r.slice(0,r.l)}function T7(e){return e.l+=4,e.read_shift(4)!=0}function C7(e,t){var r=le(8);return r.write_shift(4,e),r.write_shift(4,1),r}function j7(e,t,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],i=!1,o=2;return Qs(e,function(c,u,d){switch(d){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(f){o==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):o==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:a.push(d),i=!0;break;case 36:a.pop(),i=!1;break;default:if(!u.T){if(!i||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function A7(){var e=sn();return fe(e,332),fe(e,334,is(1)),fe(e,335,k7({name:"XLDAPR",version:12e4,flags:3496657072})),fe(e,336),fe(e,339,N7(1,"XLDAPR")),fe(e,52),fe(e,35,is(514)),fe(e,4096,is(0)),fe(e,4097,Dn(1)),fe(e,36),fe(e,53),fe(e,340),fe(e,337,C7(1)),fe(e,51,E7([[1,0]])),fe(e,338),fe(e,333),e.end()}function F7(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,a=2,i;return e.replace(Br,function(o){var c=Ke(o);switch(_s(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(i=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):a==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+c.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function CN(){var e=[qt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function P7(e){var t=[];if(!e)return t;var r=1;return(e.match(Br)||[]).forEach(function(n){var s=Ke(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function R7(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ge(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function O7(e,t,r){var n=[];return Qs(e,function(a,i,o){switch(o){case 63:n.push(a);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function D7(e,t,r,n){if(!e)return e;var s=n||{},a=!1;Qs(e,function(o,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!c.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},s)}function I7(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var yo=1024;function jN(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[we("xml",null,{"xmlns:v":dn.v,"xmlns:o":dn.o,"xmlns:x":dn.x,"xmlns:mv":dn.mv}).replace(/\/>/,">"),we("o:shapelayout",we("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),we("v:shapetype",[we("v:stroke",null,{joinstyle:"miter"}),we("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];yo<e*1e3;)yo+=1e3;return t.forEach(function(a){var i=Pt(a[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?we("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=we("v:fill",c,o),d={on:"t",obscured:"t"};++yo,s=s.concat(["<v:shape"+Bc({id:"_x0000_s"+yo,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,we("v:shadow",null,d),we("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",wr("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),wr("x:AutoFill","False"),wr("x:Row",String(i.r)),wr("x:Column",String(i.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function Mw(e,t,r,n){var s=Array.isArray(e),a;t.forEach(function(i){var o=Pt(i.ref);if(s?(e[o.r]||(e[o.r]=[]),a=e[o.r][o.c]):a=e[i.ref],!a){a={t:"z"},s?e[o.r][o.c]=a:e[i.ref]=a;var c=it(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var u=Ye(c);u!==e["!ref"]&&(e["!ref"]=u)}a.c||(a.c=[]);var d={a:i.author,t:i.t,r:i.r,T:r};i.h&&(d.h=i.h);for(var f=a.c.length-1;f>=0;--f){if(!r&&a.c[f].T)return;r&&!a.c[f].T&&a.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(d.a==n[f].id){d.a=n[f].name||d.a;break}}a.c.push(d)})}function L7(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=Ke(o[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=Pt(c.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var f=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&yg(f[1])||{r:"",t:"",h:""};u.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),u.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=h.h),n.push(u)}}}}),n}function AN(e){var t=[qt,we("comments",null,{xmlns:Fi[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var a=ft(s.a);r.indexOf(a)==-1&&(r.push(a),t.push("<author>"+a+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var s=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(s=r.indexOf(ft(c.a))),a.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),a.length<=1)t.push(wr("t",ft(a[0]||"")));else{for(var i=`Comment:
    `+a[0]+`
`,o=1;o<a.length;++o)i+=`Reply:
    `+a[o]+`
`;t.push(wr("t",ft(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function M7(e,t){var r=[],n=!1,s={},a=0;return e.replace(Br,function(o,c){var u=Ke(o);switch(_s(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=c+o.length;break;case"</text>":s.t=e.slice(a,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function B7(e,t,r){var n=[qt,we("ThreadedComments",null,{xmlns:ar.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var a="";(s[1]||[]).forEach(function(i,o){if(!i.T){delete i.ID;return}i.a&&t.indexOf(i.a)==-1&&t.push(i.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?a=c.id:c.parentId=a,i.ID=c.id,i.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),n.push(we("threadedComment",wr("text",i.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function U7(e,t){var r=[],n=!1;return e.replace(Br,function(a){var i=Ke(a);switch(_s(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return a}),r}function V7(e){var t=[qt,we("personList",null,{xmlns:ar.TCMNT,"xmlns:x":Fi[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(we("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function $7(e){var t={};t.iauthor=e.read_shift(4);var r=Di(e);return t.rfx=r.s,t.ref=Ge(r.s),e.l+=16,t}function z7(e,t){return t==null&&(t=le(36)),t.write_shift(4,e[1].iauthor),al(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var W7=Ir;function H7(e){return dr(e.slice(0,54))}function G7(e,t){var r=[],n=[],s={},a=!1;return Qs(e,function(o,c,u){switch(u){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function K7(e){var t=sn(),r=[];return fe(t,628),fe(t,630),e.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),fe(t,632,H7(s.a)))})}),fe(t,631),fe(t,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var a={s:Pt(n[0]),e:Pt(n[0])};fe(t,635,z7([a,s])),s.t&&s.t.length>0&&fe(t,637,pD(s)),fe(t,636),delete s.iauthor})}),fe(t,634),fe(t,629),t.end()}var X7="application/vnd.ms-office.vbaProject";function q7(e){var t=Le.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Le.utils.cfb_add(t,s,e.FileIndex[n].content)}}),Le.write(t)}function Y7(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Le.utils.cfb_add(e,s,t.FileIndex[n].content)}})}var FN=["xlsb","xlsm","xlam","biff8","xla"];function J7(){return{"!type":"dialog"}}function Q7(){return{"!type":"dialog"}}function Z7(){return{"!type":"macro"}}function e9(){return{"!type":"macro"}}var Ao=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,a,i){var o=!1,c=!1;a.length==0?c=!0:a.charAt(0)=="["&&(c=!0,a=a.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var u=a.length>0?parseInt(a,10)|0:0,d=i.length>0?parseInt(i,10)|0:0;return o?d+=t.c:--d,c?u+=t.r:--u,s+(o?"":"$")+Ft(d)+(c?"":"$")+Xt(u)}return function(s,a){return t=a,s.replace(e,r)}}(),kg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Sg=function(){return function(t,r){return t.replace(kg,function(n,s,a,i,o,c){var u=ug(i)-(a?0:r.c),d=cg(c)-(o?0:r.r),f=d==0?"":o?d+1:"["+d+"]",h=u==0?"":a?u+1:"["+u+"]";return s+"R"+f+"C"+h})}}();function PN(e,t){return e.replace(kg,function(r,n,s,a,i,o){return n+(s=="$"?s+a:Ft(ug(a)+t.c))+(i=="$"?i+o:Xt(cg(o)+t.r))})}function t9(e,t,r){var n=an(t),s=n.s,a=Pt(r),i={r:a.r-s.r,c:a.c-s.c};return PN(e,i)}function r9(e){return e.length!=1}function Bw(e){return e.replace(/_xlfn\./g,"")}function Jt(e){e.l+=1}function Ca(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function RN(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return ON(e);r.biff==12&&(n=4)}var s=e.read_shift(n),a=e.read_shift(n),i=Ca(e),o=Ca(e);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function ON(e){var t=Ca(e),r=Ca(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function n9(e,t,r){if(r.biff<8)return ON(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),a=Ca(e),i=Ca(e);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function DN(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return s9(e);var n=e.read_shift(r&&r.biff==12?4:2),s=Ca(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function s9(e){var t=Ca(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function a9(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function i9(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return o9(e);var s=e.read_shift(n>=12?4:2),a=e.read_shift(2),i=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;s>524287;)s-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:i,rRel:o}}function o9(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function l9(e,t,r){var n=(e[e.l++]&96)>>5,s=RN(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function c9(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var i=RN(e,a,r);return[n,s,i]}function u9(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function d9(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,s]}function f9(e,t,r){var n=(e[e.l++]&96)>>5,s=n9(e,t-1,r);return[n,s]}function h9(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Uw(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function m9(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function p9(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function x9(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function g9(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function v9(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function IN(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function y9(e){return e.read_shift(2),IN(e)}function w9(e){return e.read_shift(2),IN(e)}function _9(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=DN(e,0,r);return[n,s]}function b9(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=i9(e,0,r);return[n,s]}function k9(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=DN(e,0,r);return[n,s,a]}function S9(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[TB[s],BN[s],n]}function E9(e,t,r){var n=e[e.l++],s=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:N9(e);return[s,(a[0]===0?BN:NB)[a[1]]]}function N9(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function T9(e,t,r){e.l+=r&&r.biff==2?3:4}function C9(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function j9(e){return e.l++,Zs[e.read_shift(1)]}function A9(e){return e.l++,e.read_shift(2)}function F9(e){return e.l++,e.read_shift(1)!==0}function P9(e){return e.l++,Dr(e)}function R9(e,t,r){return e.l++,ou(e,t-1,r)}function O9(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Ht(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Zs[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Dr(e);break;case 2:r[1]=Ii(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function D9(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?Di:tf)(e));return s}function I9(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,i=[];a!=n&&(i[a]=[]);++a)for(var o=0;o!=s;++o)i[a][o]=O9(e,r.biff);return i}function L9(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function M9(e,t,r){if(r.biff==5)return B9(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),a=e.read_shift(4);return[n,s,a]}function B9(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function U9(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function V9(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function $9(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function z9(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,s]}var W9=Mr,H9=Mr,G9=Mr;function cu(e,t,r){return e.l+=2,[a9(e)]}function Eg(e){return e.l+=6,[]}var K9=cu,X9=Eg,q9=Eg,Y9=cu;function LN(e){return e.l+=2,[Zt(e),e.read_shift(2)&1]}var J9=cu,Q9=LN,Z9=Eg,eB=cu,tB=cu,rB=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function nB(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),a=e.read_shift(2),i=rB[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:s,C:a}}function sB(e){return e.l+=2,[e.read_shift(4)]}function aB(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function iB(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function oB(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function lB(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function cB(e){return e.l+=4,[0,0]}var Vw={1:{n:"PtgExp",f:C9},2:{n:"PtgTbl",f:G9},3:{n:"PtgAdd",f:Jt},4:{n:"PtgSub",f:Jt},5:{n:"PtgMul",f:Jt},6:{n:"PtgDiv",f:Jt},7:{n:"PtgPower",f:Jt},8:{n:"PtgConcat",f:Jt},9:{n:"PtgLt",f:Jt},10:{n:"PtgLe",f:Jt},11:{n:"PtgEq",f:Jt},12:{n:"PtgGe",f:Jt},13:{n:"PtgGt",f:Jt},14:{n:"PtgNe",f:Jt},15:{n:"PtgIsect",f:Jt},16:{n:"PtgUnion",f:Jt},17:{n:"PtgRange",f:Jt},18:{n:"PtgUplus",f:Jt},19:{n:"PtgUminus",f:Jt},20:{n:"PtgPercent",f:Jt},21:{n:"PtgParen",f:Jt},22:{n:"PtgMissArg",f:Jt},23:{n:"PtgStr",f:R9},26:{n:"PtgSheet",f:aB},27:{n:"PtgEndSheet",f:iB},28:{n:"PtgErr",f:j9},29:{n:"PtgBool",f:F9},30:{n:"PtgInt",f:A9},31:{n:"PtgNum",f:P9},32:{n:"PtgArray",f:h9},33:{n:"PtgFunc",f:S9},34:{n:"PtgFuncVar",f:E9},35:{n:"PtgName",f:L9},36:{n:"PtgRef",f:_9},37:{n:"PtgArea",f:l9},38:{n:"PtgMemArea",f:U9},39:{n:"PtgMemErr",f:W9},40:{n:"PtgMemNoMem",f:H9},41:{n:"PtgMemFunc",f:V9},42:{n:"PtgRefErr",f:$9},43:{n:"PtgAreaErr",f:u9},44:{n:"PtgRefN",f:b9},45:{n:"PtgAreaN",f:f9},46:{n:"PtgMemAreaN",f:oB},47:{n:"PtgMemNoMemN",f:lB},57:{n:"PtgNameX",f:M9},58:{n:"PtgRef3d",f:k9},59:{n:"PtgArea3d",f:c9},60:{n:"PtgRefErr3d",f:z9},61:{n:"PtgAreaErr3d",f:d9},255:{}},uB={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},dB={1:{n:"PtgElfLel",f:LN},2:{n:"PtgElfRw",f:eB},3:{n:"PtgElfCol",f:K9},6:{n:"PtgElfRwV",f:tB},7:{n:"PtgElfColV",f:Y9},10:{n:"PtgElfRadical",f:J9},11:{n:"PtgElfRadicalS",f:Z9},13:{n:"PtgElfColS",f:X9},15:{n:"PtgElfColSV",f:q9},16:{n:"PtgElfRadicalLel",f:Q9},25:{n:"PtgList",f:nB},29:{n:"PtgSxName",f:sB},255:{}},fB={0:{n:"PtgAttrNoop",f:cB},1:{n:"PtgAttrSemi",f:v9},2:{n:"PtgAttrIf",f:x9},4:{n:"PtgAttrChoose",f:m9},8:{n:"PtgAttrGoto",f:p9},16:{n:"PtgAttrSum",f:T9},32:{n:"PtgAttrBaxcel",f:Uw},33:{n:"PtgAttrBaxcel",f:Uw},64:{n:"PtgAttrSpace",f:y9},65:{n:"PtgAttrSpaceSemi",f:w9},128:{n:"PtgAttrIfError",f:g9},255:{}};function uu(e,t,r,n){if(n.biff<8)return Mr(e,t);for(var s=e.l+t,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=I9(e,0,n),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=D9(e,r[i][1],n),a.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=s-e.l,t!==0&&a.push(Mr(e,t)),a}function du(e,t,r){for(var n=e.l+t,s,a,i=[];n!=e.l;)t=n-e.l,a=e[e.l],s=Vw[a]||Vw[uB[a]],(a===24||a===25)&&(s=(a===24?dB:fB)[e[e.l+1]]),!s||!s.f?Mr(e,t):i.push([s.n,s.f(e,t,r)]);return i}function hB(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],a=0;a<n.length;++a){var i=n[a];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var mB={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function pB(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function MN(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function $w(e,t,r){var n=MN(e,t,r);return n=="#REF"?n:pB(n,r)}function Pr(e,t,r,n,s){var a=s&&s.biff||8,i={s:{c:0,r:0}},o=[],c,u,d,f=0,h=0,m,x="";if(!e[0]||!e[0][0])return"";for(var p=-1,g="",y=0,w=e[0].length;y<w;++y){var v=e[0][y];switch(v[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),u=o.pop(),p>=0){switch(e[0][p][1][0]){case 0:g=Ut(" ",e[0][p][1][1]);break;case 1:g=Ut("\r",e[0][p][1][1]);break;default:if(g="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}u=u+g,p=-1}o.push(u+mB[v[0]]+c);break;case"PtgIsect":c=o.pop(),u=o.pop(),o.push(u+" "+c);break;case"PtgUnion":c=o.pop(),u=o.pop(),o.push(u+","+c);break;case"PtgRange":c=o.pop(),u=o.pop(),o.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Yl(v[1][1],i,s),o.push(Jl(d,a));break;case"PtgRefN":d=r?Yl(v[1][1],r,s):v[1][1],o.push(Jl(d,a));break;case"PtgRef3d":f=v[1][1],d=Yl(v[1][2],i,s),x=$w(n,f,s),o.push(x+"!"+Jl(d,a));break;case"PtgFunc":case"PtgFuncVar":var _=v[1][0],S=v[1][1];_||(_=0),_&=127;var b=_==0?[]:o.slice(-_);o.length-=_,S==="User"&&(S=b.shift()),o.push(S+"("+b.join(",")+")");break;case"PtgBool":o.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(v[1]);break;case"PtgNum":o.push(String(v[1]));break;case"PtgStr":o.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(v[1]);break;case"PtgAreaN":m=gw(v[1][1],r?{s:r}:i,s),o.push(ch(m,s));break;case"PtgArea":m=gw(v[1][1],i,s),o.push(ch(m,s));break;case"PtgArea3d":f=v[1][1],m=v[1][2],x=$w(n,f,s),o.push(x+"!"+ch(m,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=v[1][2];var k=(n.names||[])[h-1]||(n[0]||[])[h],T=k?k.Name:"SH33TJSNAME"+String(h);T&&T.slice(0,6)=="_xlfn."&&!s.xlfn&&(T=T.slice(6)),o.push(T);break;case"PtgNameX":var j=v[1][1];h=v[1][2];var V;if(s.biff<=5)j<0&&(j=-j),n[j]&&(V=n[j][h]);else{var C="";if(((n[j]||[])[0]||[])[0]==14849||(((n[j]||[])[0]||[])[0]==1025?n[j][h]&&n[j][h].itab>0&&(C=n.SheetNames[n[j][h].itab-1]+"!"):C=n.SheetNames[h-1]+"!"),n[j]&&n[j][h])C+=n[j][h].Name;else if(n[0]&&n[0][h])C+=n[0][h].Name;else{var R=(MN(n,j,s)||"").split(";;");R[h-1]?C=R[h-1]:C+="SH33TJSERRX"}o.push(C);break}V||(V={Name:"SH33TJSERRY"}),o.push(V.Name);break;case"PtgParen":var X="(",G=")";if(p>=0){switch(g="",e[0][p][1][0]){case 2:X=Ut(" ",e[0][p][1][1])+X;break;case 3:X=Ut("\r",e[0][p][1][1])+X;break;case 4:G=Ut(" ",e[0][p][1][1])+G;break;case 5:G=Ut("\r",e[0][p][1][1])+G;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}o.push(X+o.pop()+G);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:v[1][1],r:v[1][0]};var Y={c:r.c,r:r.r};if(n.sharedf[Ge(d)]){var se=n.sharedf[Ge(d)];o.push(Pr(se,i,Y,n,s))}else{var ie=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){o.push(Pr(u[1],i,Y,n,s)),ie=!0;break}ie||o.push(v[1])}break;case"PtgArray":o.push("{"+hB(v[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(v));default:throw new Error("Unrecognized Formula Token: "+String(v))}var oe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&p>=0&&oe.indexOf(e[0][y][0])==-1){v=e[0][p];var W=!0;switch(v[1][0]){case 4:W=!1;case 0:g=Ut(" ",v[1][1]);break;case 5:W=!1;case 1:g=Ut("\r",v[1][1]);break;default:if(g="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}o.push((W?g:"")+o.pop()+(W?"":g)),p=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function xB(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],Mr(e,t-2)];var o=du(e,i,r);return t!==i+s&&(a=uu(e,t-i-s,o,r)),e.l=n,[o,a]}function gB(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],Mr(e,t-2)];var o=du(e,i,r);return t!==i+s&&(a=uu(e,t-i-s,o,r)),e.l=n,[o,a]}function vB(e,t,r,n){var s=e.l+t,a=du(e,n,r),i;return s!==e.l&&(i=uu(e,s-e.l,a,r)),[a,i]}function yB(e,t,r){var n=e.l+t,s,a=e.read_shift(2),i=du(e,a,r);return a==65535?[[],Mr(e,t-2)]:(t!==a+2&&(s=uu(e,n-a-2,i,r)),[i,s])}function wB(e){var t;if(Ps(e,e.l+6)!==65535)return[Dr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function _B(e){if(e==null){var t=le(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return wi(e);return wi(0)}function mh(e,t,r){var n=e.l+t,s=bs(e);r.biff==2&&++e.l;var a=wB(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=gB(e,n-e.l,r);return{cell:s,val:a[0],formula:o,shared:i>>3&1,tt:a[1]}}function bB(e,t,r,n,s){var a=bi(t,r,s),i=_B(e.v),o=le(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var u=le(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var f=ur([a,i,o,u]);return f}function rf(e,t,r){var n=e.read_shift(4),s=du(e,n,r),a=e.read_shift(4),i=a>0?uu(e,a,s,r):null;return[s,i]}var kB=rf,nf=rf,SB=rf,EB=rf,NB={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},BN={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},TB={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function zw(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function CB(e){var t="of:="+e.replace(kg,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function ph(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function jB(e){return e.replace(/\./,"!")}var Zl={},Fo={},ec=typeof Map<"u";function Ng(e,t,r){var n=0,s=e.length;if(r){if(ec?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var a=ec?r.get(t):r[t];n<a.length;++n)if(e[a[n]].t===t)return e.Count++,a[n]}}else for(;n<s;++n)if(e[n].t===t)return e.Count++,n;return e[s]={t},e.Count++,e.Unique++,r&&(ec?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function sf(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Or=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Wc(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=p0(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function di(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Ma(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],s=60,a=e.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){Ls(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=n=s;break}}for(s=0;s!=a;++s)if(e[s].numFmtId===n)return s;return e[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function UN(e,t,r,n,s,a){try{n.cellNF&&(e.z=He[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=bt(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(He[t]==null&&Ls(NO[t]||"General",t),e.t==="e")e.w=e.w||Zs[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Lc(e.v);else if(e.t==="d"){var i=or(e.v);(i|0)===i?e.w=i.toString(10):e.w=Lc(i)}else{if(e.v===void 0)return"";e.w=vi(e.v,Fo)}else e.t==="d"?e.w=Wn(t,or(e.v),Fo):e.w=Wn(t,e.v,Fo)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=m0(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=m0(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function AB(e,t,r){if(e&&e["!ref"]){var n=it(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function FB(e,t){var r=it(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Ye(r))}var PB=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,RB=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,OB=/<(?:\w:)?hyperlink [^>]*>/mg,DB=/"(\w*:\w*)"/,IB=/<(?:\w:)?col\b[^>]*[\/]?>/g,LB=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,MB=/<(?:\w:)?pageMargins[^>]*\/>/g,VN=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,BB=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,UB=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function VB(e,t,r,n,s,a,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",f=e.match(RB);f?(u=e.slice(0,f.index),d=e.slice(f.index+f[0].length)):u=d=e;var h=u.match(VN);h?Tg(h[0],o,s,r):(h=u.match(BB))&&zB(h[0],h[1]||"",o,s,r);var m=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var x=u.slice(m,m+50).match(DB);x&&FB(o,x[1])}var p=u.match(UB);p&&p[1]&&rU(p[1],s);var g=[];if(t.cellStyles){var y=u.match(IB);y&&JB(g,y)}f&&aU(f[1],o,t,c,a,i);var w=d.match(LB);w&&(o["!autofilter"]=ZB(w[0]));var v=[],_=d.match(PB);if(_)for(m=0;m!=_.length;++m)v[m]=it(_[m].slice(_[m].indexOf('"')+1));var S=d.match(OB);S&&XB(o,S,n);var b=d.match(MB);if(b&&(o["!margins"]=qB(Ke(b[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=Ye(c)),t.sheetRows>0&&o["!ref"]){var k=it(o["!ref"]);t.sheetRows<=+k.e.r&&(k.e.r=t.sheetRows-1,k.e.r>c.e.r&&(k.e.r=c.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>c.e.c&&(k.e.c=c.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ye(k))}return g.length>0&&(o["!cols"]=g),v.length>0&&(o["!merges"]=v),o}function $B(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Ye(e[r])+'"/>';return t+"</mergeCells>"}function Tg(e,t,r,n){var s=Ke(e);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=at(pt(s.codeName)))}function zB(e,t,r,n,s){Tg(e.slice(0,e.indexOf(">")),r,n,s)}function WB(e,t,r,n,s){var a=!1,i={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}a=!0,i.codeName=xs(ft(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+we("outlinePr",null,u)}!a&&!o||(s[s.length]=we("sheetPr",o,i))}var HB=["objects","scenarios","selectLockedCells","selectUnlockedCells"],GB=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function KB(e){var t={sheet:1};return HB.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),GB.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=wg(e.password).toString(16).toUpperCase()),we("sheetProtection",null,t)}function XB(e,t,r){for(var n=Array.isArray(e),s=0;s!=t.length;++s){var a=Ke(pt(t[s]),!0);if(!a.ref)return;var i=((r||{})["!id"]||[])[a.id];i?(a.Target=i.Target,a.location&&(a.Target+="#"+at(a.location))):(a.Target="#"+at(a.location),i={Target:a.Target,TargetMode:"Internal"}),a.Rel=i,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=it(a.ref),c=o.s.r;c<=o.e.r;++c)for(var u=o.s.c;u<=o.e.c;++u){var d=Ge({c:u,r:c});n?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=a):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=a)}}}function qB(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function YB(e){return di(e),we("pageMargins",null,e)}function JB(e,t){for(var r=!1,n=0;n!=t.length;++n){var s=Ke(t[n],!0);s.hidden&&(s.hidden=wt(s.hidden));var a=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,_g(s.width)),Ta(s);a<=i;)e[a++]=kt(s)}}function QB(e,t){for(var r=["<cols>"],n,s=0;s!=t.length;++s)(n=t[s])&&(r[r.length]=we("col",null,sf(s,n)));return r[r.length]="</cols>",r.join("")}function ZB(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function eU(e,t,r,n){var s=typeof e.ref=="string"?e.ref:Ye(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,i=an(s);i.s.r==i.e.r&&(i.e.r=an(t["!ref"]).e.r,s=Ye(i));for(var o=0;o<a.length;++o){var c=a[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return o==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),we("autoFilter",null,{ref:s})}var tU=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function rU(e,t){t.Views||(t.Views=[{}]),(e.match(tU)||[]).forEach(function(r,n){var s=Ke(r);t.Views[n]||(t.Views[n]={}),+s.zoomScale&&(t.Views[n].zoom=+s.zoomScale),wt(s.rightToLeft)&&(t.Views[n].RTL=!0)})}function nU(e,t,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),we("sheetViews",we("sheetView",null,s),{})}function sU(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",a=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=Zs[e.v];break;case"d":n&&n.cellDates?s=bt(e.v,-1).toISOString():(e=kt(e),e.t="n",s=""+(e.v=or(bt(e.v)))),typeof e.z>"u"&&(e.z=He[14]);break;default:s=e.v;break}var o=wr("v",ft(s)),c={r:t},u=Ma(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=wr("v",""+Ng(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=a&&(e.t=a,e.v=i),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=we("f",ft(e.f),d)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),we("c",o,c)}var aU=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=Mc("v"),i=Mc("f");return function(c,u,d,f,h,m){for(var x=0,p="",g=[],y=[],w=0,v=0,_=0,S="",b,k,T=0,j=0,V,C,R=0,X=0,G=Array.isArray(m.CellXf),Y,se=[],ie=[],oe=Array.isArray(u),W=[],ue={},ve=!1,F=!!d.sheetStubs,H=c.split(t),D=0,z=H.length;D!=z;++D){p=H[D].trim();var B=p.length;if(B!==0){var ne=0;e:for(x=0;x<B;++x)switch(p[x]){case">":if(p[x-1]!="/"){++x;break e}if(d&&d.cellStyles){if(k=Ke(p.slice(ne,x),!0),T=k.r!=null?parseInt(k.r,10):T+1,j=-1,d.sheetRows&&d.sheetRows<T)continue;ue={},ve=!1,k.ht&&(ve=!0,ue.hpt=parseFloat(k.ht),ue.hpx=Xo(ue.hpt)),k.hidden=="1"&&(ve=!0,ue.hidden=!0),k.outlineLevel!=null&&(ve=!0,ue.level=+k.outlineLevel),ve&&(W[T-1]=ue)}break;case"<":ne=x;break}if(ne>=x)break;if(k=Ke(p.slice(ne,x),!0),T=k.r!=null?parseInt(k.r,10):T+1,j=-1,!(d.sheetRows&&d.sheetRows<T)){f.s.r>T-1&&(f.s.r=T-1),f.e.r<T-1&&(f.e.r=T-1),d&&d.cellStyles&&(ue={},ve=!1,k.ht&&(ve=!0,ue.hpt=parseFloat(k.ht),ue.hpx=Xo(ue.hpt)),k.hidden=="1"&&(ve=!0,ue.hidden=!0),k.outlineLevel!=null&&(ve=!0,ue.level=+k.outlineLevel),ve&&(W[T-1]=ue)),g=p.slice(x).split(e);for(var U=0;U!=g.length&&g[U].trim().charAt(0)=="<";++U);for(g=g.slice(U),x=0;x!=g.length;++x)if(p=g[x].trim(),p.length!==0){if(y=p.match(r),w=x,v=0,_=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,y!=null&&y.length===2){for(w=0,S=y[1],v=0;v!=S.length&&!((_=S.charCodeAt(v)-64)<1||_>26);++v)w=26*w+_;--w,j=w}else++j;for(v=0;v!=p.length&&p.charCodeAt(v)!==62;++v);if(++v,k=Ke(p.slice(0,v),!0),k.r||(k.r=Ge({r:T-1,c:j})),S=p.slice(v),b={t:""},(y=S.match(a))!=null&&y[1]!==""&&(b.v=at(y[1])),d.cellFormula){if((y=S.match(i))!=null&&y[1]!==""){if(b.f=at(pt(y[1])).replace(/\r\n/g,`
`),d.xlfn||(b.f=Bw(b.f)),y[0].indexOf('t="array"')>-1)b.F=(S.match(s)||[])[1],b.F.indexOf(":")>-1&&se.push([it(b.F),b.F]);else if(y[0].indexOf('t="shared"')>-1){C=Ke(y[0]);var J=at(pt(y[1]));d.xlfn||(J=Bw(J)),ie[parseInt(C.si,10)]=[C,J,k.r]}}else(y=S.match(/<f[^>]*\/>/))&&(C=Ke(y[0]),ie[C.si]&&(b.f=t9(ie[C.si][1],ie[C.si][2],k.r)));var ae=Pt(k.r);for(v=0;v<se.length;++v)ae.r>=se[v][0].s.r&&ae.r<=se[v][0].e.r&&ae.c>=se[v][0].s.c&&ae.c<=se[v][0].e.c&&(b.F=se[v][1])}if(k.t==null&&b.v===void 0)if(b.f||b.F)b.v=0,b.t="n";else if(F)b.t="z";else continue;else b.t=k.t||"n";switch(f.s.c>j&&(f.s.c=j),f.e.c<j&&(f.e.c=j),b.t){case"n":if(b.v==""||b.v==null){if(!F)continue;b.t="z"}else b.v=parseFloat(b.v);break;case"s":if(typeof b.v>"u"){if(!F)continue;b.t="z"}else V=Zl[parseInt(b.v,10)],b.v=V.t,b.r=V.r,d.cellHTML&&(b.h=V.h);break;case"str":b.t="s",b.v=b.v!=null?pt(b.v):"",d.cellHTML&&(b.h=ag(b.v));break;case"inlineStr":y=S.match(n),b.t="s",y!=null&&(V=yg(y[1]))?(b.v=V.t,d.cellHTML&&(b.h=V.h)):b.v="";break;case"b":b.v=wt(b.v);break;case"d":d.cellDates?b.v=bt(b.v,1):(b.v=or(bt(b.v,1)),b.t="n");break;case"e":(!d||d.cellText!==!1)&&(b.w=b.v),b.v=zE[b.v];break}if(R=X=0,Y=null,G&&k.s!==void 0&&(Y=m.CellXf[k.s],Y!=null&&(Y.numFmtId!=null&&(R=Y.numFmtId),d.cellStyles&&Y.fillId!=null&&(X=Y.fillId))),UN(b,R,X,d,h,m),d.cellDates&&G&&b.t=="n"&&rl(He[R])&&(b.t="d",b.v=ef(b.v)),k.cm&&d.xlmeta){var q=(d.xlmeta.Cell||[])[+k.cm-1];q&&q.type=="XLDAPR"&&(b.D=!0)}if(oe){var O=Pt(k.r);u[O.r]||(u[O.r]=[]),u[O.r][O.c]=b}else u[k.r]=b}}}}W.length>0&&(u["!rows"]=W)}}();function iU(e,t,r,n){var s=[],a=[],i=it(e["!ref"]),o="",c,u="",d=[],f=0,h=0,m=e["!rows"],x=Array.isArray(e),p={r:u},g,y=-1;for(h=i.s.c;h<=i.e.c;++h)d[h]=Ft(h);for(f=i.s.r;f<=i.e.r;++f){for(a=[],u=Xt(f),h=i.s.c;h<=i.e.c;++h){c=d[h]+u;var w=x?(e[f]||[])[h]:e[c];w!==void 0&&(o=sU(w,c,e,t))!=null&&a.push(o)}(a.length>0||m&&m[f])&&(p={r:u},m&&m[f]&&(g=m[f],g.hidden&&(p.hidden=1),y=-1,g.hpx?y=Hc(g.hpx):g.hpt&&(y=g.hpt),y>-1&&(p.ht=y,p.customHeight=1),g.level&&(p.outlineLevel=g.level)),s[s.length]=we("row",a.join(""),p))}if(m)for(;f<m.length;++f)m&&m[f]&&(p={r:f+1},g=m[f],g.hidden&&(p.hidden=1),y=-1,g.hpx?y=Hc(g.hpx):g.hpt&&(y=g.hpt),y>-1&&(p.ht=y,p.customHeight=1),g.level&&(p.outlineLevel=g.level),s[s.length]=we("row","",p));return s.join("")}function $N(e,t,r,n){var s=[qt,we("worksheet",null,{xmlns:Fi[0],"xmlns:r":ar.r})],a=r.SheetNames[e],i=0,o="",c=r.Sheets[a];c==null&&(c={});var u=c["!ref"]||"A1",d=it(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=Ye(d)}n||(n={}),c["!comments"]=[];var f=[];WB(c,r,e,t,s),s[s.length]=we("dimension",null,{ref:u}),s[s.length]=nU(c,t,e,r),t.sheetFormat&&(s[s.length]=we("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=QB(c,c["!cols"])),s[i=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=iU(c,t),o.length>0&&(s[s.length]=o)),s.length>i+1&&(s[s.length]="</sheetData>",s[i]=s[i].replace("/>",">")),c["!protect"]&&(s[s.length]=KB(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=eU(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=$B(c["!merges"]));var h=-1,m,x=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(p){p[1].Target&&(m={ref:p[0]},p[1].Target.charAt(0)!="#"&&(x=dt(n,-1,ft(p[1].Target).replace(/#.*$/,""),rt.HLINK),m["r:id"]="rId"+x),(h=p[1].Target.indexOf("#"))>-1&&(m.location=ft(p[1].Target.slice(h+1))),p[1].Tooltip&&(m.tooltip=ft(p[1].Tooltip)),s[s.length]=we("hyperlink",null,m))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=YB(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=wr("ignoredErrors",we("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(x=dt(n,-1,"../drawings/drawing"+(e+1)+".xml",rt.DRAW),s[s.length]=we("drawing",null,{"r:id":"rId"+x}),c["!drawing"]=f),c["!comments"].length>0&&(x=dt(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",rt.VML),s[s.length]=we("legacyDrawing",null,{"r:id":"rId"+x}),c["!legacy"]=x),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function oU(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}function lU(e,t,r){var n=le(145),s=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var a=320;s.hpx?a=Hc(s.hpx)*20:s.hpt&&(a=s.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var i=0;s.level&&(i|=s.level),s.hidden&&(i|=16),(s.hpx||s.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var f=-1,h=-1,m=d<<10;m<d+1<<10;++m){u.c=m;var x=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Ge(u)];x&&(f<0&&(f=m),h=m)}f<0||(++o,n.write_shift(4,f),n.write_shift(4,h))}var p=n.l;return n.l=c,n.write_shift(4,o),n.l=p,n.length>n.l?n.slice(0,n.l):n}function cU(e,t,r,n){var s=lU(n,r,t);(s.length>17||(t["!rows"]||[])[n])&&fe(e,0,s)}var uU=Di,dU=al;function fU(){}function hU(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=xD(e),r}function mU(e,t,r){r==null&&(r=le(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return d0({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),ME(e,r),r.slice(0,r.l)}function pU(e){var t=Hn(e);return[t]}function xU(e,t,r){return r==null&&(r=le(8)),Pi(t,r)}function gU(e){var t=Ri(e);return[t]}function vU(e,t,r){return r==null&&(r=le(4)),Oi(t,r)}function yU(e){var t=Hn(e),r=e.read_shift(1);return[t,r,"b"]}function wU(e,t,r){return r==null&&(r=le(9)),Pi(t,r),r.write_shift(1,e.v?1:0),r}function _U(e){var t=Ri(e),r=e.read_shift(1);return[t,r,"b"]}function bU(e,t,r){return r==null&&(r=le(5)),Oi(t,r),r.write_shift(1,e.v?1:0),r}function kU(e){var t=Hn(e),r=e.read_shift(1);return[t,r,"e"]}function SU(e,t,r){return r==null&&(r=le(9)),Pi(t,r),r.write_shift(1,e.v),r}function EU(e){var t=Ri(e),r=e.read_shift(1);return[t,r,"e"]}function NU(e,t,r){return r==null&&(r=le(8)),Oi(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function TU(e){var t=Hn(e),r=e.read_shift(4);return[t,r,"s"]}function CU(e,t,r){return r==null&&(r=le(12)),Pi(t,r),r.write_shift(4,t.v),r}function jU(e){var t=Ri(e),r=e.read_shift(4);return[t,r,"s"]}function AU(e,t,r){return r==null&&(r=le(8)),Oi(t,r),r.write_shift(4,t.v),r}function FU(e){var t=Hn(e),r=Dr(e);return[t,r,"n"]}function PU(e,t,r){return r==null&&(r=le(16)),Pi(t,r),wi(e.v,r),r}function zN(e){var t=Ri(e),r=Dr(e);return[t,r,"n"]}function RU(e,t,r){return r==null&&(r=le(12)),Oi(t,r),wi(e.v,r),r}function OU(e){var t=Hn(e),r=mg(e);return[t,r,"n"]}function DU(e,t,r){return r==null&&(r=le(12)),Pi(t,r),BE(e.v,r),r}function IU(e){var t=Ri(e),r=mg(e);return[t,r,"n"]}function LU(e,t,r){return r==null&&(r=le(8)),Oi(t,r),BE(e.v,r),r}function MU(e){var t=Hn(e),r=dg(e);return[t,r,"is"]}function BU(e){var t=Hn(e),r=Ir(e);return[t,r,"str"]}function UU(e,t,r){return r==null&&(r=le(12+4*e.v.length)),Pi(t,r),dr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function VU(e){var t=Ri(e),r=Ir(e);return[t,r,"str"]}function $U(e,t,r){return r==null&&(r=le(8+4*e.v.length)),Oi(t,r),dr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function zU(e,t,r){var n=e.l+t,s=Hn(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"b"];if(r.cellFormula){e.l+=2;var o=nf(e,n-e.l,r);i[3]=Pr(o,null,s,r.supbooks,r)}else e.l=n;return i}function WU(e,t,r){var n=e.l+t,s=Hn(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"e"];if(r.cellFormula){e.l+=2;var o=nf(e,n-e.l,r);i[3]=Pr(o,null,s,r.supbooks,r)}else e.l=n;return i}function HU(e,t,r){var n=e.l+t,s=Hn(e);s.r=r["!row"];var a=Dr(e),i=[s,a,"n"];if(r.cellFormula){e.l+=2;var o=nf(e,n-e.l,r);i[3]=Pr(o,null,s,r.supbooks,r)}else e.l=n;return i}function GU(e,t,r){var n=e.l+t,s=Hn(e);s.r=r["!row"];var a=Ir(e),i=[s,a,"str"];if(r.cellFormula){e.l+=2;var o=nf(e,n-e.l,r);i[3]=Pr(o,null,s,r.supbooks,r)}else e.l=n;return i}var KU=Di,XU=al;function qU(e,t){return t==null&&(t=le(4)),t.write_shift(4,e),t}function YU(e,t){var r=e.l+t,n=Di(e),s=fg(e),a=Ir(e),i=Ir(e),o=Ir(e);e.l=r;var c={rfx:n,relId:s,loc:a,display:o};return i&&(c.Tooltip=i),c}function JU(e,t){var r=le(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));al({s:Pt(e[0]),e:Pt(e[0])},r),hg("rId"+t,r);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return dr(s||"",r),dr(e[1].Tooltip||"",r),dr("",r),r.slice(0,r.l)}function QU(){}function ZU(e,t,r){var n=e.l+t,s=UE(e),a=e.read_shift(1),i=[s];if(i[2]=a,r.cellFormula){var o=kB(e,n-e.l,r);i[1]=o}else e.l=n;return i}function eV(e,t,r){var n=e.l+t,s=Di(e),a=[s];if(r.cellFormula){var i=EB(e,n-e.l,r);a[1]=i,e.l=n}else e.l=n;return a}function tV(e,t,r){r==null&&(r=le(18));var n=sf(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var WN=["left","right","top","bottom","header","footer"];function rV(e){var t={};return WN.forEach(function(r){t[r]=Dr(e)}),t}function nV(e,t){return t==null&&(t=le(6*8)),di(e),WN.forEach(function(r){wi(e[r],t)}),t}function sV(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function aV(e,t,r){r==null&&(r=le(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function iV(e){var t=le(24);return t.write_shift(4,4),t.write_shift(4,1),al(e,t),t}function oV(e,t){return t==null&&(t=le(16*4+2)),t.write_shift(2,e.password?wg(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function lV(){}function cV(){}function uV(e,t,r,n,s,a,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var c=o.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,m,x,p,g,y,w,v,_,S,b=[];o.biff=12,o["!row"]=0;var k=0,T=!1,j=[],V={},C=o.supbooks||s.supbooks||[[]];if(C.sharedf=V,C.arrayf=j,C.SheetNames=s.SheetNames||s.Sheets.map(function(oe){return oe.name}),!o.supbooks&&(o.supbooks=C,s.Names))for(var R=0;R<s.Names.length;++R)C[0][R+1]=s.Names[R];var X=[],G=[],Y=!1;Gc[16]={n:"BrtShortReal",f:zN};var se;if(Qs(e,function(W,ue,ve){if(!h)switch(ve){case 148:u=W;break;case 0:m=W,o.sheetRows&&o.sheetRows<=m.r&&(h=!0),_=Xt(g=m.r),o["!row"]=m.r,(W.hidden||W.hpt||W.level!=null)&&(W.hpt&&(W.hpx=Xo(W.hpt)),G[W.r]=W);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:W[2]},W[2]){case"n":x.v=W[1];break;case"s":v=Zl[W[1]],x.v=v.t,x.r=v.r;break;case"b":x.v=!!W[1];break;case"e":x.v=W[1],o.cellText!==!1&&(x.w=Zs[x.v]);break;case"str":x.t="s",x.v=W[1];break;case"is":x.t="s",x.v=W[1].t;break}if((p=i.CellXf[W[0].iStyleRef])&&UN(x,p.numFmtId,null,o,a,i),y=W[0].c==-1?y+1:W[0].c,o.dense?(c[g]||(c[g]=[]),c[g][y]=x):c[Ft(y)+_]=x,o.cellFormula){for(T=!1,k=0;k<j.length;++k){var F=j[k];m.r>=F[0].s.r&&m.r<=F[0].e.r&&y>=F[0].s.c&&y<=F[0].e.c&&(x.F=Ye(F[0]),T=!0)}!T&&W.length>3&&(x.f=W[3])}if(d.s.r>m.r&&(d.s.r=m.r),d.s.c>y&&(d.s.c=y),d.e.r<m.r&&(d.e.r=m.r),d.e.c<y&&(d.e.c=y),o.cellDates&&p&&x.t=="n"&&rl(He[p.numFmtId])){var H=ni(x.v);H&&(x.t="d",x.v=new Date(H.y,H.m-1,H.d,H.H,H.M,H.S,H.u))}se&&(se.type=="XLDAPR"&&(x.D=!0),se=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;x={t:"z",v:void 0},y=W[0].c==-1?y+1:W[0].c,o.dense?(c[g]||(c[g]=[]),c[g][y]=x):c[Ft(y)+_]=x,d.s.r>m.r&&(d.s.r=m.r),d.s.c>y&&(d.s.c=y),d.e.r<m.r&&(d.e.r=m.r),d.e.c<y&&(d.e.c=y),se&&(se.type=="XLDAPR"&&(x.D=!0),se=void 0);break;case 176:b.push(W);break;case 49:se=((o.xlmeta||{}).Cell||[])[W-1];break;case 494:var D=n["!id"][W.relId];for(D?(W.Target=D.Target,W.loc&&(W.Target+="#"+W.loc),W.Rel=D):W.relId==""&&(W.Target="#"+W.loc),g=W.rfx.s.r;g<=W.rfx.e.r;++g)for(y=W.rfx.s.c;y<=W.rfx.e.c;++y)o.dense?(c[g]||(c[g]=[]),c[g][y]||(c[g][y]={t:"z",v:void 0}),c[g][y].l=W):(w=Ge({c:y,r:g}),c[w]||(c[w]={t:"z",v:void 0}),c[w].l=W);break;case 426:if(!o.cellFormula)break;j.push(W),S=o.dense?c[g][y]:c[Ft(y)+_],S.f=Pr(W[1],d,{r:m.r,c:y},C,o),S.F=Ye(W[0]);break;case 427:if(!o.cellFormula)break;V[Ge(W[0].s)]=W[1],S=o.dense?c[g][y]:c[Ft(y)+_],S.f=Pr(W[1],d,{r:m.r,c:y},C,o);break;case 60:if(!o.cellStyles)break;for(;W.e>=W.s;)X[W.e--]={width:W.w/256,hidden:!!(W.flags&1),level:W.level},Y||(Y=!0,_g(W.w/256)),Ta(X[W.e+1]);break;case 161:c["!autofilter"]={ref:Ye(W)};break;case 476:c["!margins"]=W;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),W.name&&(s.Sheets[r].CodeName=W.name),(W.above||W.left)&&(c["!outline"]={above:W.above,left:W.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),W.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!ue.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+ve.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=Ye(u||d)),o.sheetRows&&c["!ref"]){var ie=it(c["!ref"]);o.sheetRows<=+ie.e.r&&(ie.e.r=o.sheetRows-1,ie.e.r>d.e.r&&(ie.e.r=d.e.r),ie.e.r<ie.s.r&&(ie.s.r=ie.e.r),ie.e.c>d.e.c&&(ie.e.c=d.e.c),ie.e.c<ie.s.c&&(ie.s.c=ie.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Ye(ie))}return b.length>0&&(c["!merges"]=b),X.length>0&&(c["!cols"]=X),G.length>0&&(c["!rows"]=G),c}function dV(e,t,r,n,s,a,i){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=kt(t),t.z=t.z||He[14],t.v=or(bt(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r,c:n};switch(c.s=Ma(s.cellXfs,t,s),t.l&&a["!links"].push([Ge(c),t.l]),t.c&&a["!comments"].push([Ge(c),t.c]),t.t){case"s":case"str":return s.bookSST?(o=Ng(s.Strings,t.v,s.revStrings),c.t="s",c.v=o,i?fe(e,18,AU(t,c)):fe(e,7,CU(t,c))):(c.t="str",i?fe(e,17,$U(t,c)):fe(e,6,UU(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?i?fe(e,13,LU(t,c)):fe(e,2,DU(t,c)):i?fe(e,16,RU(t,c)):fe(e,5,PU(t,c)),!0;case"b":return c.t="b",i?fe(e,15,bU(t,c)):fe(e,4,wU(t,c)),!0;case"e":return c.t="e",i?fe(e,14,NU(t,c)):fe(e,3,SU(t,c)),!0}return i?fe(e,12,vU(t,c)):fe(e,1,xU(t,c)),!0}function fV(e,t,r,n){var s=it(t["!ref"]||"A1"),a,i="",o=[];fe(e,145);var c=Array.isArray(t),u=s.e.r;t["!rows"]&&(u=Math.max(s.e.r,t["!rows"].length-1));for(var d=s.s.r;d<=u;++d){i=Xt(d),cU(e,t,s,d);var f=!1;if(d<=s.e.r)for(var h=s.s.c;h<=s.e.c;++h){d===s.s.r&&(o[h]=Ft(h)),a=o[h]+i;var m=c?(t[d]||[])[h]:t[a];if(!m){f=!1;continue}f=dV(e,m,d,h,n,t,f)}}fe(e,146)}function hV(e,t){!t||!t["!merges"]||(fe(e,177,qU(t["!merges"].length)),t["!merges"].forEach(function(r){fe(e,176,XU(r))}),fe(e,178))}function mV(e,t){!t||!t["!cols"]||(fe(e,390),t["!cols"].forEach(function(r,n){r&&fe(e,60,tV(n,r))}),fe(e,391))}function pV(e,t){!t||!t["!ref"]||(fe(e,648),fe(e,649,iV(it(t["!ref"]))),fe(e,650))}function xV(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var s=dt(r,-1,n[1].Target.replace(/#.*$/,""),rt.HLINK);fe(e,494,JU(n,s))}}),delete t["!links"]}function gV(e,t,r,n){if(t["!comments"].length>0){var s=dt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",rt.VML);fe(e,551,hg("rId"+s)),t["!legacy"]=s}}function vV(e,t,r,n){if(t["!autofilter"]){var s=t["!autofilter"],a=typeof s.ref=="string"?s.ref:Ye(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=an(a);o.s.r==o.e.r&&(o.e.r=an(t["!ref"]).e.r,a=Ye(o));for(var c=0;c<i.length;++c){var u=i[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+a;break}}c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),fe(e,161,al(it(a))),fe(e,162)}}function yV(e,t,r){fe(e,133),fe(e,137,aV(t,r)),fe(e,138),fe(e,134)}function wV(e,t){t["!protect"]&&fe(e,535,oV(t["!protect"]))}function _V(e,t,r,n){var s=sn(),a=r.SheetNames[e],i=r.Sheets[a]||{},o=a;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var c=it(i["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],fe(s,129),(r.vbaraw||i["!outline"])&&fe(s,147,mU(o,i["!outline"])),fe(s,148,dU(c)),yV(s,i,r.Workbook),mV(s,i),fV(s,i,e,t),wV(s,i),vV(s,i,r,e),hV(s,i),xV(s,i,n),i["!margins"]&&fe(s,476,nV(i["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&pV(s,i),gV(s,i,e,n),fe(s,130),s.end()}function bV(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var i=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var s=at((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,s,n]}function kV(e,t,r,n,s,a){var i=a||{"!type":"chart"};if(!e)return a;var o=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=bV(f);d.s.r=d.s.c=0,d.e.c=o,u=Ft(o),h[0].forEach(function(m,x){i[u+Xt(x)]={t:"n",v:m,z:h[1]},c=x}),d.e.r<c&&(d.e.r=c),++o}),o>0&&(i["!ref"]=Ye(d)),i}function SV(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(VN);return o&&Tg(o[0],a,s,r),(i=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function EV(e,t){e.l+=10;var r=Ir(e);return{name:r}}function NV(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i=!1;return Qs(e,function(c,u,d){switch(d){case 550:a["!rel"]=c;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),c.name&&(s.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var Cg=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],TV=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],CV=[],jV=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Ww(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],s=0;s!=t.length;++s){var a=t[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=wt(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function Hw(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=wt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function HN(e){Hw(e.WBProps,Cg),Hw(e.CalcPr,jV),Ww(e.WBView,TV),Ww(e.Sheets,CV),Fo.date1904=wt(e.WBProps.date1904)}function AV(e){return!e.Workbook||!e.Workbook.WBProps?"false":wt(e.Workbook.WBProps.date1904)?"true":"false"}var FV="][*?/\\".split("");function GN(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return FV.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function PV(e,t,r){e.forEach(function(n,s){GN(n);for(var a=0;a<s;++a)if(n==e[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var i=t&&t[s]&&t[s].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function RV(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];PV(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)AB(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var OV=/<\w+:workbook/;function DV(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},i=0;if(e.replace(Br,function(c,u){var d=Ke(c);switch(_s(d[0])){case"<?xml":break;case"<workbook":c.match(OV)&&(s="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[s];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Cg.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=wt(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=pt(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=at(pt(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=pt(d.name),d.comment&&(a.Comment=d.comment),d.localSheetId&&(a.Sheet=+d.localSheetId),wt(d.hidden||"0")&&(a.Hidden=!0),i=u+c.length;break;case"</definedName>":a.Ref=at(pt(e.slice(i,u))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),Fi.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return HN(r),r}function KN(e){var t=[qt];t[t.length]=we("workbook",null,{xmlns:Fi[0],"xmlns:r":ar.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Cg.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=we("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],a=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!s[a]||!s[a].Hidden);++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var i={name:ft(e.SheetNames[a].slice(0,31))};if(i.sheetId=""+(a+1),i["r:id"]="rId"+(a+1),s[a])switch(s[a].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=we("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=we("definedName",ft(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function IV(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=tp(e),r.name=Ir(e),r}function LV(e,t){return t||(t=le(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),hg(e.strRelID,t),dr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function MV(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?Ir(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function BV(e,t){t||(t=le(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),ME(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function UV(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function VV(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),a=gD(e),i=SB(e,0,r),o=fg(e);e.l=n;var c={Name:a,Ptg:i};return s<268435455&&(c.Sheet=s),o&&(c.Comment=o),c}function $V(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;t||(t={}),t.biff=12;var a=[],i=[[]];return i.SheetNames=[],i.XTI=[],Gc[16]={n:"BrtFRTArchID$",f:UV},Qs(e,function(c,u,d){switch(d){case 156:i.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=Pr(c.Ptg,null,null,i,t),delete t.SID,delete c.Ptg,a.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([d,c]):i[0]=[d,c],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(c),i.XTI=i.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(d),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!u.T){if(!s||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),HN(r),r.Names=a,r.supbooks=i,r}function zV(e,t){fe(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};fe(e,156,LV(s))}fe(e,144)}function WV(e,t){t||(t=le(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return dr("SheetJS",t),dr(s0.version,t),dr(s0.version,t),dr("7262",t),t.length>t.l?t.slice(0,t.l):t}function HV(e,t){t||(t=le(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function GV(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,s=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&a==-1&&(a=n);a>s||(fe(e,135),fe(e,158,HV(s)),fe(e,136))}}function KV(e,t){var r=sn();return fe(r,131),fe(r,128,WV()),fe(r,153,BV(e.Workbook&&e.Workbook.WBProps||null)),GV(r,e),zV(r,e),fe(r,132),r.end()}function XV(e,t,r){return t.slice(-4)===".bin"?$V(e,r):DV(e,r)}function qV(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?uV(e,n,r,s,a,i,o):VB(e,n,r,s,a,i,o)}function YV(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?NV(e,n,r,s,a):SV(e,n,r,s,a)}function JV(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?Z7():e9()}function QV(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?J7():Q7()}function ZV(e,t,r,n){return t.slice(-4)===".bin"?XM(e,r,n):IM(e,r,n)}function e$(e,t,r){return TN(e,r)}function t$(e,t,r){return t.slice(-4)===".bin"?tM(e,r):QL(e,r)}function r$(e,t,r){return t.slice(-4)===".bin"?G7(e,r):L7(e,r)}function n$(e,t,r){return t.slice(-4)===".bin"?O7(e):P7(e)}function s$(e,t,r,n){return r.slice(-4)===".bin"?D7(e,t,r,n):void 0}function a$(e,t,r){return t.slice(-4)===".bin"?j7(e,t,r):F7(e,t,r)}function i$(e,t,r){return(t.slice(-4)===".bin"?KV:KN)(e)}function o$(e,t,r,n,s){return(t.slice(-4)===".bin"?_V:$N)(e,r,n,s)}function l$(e,t,r){return(t.slice(-4)===".bin"?s7:EN)(e,r)}function c$(e,t,r){return(t.slice(-4)===".bin"?sM:gN)(e,r)}function u$(e,t,r){return(t.slice(-4)===".bin"?K7:AN)(e)}function d$(e){return(e.slice(-4)===".bin"?A7:CN)()}var XN=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,qN=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Kn(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=e.match(XN),a,i,o,c;if(s)for(c=0;c!=s.length;++c)a=s[c].match(qN),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),n[o]=a[2].slice(1,a[2].length-1));return n}function f$(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(XN),s,a,i,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(qN),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(a+1),r[i]=s[2].slice(1,s[2].length-1));return r}var tc;function h$(e,t){var r=tc[e]||at(e);return r==="General"?vi(t):Wn(r,t)}function m$(e,t,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=wt(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=bt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[at(t)]=s}function p$(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Zs[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Lc(e.v):e.w=vi(e.v):e.w=h$(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=tc[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&rl(n)){var s=ni(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function x$(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=CM[n.Pattern]||n.Pattern)}e[t.ID]=t}function g$(e,t,r,n,s,a,i,o,c,u){var d="General",f=n.StyleID,h={};u=u||{};var m=[],x=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&i&&(f=i.StyleID);a[f]!==void 0&&(a[f].nf&&(d=a[f].nf),a[f].Interior&&m.push(a[f].Interior),!!a[f].Parent);)f=a[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=wt(e);break;case"String":n.t="s",n.r=lw(at(e)),n.v=e.indexOf("<")>-1?at(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(bt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=at(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=zE[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=lw(t||e));break}if(p$(n,d,u),u.cellFormula!==!1)if(n.Formula){var p=at(n.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),n.f=Ao(p,s),delete n.Formula,n.ArrayRange=="RC"?n.F=Ao("RC:RC",s):n.ArrayRange&&(n.F=Ao(n.ArrayRange,s),c.push([it(n.F),n.F]))}else for(x=0;x<c.length;++x)s.r>=c[x][0].s.r&&s.r<=c[x][0].e.r&&s.c>=c[x][0].s.c&&s.c<=c[x][0].e.c&&(n.F=c[x][1]);u.cellStyles&&(m.forEach(function(g){!h.patternType&&g.patternType&&(h.patternType=g.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function v$(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function xh(e,t){var r=t||{};nl();var n=Cl(ig(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=pt(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var i=kt(r);return i.type="string",Ko.to_workbook(n,i)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(et){s.indexOf("<"+et)>=0&&(a=!0)}),a)return nz(n,r);tc={"General Number":"General","General Date":He[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":He[15],"Short Date":He[14],"Long Time":He[19],"Medium Time":He[18],"Short Time":He[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:He[2],Standard:He[4],Percent:He[10],Scientific:He[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],u,d={},f=[],h=r.dense?[]:{},m="",x={},p={},g=Kn('<Data ss:Type="String">'),y=0,w=0,v=0,_={s:{r:2e6,c:2e6},e:{r:0,c:0}},S={},b={},k="",T=0,j=[],V={},C={},R=0,X=[],G=[],Y={},se=[],ie,oe=!1,W=[],ue=[],ve={},F=0,H=0,D={Sheets:[],WBProps:{date1904:!1}},z={};Uc.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var B="";o=Uc.exec(n);)switch(o[3]=(B=o[3]).toLowerCase()){case"data":if(B=="data"){if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?g$(n.slice(y,o.index),k,g,c[c.length-1][0]=="comment"?Y:x,{c:w,r:v},S,se[w],p,W,r):(k="",g=Kn(o[0]),y=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(G.length>0&&(x.c=G),(!r.sheetRows||r.sheetRows>v)&&x.v!==void 0&&(r.dense?(h[v]||(h[v]=[]),h[v][w]=x):h[Ft(w)+Xt(v)]=x),x.HRef&&(x.l={Target:at(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(F=w+(parseInt(x.MergeAcross,10)|0),H=v+(parseInt(x.MergeDown,10)|0),j.push({s:{c:w,r:v},e:{c:F,r:H}})),!r.sheetStubs)x.MergeAcross?w=F+1:++w;else if(x.MergeAcross||x.MergeDown){for(var ne=w;ne<=F;++ne)for(var U=v;U<=H;++U)(ne>w||U>v)&&(r.dense?(h[U]||(h[U]=[]),h[U][ne]={t:"z"}):h[Ft(ne)+Xt(U)]={t:"z"});w=F+1}else++w;else x=f$(o[0]),x.Index&&(w=+x.Index-1),w<_.s.c&&(_.s.c=w),w>_.e.c&&(_.e.c=w),o[0].slice(-2)==="/>"&&++w,G=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(v<_.s.r&&(_.s.r=v),v>_.e.r&&(_.e.r=v),o[0].slice(-2)==="/>"&&(p=Kn(o[0]),p.Index&&(v=+p.Index-1)),w=0,++v):(p=Kn(o[0]),p.Index&&(v=+p.Index-1),ve={},(p.AutoFitHeight=="0"||p.Height)&&(ve.hpx=parseInt(p.Height,10),ve.hpt=Hc(ve.hpx),ue[v]=ve),p.Hidden=="1"&&(ve.hidden=!0,ue[v]=ve));break;case"worksheet":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));f.push(m),_.s.r<=_.e.r&&_.s.c<=_.e.c&&(h["!ref"]=Ye(_),r.sheetRows&&r.sheetRows<=_.e.r&&(h["!fullref"]=h["!ref"],_.e.r=r.sheetRows-1,h["!ref"]=Ye(_))),j.length&&(h["!merges"]=j),se.length>0&&(h["!cols"]=se),ue.length>0&&(h["!rows"]=ue),d[m]=h}else _={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=w=0,c.push([o[3],!1]),u=Kn(o[0]),m=at(u.Name),h=r.dense?[]:{},j=[],W=[],ue=[],z={name:m,Hidden:0},D.Sheets.push(z);break;case"table":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),se=[],oe=!1}break;case"style":o[1]==="/"?x$(S,b,r):b=Kn(o[0]);break;case"numberformat":b.nf=at(Kn(o[0]).Format||"General"),tc[b.nf]&&(b.nf=tc[b.nf]);for(var J=0;J!=392&&He[J]!=b.nf;++J);if(J==392){for(J=57;J!=392;++J)if(He[J]==null){Ls(b.nf,J);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(ie=Kn(o[0]),ie.Hidden&&(ie.hidden=!0,delete ie.Hidden),ie.Width&&(ie.wpx=parseInt(ie.Width,10)),!oe&&ie.wpx>10){oe=!0,Or=kN;for(var ae=0;ae<se.length;++ae)se[ae]&&Ta(se[ae])}oe&&Ta(ie),se[ie.Index-1||se.length]=ie;for(var q=0;q<+ie.Span;++q)se[se.length]=kt(ie);break;case"namedrange":if(o[1]==="/")break;D.Names||(D.Names=[]);var O=Ke(o[0]),be={Name:O.Name,Ref:Ao(O.RefersTo.slice(1),{r:0,c:0})};D.Sheets.length>0&&(be.Sheet=D.Sheets.length-1),D.Names.push(be);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?k+=n.slice(T,o.index):T=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;b.Interior=Kn(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?$D(V,B,n.slice(R,o.index)):R=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));v$(Y),G.push(Y)}else c.push([o[3],!1]),u=Kn(o[0]),Y={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Ee=Kn(o[0]);h["!autofilter"]={ref:Ao(Ee.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return Yw(n,r);var Ve=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ve=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ve=!1}break;case"excelworkbook":switch(o[3]){case"date1904":D.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ve=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Ve=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(R,o.index)){case"SheetHidden":z.Hidden=1;break;case"SheetVeryHidden":z.Hidden=2;break}else R=o.index+o[0].length;break;case"header":h["!margins"]||di(h["!margins"]={},"xlml"),isNaN(+Ke(o[0]).Margin)||(h["!margins"].header=+Ke(o[0]).Margin);break;case"footer":h["!margins"]||di(h["!margins"]={},"xlml"),isNaN(+Ke(o[0]).Margin)||(h["!margins"].footer=+Ke(o[0]).Margin);break;case"pagemargins":var Ue=Ke(o[0]);h["!margins"]||di(h["!margins"]={},"xlml"),isNaN(+Ue.Top)||(h["!margins"].top=+Ue.Top),isNaN(+Ue.Left)||(h["!margins"].left=+Ue.Left),isNaN(+Ue.Right)||(h["!margins"].right=+Ue.Right),isNaN(+Ue.Bottom)||(h["!margins"].bottom=+Ue.Bottom);break;case"displayrighttoleft":D.Views||(D.Views=[]),D.Views[0]||(D.Views[0]={}),D.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ve=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ve=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ve=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ve=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ve=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ve=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ve=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ve=!1}break;case"smarttags":break;default:Ve=!1;break}if(Ve||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?m$(C,B,X,n.slice(R,o.index)):(X=o,R=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var me={};return!r.bookSheets&&!r.bookProps&&(me.Sheets=d),me.SheetNames=f,me.Workbook=D,me.SSF=kt(He),me.Props=V,me.Custprops=C,me}function lp(e,t){switch(Ag(t=t||{}),t.type||"base64"){case"base64":return xh(kn(e),t);case"binary":case"buffer":case"file":return xh(e,t);case"array":return xh(Ia(e),t)}}function y$(e,t){var r=[];return e.Props&&r.push(zD(e.Props,t)),e.Custprops&&r.push(WD(e.Props,e.Custprops)),r.join("")}function w$(){return""}function _$(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,s){var a=[];a.push(we("NumberFormat",null,{"ss:Format":ft(He[n.numFmtId])}));var i={"ss:ID":"s"+(21+s)};r.push(we("Style",a.join(""),i))}),we("Styles",r.join(""))}function YN(e){return we("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Sg(e.Ref,{r:0,c:0})})}function b$(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var s=t[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(YN(s)))}return we("Names",r.join(""))}function k$(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,a=[],i=0;i<s.length;++i){var o=s[i];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||a.push(YN(o)))}return a.join("")}function S$(e,t,r,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(we("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(we("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(we("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(we("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(wr("ProtectContents","True")),e["!protect"].objects&&s.push(wr("ProtectObjects","True")),e["!protect"].scenarios&&s.push(wr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(wr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(wr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&s.push("<"+i[1]+"/>")})),s.length==0?"":we("WorksheetOptions",s.join(""),{xmlns:dn.x})}function E$(e){return e.map(function(t){var r=GO(t.t||""),n=we("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return we("Comment",n,{"ss:Author":t.a})}).join("")}function N$(e,t,r,n,s,a,i){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+ft(Sg(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var c=Pt(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==i.r?"":"["+(c.r-i.r)+"]")+"C"+(c.c==i.c?"":"["+(c.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=ft(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=ft(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=i.c||u[d].s.r!=i.r||(u[d].e.c>u[d].s.c&&(o["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(o["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",h=String(e.v);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=Zs[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||He[14]);break;case"s":f="String",h=HO(e.v||"");break}var m=Ma(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+m),o["ss:Index"]=i.c+1;var x=e.v!=null?h:"",p=e.t=="z"?"":'<Data ss:Type="'+f+'">'+x+"</Data>";return(e.c||[]).length>0&&(p+=E$(e.c)),we("Cell",p,o)}function T$(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Xo(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function C$(e,t,r,n){if(!e["!ref"])return"";var s=it(e["!ref"]),a=e["!merges"]||[],i=0,o=[];e["!cols"]&&e["!cols"].forEach(function(g,y){Ta(g);var w=!!g.width,v=sf(y,g),_={"ss:Index":y+1};w&&(_["ss:Width"]=zc(v.width)),g.hidden&&(_["ss:Hidden"]="1"),o.push(we("Column",null,_))});for(var c=Array.isArray(e),u=s.s.r;u<=s.e.r;++u){for(var d=[T$(u,(e["!rows"]||[])[u])],f=s.s.c;f<=s.e.c;++f){var h=!1;for(i=0;i!=a.length;++i)if(!(a[i].s.c>f)&&!(a[i].s.r>u)&&!(a[i].e.c<f)&&!(a[i].e.r<u)){(a[i].s.c!=f||a[i].s.r!=u)&&(h=!0);break}if(!h){var m={r:u,c:f},x=Ge(m),p=c?(e[u]||[])[f]:e[x];d.push(N$(p,x,e,t,r,n,m))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function j$(e,t,r){var n=[],s=r.SheetNames[e],a=r.Sheets[s],i=a?k$(a,t,e,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=a?C$(a,t,e,r):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(S$(a,t,e,r)),n.join("")}function A$(e,t){t||(t={}),e.SSF||(e.SSF=kt(He)),e.SSF&&(nl(),J0(e.SSF),t.revssf=Z0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Ma(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(y$(e,t)),r.push(w$()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(we("Worksheet",j$(n,t,e),{"ss:Name":ft(e.SheetNames[n])}));return r[2]=_$(e,t),r[3]=b$(e),qt+we("Workbook",r.join(""),{xmlns:dn.ss,"xmlns:o":dn.o,"xmlns:x":dn.x,"xmlns:ss":dn.ss,"xmlns:dt":dn.dt,"xmlns:html":dn.html})}function F$(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=bD(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=kD(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var P$=[60,1084,2066,2165,2175];function R$(e,t,r,n,s){var a=n,i=[],o=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}i.push(o),r.l+=a;for(var c=Ps(r,r.l),u=cp[c],d=0;u!=null&&P$.indexOf(c)>-1;)a=Ps(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),o=r.slice(d,r.l+4+a),i.push(o),r.l+=4+a,u=cp[c=Ps(r,r.l)];var f=ur(i);yr(f,0);var h=0;f.lens=[];for(var m=0;m<i.length;++m)f.lens.push(h),h+=i[m].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,s)}function us(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=He[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Zs[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Lc(e.v):e.w=vi(e.v):e.w=Wn(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&rl(He[n]||String(n))){var s=ni(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Xu(e,t,r){return{v:e,ixfe:t,t:r}}function O$(e,t){var r={opts:{}},n={},s=t.dense?[]:{},a={},i={},o=null,c=[],u="",d={},f,h="",m,x,p,g,y={},w=[],v,_,S=[],b=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},T={},j=function(je){return je<8?li[je]:je<64&&b[je-8]||li[je]},V=function(je,Ie,Fe){var Xe=Ie.XF.data;if(!(!Xe||!Xe.patternType||!Fe||!Fe.cellStyles)){Ie.s={},Ie.s.patternType=Xe.patternType;var Te;(Te=$c(j(Xe.icvFore)))&&(Ie.s.fgColor={rgb:Te}),(Te=$c(j(Xe.icvBack)))&&(Ie.s.bgColor={rgb:Te})}},C=function(je,Ie,Fe){if(!(ve>1)&&!(Fe.sheetRows&&je.r>=Fe.sheetRows)){if(Fe.cellStyles&&Ie.XF&&Ie.XF.data&&V(je,Ie,Fe),delete Ie.ixfe,delete Ie.XF,f=je,h=Ge(je),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),je.r<i.s.r&&(i.s.r=je.r),je.c<i.s.c&&(i.s.c=je.c),je.r+1>i.e.r&&(i.e.r=je.r+1),je.c+1>i.e.c&&(i.e.c=je.c+1),Fe.cellFormula&&Ie.f){for(var Xe=0;Xe<w.length;++Xe)if(!(w[Xe][0].s.c>je.c||w[Xe][0].s.r>je.r)&&!(w[Xe][0].e.c<je.c||w[Xe][0].e.r<je.r)){Ie.F=Ye(w[Xe][0]),(w[Xe][0].s.c!=je.c||w[Xe][0].s.r!=je.r)&&delete Ie.f,Ie.f&&(Ie.f=""+Pr(w[Xe][1],i,je,W,R));break}}Fe.dense?(s[je.r]||(s[je.r]=[]),s[je.r][je.c]=Ie):s[h]=Ie}},R={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(R.password=t.password);var X,G=[],Y=[],se=[],ie=[],oe=!1,W=[];W.SheetNames=R.snames,W.sharedf=R.sharedf,W.arrayf=R.arrayf,W.names=[],W.XTI=[];var ue=0,ve=0,F=0,H=[],D=[],z;R.codepage=1200,ts(1200);for(var B=!1;e.l<e.length-1;){var ne=e.l,U=e.read_shift(2);if(U===0&&ue===10)break;var J=e.l===e.length?0:e.read_shift(2),ae=cp[U];if(ae&&ae.f){if(t.bookSheets&&ue===133&&U!==133)break;if(ue=U,ae.r===2||ae.r==12){var q=e.read_shift(2);if(J-=2,!R.enc&&q!==U&&((q&255)<<8|q>>8)!==U)throw new Error("rt mismatch: "+q+"!="+U);ae.r==12&&(e.l+=10,J-=10)}var O={};if(U===10?O=ae.f(e,J,R):O=R$(U,ae,e,J,R),ve==0&&[9,521,1033,2057].indexOf(ue)===-1)continue;switch(U){case 34:r.opts.Date1904=k.WBProps.date1904=O;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(R.enc||(e.l=0),R.enc=O,!t.password)throw new Error("File is password-protected");if(O.valid==null)throw new Error("Encryption scheme unsupported");if(!O.valid)throw new Error("Password is incorrect");break;case 92:R.lastuser=O;break;case 66:var be=Number(O);switch(be){case 21010:be=1200;break;case 32768:be=1e4;break;case 32769:be=1252;break}ts(R.codepage=be),B=!0;break;case 317:R.rrtabid=O;break;case 25:R.winlocked=O;break;case 439:r.opts.RefreshAll=O;break;case 12:r.opts.CalcCount=O;break;case 16:r.opts.CalcDelta=O;break;case 17:r.opts.CalcIter=O;break;case 13:r.opts.CalcMode=O;break;case 14:r.opts.CalcPrecision=O;break;case 95:r.opts.CalcSaveRecalc=O;break;case 15:R.CalcRefMode=O;break;case 2211:r.opts.FullCalc=O;break;case 129:O.fDialog&&(s["!type"]="dialog"),O.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),O.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:S.push(O);break;case 430:W.push([O]),W[W.length-1].XTI=[];break;case 35:case 547:W[W.length-1].push(O);break;case 24:case 536:z={Name:O.Name,Ref:Pr(O.rgce,i,null,W,R)},O.itab>0&&(z.Sheet=O.itab-1),W.names.push(z),W[0]||(W[0]=[],W[0].XTI=[]),W[W.length-1].push(O),O.Name=="_xlnm._FilterDatabase"&&O.itab>0&&O.rgce&&O.rgce[0]&&O.rgce[0][0]&&O.rgce[0][0][0]=="PtgArea3d"&&(D[O.itab-1]={ref:Ye(O.rgce[0][0][1][2])});break;case 22:R.ExternCount=O;break;case 23:W.length==0&&(W[0]=[],W[0].XTI=[]),W[W.length-1].XTI=W[W.length-1].XTI.concat(O),W.XTI=W.XTI.concat(O);break;case 2196:if(R.biff<8)break;z!=null&&(z.Comment=O[1]);break;case 18:s["!protect"]=O;break;case 19:O!==0&&R.WTF&&console.error("Password verifier: "+O);break;case 133:a[O.pos]=O,R.snames.push(O.name);break;case 10:{if(--ve)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,s["!ref"]=Ye(i),t.sheetRows&&t.sheetRows<=i.e.r){var Ee=i.e.r;i.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=Ye(i),i.e.r=Ee}i.e.r++,i.e.c++}G.length>0&&(s["!merges"]=G),Y.length>0&&(s["!objects"]=Y),se.length>0&&(s["!cols"]=se),ie.length>0&&(s["!rows"]=ie),k.Sheets.push(T)}u===""?d=s:n[u]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(R.biff===8&&(R.biff={9:2,521:3,1033:4}[U]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[O.BIFFVer]||8),R.biffguess=O.BIFFVer==0,O.BIFFVer==0&&O.dt==4096&&(R.biff=5,B=!0,ts(R.codepage=28591)),R.biff==8&&O.BIFFVer==0&&O.dt==16&&(R.biff=2),ve++)break;if(s=t.dense?[]:{},R.biff<8&&!B&&(B=!0,ts(R.codepage=t.codepage||1252)),R.biff<5||O.BIFFVer==0&&O.dt==4096){u===""&&(u="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var Ve={pos:e.l-J,name:u};a[Ve.pos]=Ve,R.snames.push(u)}else u=(a[ne]||{name:""}).name;O.dt==32&&(s["!type"]="chart"),O.dt==64&&(s["!type"]="macro"),G=[],Y=[],R.arrayf=w=[],se=[],ie=[],oe=!1,T={Hidden:(a[ne]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[O.r]||[])[O.c]:s[Ge({c:O.c,r:O.r})])&&++O.c,v={ixfe:O.ixfe,XF:S[O.ixfe]||{},v:O.val,t:"n"},F>0&&(v.z=H[v.ixfe>>8&63]),us(v,t,r.opts.Date1904),C({c:O.c,r:O.r},v,t);break;case 5:case 517:v={ixfe:O.ixfe,XF:S[O.ixfe],v:O.val,t:O.t},F>0&&(v.z=H[v.ixfe>>8&63]),us(v,t,r.opts.Date1904),C({c:O.c,r:O.r},v,t);break;case 638:v={ixfe:O.ixfe,XF:S[O.ixfe],v:O.rknum,t:"n"},F>0&&(v.z=H[v.ixfe>>8&63]),us(v,t,r.opts.Date1904),C({c:O.c,r:O.r},v,t);break;case 189:for(var Ue=O.c;Ue<=O.C;++Ue){var me=O.rkrec[Ue-O.c][0];v={ixfe:me,XF:S[me],v:O.rkrec[Ue-O.c][1],t:"n"},F>0&&(v.z=H[v.ixfe>>8&63]),us(v,t,r.opts.Date1904),C({c:Ue,r:O.r},v,t)}break;case 6:case 518:case 1030:{if(O.val=="String"){o=O;break}if(v=Xu(O.val,O.cell.ixfe,O.tt),v.XF=S[v.ixfe],t.cellFormula){var et=O.formula;if(et&&et[0]&&et[0][0]&&et[0][0][0]=="PtgExp"){var lt=et[0][0][1][0],zt=et[0][0][1][1],Yt=Ge({r:lt,c:zt});y[Yt]?v.f=""+Pr(O.formula,i,O.cell,W,R):v.F=((t.dense?(s[lt]||[])[zt]:s[Yt])||{}).F}else v.f=""+Pr(O.formula,i,O.cell,W,R)}F>0&&(v.z=H[v.ixfe>>8&63]),us(v,t,r.opts.Date1904),C(O.cell,v,t),o=O}break;case 7:case 519:if(o)o.val=O,v=Xu(O,o.cell.ixfe,"s"),v.XF=S[v.ixfe],t.cellFormula&&(v.f=""+Pr(o.formula,i,o.cell,W,R)),F>0&&(v.z=H[v.ixfe>>8&63]),us(v,t,r.opts.Date1904),C(o.cell,v,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(O);var he=Ge(O[0].s);if(m=t.dense?(s[O[0].s.r]||[])[O[0].s.c]:s[he],t.cellFormula&&m){if(!o||!he||!m)break;m.f=""+Pr(O[1],i,O[0],W,R),m.F=Ye(O[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!o)break;y[Ge(o.cell)]=O[0],m=t.dense?(s[o.cell.r]||[])[o.cell.c]:s[Ge(o.cell)],(m||{}).f=""+Pr(O[0],i,f,W,R)}}break;case 253:v=Xu(c[O.isst].t,O.ixfe,"s"),c[O.isst].h&&(v.h=c[O.isst].h),v.XF=S[v.ixfe],F>0&&(v.z=H[v.ixfe>>8&63]),us(v,t,r.opts.Date1904),C({c:O.c,r:O.r},v,t);break;case 513:t.sheetStubs&&(v={ixfe:O.ixfe,XF:S[O.ixfe],t:"z"},F>0&&(v.z=H[v.ixfe>>8&63]),us(v,t,r.opts.Date1904),C({c:O.c,r:O.r},v,t));break;case 190:if(t.sheetStubs)for(var re=O.c;re<=O.C;++re){var pe=O.ixfe[re-O.c];v={ixfe:pe,XF:S[pe],t:"z"},F>0&&(v.z=H[v.ixfe>>8&63]),us(v,t,r.opts.Date1904),C({c:re,r:O.r},v,t)}break;case 214:case 516:case 4:v=Xu(O.val,O.ixfe,"s"),v.XF=S[v.ixfe],F>0&&(v.z=H[v.ixfe>>8&63]),us(v,t,r.opts.Date1904),C({c:O.c,r:O.r},v,t);break;case 0:case 512:ve===1&&(i=O);break;case 252:c=O;break;case 1054:if(R.biff==4){H[F++]=O[1];for(var Re=0;Re<F+163&&He[Re]!=O[1];++Re);Re>=163&&Ls(O[1],F+163)}else Ls(O[1],O[0]);break;case 30:{H[F++]=O;for(var K=0;K<F+163&&He[K]!=O;++K);K>=163&&Ls(O,F+163)}break;case 229:G=G.concat(O);break;case 93:Y[O.cmo[0]]=R.lastobj=O;break;case 438:R.lastobj.TxO=O;break;case 127:R.lastobj.ImData=O;break;case 440:for(g=O[0].s.r;g<=O[0].e.r;++g)for(p=O[0].s.c;p<=O[0].e.c;++p)m=t.dense?(s[g]||[])[p]:s[Ge({c:p,r:g})],m&&(m.l=O[1]);break;case 2048:for(g=O[0].s.r;g<=O[0].e.r;++g)for(p=O[0].s.c;p<=O[0].e.c;++p)m=t.dense?(s[g]||[])[p]:s[Ge({c:p,r:g})],m&&m.l&&(m.l.Tooltip=O[1]);break;case 28:{if(R.biff<=5&&R.biff>=2)break;m=t.dense?(s[O[0].r]||[])[O[0].c]:s[Ge(O[0])];var Se=Y[O[2]];m||(t.dense?(s[O[0].r]||(s[O[0].r]=[]),m=s[O[0].r][O[0].c]={t:"z"}):m=s[Ge(O[0])]={t:"z"},i.e.r=Math.max(i.e.r,O[0].r),i.s.r=Math.min(i.s.r,O[0].r),i.e.c=Math.max(i.e.c,O[0].c),i.s.c=Math.min(i.s.c,O[0].c)),m.c||(m.c=[]),x={a:O[1],t:Se.TxO.t},m.c.push(x)}break;case 2173:_7(S[O.ixfe],O.ext);break;case 125:{if(!R.cellStyles)break;for(;O.e>=O.s;)se[O.e--]={width:O.w/256,level:O.level||0,hidden:!!(O.flags&1)},oe||(oe=!0,_g(O.w/256)),Ta(se[O.e+1])}break;case 520:{var de={};O.level!=null&&(ie[O.r]=de,de.level=O.level),O.hidden&&(ie[O.r]=de,de.hidden=!0),O.hpt&&(ie[O.r]=de,de.hpt=O.hpt,de.hpx=Xo(O.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||di(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[U]]=O;break;case 161:s["!margins"]||di(s["!margins"]={}),s["!margins"].header=O.header,s["!margins"].footer=O.footer;break;case 574:O.RTL&&(k.Views[0].RTL=!0);break;case 146:b=O;break;case 2198:X=O;break;case 140:_=O;break;case 442:u?T.CodeName=O||T.name:k.WBProps.CodeName=O||"ThisWorkbook";break}}else ae||console.error("Missing Info for XLS Record 0x"+U.toString(16)),e.l+=J}return r.SheetNames=$t(a).sort(function(Ne,je){return Number(Ne)-Number(je)}).map(function(Ne){return a[Ne].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&D.forEach(function(Ne,je){r.Sheets[r.SheetNames[je]]["!autofilter"]=Ne}),r.Strings=c,r.SSF=kt(He),R.enc&&(r.Encryption=R.enc),X&&(r.Themes=X),r.Metadata={},_!==void 0&&(r.Metadata.Country=_),W.names.length>0&&(k.Names=W.names),r.Workbook=k,r}var rc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function D$(e,t,r){var n=Le.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=Nw(n,rp,rc.DSI);for(var a in s)t[a]=s[a]}catch(u){if(r.WTF)throw u}var i=Le.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=Nw(i,np,rc.SI);for(var c in o)t[c]==null&&(t[c]=o[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(qE(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function I$(e,t){var r=[],n=[],s=[],a=0,i,o=rw(rp,"n"),c=rw(np,"n");if(e.Props)for(i=$t(e.Props),a=0;a<i.length;++a)(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?n:s).push([i[a],e.Props[i[a]]]);if(e.Custprops)for(i=$t(e.Custprops),a=0;a<i.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},i[a])||(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?n:s).push([i[a],e.Custprops[i[a]]]);var u=[];for(a=0;a<s.length;++a)rN.indexOf(s[a][0])>-1||XE.indexOf(s[a][0])>-1||s[a][1]!=null&&u.push(s[a]);n.length&&Le.utils.cfb_add(t,"/SummaryInformation",Tw(n,rc.SI,c,np)),(r.length||u.length)&&Le.utils.cfb_add(t,"/DocumentSummaryInformation",Tw(r,rc.DSI,o,rp,u.length?u:null,rc.UDI))}function JN(e,t){t||(t={}),Ag(t),Jx(),t.codepage&&Yx(t.codepage);var r,n;if(e.FullPaths){if(Le.find(e,"/encryption"))throw new Error("File is password-protected");r=Le.find(e,"!CompObj"),n=Le.find(e,"/Workbook")||Le.find(e,"/Book")}else{switch(t.type){case"base64":e=pn(kn(e));break;case"binary":e=pn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}yr(e,0),n={content:e}}var s,a;if(r&&F$(r),t.bookProps&&!t.bookSheets)s={};else{var i=tt?"buffer":"array";if(n&&n.content)s=O$(n.content,t);else if((a=Le.find(e,"PerfectOffice_MAIN"))&&a.content)s=ui.to_workbook(a.content,(t.type=i,t));else if((a=Le.find(e,"NativeContent_MAIN"))&&a.content)s=ui.to_workbook(a.content,(t.type=i,t));else throw(a=Le.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Le.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=q7(e))}var o={};return e.FullPaths&&D$(e,o,t),s.Props=s.Custprops=o,t.bookFiles&&(s.cfb=e),s}function L$(e,t){var r=t||{},n=Le.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Le.utils.cfb_add(n,s,QN(e,r)),r.biff==8&&(e.Props||e.Custprops)&&I$(e,n),r.biff==8&&e.vbaraw&&Y7(n,Le.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Gc={0:{f:oU},1:{f:pU},2:{f:OU},3:{f:kU},4:{f:yU},5:{f:FU},6:{f:BU},7:{f:TU},8:{f:GU},9:{f:HU},10:{f:zU},11:{f:WU},12:{f:gU},13:{f:IU},14:{f:EU},15:{f:_U},16:{f:zN},17:{f:VU},18:{f:jU},19:{f:dg},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:VV},40:{},42:{},43:{f:BM},44:{f:LM},45:{f:$M},46:{f:WM},47:{f:zM},48:{},49:{f:uD},50:{},51:{f:S7},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:hN},62:{f:MU},63:{f:R7},64:{f:lV},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Mr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:sV},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:hU},148:{f:uU,p:16},151:{f:QU},152:{},153:{f:MV},154:{},155:{},156:{f:IV},157:{},158:{},159:{T:1,f:eM},160:{T:-1},161:{T:1,f:Di},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:KU},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:b7},336:{T:-1},337:{f:T7,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:tp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:fN},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:ZU},427:{f:eV},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:rV},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:fU},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:YU},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:tp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:W7},633:{T:1},634:{T:-1},635:{T:1,f:$7},636:{T:-1},637:{f:mD},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:EV},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:cV},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},cp={6:{f:mh},10:{f:ta},12:{f:Zt},13:{f:Zt},14:{f:Ht},15:{f:Ht},16:{f:Dr},17:{f:Ht},18:{f:Ht},19:{f:Zt},20:{f:Rw},21:{f:Rw},23:{f:fN},24:{f:Dw},25:{f:Ht},26:{},27:{},28:{f:cL},29:{},34:{f:Ht},35:{f:Ow},38:{f:Dr},39:{f:Dr},40:{f:Dr},41:{f:Dr},42:{f:Ht},43:{f:Ht},47:{f:_M},49:{f:II},51:{f:Zt},60:{},61:{f:FI},64:{f:Ht},65:{f:DI},66:{f:Zt},77:{},80:{},81:{},82:{},85:{f:Zt},89:{},90:{},91:{},92:{f:wI},93:{f:fL},94:{},95:{f:Ht},96:{},97:{},99:{f:Ht},125:{f:hN},128:{f:JI},129:{f:bI},130:{f:Zt},131:{f:Ht},132:{f:Ht},133:{f:kI},134:{},140:{f:wL},141:{f:Zt},144:{},146:{f:kL},151:{},152:{},153:{},154:{},155:{},156:{f:Zt},157:{},158:{},160:{f:AL},161:{f:NL},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:KI},190:{f:XI},193:{f:ta},197:{},198:{},199:{},200:{},201:{},202:{f:Ht},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Zt},220:{},221:{f:Ht},222:{},224:{f:YI},225:{f:yI},226:{f:ta},227:{},229:{f:uL},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:EI},253:{f:MI},255:{f:TI},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:nN},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ht},353:{f:ta},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:rL},431:{f:Ht},432:{},433:{},434:{},437:{},438:{f:pL},439:{f:Ht},440:{f:xL},441:{},442:{f:lu},443:{},444:{f:Zt},445:{},446:{},448:{f:ta},449:{f:AI,r:2},450:{f:ta},512:{f:Aw},513:{f:jL},515:{f:eL},516:{f:UI},517:{f:Pw},519:{f:FL},520:{f:CI},523:{},545:{f:Iw},549:{f:jw},566:{},574:{f:RI},638:{f:GI},659:{},1048:{},1054:{f:$I},1084:{},1212:{f:iL},2048:{f:vL},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Hu},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ta},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:SL,r:12},2173:{f:w7,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ht,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:aL,r:12},2197:{},2198:{f:m7,r:12},2199:{},2200:{},2201:{},2202:{f:oL,r:12},2203:{f:ta},2204:{},2205:{},2206:{},2207:{},2211:{f:jI},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Zt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:TL},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:bL},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Aw},1:{},2:{f:IL},3:{f:OL},4:{f:RL},5:{f:Pw},7:{f:ML},8:{},9:{f:Hu},11:{},22:{f:Zt},30:{f:WI},31:{},32:{},33:{f:Iw},36:{},37:{f:jw},50:{f:BL},62:{},52:{},67:{},68:{f:Zt},69:{},86:{},126:{},127:{f:PL},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:UL},223:{},234:{},354:{},421:{},518:{f:mh},521:{f:Hu},536:{f:Dw},547:{f:Ow},561:{},579:{},1030:{f:mh},1033:{f:Hu},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function _e(e,t,r,n){var s=t;if(!isNaN(s)){var a=n||(r||[]).length||0,i=e.next(4);i.write_shift(2,s),i.write_shift(2,a),a>0&&lg(r)&&e.push(r)}}function M$(e,t,r,n){var s=(r||[]).length||0;if(s<=8224)return _e(e,t,r,s);var a=t;if(!isNaN(a)){for(var i=r.parts||[],o=0,c=0,u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;var d=e.next(4);for(d.write_shift(2,a),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<s;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function fu(e,t,r){return e||(e=le(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function B$(e,t,r,n){var s=le(9);return fu(s,e,t),sN(r,n||"b",s),s}function U$(e,t,r){var n=le(8+2*r.length);return fu(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function V$(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?or(bt(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?_e(e,2,LL(r,n,s)):_e(e,3,DL(r,n,s));return;case"b":case"e":_e(e,5,B$(r,n,t.v,t.t));return;case"s":case"str":_e(e,4,U$(r,n,(t.v||"").slice(0,255)));return}_e(e,1,fu(null,r,n))}function $$(e,t,r,n){var s=Array.isArray(t),a=it(t["!ref"]||"A1"),i,o="",c=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),i=Ye(a)}for(var u=a.s.r;u<=a.e.r;++u){o=Xt(u);for(var d=a.s.c;d<=a.e.c;++d){u===a.s.r&&(c[d]=Ft(d)),i=c[d]+o;var f=s?(t[u]||[])[d]:t[i];f&&V$(e,f,u,d)}}}function z$(e,t){for(var r=t||{},n=sn(),s=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(s=a);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return _e(n,r.biff==4?1033:r.biff==3?521:9,vg(e,16,r)),$$(n,e.Sheets[e.SheetNames[s]],s,r),_e(n,10),n.end()}function W$(e,t,r){_e(e,49,LI({sz:12,name:"Arial"},r))}function H$(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&_e(e,1054,zI(s,t[s],r))})}function G$(e,t){var r=le(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),_e(e,2151,r),r=le(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),cN(it(t["!ref"]||"A1"),r),r.write_shift(4,4),_e(e,2152,r)}function K$(e,t){for(var r=0;r<16;++r)_e(e,224,Fw({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){_e(e,224,Fw(n,0,t))})}function X$(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];_e(e,440,gL(n)),n[1].Tooltip&&_e(e,2048,yL(n))}delete t["!links"]}function q$(e,t){if(t){var r=0;t.forEach(function(n,s){++r<=256&&n&&_e(e,125,EL(sf(s,n),s))})}}function Y$(e,t,r,n,s){var a=16+Ma(s.cellXfs,t,s);if(t.v==null&&!t.bf){_e(e,513,bi(r,n,a));return}if(t.bf)_e(e,6,bB(t,r,n,s,a));else switch(t.t){case"d":case"n":var i=t.t=="d"?or(bt(t.v)):t.v;_e(e,515,tL(r,n,i,a));break;case"b":case"e":_e(e,517,ZI(r,n,t.v,a,s,t.t));break;case"s":case"str":if(s.bookSST){var o=Ng(s.Strings,t.v,s.revStrings);_e(e,253,BI(r,n,o,a))}else _e(e,516,VI(r,n,(t.v||"").slice(0,255),a,s));break;default:_e(e,513,bi(r,n,a))}}function J$(e,t,r){var n=sn(),s=r.SheetNames[e],a=r.Sheets[s]||{},i=(r||{}).Workbook||{},o=(i.Sheets||[])[e]||{},c=Array.isArray(a),u=t.biff==8,d,f="",h=[],m=it(a["!ref"]||"A1"),x=u?65536:16384;if(m.e.c>255||m.e.r>=x){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,x-1)}_e(n,2057,vg(r,16,t)),_e(n,13,Dn(1)),_e(n,12,Dn(100)),_e(n,15,$r(!0)),_e(n,17,$r(!1)),_e(n,16,wi(.001)),_e(n,95,$r(!0)),_e(n,42,$r(!1)),_e(n,43,$r(!1)),_e(n,130,Dn(1)),_e(n,128,QI()),_e(n,131,$r(!1)),_e(n,132,$r(!1)),u&&q$(n,a["!cols"]),_e(n,512,HI(m,t)),u&&(a["!links"]=[]);for(var p=m.s.r;p<=m.e.r;++p){f=Xt(p);for(var g=m.s.c;g<=m.e.c;++g){p===m.s.r&&(h[g]=Ft(g)),d=h[g]+f;var y=c?(a[p]||[])[g]:a[d];y&&(Y$(n,y,p,g,t),u&&y.l&&a["!links"].push([d,y.l]))}}var w=o.CodeName||o.name||s;return u&&_e(n,574,OI((i.Views||[])[0])),u&&(a["!merges"]||[]).length&&_e(n,229,dL(a["!merges"])),u&&X$(n,a),_e(n,442,aN(w)),u&&G$(n,a),_e(n,10),n.end()}function Q$(e,t,r){var n=sn(),s=(e||{}).Workbook||{},a=s.Sheets||[],i=s.WBProps||{},o=r.biff==8,c=r.biff==5;if(_e(n,2057,vg(e,5,r)),r.bookType=="xla"&&_e(n,135),_e(n,225,o?Dn(1200):null),_e(n,193,ZD(2)),c&&_e(n,191),c&&_e(n,192),_e(n,226),_e(n,92,_I("SheetJS",r)),_e(n,66,Dn(o?1200:1252)),o&&_e(n,353,Dn(0)),o&&_e(n,448),_e(n,317,CL(e.SheetNames.length)),o&&e.vbaraw&&_e(n,211),o&&e.vbaraw){var u=i.CodeName||"ThisWorkbook";_e(n,442,aN(u))}_e(n,156,Dn(17)),_e(n,25,$r(!1)),_e(n,18,$r(!1)),_e(n,19,Dn(0)),o&&_e(n,431,$r(!1)),o&&_e(n,444,Dn(0)),_e(n,61,PI()),_e(n,64,$r(!1)),_e(n,141,Dn(0)),_e(n,34,$r(AV(e)=="true")),_e(n,14,$r(!0)),o&&_e(n,439,$r(!1)),_e(n,218,Dn(0)),W$(n,e,r),H$(n,e.SSF,r),K$(n,r),o&&_e(n,352,$r(!1));var d=n.end(),f=sn();o&&_e(f,140,_L()),o&&r.Strings&&M$(f,252,NI(r.Strings)),_e(f,10);var h=f.end(),m=sn(),x=0,p=0;for(p=0;p<e.SheetNames.length;++p)x+=(o?12:11)+(o?2:1)*e.SheetNames[p].length;var g=d.length+x+h.length;for(p=0;p<e.SheetNames.length;++p){var y=a[p]||{};_e(m,133,SI({pos:g,hs:y.Hidden||0,dt:0,name:e.SheetNames[p]},r)),g+=t[p].length}var w=m.end();if(x!=w.length)throw new Error("BS8 "+x+" != "+w.length);var v=[];return d.length&&v.push(d),w.length&&v.push(w),h.length&&v.push(h),ur(v)}function Z$(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=kt(He)),e&&e.SSF&&(nl(),J0(e.SSF),r.revssf=Z0(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Fg(r),r.cellXfs=[],Ma(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=J$(s,r,e);return n.unshift(Q$(e,n,r)),ur(n)}function QN(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var s=an(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return Z$(e,t);case 4:case 3:case 2:return z$(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function Gw(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),i=s.index,o=a&&a.index||e.length,c=LO(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,f=0,h=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(i=0;i<c.length;++i){var p=c[i].trim(),g=p.slice(0,3).toLowerCase();if(g=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(g!="<td"&&g!="<th")){var y=p.split(/<\/t[dh]>/i);for(o=0;o<y.length;++o){var w=y[o].trim();if(w.match(/<t[dh]/i)){for(var v=w,_=0;v.charAt(0)=="<"&&(_=v.indexOf(">"))>-1;)v=v.slice(_+1);for(var S=0;S<x.length;++S){var b=x[S];b.s.c==d&&b.s.r<u&&u<=b.e.r&&(d=b.e.c+1,S=-1)}var k=Ke(w.slice(0,w.indexOf(">")));h=k.colspan?+k.colspan:1,((f=+k.rowspan)>1||h>1)&&x.push({s:{r:u,c:d},e:{r:u+(f||1)-1,c:d+h-1}});var T=k.t||k["data-t"]||"";if(!v.length){d+=h;continue}if(v=bE(v),m.s.r>u&&(m.s.r=u),m.e.r<u&&(m.e.r=u),m.s.c>d&&(m.s.c=d),m.e.c<d&&(m.e.c=d),!v.length){d+=h;continue}var j={t:"s",v};r.raw||!v.trim().length||T=="s"||(v==="TRUE"?j={t:"b",v:!0}:v==="FALSE"?j={t:"b",v:!1}:isNaN(as(v))?isNaN(Go(v).getDate())||(j={t:"d",v:bt(v)},r.cellDates||(j={t:"n",v:or(j.v)}),j.z=r.dateNF||He[14]):j={t:"n",v:as(v)}),r.dense?(n[u]||(n[u]=[]),n[u][d]=j):n[Ge({r:u,c:d})]=j,d+=h}}}}return n["!ref"]=Ye(m),x.length&&(n["!merges"]=x),n}function ez(e,t,r,n){for(var s=e["!merges"]||[],a=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,c=0,u=0;u<s.length;++u)if(!(s[u].s.r>r||s[u].s.c>i)&&!(s[u].e.r<r||s[u].e.c<i)){if(s[u].s.r<r||s[u].s.c<i){o=-1;break}o=s[u].e.r-s[u].s.r+1,c=s[u].e.c-s[u].s.c+1;break}if(!(o<0)){var d=Ge({r,c:i}),f=n.dense?(e[r]||[])[i]:e[d],h=f&&f.v!=null&&(f.h||ag(f.w||(Gs(f),f.w)||""))||"",m={};o>1&&(m.rowspan=o),c>1&&(m.colspan=c),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(m["data-t"]=f&&f.t||"z",f.v!=null&&(m["data-v"]=f.v),f.z!=null&&(m["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),m.id=(n.id||"sjs")+"-"+d,a.push(we("td",h,m))}}var x="<tr>";return x+a.join("")+"</tr>"}var tz='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',rz="</body></html>";function nz(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return La(Gw(r[0],t),t);var n=Og();return r.forEach(function(s,a){Dg(n,Gw(s,t),"Sheet"+(a+1))}),n}function sz(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function ZN(e,t){var r=t||{},n=r.header!=null?r.header:tz,s=r.footer!=null?r.footer:rz,a=[n],i=an(e["!ref"]);r.dense=Array.isArray(e),a.push(sz(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)a.push(ez(e,i,o,r));return a.push("</table>"+s),a.join("")}function eT(e,t,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var i=typeof n.origin=="string"?Pt(n.origin):n.origin;s=i.r,a=i.c}var o=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:s,c:a}};if(e["!ref"]){var d=an(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),s==-1&&(u.e.r=s=d.e.r+1)}var f=[],h=0,m=e["!rows"]||(e["!rows"]=[]),x=0,p=0,g=0,y=0,w=0,v=0;for(e["!cols"]||(e["!cols"]=[]);x<o.length&&p<c;++x){var _=o[x];if(Kw(_)){if(n.display)continue;m[p]={hidden:!0}}var S=_.children;for(g=y=0;g<S.length;++g){var b=S[g];if(!(n.display&&Kw(b))){var k=b.hasAttribute("data-v")?b.getAttribute("data-v"):b.hasAttribute("v")?b.getAttribute("v"):bE(b.innerHTML),T=b.getAttribute("data-z")||b.getAttribute("z");for(h=0;h<f.length;++h){var j=f[h];j.s.c==y+a&&j.s.r<p+s&&p+s<=j.e.r&&(y=j.e.c+1-a,h=-1)}v=+b.getAttribute("colspan")||1,((w=+b.getAttribute("rowspan")||1)>1||v>1)&&f.push({s:{r:p+s,c:y+a},e:{r:p+s+(w||1)-1,c:y+a+(v||1)-1}});var V={t:"s",v:k},C=b.getAttribute("data-t")||b.getAttribute("t")||"";k!=null&&(k.length==0?V.t=C||"z":n.raw||k.trim().length==0||C=="s"||(k==="TRUE"?V={t:"b",v:!0}:k==="FALSE"?V={t:"b",v:!1}:isNaN(as(k))?isNaN(Go(k).getDate())||(V={t:"d",v:bt(k)},n.cellDates||(V={t:"n",v:or(V.v)}),V.z=n.dateNF||He[14]):V={t:"n",v:as(k)})),V.z===void 0&&T!=null&&(V.z=T);var R="",X=b.getElementsByTagName("A");if(X&&X.length)for(var G=0;G<X.length&&!(X[G].hasAttribute("href")&&(R=X[G].getAttribute("href"),R.charAt(0)!="#"));++G);R&&R.charAt(0)!="#"&&(V.l={Target:R}),n.dense?(e[p+s]||(e[p+s]=[]),e[p+s][y+a]=V):e[Ge({c:y+a,r:p+s})]=V,u.e.c<y+a&&(u.e.c=y+a),y+=v}}++p}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,p-1+s),e["!ref"]=Ye(u),p>=c&&(e["!fullref"]=Ye((u.e.r=o.length-x+p-1+s,u))),e}function tT(e,t){var r=t||{},n=r.dense?[]:{};return eT(n,e,t)}function az(e,t){return La(tT(e,t),t)}function Kw(e){var t="",r=iz(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function iz(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function oz(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=at(t.replace(/<[^>]*>/g,""));return[r]}var Xw={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function rT(e,t){var r=t||{},n=ig(e),s=[],a,i,o={name:""},c="",u=0,d,f,h={},m=[],x=r.dense?[]:{},p,g,y={value:""},w="",v=0,_=[],S=-1,b=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},T=0,j={},V=[],C={},R=0,X=0,G=[],Y=1,se=1,ie=[],oe={Names:[]},W={},ue=["",""],ve=[],F={},H="",D=0,z=!1,B=!1,ne=0;for(Uc.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=Uc.exec(n);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"":p[1]==="/"?(k.e.c>=k.s.c&&k.e.r>=k.s.r?x["!ref"]=Ye(k):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=k.e.r&&(x["!fullref"]=x["!ref"],k.e.r=r.sheetRows-1,x["!ref"]=Ye(k)),V.length&&(x["!merges"]=V),G.length&&(x["!rows"]=G),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),m.push(d.name),h[d.name]=x,B=!1):p[0].charAt(p[0].length-2)!=="/"&&(d=Ke(p[0],!1),S=b=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,x=r.dense?[]:{},V=[],G=[],B=!0);break;case"table-row-group":p[1]==="/"?--T:++T;break;case"table-row":case"":if(p[1]==="/"){S+=Y,Y=1;break}if(f=Ke(p[0],!1),f.?S=f.-1:S==-1&&(S=0),Y=+f["number-rows-repeated"]||1,Y<10)for(ne=0;ne<Y;++ne)T>0&&(G[S+ne]={level:T});b=-1;break;case"covered-table-cell":p[1]!=="/"&&++b,r.sheetStubs&&(r.dense?(x[S]||(x[S]=[]),x[S][b]={t:"z"}):x[Ge({r:S,c:b})]={t:"z"}),w="",_=[];break;case"table-cell":case"":if(p[0].charAt(p[0].length-2)==="/")++b,y=Ke(p[0],!1),se=parseInt(y["number-columns-repeated"]||"1",10),g={t:"z",v:null},y.formula&&r.cellFormula!=!1&&(g.f=zw(at(y.formula))),(y.||y["value-type"])=="string"&&(g.t="s",g.v=at(y["string-value"]||""),r.dense?(x[S]||(x[S]=[]),x[S][b]=g):x[Ge({r:S,c:b})]=g),b+=se-1;else if(p[1]!=="/"){++b,w="",v=0,_=[],se=1;var U=Y?S+Y-1:S;if(b>k.e.c&&(k.e.c=b),b<k.s.c&&(k.s.c=b),S<k.s.r&&(k.s.r=S),U>k.e.r&&(k.e.r=U),y=Ke(p[0],!1),ve=[],F={},g={t:y.||y["value-type"],v:null},r.cellFormula)if(y.formula&&(y.formula=at(y.formula)),y["number-matrix-columns-spanned"]&&y["number-matrix-rows-spanned"]&&(R=parseInt(y["number-matrix-rows-spanned"],10)||0,X=parseInt(y["number-matrix-columns-spanned"],10)||0,C={s:{r:S,c:b},e:{r:S+R-1,c:b+X-1}},g.F=Ye(C),ie.push([C,g.F])),y.formula)g.f=zw(y.formula);else for(ne=0;ne<ie.length;++ne)S>=ie[ne][0].s.r&&S<=ie[ne][0].e.r&&b>=ie[ne][0].s.c&&b<=ie[ne][0].e.c&&(g.F=ie[ne][1]);switch((y["number-columns-spanned"]||y["number-rows-spanned"])&&(R=parseInt(y["number-rows-spanned"],10)||0,X=parseInt(y["number-columns-spanned"],10)||0,C={s:{r:S,c:b},e:{r:S+R-1,c:b+X-1}},V.push(C)),y["number-columns-repeated"]&&(se=parseInt(y["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=wt(y["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(y.value);break;case"percentage":g.t="n",g.v=parseFloat(y.value);break;case"currency":g.t="n",g.v=parseFloat(y.value);break;case"date":g.t="d",g.v=bt(y["date-value"]),r.cellDates||(g.t="n",g.v=or(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=OO(y["time-value"])/86400,r.cellDates&&(g.t="d",g.v=ef(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(y.);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",y["string-value"]!=null&&(w=at(y["string-value"]),_=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(z=!1,g.t==="s"&&(g.v=w||"",_.length&&(g.R=_),z=v==0),W.Target&&(g.l=W),ve.length>0&&(g.c=ve,ve=[]),w&&r.cellText!==!1&&(g.w=w),z&&(g.t="z",delete g.v),(!z||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=S))for(var J=0;J<Y;++J){if(se=parseInt(y["number-columns-repeated"]||"1",10),r.dense)for(x[S+J]||(x[S+J]=[]),x[S+J][b]=J==0?g:kt(g);--se>0;)x[S+J][b+se]=kt(g);else for(x[Ge({r:S+J,c:b})]=g;--se>0;)x[Ge({r:S+J,c:b+se})]=kt(g);k.e.c<=b&&(k.e.c=b)}se=parseInt(y["number-columns-repeated"]||"1",10),b+=se-1,se=0,g={},w="",_=[]}W={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((a=s.pop())[0]!==p[3])throw"Bad state: "+a}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((a=s.pop())[0]!==p[3])throw"Bad state: "+a;F.t=w,_.length&&(F.R=_),F.a=H,ve.push(F)}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!1]);H="",D=0,w="",v=0,_=[];break;case"creator":p[1]==="/"?H=n.slice(D,p.index):D=p.index+p[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((a=s.pop())[0]!==p[3])throw"Bad state: "+a}else p[0].charAt(p[0].length-2)!=="/"&&s.push([p[3],!1]);w="",v=0,_=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(j[o.name]=c,(a=s.pop())[0]!==p[3])throw"Bad state: "+a}else p[0].charAt(p[0].length-2)!=="/"&&(c="",o=Ke(p[0],!1),s.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Ke(p[0],!1),c+=Xw[p[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Ke(p[0],!1),c+=Xw[p[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(u,p.index);break}else u=p.index+p[0].length;break;case"named-range":i=Ke(p[0],!1),ue=ph(i["cell-range-address"]);var ae={Name:i.name,Ref:ue[0]+"!"+ue[1]};B&&(ae.Sheet=m.length),oe.Names.push(ae);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(p[1]==="/"&&(!y||!y["string-value"])){var q=oz(n.slice(v,p.index));w=(w.length>0?w+`
`:"")+q[0]}else Ke(p[0],!1),v=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{ue=ph(Ke(p[0])["target-range-address"]),h[ue[0]]["!autofilter"]={ref:ue[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(W=Ke(p[0],!1),!W.href)break;W.Target=at(W.href),delete W.href,W.Target.charAt(0)=="#"&&W.Target.indexOf(".")>-1?(ue=ph(W.Target.slice(1)),W.Target="#"+ue[0]+"!"+ue[1]):W.Target.match(/^\.\.[\\\/]/)&&(W.Target=W.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(p)}}var O={Sheets:h,SheetNames:m,Workbook:oe};return r.bookSheets&&delete O.Sheets,O}function qw(e,t){t=t||{},On(e,"META-INF/manifest.xml")&&OD(Qt(e,"META-INF/manifest.xml"),t);var r=xn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=rT(pt(r),t);return On(e,"meta.xml")&&(n.Props=GE(Qt(e,"meta.xml"))),n}function Yw(e,t){return rT(e,t)}var lz=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Bc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return qt+t}}(),Jw=function(){var e=function(a){return ft(a).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,i,o){var c=[];c.push('      <table:table table:name="'+ft(i.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,d=0,f=an(a["!ref"]||"A1"),h=a["!merges"]||[],m=0,x=Array.isArray(a);if(a["!cols"])for(d=0;d<=f.e.c;++d)c.push("        <table:table-column"+(a["!cols"][d]?' table:style-name="co'+a["!cols"][d].ods+'"':"")+`></table:table-column>
`);var p="",g=a["!rows"]||[];for(u=0;u<f.s.r;++u)p=g[u]?' table:style-name="ro'+g[u].ods+'"':"",c.push("        <table:table-row"+p+`></table:table-row>
`);for(;u<=f.e.r;++u){for(p=g[u]?' table:style-name="ro'+g[u].ods+'"':"",c.push("        <table:table-row"+p+`>
`),d=0;d<f.s.c;++d)c.push(t);for(;d<=f.e.c;++d){var y=!1,w={},v="";for(m=0;m!=h.length;++m)if(!(h[m].s.c>d)&&!(h[m].s.r>u)&&!(h[m].e.c<d)&&!(h[m].e.r<u)){(h[m].s.c!=d||h[m].s.r!=u)&&(y=!0),w["table:number-columns-spanned"]=h[m].e.c-h[m].s.c+1,w["table:number-rows-spanned"]=h[m].e.r-h[m].s.r+1;break}if(y){c.push(r);continue}var _=Ge({r:u,c:d}),S=x?(a[u]||[])[d]:a[_];if(S&&S.f&&(w["table:formula"]=ft(CB(S.f)),S.F&&S.F.slice(0,_.length)==_)){var b=an(S.F);w["table:number-matrix-columns-spanned"]=b.e.c-b.s.c+1,w["table:number-matrix-rows-spanned"]=b.e.r-b.s.r+1}if(!S){c.push(t);continue}switch(S.t){case"b":v=S.v?"TRUE":"FALSE",w["office:value-type"]="boolean",w["office:boolean-value"]=S.v?"true":"false";break;case"n":v=S.w||String(S.v||0),w["office:value-type"]="float",w["office:value"]=S.v||0;break;case"s":case"str":v=S.v==null?"":S.v,w["office:value-type"]="string";break;case"d":v=S.w||bt(S.v).toISOString(),w["office:value-type"]="date",w["office:date-value"]=bt(S.v).toISOString(),w["table:style-name"]="ce1";break;default:c.push(t);continue}var k=e(v);if(S.l&&S.l.Target){var T=S.l.Target;T=T.charAt(0)=="#"?"#"+jB(T.slice(1)):T,T.charAt(0)!="#"&&!T.match(/^\w+:/)&&(T="../"+T),k=we("text:a",k,{"xlink:href":T.replace(/&/g,"&amp;")})}c.push("          "+we("table:table-cell",we("text:p",k,{}),w)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(a,i){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var o=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var f=u["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Ta(f),f.ods=o;var h=u["!cols"][d].wpx+"px";a.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),a.push(`  </style:style>
`),++o}}});var c=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var f=u["!rows"][d].hpx+"px";a.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),a.push(`  </style:style>
`),++c}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(i,o){var c=[qt],u=Bc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=Bc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(HE().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),s(c,i),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=i.SheetNames.length;++f)c.push(n(i.Sheets[i.SheetNames[f]],i,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function nT(e,t){if(t.bookType=="fods")return Jw(e,t);var r=rg(),n="",s=[],a=[];return n="mimetype",Qe(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Qe(r,n,Jw(e,t)),s.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",Qe(r,n,lz(e,t)),s.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",Qe(r,n,qt+HE()),s.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",Qe(r,n,LD(a)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Qe(r,n,DD(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function ki(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function up(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):pt(Ia(e))}function cz(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):pn(xs(e))}function uz(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function ja(e){var t=e.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function Qw(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function dz(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,s=t+13;s>=t;--s)n=n*256+e[s];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function fz(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var a=0;s>=1;++a,s/=256)e[t+a]=s&255;e[t+15]|=r>=0?0:128}function Kc(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function ut(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Vt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function ot(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=Kc(e,r),a=s&7;s=Math.floor(s/8);var i=0,o;if(s==0)break;switch(a){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=Kc(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var u={data:o,type:a};t[s]==null?t[s]=[u]:t[s].push(u)}return t}function xr(e){var t=[];return e.forEach(function(r,n){r.forEach(function(s){s.data&&(t.push(ut(n*8+s.type)),s.type==2&&t.push(ut(s.data.length)),t.push(s.data))})}),ja(t)}function jg(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Fn(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=Kc(e,n),a=ot(e.slice(n[0],n[0]+s));n[0]+=s;var i={id:Vt(a[1][0].data),messages:[]};a[2].forEach(function(o){var c=ot(o.data),u=Vt(c[3][0].data);i.messages.push({meta:c,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=a[3])!=null&&t[0]&&(i.merge=Vt(a[3][0].data)>>>0>0),r.push(i)}return r}function Ki(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:ut(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:ut(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(i){s.push(i.data),i.meta[3]=[{type:0,data:ut(i.data.length)}],n[2].push({data:xr(i.meta),type:2})});var a=xr(n);t.push(ut(a.length)),t.push(a),s.forEach(function(i){return t.push(i)})}),ja(t)}function hz(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Kc(t,r),s=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}s.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var c=0,u=0;if(a==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,a==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[ja(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(s.push(s[0].slice(-c)),u-=c;u>=s[s.length-1].length;)s.push(s[s.length-1]),u-=s[s.length-1].length;s.push(s[0].slice(-c,-c+u))}}var d=ja(s);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function Pn(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(hz(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return ja(t)}function Xi(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var a=ut(n),i=a.length;t.push(a),n<=60?(i++,t.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),i+=n,s[0]=0,s[1]=i&255,s[2]=i>>8&255,s[3]=i>>16&255,r+=n}return ja(t)}function mz(e,t,r,n){var s=ki(e),a=s.getUint32(4,!0),i=(n>1?12:8)+Qw(a&(n>1?3470:398))*4,o=-1,c=-1,u=NaN,d=new Date(2001,0,1);a&512&&(o=s.getUint32(i,!0),i+=4),i+=Qw(a&(n>1?12288:4096))*4,a&16&&(c=s.getUint32(i,!0),i+=4),a&32&&(u=s.getFloat64(i,!0),i+=8),a&64&&(d.setTime(d.getTime()+s.getFloat64(i,!0)*1e3),i+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(c>-1)f={t:"s",v:t[c]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function pz(e,t,r){var n=ki(e),s=n.getUint32(8,!0),a=12,i=-1,o=-1,c=NaN,u=NaN,d=new Date(2001,0,1);s&1&&(c=dz(e,a),a+=16),s&2&&(u=n.getFloat64(a,!0),a+=8),s&4&&(d.setTime(d.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(o=n.getUint32(a,!0),a+=4),s&16&&(i=n.getUint32(a,!0),a+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[o]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(i>-1)f={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return f}function gh(e,t){var r=new Uint8Array(32),n=ki(r),s=12,a=0;switch(r[0]=5,e.t){case"n":r[1]=2,fz(r,s,e.v),a|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,e.v?1:0,!0),a|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,a,!0),r.slice(0,s)}function vh(e,t){var r=new Uint8Array(32),n=ki(r),s=12,a=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(s,e.v,!0),a|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,e.v?1:0,!0),a|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,a,!0),r.slice(0,s)}function xz(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return mz(e,t,r,e[0]);case 5:return pz(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Fr(e){var t=ot(e);return Kc(t[1][0].data)}function Zw(e,t){var r=ot(t.data),n=Vt(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(i){var o=ot(i.data),c=Vt(o[1][0].data)>>>0;switch(n){case 1:a[c]=up(o[3][0].data);break;case 8:{var u=e[Fr(o[9][0].data)][0],d=ot(u.data),f=e[Fr(d[1][0].data)][0],h=Vt(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var m=ot(f.data);a[c]=m[3].map(function(x){return up(x.data)}).join("")}break}}),a}function gz(e,t){var r,n,s,a,i,o,c,u,d,f,h,m,x,p,g=ot(e),y=Vt(g[1][0].data)>>>0,w=Vt(g[2][0].data)>>>0,v=((n=(r=g[8])==null?void 0:r[0])==null?void 0:n.data)&&Vt(g[8][0].data)>0||!1,_,S;if((a=(s=g[7])==null?void 0:s[0])!=null&&a.data&&t!=0)_=(o=(i=g[7])==null?void 0:i[0])==null?void 0:o.data,S=(u=(c=g[6])==null?void 0:c[0])==null?void 0:u.data;else if((f=(d=g[4])==null?void 0:d[0])!=null&&f.data&&t!=1)_=(m=(h=g[4])==null?void 0:h[0])==null?void 0:m.data,S=(p=(x=g[3])==null?void 0:x[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var b=v?4:1,k=ki(_),T=[],j=0;j<_.length/2;++j){var V=k.getUint16(j*2,!0);V<65535&&T.push([j,V])}if(T.length!=w)throw"Expected ".concat(w," cells, found ").concat(T.length);var C=[];for(j=0;j<T.length-1;++j)C[T[j][0]]=S.subarray(T[j][1]*b,T[j+1][1]*b);return T.length>=1&&(C[T[T.length-1][0]]=S.subarray(T[T.length-1][1]*b)),{R:y,cells:C}}function vz(e,t){var r,n=ot(t.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?Vt(n[7][0].data)>>>0>0?1:0:-1,a=jg(n[5],function(i){return gz(i,s)});return{nrows:Vt(n[4][0].data)>>>0,data:a.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(c,u){if(i[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));i[o.R][u]=c}),i},[])}}function yz(e,t,r){var n,s=ot(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(Vt(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(Vt(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=Ye(a);var i=ot(s[4][0].data),o=Zw(e,e[Fr(i[4][0].data)][0]),c=(n=i[17])!=null&&n[0]?Zw(e,e[Fr(i[17][0].data)][0]):[],u=ot(i[3][0].data),d=0;u[1].forEach(function(f){var h=ot(f.data),m=e[Fr(h[2][0].data)][0],x=Vt(m.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var p=vz(e,m);p.data.forEach(function(g,y){g.forEach(function(w,v){var _=Ge({r:d+y,c:v}),S=xz(w,o,c);S&&(r[_]=S)})}),d+=p.nrows})}function wz(e,t){var r=ot(t.data),n={"!ref":"A1"},s=e[Fr(r[2][0].data)],a=Vt(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return yz(e,s[0],n),n}function _z(e,t){var r,n=ot(t.data),s={name:(r=n[1])!=null&&r[0]?up(n[1][0].data):"",sheets:[]},a=jg(n[2],Fr);return a.forEach(function(i){e[i].forEach(function(o){var c=Vt(o.meta[1][0].data);c==6e3&&s.sheets.push(wz(e,o))})}),s}function bz(e,t){var r=Og(),n=ot(t.data),s=jg(n[1],Fr);if(s.forEach(function(a){e[a].forEach(function(i){var o=Vt(i.meta[1][0].data);if(o==2){var c=_z(e,i);c.sheets.forEach(function(u,d){Dg(r,u,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function yh(e){var t,r,n,s,a={},i=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=Pn(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var d;try{d=Fn(u)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){a[f.id]=f.messages,i.push(f.id)})}}),!i.length)throw new Error("File has no messages");var o=((s=(n=(r=(t=a==null?void 0:a[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Vt(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||i.forEach(function(c){a[c].forEach(function(u){var d=Vt(u.meta[1][0].data)>>>0;if(d==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return bz(a,o)}function kz(e,t,r){var n,s,a,i;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var o=((i=(a=e[8])==null?void 0:a[0])==null?void 0:i.data)&&Vt(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,u=ki(e[7][0].data),d=0,f=[],h=ki(e[4][0].data),m=0,x=[],p=0;p<t.length;++p){if(t[p]==null){u.setUint16(p*2,65535,!0),h.setUint16(p*2,65535);continue}u.setUint16(p*2,d,!0),h.setUint16(p*2,m,!0);var g,y;switch(typeof t[p]){case"string":g=gh({t:"s",v:t[p]},r),y=vh({t:"s",v:t[p]},r);break;case"number":g=gh({t:"n",v:t[p]},r),y=vh({t:"n",v:t[p]},r);break;case"boolean":g=gh({t:"b",v:t[p]},r),y=vh({t:"b",v:t[p]},r);break;default:throw new Error("Unsupported value "+t[p])}f.push(g),d+=g.length,x.push(y),m+=y.length,++c}for(e[2][0].data=ut(c);p<e[7][0].data.length/2;++p)u.setUint16(p*2,65535,!0),h.setUint16(p*2,65535,!0);return e[6][0].data=ja(f),e[3][0].data=ja(x),c}function Sz(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=an(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(Ye(n)));var a=g0(r,{range:n,header:1}),i=["~Sh33tJ5~"];a.forEach(function(H){return H.forEach(function(D){typeof D=="string"&&i.push(D)})});var o={},c=[],u=Le.read(t.numbers,{type:"base64"});u.FileIndex.map(function(H,D){return[H,u.FullPaths[D]]}).forEach(function(H){var D=H[0],z=H[1];if(D.type==2&&D.name.match(/\.iwa/)){var B=D.content,ne=Pn(B),U=Fn(ne);U.forEach(function(J){c.push(J.id),o[J.id]={deps:[],location:z,type:Vt(J.messages[0].meta[1][0].data)}})}}),c.sort(function(H,D){return H-D});var d=c.filter(function(H){return H>1}).map(function(H){return[H,ut(H)]});u.FileIndex.map(function(H,D){return[H,u.FullPaths[D]]}).forEach(function(H){var D=H[0];if(H[1],!!D.name.match(/\.iwa/)){var z=Fn(Pn(D.content));z.forEach(function(B){B.messages.forEach(function(ne){d.forEach(function(U){B.messages.some(function(J){return Vt(J.meta[1][0].data)!=11006&&uz(J.data,U[1])})&&o[U[0]].deps.push(B.id)})})})}});for(var f=Le.find(u,o[1].location),h=Fn(Pn(f.content)),m,x=0;x<h.length;++x){var p=h[x];p.id==1&&(m=p)}var g=Fr(ot(m.messages[0].data)[1][0].data);for(f=Le.find(u,o[g].location),h=Fn(Pn(f.content)),x=0;x<h.length;++x)p=h[x],p.id==g&&(m=p);for(g=Fr(ot(m.messages[0].data)[2][0].data),f=Le.find(u,o[g].location),h=Fn(Pn(f.content)),x=0;x<h.length;++x)p=h[x],p.id==g&&(m=p);for(g=Fr(ot(m.messages[0].data)[2][0].data),f=Le.find(u,o[g].location),h=Fn(Pn(f.content)),x=0;x<h.length;++x)p=h[x],p.id==g&&(m=p);var y=ot(m.messages[0].data);{y[6][0].data=ut(n.e.r+1),y[7][0].data=ut(n.e.c+1);var w=Fr(y[46][0].data),v=Le.find(u,o[w].location),_=Fn(Pn(v.content));{for(var S=0;S<_.length&&_[S].id!=w;++S);if(_[S].id!=w)throw"Bad ColumnRowUIDMapArchive";var b=ot(_[S].messages[0].data);b[1]=[],b[2]=[],b[3]=[];for(var k=0;k<=n.e.c;++k){var T=[];T[1]=T[2]=[{type:0,data:ut(k+420690)}],b[1].push({type:2,data:xr(T)}),b[2].push({type:0,data:ut(k)}),b[3].push({type:0,data:ut(k)})}b[4]=[],b[5]=[],b[6]=[];for(var j=0;j<=n.e.r;++j)T=[],T[1]=T[2]=[{type:0,data:ut(j+726270)}],b[4].push({type:2,data:xr(T)}),b[5].push({type:0,data:ut(j)}),b[6].push({type:0,data:ut(j)});_[S].messages[0].data=xr(b)}v.content=Xi(Ki(_)),v.size=v.content.length,delete y[46];var V=ot(y[4][0].data);{V[7][0].data=ut(n.e.r+1);var C=ot(V[1][0].data),R=Fr(C[2][0].data);v=Le.find(u,o[R].location),_=Fn(Pn(v.content));{if(_[0].id!=R)throw"Bad HeaderStorageBucket";var X=ot(_[0].messages[0].data);for(j=0;j<a.length;++j){var G=ot(X[2][0].data);G[1][0].data=ut(j),G[4][0].data=ut(a[j].length),X[2][j]={type:X[2][0].type,data:xr(G)}}_[0].messages[0].data=xr(X)}v.content=Xi(Ki(_)),v.size=v.content.length;var Y=Fr(V[2][0].data);v=Le.find(u,o[Y].location),_=Fn(Pn(v.content));{if(_[0].id!=Y)throw"Bad HeaderStorageBucket";for(X=ot(_[0].messages[0].data),k=0;k<=n.e.c;++k)G=ot(X[2][0].data),G[1][0].data=ut(k),G[4][0].data=ut(n.e.r+1),X[2][k]={type:X[2][0].type,data:xr(G)};_[0].messages[0].data=xr(X)}v.content=Xi(Ki(_)),v.size=v.content.length;var se=Fr(V[4][0].data);(function(){for(var H=Le.find(u,o[se].location),D=Fn(Pn(H.content)),z,B=0;B<D.length;++B){var ne=D[B];ne.id==se&&(z=ne)}var U=ot(z.messages[0].data);{U[3]=[];var J=[];i.forEach(function(O,be){J[1]=[{type:0,data:ut(be)}],J[2]=[{type:0,data:ut(1)}],J[3]=[{type:2,data:cz(O)}],U[3].push({type:2,data:xr(J)})})}z.messages[0].data=xr(U);var ae=Ki(D),q=Xi(ae);H.content=q,H.size=H.content.length})();var ie=ot(V[3][0].data);{var oe=ie[1][0];delete ie[2];var W=ot(oe.data);{var ue=Fr(W[2][0].data);(function(){for(var H=Le.find(u,o[ue].location),D=Fn(Pn(H.content)),z,B=0;B<D.length;++B){var ne=D[B];ne.id==ue&&(z=ne)}var U=ot(z.messages[0].data);{delete U[6],delete ie[7];var J=new Uint8Array(U[5][0].data);U[5]=[];for(var ae=0,q=0;q<=n.e.r;++q){var O=ot(J);ae+=kz(O,a[q],i),O[1][0].data=ut(q),U[5].push({data:xr(O),type:2})}U[1]=[{type:0,data:ut(n.e.c+1)}],U[2]=[{type:0,data:ut(n.e.r+1)}],U[3]=[{type:0,data:ut(ae)}],U[4]=[{type:0,data:ut(n.e.r+1)}]}z.messages[0].data=xr(U);var be=Ki(D),Ee=Xi(be);H.content=Ee,H.size=H.content.length})()}oe.data=xr(W)}V[3][0].data=xr(ie)}y[4][0].data=xr(V)}m.messages[0].data=xr(y);var ve=Ki(h),F=Xi(ve);return f.content=F,f.size=f.content.length,u}function sT(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function Ag(e){sT([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Fg(e){sT([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Ez(e){return rt.WS.indexOf(e)>-1?"sheet":e==rt.CS?"chart":e==rt.DS?"dialog":e==rt.MS?"macro":e&&e.length?e:"sheet"}function Nz(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,Ez(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Tz(e,t,r,n,s,a,i,o,c,u,d,f){try{a[n]=Ql(xn(e,r,!0),t);var h=Qt(e,t),m;switch(o){case"sheet":m=qV(h,t,s,c,a[n],u,d,f);break;case"chart":if(m=YV(h,t,s,c,a[n],u,d,f),!m||!m["!drawel"])break;var x=Al(m["!drawel"].Target,t),p=Vc(x),g=I7(xn(e,x,!0),Ql(xn(e,p,!0),x)),y=Al(g,x),w=Vc(y);m=kV(xn(e,y,!0),y,c,Ql(xn(e,w,!0),y),u,m);break;case"macro":m=JV(h,t,s,c,a[n],u,d,f);break;case"dialog":m=QV(h,t,s,c,a[n],u,d,f);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=m;var v=[];a&&a[n]&&$t(a[n]).forEach(function(_){var S="";if(a[n][_].Type==rt.CMNT){S=Al(a[n][_].Target,t);var b=r$(Qt(e,S,!0),S,c);if(!b||!b.length)return;Mw(m,b,!1)}a[n][_].Type==rt.TCMNT&&(S=Al(a[n][_].Target,t),v=v.concat(M7(Qt(e,S,!0),c)))}),v&&v.length&&Mw(m,v,!0,c.people||[])}catch(_){if(c.WTF)throw _}}function jn(e){return e.charAt(0)=="/"?e.slice(1):e}function Cz(e,t){if(nl(),t=t||{},Ag(t),On(e,"META-INF/manifest.xml")||On(e,"objectdata.xml"))return qw(e,t);if(On(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof yh<"u"){if(e.FileIndex)return yh(e);var r=Le.utils.cfb_new();return aw(e).forEach(function(G){Qe(r,G,BO(e,G))}),yh(r)}throw new Error("Unsupported NUMBERS file")}if(!On(e,"[Content_Types].xml"))throw On(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):On(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=aw(e),s=PD(xn(e,"[Content_Types].xml")),a=!1,i,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",Qt(e,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!Qt(e,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(Zl=[],s.sst)try{Zl=t$(Qt(e,jn(s.sst)),s.sst,t)}catch(G){if(t.WTF)throw G}t.cellStyles&&s.themes.length&&(c=e$(xn(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(u=ZV(Qt(e,jn(s.style)),s.style,c,t))}s.links.map(function(G){try{var Y=Ql(xn(e,Vc(jn(G))),G);return s$(Qt(e,jn(G)),Y,G,t)}catch{}});var d=XV(Qt(e,jn(s.workbooks[0])),s.workbooks[0],t),f={},h="";s.coreprops.length&&(h=Qt(e,jn(s.coreprops[0]),!0),h&&(f=GE(h)),s.extprops.length!==0&&(h=Qt(e,jn(s.extprops[0]),!0),h&&BD(h,f,t)));var m={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(h=xn(e,jn(s.custprops[0]),!0),h&&(m=VD(h,t)));var x={};if((t.bookSheets||t.bookProps)&&(d.Sheets?i=d.Sheets.map(function(Y){return Y.name}):f.Worksheets&&f.SheetNames.length>0&&(i=f.SheetNames),t.bookProps&&(x.Props=f,x.Custprops=m),t.bookSheets&&typeof i<"u"&&(x.SheetNames=i),t.bookSheets?x.SheetNames:t.bookProps))return x;i={};var p={};t.bookDeps&&s.calcchain&&(p=n$(Qt(e,jn(s.calcchain)),s.calcchain));var g=0,y={},w,v;{var _=d.Sheets;f.Worksheets=_.length,f.SheetNames=[];for(var S=0;S!=_.length;++S)f.SheetNames[S]=_[S].name}var b=a?"bin":"xml",k=s.workbooks[0].lastIndexOf("/"),T=(s.workbooks[0].slice(0,k+1)+"_rels/"+s.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");On(e,T)||(T="xl/_rels/workbook."+b+".rels");var j=Ql(xn(e,T,!0),T.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=a$(Qt(e,jn(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=U7(Qt(e,jn(s.people[0])),t)),j&&(j=Nz(j,d.Sheets));var V=Qt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=f.Worksheets;++g){var C="sheet";if(j&&j[g]?(w="xl/"+j[g][1].replace(/[\/]?xl\//,""),On(e,w)||(w=j[g][1]),On(e,w)||(w=T.replace(/_rels\/.*$/,"")+j[g][1]),C=j[g][2]):(w="xl/worksheets/sheet"+(g+1-V)+"."+b,w=w.replace(/sheet0\./,"sheet.")),v=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(f.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var R=!1,X=0;X!=t.sheets.length;++X)typeof t.sheets[X]=="number"&&t.sheets[X]==g&&(R=1),typeof t.sheets[X]=="string"&&t.sheets[X].toLowerCase()==f.SheetNames[g].toLowerCase()&&(R=1);if(!R)continue e}}Tz(e,w,v,f.SheetNames[g],g,y,i,C,t,d,c,u)}return x={Directory:s,Workbook:d,Props:f,Custprops:m,Deps:p,Sheets:i,SheetNames:f.SheetNames,Strings:Zl,Styles:u,Themes:c,SSF:kt(He)},t&&t.bookFiles&&(e.files?(x.keys=n,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(G,Y){G=G.replace(/^Root Entry[\/]/,""),x.keys.push(G),x.files[G]=e.FileIndex[Y]}))),t&&t.bookVBA&&(s.vba.length>0?x.vbaraw=Qt(e,jn(s.vba[0]),!0):s.defaults&&s.defaults.bin===X7&&(x.vbaraw=Qt(e,"xl/vbaProject.bin",!0))),x}function jz(e,t){var r=t||{},n="Workbook",s=Le.find(e,n);try{if(n="/!DataSpaces/Version",s=Le.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(aM(s.content),n="/!DataSpaces/DataSpaceMap",s=Le.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=oM(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Le.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=lM(s.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Le.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);uM(s.content)}catch{}if(n="/EncryptionInfo",s=Le.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=dM(s.content);if(n="/EncryptedPackage",s=Le.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function Az(e,t){return t.bookType=="ods"?nT(e,t):t.bookType=="numbers"?Sz(e,t):t.bookType=="xlsb"?Fz(e,t):Pz(e,t)}function Fz(e,t){yo=1024,e&&!e.SSF&&(e.SSF=kt(He)),e&&e.SSF&&(nl(),J0(e.SSF),t.revssf=Z0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ec?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=FN.indexOf(t.bookType)>-1,s=xg();Fg(t=t||{});var a=rg(),i="",o=0;if(t.cellXfs=[],Ma(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Qe(a,i,KE(e.Props,t)),s.coreprops.push(i),dt(t.rels,2,i,rt.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Qe(a,i,YE(e.Props)),s.extprops.push(i),dt(t.rels,3,i,rt.EXT_PROPS),e.Custprops!==e.Props&&$t(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Qe(a,i,JE(e.Custprops)),s.custprops.push(i),dt(t.rels,4,i,rt.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,Qe(a,i,o$(o-1,i,t,e,d)),s.sheets.push(i),dt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,rt.WS[0])}if(f){var m=f["!comments"],x=!1,p="";m&&m.length>0&&(p="xl/comments"+o+"."+r,Qe(a,p,u$(m,p)),s.comments.push(p),dt(d,-1,"../comments"+o+"."+r,rt.CMNT),x=!0),f["!legacy"]&&x&&Qe(a,"xl/drawings/vmlDrawing"+o+".vml",jN(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&Qe(a,Vc(i),jo(d))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Qe(a,i,c$(t.Strings,i,t)),s.strs.push(i),dt(t.wbrels,-1,"sharedStrings."+r,rt.SST)),i="xl/workbook."+r,Qe(a,i,i$(e,i)),s.workbooks.push(i),dt(t.rels,1,i,rt.WB),i="xl/theme/theme1.xml",Qe(a,i,bg(e.Themes,t)),s.themes.push(i),dt(t.wbrels,-1,"theme/theme1.xml",rt.THEME),i="xl/styles."+r,Qe(a,i,l$(e,i,t)),s.styles.push(i),dt(t.wbrels,-1,"styles."+r,rt.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Qe(a,i,e.vbaraw),s.vba.push(i),dt(t.wbrels,-1,"vbaProject.bin",rt.VBA)),i="xl/metadata."+r,Qe(a,i,d$(i)),s.metadata.push(i),dt(t.wbrels,-1,"metadata."+r,rt.XLMETA),Qe(a,"[Content_Types].xml",WE(s,t)),Qe(a,"_rels/.rels",jo(t.rels)),Qe(a,"xl/_rels/workbook."+r+".rels",jo(t.wbrels)),delete t.revssf,delete t.ssf,a}function Pz(e,t){yo=1024,e&&!e.SSF&&(e.SSF=kt(He)),e&&e.SSF&&(nl(),J0(e.SSF),t.revssf=Z0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,ec?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=FN.indexOf(t.bookType)>-1,s=xg();Fg(t=t||{});var a=rg(),i="",o=0;if(t.cellXfs=[],Ma(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Qe(a,i,KE(e.Props,t)),s.coreprops.push(i),dt(t.rels,2,i,rt.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Qe(a,i,YE(e.Props)),s.extprops.push(i),dt(t.rels,3,i,rt.EXT_PROPS),e.Custprops!==e.Props&&$t(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Qe(a,i,JE(e.Custprops)),s.custprops.push(i),dt(t.rels,4,i,rt.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],m=(h||{})["!type"]||"sheet";switch(m){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,Qe(a,i,$N(o-1,t,e,f)),s.sheets.push(i),dt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,rt.WS[0])}if(h){var x=h["!comments"],p=!1,g="";if(x&&x.length>0){var y=!1;x.forEach(function(w){w[1].forEach(function(v){v.T==!0&&(y=!0)})}),y&&(g="xl/threadedComments/threadedComment"+o+"."+r,Qe(a,g,B7(x,d,t)),s.threadedcomments.push(g),dt(f,-1,"../threadedComments/threadedComment"+o+"."+r,rt.TCMNT)),g="xl/comments"+o+"."+r,Qe(a,g,AN(x)),s.comments.push(g),dt(f,-1,"../comments"+o+"."+r,rt.CMNT),p=!0}h["!legacy"]&&p&&Qe(a,"xl/drawings/vmlDrawing"+o+".vml",jN(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&Qe(a,Vc(i),jo(f))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Qe(a,i,gN(t.Strings,t)),s.strs.push(i),dt(t.wbrels,-1,"sharedStrings."+r,rt.SST)),i="xl/workbook."+r,Qe(a,i,KN(e)),s.workbooks.push(i),dt(t.rels,1,i,rt.WB),i="xl/theme/theme1.xml",Qe(a,i,bg(e.Themes,t)),s.themes.push(i),dt(t.wbrels,-1,"theme/theme1.xml",rt.THEME),i="xl/styles."+r,Qe(a,i,EN(e,t)),s.styles.push(i),dt(t.wbrels,-1,"styles."+r,rt.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Qe(a,i,e.vbaraw),s.vba.push(i),dt(t.wbrels,-1,"vbaProject.bin",rt.VBA)),i="xl/metadata."+r,Qe(a,i,CN()),s.metadata.push(i),dt(t.wbrels,-1,"metadata."+r,rt.XLMETA),d.length>1&&(i="xl/persons/person.xml",Qe(a,i,V7(d)),s.people.push(i),dt(t.wbrels,-1,"persons/person.xml",rt.PEOPLE)),Qe(a,"[Content_Types].xml",WE(s,t)),Qe(a,"_rels/.rels",jo(t.rels)),Qe(a,"xl/_rels/workbook."+r+".rels",jo(t.wbrels)),delete t.revssf,delete t.ssf,a}function Pg(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=kn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Rz(e,t){return Le.find(e,"EncryptedPackage")?jz(e,t):JN(e,t)}function Oz(e,t){var r,n=e,s=t||{};return s.type||(s.type=tt&&Buffer.isBuffer(e)?"buffer":"base64"),r=yE(n,s),Cz(r,s)}function aT(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return lp(e.slice(r),t);default:break e}return Ko.to_workbook(e,t)}function Dz(e,t){var r="",n=Pg(e,t);switch(t.type){case"base64":r=kn(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=yi(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=pt(r)),t.type="binary",aT(r,t)}function Iz(e,t){var r=e;return t.type=="base64"&&(r=kn(r)),r=Dc.utils.decode(1200,r.slice(2),"str"),t.type="binary",aT(r,t)}function Lz(e){return e.match(/[^\x00-\x7F]/)?xs(e):e}function wh(e,t,r,n){return n?(r.type="string",Ko.to_workbook(e,r)):Ko.to_workbook(t,r)}function x0(e,t){Jx();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return x0(new Uint8Array(e),(r=kt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Fo={},r.dateNF&&(Fo.dateNF=r.dateNF),r.type||(r.type=tt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=tt?"buffer":"binary",n=FO(e),typeof Uint8Array<"u"&&!tt&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=Lz(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=kt(r),r.type="array",x0(Qx(n),r)}switch((s=Pg(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return Rz(Le.read(n,r),r);break;case 9:if(s[1]<=8)return JN(n,r);break;case 60:return lp(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return $L(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return pN.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?Oz(n,r):wh(e,n,r,a);case 239:return s[3]===60?lp(n,r):wh(e,n,r,a);case 255:if(s[1]===254)return Iz(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return ui.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return ui.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return op.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return bN.to_workbook(n,r);break;case 10:case 13:case 32:return Dz(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return VL.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?op.to_workbook(n,r):wh(e,n,r,a)}function iT(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return au(t.file,Le.write(e,{type:tt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Le.write(e,t)}function Mz(e,t){var r=kt(t||{}),n=Az(e,r);return Bz(n,r)}function Bz(e,t){var r={},n=tt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?Le.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(Y0(s))}return t.password&&typeof encrypt_agile<"u"?iT(encrypt_agile(s,t.password),t):t.type==="file"?au(t.file,s):t.type=="string"?pt(s):s}function Uz(e,t){var r=t||{},n=L$(e,r);return iT(n,r)}function fs(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Ic(xs(n));case"binary":return xs(n);case"string":return e;case"file":return au(t.file,n,"utf8");case"buffer":return tt?Js(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):fs(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Vz(e,t){switch(t.type){case"base64":return Ic(e);case"binary":return e;case"string":return e;case"file":return au(t.file,e,"binary");case"buffer":return tt?Js(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function qu(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Ic(r):t.type=="string"?pt(r):r;case"file":return au(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function oT(e,t){Jx(),RV(e);var r=kt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=oT(e,r);return r.type="array",Y0(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return fs(A$(e,r),r);case"slk":case"sylk":return fs(mN.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return fs(ZN(e.Sheets[e.SheetNames[s]],r),r);case"txt":return Vz(lT(e.Sheets[e.SheetNames[s]],r),r);case"csv":return fs(Rg(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return fs(pN.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return qu(op.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return fs(Ko.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return fs(bN.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return fs(xN.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return fs(nT(e,r),r);case"wk1":return qu(ui.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return qu(ui.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),qu(QN(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),Uz(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Mz(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function $z(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Si(e,t,r){var n={};return n.type="file",n.file=t,$z(n),oT(e,n)}function zz(e,t,r,n,s,a,i,o){var c=Xt(r),u=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,h=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!i||e[r])for(var m=t.s.c;m<=t.e.c;++m){var x=i?e[r][m]:e[n[m]+c];if(x===void 0||x.t===void 0){if(u===void 0)continue;a[m]!=null&&(h[a[m]]=u);continue}var p=x.v;switch(x.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(a[m]!=null){if(p==null)if(x.t=="e"&&p===null)h[a[m]]=null;else if(u!==void 0)h[a[m]]=u;else if(d&&p===null)h[a[m]]=null;else continue;else h[a[m]]=d&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?p:Gs(x,p,o);p!=null&&(f=!1)}}return{row:h,isempty:f}}function g0(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],i=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":c=it(d);break;case"number":c=it(e["!ref"]),c.s.r=d;break;default:c=d}n>0&&(s=0);var f=Xt(c.s.r),h=[],m=[],x=0,p=0,g=Array.isArray(e),y=c.s.r,w=0,v={};g&&!e[y]&&(e[y]=[]);var _=u.skipHidden&&e["!cols"]||[],S=u.skipHidden&&e["!rows"]||[];for(w=c.s.c;w<=c.e.c;++w)if(!(_[w]||{}).hidden)switch(h[w]=Ft(w),r=g?e[y][w]:e[h[w]+f],n){case 1:a[w]=w-c.s.c;break;case 2:a[w]=h[w];break;case 3:a[w]=u.header[w-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=Gs(r,null,u),p=v[i]||0,!p)v[i]=1;else{do o=i+"_"+p++;while(v[o]);v[i]=p,v[o]=1}a[w]=o}for(y=c.s.r+s;y<=c.e.r;++y)if(!(S[y]||{}).hidden){var b=zz(e,c,y,h,n,a,g,u);(b.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(m[x++]=b.row)}return m.length=x,m}var e_=/"/g;function Wz(e,t,r,n,s,a,i,o){for(var c=!0,u=[],d="",f=Xt(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var m=o.dense?(e[r]||[])[h]:e[n[h]+f];if(m==null)d="";else if(m.v!=null){c=!1,d=""+(o.rawNumbers&&m.t=="n"?m.v:Gs(m,null,o));for(var x=0,p=0;x!==d.length;++x)if((p=d.charCodeAt(x))===s||p===a||p===34||o.forceQuotes){d='"'+d.replace(e_,'""')+'"';break}d=="ID"&&(d='"ID"')}else m.f!=null&&!m.F?(c=!1,d="="+m.f,d.indexOf(",")>=0&&(d='"'+d.replace(e_,'""')+'"')):d="";u.push(d)}return o.blankrows===!1&&c?null:u.join(i)}function Rg(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=it(e["!ref"]),a=n.FS!==void 0?n.FS:",",i=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),u=new RegExp((a=="|"?"\\|":a)+"+$"),d="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],m=n.skipHidden&&e["!rows"]||[],x=s.s.c;x<=s.e.c;++x)(h[x]||{}).hidden||(f[x]=Ft(x));for(var p=0,g=s.s.r;g<=s.e.r;++g)(m[g]||{}).hidden||(d=Wz(e,s,g,f,i,c,a,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((p++?o:"")+d)));return delete n.dense,r.join("")}function lT(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Rg(e,t);return r}function Hz(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=it(e["!ref"]),a="",i=[],o,c=[],u=Array.isArray(e);for(o=s.s.c;o<=s.e.c;++o)i[o]=Ft(o);for(var d=s.s.r;d<=s.e.r;++d)for(a=Xt(d),o=s.s.c;o<=s.e.c;++o)if(t=i[o]+a,r=u?(e[d]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function cT(e,t,r){var n=r||{},s=+!n.skipHeader,a=e||{},i=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?Pt(n.origin):n.origin;i=c.r,o=c.c}var u,d={s:{c:0,r:0},e:{c:o,r:i+t.length-1+s}};if(a["!ref"]){var f=it(a["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),i==-1&&(i=f.e.r+1,d.e.r=i+t.length-1+s)}else i==-1&&(i=0,d.e.r=t.length-1+s);var h=n.header||[],m=0;t.forEach(function(p,g){$t(p).forEach(function(y){(m=h.indexOf(y))==-1&&(h[m=h.length]=y);var w=p[y],v="z",_="",S=Ge({c:o+m,r:i+g+s});u=Xc(a,S),w&&typeof w=="object"&&!(w instanceof Date)?a[S]=w:(typeof w=="number"?v="n":typeof w=="boolean"?v="b":typeof w=="string"?v="s":w instanceof Date?(v="d",n.cellDates||(v="n",w=or(w)),_=n.dateNF||He[14]):w===null&&n.nullError&&(v="e",w=0),u?(u.t=v,u.v=w,delete u.w,delete u.R,_&&(u.z=_)):a[S]=u={t:v,v:w},_&&(u.z=_))})}),d.e.c=Math.max(d.e.c,o+h.length-1);var x=Xt(i);if(s)for(m=0;m<h.length;++m)a[Ft(m+o)+x]={t:"s",v:h[m]};return a["!ref"]=Ye(d),a}function Gz(e,t){return cT(null,e,t)}function Xc(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Pt(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Xc(e,Ge(t)):Xc(e,Ge({r:t,c:r||0}))}function Kz(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Og(){return{SheetNames:[],Sheets:{}}}function Dg(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var i=a&&a[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=i+s)!=-1;++s);}if(GN(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function Xz(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=Kz(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function qz(e,t){return e.z=t,e}function uT(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function Yz(e,t,r){return uT(e,"#"+t,r)}function Jz(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function Qz(e,t,r,n){for(var s=typeof t!="string"?t:it(t),a=typeof t=="string"?t:Ye(t),i=s.s.r;i<=s.e.r;++i)for(var o=s.s.c;o<=s.e.c;++o){var c=Xc(e,i,o);c.t="n",c.F=a,delete c.v,i==s.s.r&&o==s.s.c&&(c.f=r,n&&(c.D=!0))}return e}var At={encode_col:Ft,encode_row:Xt,encode_cell:Ge,encode_range:Ye,decode_col:ug,decode_row:cg,split_cell:cD,decode_cell:Pt,decode_range:an,format_cell:Gs,sheet_add_aoa:LE,sheet_add_json:cT,sheet_add_dom:eT,aoa_to_sheet:sl,json_to_sheet:Gz,table_to_sheet:tT,table_to_book:az,sheet_to_csv:Rg,sheet_to_txt:lT,sheet_to_json:g0,sheet_to_html:ZN,sheet_to_formulae:Hz,sheet_to_row_object_array:g0,sheet_get_cell:Xc,book_new:Og,book_append_sheet:Dg,book_set_sheet_visibility:Xz,cell_set_number_format:qz,cell_set_hyperlink:uT,cell_set_internal_link:Yz,cell_add_comment:Jz,sheet_set_array_formula:Qz,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function Zz(){const{user:e}=on(),{selectedCamp:t}=Nn(),[r,n]=E.useState(!1),[s,a]=E.useState(""),[i,o]=E.useState(""),[c,u]=E.useState(!1),[d,f]=E.useState(0),[h,m]=E.useState(0),[x,p]=E.useState(0),[g,y]=E.useState(""),[w,v]=E.useState(""),[_,S]=E.useState(""),[b,k]=E.useState(""),[T,j]=E.useState(""),[V,C]=E.useState(""),[R,X]=E.useState([]),[G,Y]=E.useState(""),[se,ie]=E.useState(""),[oe,W]=E.useState(""),ue=async re=>{try{const pe=await Uo(re);X(pe)}catch(pe){console.error("Failed to load delegates",pe)}},ve=async re=>{try{const pe=await rn(re);if(pe.length>0){const Re=pe[pe.length-1],K=parseInt(Re.family_number,10);isNaN(K)?y("1"):y(String(K+1))}else y("1")}catch(pe){console.error("Failed to suggest family number",pe)}};E.useEffect(()=>{t?(ue(t.camp_id),ve(t.camp_id)):(X([]),y(""))},[t]);const[F,H]=E.useState([]),[D,z]=E.useState({name:"",nid:"",dob:"",role:"son",healthNotes:"",isPregnant:!1,isNursing:!1,guardianGender:"male",roleDescription:"",deceasedHusbandName:"",husbandDeathDate:"",shoeSize:"",clothesSize:""}),[B,ne]=E.useState(""),[U,J]=E.useState(""),[ae,q]=E.useState(""),O=[{value:"husband",label:""},{value:"wife",label:""},{value:"second_wife",label:" "},{value:"widow",label:""},{value:"widower",label:""},{value:"divorced",label:""},{value:"abandoned",label:""},{value:"guardian",label:""},{value:"son",label:""},{value:"daughter",label:""},{value:"other",label:""}],be=()=>{const re=[" "," "," ",""," "," ","  ","  "," ","  (//)"," "," "," "," "," (/)"," (/)",""],pe=[["101"," ","800000000",""," ","1980-01-01","0599000000","0599111111"," ",""," "," ","42","XL","",""," "],["101"," ","900000000",""," ","1985-05-15","0599000000",""," ",""," ","","38","L","",""," "],["102"," ","750000000","","","1975-03-10","0598111111",""," ","","","","39","XXL","","","  "]],Re=At.aoa_to_sheet([re,...pe]),K=At.book_new();K.Workbook||(K.Workbook={}),K.Workbook.Views||(K.Workbook.Views=[]),K.Workbook.Views[0]||(K.Workbook.Views[0]={}),K.Workbook.Views[0].RTL=!0,At.book_append_sheet(K,Re," "),Si(K,"family_data_template.xlsx")},Ee=async re=>{if(!t){alert("      "),re.target.value="";return}const pe=re.target.files[0];if(pe){u(!0),n(!0),o("");try{const Re=await pe.arrayBuffer(),K=x0(Re,{type:"array",cellDates:!0}),Se=K.Sheets[K.SheetNames[0]],de=At.sheet_to_json(Se,{header:1,defval:""});await Ve(de)}catch(Re){console.error("File upload error:",Re),o("   : "+Re.message)}finally{u(!1),n(!1),re.target.value=""}}},Ve=async re=>{if(re.length<2){o("      ");return}const pe=re.slice(1),Re={:"husband",:"father",:"father",:"wife",:"wife",:"mother",:"mother",:"son",:"daughter",:"daughter",:"daughter",:"daughter",:"widow",:"widow",:"widow",:"widow",:"widower",:"widower",:"divorced",:"divorced",:"abandoned",:"abandoned",:"grandfather",:"grandmother",:"grandmother"},Se=(await Uo(t==null?void 0:t.camp_id)).map(Te=>Te.name),de=(Te,Oe)=>{const Je=[],It=Te.length,hr=Oe.length;for(let ct=0;ct<=hr;ct++)Je[ct]=[ct];for(let ct=0;ct<=It;ct++)Je[0][ct]=ct;for(let ct=1;ct<=hr;ct++)for(let Wt=1;Wt<=It;Wt++)Oe.charAt(ct-1)===Te.charAt(Wt-1)?Je[ct][Wt]=Je[ct-1][Wt-1]:Je[ct][Wt]=Math.min(Je[ct-1][Wt-1]+1,Je[ct][Wt-1]+1,Je[ct-1][Wt]+1);return Je[hr][It]},Ne=(Te,Oe)=>{const Je=de(Te.toLowerCase(),Oe.toLowerCase()),It=Math.max(Te.length,Oe.length);return It===0?100:(It-Je)/It*100},je=Te=>{if(!Te)return null;let Oe=null,Je=0;for(const It of Se){const hr=Ne(Te,It);hr>Je&&(Je=hr,Oe=It)}return Je>=65?Oe:null},Ie={},Fe=[];for(const Te of pe){if(!Te||Te.length<4)continue;const Oe=String(Te[0]||"").trim(),Je=String(Te[1]||"").trim(),It=String(Te[2]||"").trim(),hr=String(Te[3]||"").trim(),ct=String(Te[4]||"").trim(),Wt=Te[5]?Yt(Te[5]):null,Kr=String(Te[6]||"").trim(),mt=String(Te[7]||"").trim(),Tn=String(Te[8]||"").trim(),Li=String(Te[9]||"").trim(),ks=String(Te[10]||"").trim(),Xr=String(Te[11]||"").trim(),Ba=String(Te[12]||"").trim(),Mi=String(Te[13]||"").trim(),af=String(Te[14]||"").trim().toLowerCase(),of=String(Te[15]||"").trim().toLowerCase(),il=String(Te[16]||"").trim();if(!Oe||!Je)continue;let ls="",hu="";Tn?Tn.includes("")?ls="ready_tent":Tn.includes("")?ls="manufactured_tent":Tn.includes("")?ls="house":(ls="other",hu=Tn):ls=null;const lf=Re[hr]||hr,cf=["","yes","1","true"].includes(af),N=["","yes","1","true"].includes(of);let I=null;il&&(I=je(il),!I&&!Fe.find(A=>A.familyNum===Oe)&&Fe.push({familyNum:Oe,inputDelegate:il})),Ie[Oe]||(Ie[Oe]={family:{number:Oe,address:ct,phone:Kr,alternative_mobile:mt,housing_status:Li,family_needs:ks,shelter_type:ls,shelter_other:hu,delegate:I},members:[]}),Ie[Oe].members.push({name:Je,role:lf,dob:Wt,nid:It,notes:Xr,isPregnant:cf,isNursing:N,shoeSize:Ba,clothesSize:Mi})}if(Fe.length>0){const Oe=`        :

${Fe.map(Je=>`  ${Je.familyNum}:  "${Je.inputDelegate}"  `).join(`
`)}

        .`;o(Oe),alert(Oe);return}const Xe=[];for(const Te in Ie){const Oe=Ie[Te];Xe.push({family_number:Oe.family.number,address:Oe.family.address,contact:Oe.family.phone,alternative_mobile:Oe.family.alternative_mobile,housing_status:Oe.family.housing_status,family_needs:Oe.family.family_needs,shelter_type:Oe.family.shelter_type,shelter_type_other:Oe.family.shelter_other,delegate:Oe.family.delegate||null,members:Oe.members.map(Je=>{const It=zt(Je.role);return{name:Je.name,nid:Je.nid||null,dob:Je.dob||null,gender:It,role:Je.role,is_pregnant:Je.isPregnant||!1,is_nursing:Je.isNursing||!1,shoe_size:Je.shoeSize||null,clothes_size:Je.clothesSize||null,notes:Je.notes||null}})})}try{m(Xe.length),p(0),f(0);const Te=(t==null?void 0:t.camp_id)||"default",Oe=await rn(Te),Je=await zn(Te),It=[];for(let Kr=0;Kr<Xe.length;Kr++){const mt=Xe[Kr];try{if(Oe.find(Xr=>Xr.family_number===mt.family_number&&!Xr.is_departed))throw new Error(`  ${mt.family_number}     `);if(mt.members&&mt.members.length>0){for(const Xr of mt.members)if(Xr.nid){const Ba=Je.find(Mi=>Mi.nid===Xr.nid&&!Mi.is_departed);if(Ba)throw new Error(`  ${Xr.nid} (${Ba.name})      ${Ba.family_number}`)}}const ks=await jc({family_number:mt.family_number,address:mt.address,contact:mt.contact,alternative_mobile:mt.alternative_mobile,housing_status:mt.housing_status,family_needs:mt.family_needs,delegate:mt.delegate||null,shelter_type:mt.shelter_type||null,shelter_type_other:mt.shelter_type_other||null,camp_id:Te});if(mt.members&&mt.members.length>0){for(const Xr of mt.members)await Wd({family_id:ks.family_id,shoe_size:Xr.shoe_size||null,clothes_size:Xr.clothes_size||null,...Xr});await ck(ks.family_id,ks.camp_id,mt.members,e)}It.push({success:!0,family_id:ks.family_id,family_number:ks.family_number})}catch(Li){It.push({success:!1,error:Li.message,family_number:mt.family_number})}const Tn=Kr+1;f(Math.round(Tn/Xe.length*100))}const hr=It.filter(Kr=>Kr.success).length,ct=It.filter(Kr=>!Kr.success).length;if(o(""),ct>0){const Kr=It.filter(mt=>!mt.success).map(mt=>`  ${mt.family_number}: ${mt.error}`).join(`
`);o(`      :

${Kr}`)}let Wt="";hr>0&&(Wt=`   ${hr}  !
`),ct>0&&(Wt+=`   ${ct}    .`),Wt&&(a(Wt),ct>0?alert(Wt+`

      .`):alert(Wt)),e&&hr>0&&Hd({type:"new_entry",message:` ${e.fullName||e.username||e.email}  ${hr}  .`,user_name:e.fullName||e.username||e.email}),setTimeout(()=>a(""),1e4)}catch(Te){console.error("Batch import error:",Te);const Oe="   : "+Te.message;o(Oe),alert(Oe)}finally{f(0),p(0),m(0)}},Ue=async()=>{if(!D.name){alert("   ");return}if(!B||!U||!ae){alert("     ( -  - )");return}const re=parseInt(B),pe=parseInt(U),Re=parseInt(ae);if(re<1||re>31||pe<1||pe>12||Re<1900||Re>new Date().getFullYear()){alert("   ");return}const K=`${Re}-${String(pe).padStart(2,"0")}-${String(re).padStart(2,"0")}`;if(!D.nid||D.nid.trim()===""){alert("  ");return}const Se=D.nid.replace(/\D/g,"");if(Se.length!==9){alert("     9  ");return}if(F.some(Ne=>Ne.nid===Se)){alert("       ");return}if(await zd(Se)){alert("       !");return}H([...F,{...D,dob:K,nid:Se,id:Date.now()}]),z({name:"",nid:"",dob:"",role:"son",healthNotes:"",isPregnant:!1,isNursing:!1,guardianGender:"male",roleDescription:"",deceasedHusbandName:"",husbandDeathDate:"",shoeSize:"",clothesSize:""}),ne(""),J(""),q("")},me=re=>{H(F.filter(pe=>pe.id!==re))},et=re=>{if(!re||re.trim()==="")return!0;const pe=re.replace(/\D/g,"");return pe.length===10?pe.startsWith("0"):pe.length===9?!pe.startsWith("0"):!1},lt=async()=>{if(!t){alert("      ");return}if(!g||!w||F.length===0){alert("         ");return}if(_&&!et(_)){alert("   .  : 0590000000  590000000");return}if(b&&!et(b)){alert("    .  : 0590000000  590000000");return}n(!0),o("");try{if((await rn(t.camp_id)).some(de=>de.family_number===g)){alert("          "),n(!1);return}const pe=_?_.replace(/\D/g,""):"",Re=b?b.replace(/\D/g,""):"",K=await jc({family_number:g,address:w,contact:pe,alternative_mobile:Re,housing_status:T,family_needs:V,delegate:G||null,shelter_type:se||null,shelter_type_other:se==="other"?oe:null,camp_id:t.camp_id});for(const de of F){let Ne;de.role==="guardian"?Ne=de.guardianGender||"male":Ne=zt(de.role),await Wd({family_id:K.family_id,name:de.name,nid:de.nid||null,dob:de.dob||null,gender:Ne,role:de.role,role_description:de.role==="other"?de.roleDescription:null,deceased_husband_name:de.role==="widow"?de.deceasedHusbandName:null,husband_death_date:de.role==="widow"?de.husbandDeathDate:null,is_pregnant:de.isPregnant||!1,is_nursing:de.isNursing||!1,shoe_size:de.shoeSize||null,clothes_size:de.clothesSize||null,notes:de.healthNotes||null})}a("   !"),e&&Hd({type:"new_entry",message:` ${e.fullName||e.username||e.email}    (#${g})  ${F.length} .`,user_name:e.fullName||e.username||e.email,link:`/edit/${K.family_id}`}),setTimeout(()=>a(""),3e3);const Se=parseInt(g)?String(parseInt(g)+1):"";y(Se),v(""),S(""),k(""),j(""),C(""),ie(""),W(""),H([])}catch(re){console.error("Error saving family:",re),o("   : "+re.message)}finally{n(!1)}},zt=re=>["wife","second_wife","widow","divorced","abandoned","daughter"].includes(re)?"female":"male",Yt=re=>{if(!re)return"";if(typeof re=="number"){const de=new Date(Math.round((re-25569)*86400*1e3));return isNaN(de.getTime())?"":de.toISOString().split("T")[0]}const pe=String(re).trim(),Re=/^(\d{1,2})[/\-](\d{1,2})[/\-](\d{4})$/,K=pe.match(Re);if(K){const de=K[1].padStart(2,"0"),Ne=K[2].padStart(2,"0");return`${K[3]}-${Ne}-${de}`}const Se=new Date(pe);if(!isNaN(Se.getTime()))try{return Se.toISOString().split("T")[0]}catch{return""}return""},he=re=>({husband:"",father:"",mother:"",wife:"",son:"",daughter:"",widow:"",widower:"",divorced:"",abandoned:"",grandfather:"",grandmother:""})[re]||re;return l.jsxs("div",{className:"space-y-4 md:space-y-6",children:[l.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[l.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-800",children:"  "}),l.jsx("div",{className:"flex w-full md:w-auto",children:l.jsxs("button",{onClick:be,className:"w-full md:w-auto bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2.5 rounded-xl flex items-center justify-center gap-2 font-bold transition shadow-sm text-sm",children:[l.jsx(ms,{className:"h-4 w-4"}),"  Excel"]})})]}),l.jsxs(Ar,{children:[s&&l.jsx(Ze.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0},className:"bg-green-50 border border-green-200 text-green-800 p-4 rounded-xl whitespace-pre-line",children:s}),i&&l.jsxs(Ze.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0},className:"bg-red-50 border border-red-200 text-red-800 p-4 rounded-xl flex items-start gap-3",children:[l.jsx(Ho,{className:"h-5 w-5 shrink-0 mt-0.5"}),l.jsx("div",{children:i})]}),c&&h>0&&l.jsxs(Ze.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-indigo-50 border-2 border-indigo-200 p-6 rounded-2xl",children:[l.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-bold text-indigo-900 text-lg",children:" ..."}),l.jsxs("p",{className:"text-indigo-700 text-sm",children:[x,"  ",h,"  (",d,"%)"]})]})]}),l.jsx("div",{className:"w-full bg-indigo-200 rounded-full h-4 overflow-hidden",children:l.jsx(Ze.div,{className:"bg-indigo-600 h-full rounded-full",initial:{width:0},animate:{width:`${d}%`},transition:{duration:.3}})}),l.jsx("p",{className:"text-xs text-indigo-600 mt-3 text-center",children:"      "})]})]}),l.jsxs("div",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 p-6 rounded-2xl border border-indigo-100",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[l.jsx(e0,{className:"h-6 w-6 text-indigo-600"}),l.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"  Excel"})]}),l.jsx("p",{className:"text-sm text-gray-600 mb-4",children:'   Excel    .     ""  .'}),l.jsx("div",{className:"flex gap-3 items-center",children:l.jsxs("label",{className:"flex-1 cursor-pointer",children:[l.jsxs("div",{className:"bg-white border-2 border-dashed border-indigo-300 rounded-xl p-6 hover:border-indigo-500 transition text-center",children:[l.jsx(eE,{className:"h-12 w-12 text-indigo-400 mx-auto mb-2"}),l.jsx("p",{className:"text-gray-700 font-medium",children:"   Excel"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"    "})]}),l.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:Ee,className:"hidden",disabled:c})]})})]}),l.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100",children:[l.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-6",children:" "}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6 p-4 bg-indigo-50 rounded-xl",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"  *"}),l.jsx("input",{type:"text",value:g,onChange:re=>y(re.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:"101"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:" *"}),l.jsx("input",{type:"text",value:w,onChange:re=>v(re.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:" "})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:" "}),l.jsx("input",{type:"tel",value:_,onChange:re=>{const pe=re.target.value.replace(/\D/g,"");pe.length<=10&&S(pe)},className:`w-full px-4 py-2 border rounded-lg focus:ring-2 outline-none ${_&&!et(_)?"border-red-500 focus:ring-red-500 bg-red-50":_&&et(_)?"border-green-500 focus:ring-green-500 bg-green-50":"border-gray-300 focus:ring-indigo-500"}`,placeholder:"0590000000",maxLength:"10",dir:"ltr"}),_&&!et(_)&&l.jsx("p",{className:"text-xs text-red-600 mt-1 font-medium",children:"    - : 0590000000  590000000"}),(!_||et(_))&&l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:": 0590000000  590000000"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"  / "}),l.jsxs("select",{value:G,onChange:re=>Y(re.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none bg-white",children:[l.jsx("option",{value:"",children:"--   --"}),R.map(re=>l.jsx("option",{value:re.name,children:re.name},re.delegate_id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"   ()"}),l.jsx("input",{type:"tel",value:b,onChange:re=>{const pe=re.target.value.replace(/\D/g,"");pe.length<=10&&k(pe)},className:`w-full px-4 py-2 border rounded-lg focus:ring-2 outline-none ${b&&!et(b)?"border-red-500 focus:ring-red-500 bg-red-50":"border-gray-300 focus:ring-indigo-500"}`,placeholder:"059xxxxxxx",maxLength:"10",dir:"ltr"}),b&&!et(b)&&l.jsx("p",{className:"text-xs text-red-600 mt-1 font-medium",children:"   "})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:" "}),l.jsxs("select",{value:T,onChange:re=>j(re.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none bg-white",children:[l.jsx("option",{value:"",children:"--    --"}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""})]})]}),l.jsxs("div",{className:"md:col-span-2",children:[l.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:" "}),l.jsx("input",{type:"text",value:V,onChange:re=>C(re.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:" ..."})]})]}),l.jsx("div",{className:"mb-6 p-4 bg-gray-50 rounded-xl border border-gray-100",children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"  / "}),l.jsxs("select",{value:se,onChange:re=>ie(re.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none bg-white",children:[l.jsx("option",{value:"",children:"--    --"}),l.jsx("option",{value:"ready_tent",children:" "}),l.jsx("option",{value:"manufactured_tent",children:" "}),l.jsx("option",{value:"house",children:""}),l.jsx("option",{value:"other",children:""})]})]}),se==="other"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"  "}),l.jsx("input",{type:"text",value:oe,onChange:re=>W(re.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:"   "})]})]})}),l.jsxs("div",{className:"border-2 border-dashed border-gray-200 rounded-xl p-6 mb-6",children:[l.jsx("h3",{className:"font-bold text-gray-700 mb-4",children:"  "}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" *"}),l.jsx("input",{type:"text",value:D.name,onChange:re=>z({...D,name:re.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:" "})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" *"}),l.jsx("select",{value:D.role,onChange:re=>z({...D,role:re.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none",children:O.map(re=>l.jsx("option",{value:re.value,children:re.label},re.value))})]}),D.role==="guardian"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"  *"}),l.jsxs("select",{value:D.guardianGender,onChange:re=>z({...D,guardianGender:re.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none bg-yellow-50",children:[l.jsx("option",{value:"male",children:""}),l.jsx("option",{value:"female",children:""})]})]}),D.role==="other"&&l.jsxs("div",{className:"md:col-span-2",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"  *"}),l.jsx("input",{type:"text",value:D.roleDescription,onChange:re=>z({...D,roleDescription:re.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none bg-yellow-50",placeholder:":    ...",required:!0})]}),D.role==="widow"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"  "}),l.jsx("input",{type:"text",value:D.deceasedHusbandName,onChange:re=>z({...D,deceasedHusbandName:re.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none bg-gray-50",placeholder:"  "})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),l.jsx("input",{type:"date",value:D.husbandDeathDate,onChange:re=>z({...D,husbandDeathDate:re.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none bg-gray-50 text-right"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"  *"}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{type:"text",value:B,onChange:re=>{const pe=re.target.value.replace(/\D/g,"");pe.length<=2&&ne(pe)},className:"w-1/3 px-3 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none text-center",placeholder:"",maxLength:"2",dir:"ltr"}),l.jsx("input",{type:"text",value:U,onChange:re=>{const pe=re.target.value.replace(/\D/g,"");pe.length<=2&&J(pe)},className:"w-1/3 px-3 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none text-center",placeholder:"",maxLength:"2",dir:"ltr"}),l.jsx("input",{type:"text",value:ae,onChange:re=>{const pe=re.target.value.replace(/\D/g,"");pe.length<=4&&q(pe)},className:"w-1/3 px-3 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none text-center",placeholder:"",maxLength:"4",dir:"ltr"})]}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:":  15  6  1990"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"  *"}),l.jsx("input",{type:"text",value:D.nid,onChange:re=>{const pe=re.target.value.replace(/\D/g,"");pe.length<=9&&z({...D,nid:pe})},className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:"800000000",maxLength:"9",required:!0,dir:"ltr"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"9  "})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),l.jsx("input",{type:"text",value:D.healthNotes,onChange:re=>z({...D,healthNotes:re.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:"  "})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),l.jsx("input",{type:"text",value:D.shoeSize,onChange:re=>z({...D,shoeSize:re.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:": 42"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),l.jsx("input",{type:"text",value:D.clothesSize,onChange:re=>z({...D,clothesSize:re.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:": XL  14 "})]}),l.jsxs("div",{className:"flex items-center gap-6 pt-6",children:[l.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:D.isPregnant,onChange:re=>z({...D,isPregnant:re.target.checked}),className:"w-4 h-4 text-indigo-600 rounded"}),l.jsx("span",{className:"text-sm font-medium text-gray-700",children:""})]}),l.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:D.isNursing,onChange:re=>z({...D,isNursing:re.target.checked}),className:"w-4 h-4 text-indigo-600 rounded"}),l.jsx("span",{className:"text-sm font-medium text-gray-700",children:""})]})]})]}),l.jsxs("button",{onClick:Ue,className:"mt-4 bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 font-bold transition",children:[l.jsx(gi,{className:"h-4 w-4"})," "]})]}),F.length>0&&l.jsxs("div",{className:"mb-6",children:[l.jsxs("h3",{className:"font-bold text-gray-700 mb-3",children:["  (",F.length,")"]}),l.jsx("div",{className:"space-y-2",children:F.map(re=>l.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-3 rounded-lg",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("div",{className:"font-medium text-gray-800",children:re.name}),l.jsxs("div",{className:"text-sm text-gray-500",children:[he(re.role),"  ",re.dob,"  ",re.nid||" ",(re.shoeSize||re.clothesSize)&&`  : ${re.shoeSize||"-"} / : ${re.clothesSize||"-"}`,re.healthNotes&&`  ${re.healthNotes}`]})]}),l.jsx("button",{onClick:()=>me(re.id),className:"text-red-600 hover:text-red-800 p-2 rounded-lg hover:bg-red-50 transition",children:l.jsx(nn,{className:"h-4 w-4"})})]},re.id))})]}),l.jsx("button",{onClick:lt,disabled:r||F.length===0,className:"w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded-lg flex items-center justify-center gap-2 transition disabled:opacity-50 disabled:cursor-not-allowed shadow-md",children:r?l.jsx(l.Fragment,{children:" ..."}):l.jsxs(l.Fragment,{children:[l.jsx(Oc,{className:"h-5 w-5"})," "]})})]})]})}function eW(){const{user:e}=on(),{selectedCamp:t}=Nn(),[r,n]=E.useState([]),[s,a]=E.useState(!0),[i,o]=E.useState(""),[c,u]=E.useState("all"),[d,f]=E.useState("active"),[h,m]=E.useState(new Set),[x,p]=E.useState(!1),[g,y]=E.useState([]),[w,v]=E.useState(!1);E.useEffect(()=>{t?k():(n([]),a(!1))},[t]);const _=C=>{const R=new Set(h);R.has(C)?R.delete(C):R.add(C),m(R)},S=()=>{h.size===T.length?m(new Set):m(new Set(T.map(C=>C.family_id)))},b=async()=>{if(h.size!==0&&window.confirm(`     ${h.size} /`))try{for(const C of h)await dk(C);m(new Set),alert("  "),k()}catch(C){console.error("Delete error:",C),alert("  ")}},k=async()=>{if(t){a(!0);try{const C=await rn(t.camp_id),R=await zn(t.camp_id),X=C.map(Y=>{const se=R.filter(H=>H.family_id===Y.family_id),ie=zs(se),oe=se.find(H=>{var D;return["wife","wife_second",""," "].includes((D=H.role)==null?void 0:D.toLowerCase().trim())});let W=" ",ue="-",ve="-",F="-";return ie&&(W=ie.name,ie.role==="other"&&ie.role_description?W+=` (${ie.role_description})`:(ie.role==="guardian"||ie.role==="")&&(W+=" ()"),ue=ie.nid||"-",(ie.role==="husband"||ie.role==="")&&oe&&(ve=oe.name,F=oe.nid||"-")),{...Y,headName:W,headNid:ue,partnerName:ve,partnerNid:F,memberCount:se.length}});X.sort((Y,se)=>(parseInt(Y.family_number)||0)-(parseInt(se.family_number)||0));const G=X.map(Y=>({...Y,headName:Y.head_name||Y.headName||" ",headNid:Y.head_nid||Y.headNid||"-",partnerName:Y.partner_name||Y.partnerName||"-",partnerNid:Y.partner_nid||Y.partnerNid||"-",memberCount:Y.member_count||Y.memberCount||0}));n(G)}catch(C){console.error("Load error:",C),alert("    : "+C.message)}finally{a(!1)}}},T=r.map(C=>({...C,searchStr_number:(C.family_number||"").toString().toLowerCase(),searchStr_headName:(C.headName||"").toString().toLowerCase(),searchStr_partnerName:(C.partnerName||"").toString().toLowerCase(),searchStr_headNid:(C.headNid||"").toString().toLowerCase(),searchStr_partnerNid:(C.partnerNid||"").toString().toLowerCase()})).filter(C=>{if(d==="active"&&C.is_departed||d==="departed"&&!C.is_departed)return!1;if(!i)return!0;const R=i.toLowerCase();return c==="number"?C.searchStr_number.includes(R):c==="nid"?C.searchStr_headNid.includes(R)||C.searchStr_partnerNid.includes(R):c==="name"?C.searchStr_headName.includes(R)||C.searchStr_partnerName.includes(R):C.searchStr_number.includes(R)||C.searchStr_headName.includes(R)||C.searchStr_partnerName.includes(R)||C.searchStr_headNid.includes(R)||C.searchStr_partnerNid.includes(R)}),j=()=>{const C=h.size>0?T.filter(G=>h.has(G.family_id)):T,R=At.json_to_sheet(C.map(G=>({" ":G.family_number," ":G.headName,"  ":G.headNid,"/":G.partnerName," ":G.partnerNid," ":G.memberCount," ":G.contact,:G.address,:G.delegate||"-"}))),X=At.book_new();At.book_append_sheet(X,R,""),Si(X,h.size>0?"families_selected.xlsx":"families_list.xlsx")},V=async()=>{if(t){v(!0);try{const C=await zn(t.camp_id),R={};C.forEach(G=>{if(G.nid&&G.nid.trim()!==""){const Y=G.nid.trim();R[Y]||(R[Y]=[]),R[Y].push(G)}});const X=Object.entries(R).filter(([G,Y])=>Y.length>1).map(([G,Y])=>({nid:G,members:Y.map(se=>({family_number:se.family_number,name:se.name,role:se.role,family_id:se.family_id}))}));y(X),p(!0)}catch(C){console.error("Check duplicates error:",C),alert("   ")}finally{v(!1)}}};return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[l.jsxs("h1",{className:"text-3xl font-bold text-gray-800 flex items-center gap-3",children:[l.jsx(vn,{className:"h-8 w-8 text-indigo-600"}),"  "]}),l.jsxs("div",{className:"flex items-center gap-3 w-full md:w-auto",children:[h.size>0&&l.jsxs("button",{onClick:b,className:"bg-red-100 text-red-600 px-4 py-2 rounded-lg font-bold flex items-center gap-2 hover:bg-red-200 transition animate-in fade-in slide-in-from-top-2",children:[l.jsx(nn,{className:"h-4 w-4"})," (",h.size,")"]}),l.jsxs(un,{to:"/cards",className:"bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg font-medium flex items-center gap-2 shadow-sm transition-colors whitespace-nowrap",target:"_blank",children:[l.jsx(vn,{className:"h-4 w-4"})," "]}),l.jsxs("button",{onClick:j,disabled:T.length===0,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium flex items-center gap-2 shadow-sm transition-colors disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap",children:[l.jsx(ms,{className:"h-4 w-4"}),h.size>0?`  (${h.size})`:" Excel"]}),l.jsxs("button",{onClick:V,disabled:w,className:"bg-amber-100 hover:bg-amber-200 text-amber-700 px-4 py-2 rounded-lg font-medium flex items-center gap-2 border border-amber-200 transition-colors whitespace-nowrap",title:"     ",children:[w?l.jsx("div",{className:"h-4 w-4 border-2 border-amber-600 border-t-transparent rounded-full animate-spin"}):l.jsx(Ho,{className:"h-4 w-4"})," "]})]})]}),l.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-100 flex flex-col md:flex-row gap-4 items-center",children:[l.jsxs("div",{className:"relative flex-1 w-full",children:[l.jsx(Ai,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"text",placeholder:"  ...",value:i,onChange:C=>o(C.target.value),className:"w-full pr-10 pl-4 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none"})]}),l.jsxs("div",{className:"flex items-center gap-2 min-w-[200px]",children:[l.jsx(Xl,{className:"h-5 w-5 text-gray-500"}),l.jsxs("select",{value:c,onChange:C=>u(C.target.value),className:"w-full p-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none text-sm",children:[l.jsx("option",{value:"all",children:" "}),l.jsx("option",{value:"number",children:" "}),l.jsx("option",{value:"name",children:" ( /)"}),l.jsx("option",{value:"nid",children:" "})]})]}),l.jsxs("div",{className:"flex items-center gap-2 min-w-[180px]",children:[l.jsx(n0,{className:"h-5 w-5 text-gray-500"}),l.jsxs("select",{value:d,onChange:C=>f(C.target.value),className:"w-full p-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none text-sm",children:[l.jsx("option",{value:"active",children:" "}),l.jsx("option",{value:"departed",children:" "}),l.jsx("option",{value:"all",children:""})]})]}),i&&l.jsx("button",{onClick:()=>o(""),className:"text-gray-500 hover:text-gray-700 p-2 hover:bg-gray-100 rounded-full",children:l.jsx(Cs,{className:"h-5 w-5"})})]}),l.jsx("div",{className:"md:hidden -mx-4 overflow-x-auto",children:l.jsx("div",{className:"inline-block min-w-full align-middle",children:l.jsx("div",{className:"overflow-hidden border-t border-gray-100",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-100",children:[l.jsx("thead",{className:"bg-gray-50/50",children:l.jsxs("tr",{children:[l.jsx("th",{scope:"col",className:"px-3 py-3 text-right text-[10px] font-black text-gray-400 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"px-3 py-3 text-right text-[10px] font-black text-gray-400 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"px-3 py-3 text-center text-[10px] font-black text-gray-400 uppercase tracking-wider",children:""}),l.jsx("th",{scope:"col",className:"px-3 py-3 text-left text-[10px] font-black text-gray-400 uppercase tracking-wider",children:""})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-50",children:s?l.jsx("tr",{children:l.jsx("td",{colSpan:"4",className:"px-3 py-10 text-center text-xs text-gray-400",children:" ..."})}):T.length===0?l.jsx("tr",{children:l.jsx("td",{colSpan:"4",className:"px-3 py-10 text-center text-xs text-gray-400",children:r.length===0?"   ":"  "})}):T.map(C=>l.jsxs("tr",{className:`hover:bg-indigo-50/30 transition-colors ${C.is_departed?"bg-orange-50/20":""}`,children:[l.jsx("td",{className:"px-3 py-3 whitespace-nowrap",children:l.jsxs("div",{className:"flex flex-col",children:[l.jsxs("span",{className:"text-xs font-black text-indigo-600",children:["#",C.family_number]}),C.is_departed&&l.jsx("span",{className:"text-[10px] text-orange-600 font-bold",children:""})]})}),l.jsx("td",{className:"px-3 py-3",children:l.jsxs("div",{className:"flex flex-col gap-0.5 max-w-[140px]",children:[l.jsxs("div",{className:"text-xs font-bold text-gray-800 truncate",title:C.headName,children:[C.headName,l.jsxs("span",{className:"block text-[9px] text-gray-400 font-normal",children:[": ",C.headNid]})]}),l.jsxs("div",{className:"text-[10px] text-gray-400 truncate italic mt-1 border-t border-gray-50 pt-0.5",title:C.partnerName,children:[C.partnerName||"-",C.partnerName!=="-"&&l.jsxs("span",{className:"block text-[9px] text-gray-400 font-normal",children:[": ",C.partnerNid]})]})]})}),l.jsx("td",{className:"px-3 py-3 text-center",children:l.jsx("span",{className:"inline-flex items-center justify-center w-6 h-6 rounded-full bg-blue-50 text-blue-600 text-[10px] font-black border border-blue-100",children:C.memberCount})}),l.jsx("td",{className:"px-3 py-3 text-left",children:l.jsxs("div",{className:"flex items-center gap-1.5 justify-end",children:[l.jsx(un,{to:`/edit/${C.family_id}`,className:"p-1.5 bg-indigo-50 text-indigo-600 rounded-lg border border-indigo-100",children:l.jsx(oi,{className:"h-4 w-4"})}),l.jsx(un,{to:`/aid/${C.family_id}`,className:"p-1.5 bg-emerald-50 text-emerald-600 rounded-lg border border-emerald-100",children:l.jsx(Fs,{className:"h-4 w-4"})})]})})]},C.family_id))})]})})})}),l.jsx("div",{className:"hidden md:block bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-right",children:[l.jsx("thead",{className:"bg-gray-50 text-xs text-gray-500 uppercase font-bold border-b",children:l.jsxs("tr",{children:[((e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="manager")&&l.jsx("th",{className:"px-4 py-4 w-12 text-center pointer-events-auto",children:l.jsx("button",{onClick:S,className:"flex items-center justify-center text-gray-600 hover:text-indigo-600",children:T.length>0&&h.size===T.length?l.jsx(Kl,{className:"h-5 w-5 text-indigo-600"}):l.jsx(t0,{className:"h-5 w-5"})})}),l.jsx("th",{className:"px-6 py-4",children:" "}),l.jsx("th",{className:"px-6 py-4",children:"  ( / )"}),l.jsx("th",{className:"px-6 py-4",children:"/ ( / )"}),l.jsx("th",{className:"px-6 py-4 text-center",children:" "}),l.jsx("th",{className:"px-6 py-4",children:" "}),l.jsx("th",{className:"px-6 py-4",children:""}),l.jsx("th",{className:"px-6 py-4",children:""}),l.jsx("th",{className:"px-6 py-4 text-left",children:""})]})}),l.jsx("tbody",{className:"divide-y divide-gray-100 text-sm",children:s?l.jsx("tr",{children:l.jsx("td",{colSpan:"8",className:"text-center p-8",children:" ..."})}):T.length===0?l.jsx("tr",{children:l.jsx("td",{colSpan:"8",className:"text-center p-8 text-gray-500",children:r.length===0?"   ":"   "})}):T.map(C=>{const R=h.has(C.family_id);return l.jsxs("tr",{className:`transition ${R?"bg-indigo-50 hover:bg-indigo-100":C.is_departed?"bg-orange-50/40 hover:bg-orange-50":"hover:bg-gray-50"}`,children:[((e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="manager")&&l.jsx("td",{className:"px-4 py-4 text-center",children:l.jsx("button",{onClick:()=>_(C.family_id),className:`hover:text-indigo-600 ${R?"text-indigo-600":"text-gray-400"}`,children:R?l.jsx(Kl,{className:"h-5 w-5"}):l.jsx(t0,{className:"h-5 w-5"})})}),l.jsx("td",{className:"px-6 py-4 font-bold text-indigo-700",children:l.jsxs("div",{className:"flex items-center gap-2",children:["#",C.family_number,C.is_departed&&l.jsxs("span",{className:"bg-orange-100 text-orange-700 text-xs px-2 py-0.5 rounded-full font-medium flex items-center gap-1",children:[l.jsx(n0,{className:"h-3 w-3"}),""]})]})}),l.jsxs("td",{className:"px-6 py-4",children:[l.jsx("div",{className:"font-medium text-gray-900",children:C.headName}),l.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[": ",C.headNid]})]}),l.jsxs("td",{className:"px-6 py-4",children:[l.jsx("div",{className:"text-gray-700",children:C.partnerName}),l.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:[": ",C.partnerNid]})]}),l.jsx("td",{className:"px-6 py-4 text-center",children:l.jsx("span",{className:"bg-blue-100 text-blue-800 px-3 py-1 rounded-full font-bold text-xs",children:C.memberCount})}),l.jsx("td",{className:"px-6 py-4 text-gray-500 ltr",dir:"ltr",children:l.jsxs("div",{className:"flex items-center gap-2 justify-end",children:[C.contact,l.jsx(Xx,{className:"h-3 w-3"})]})}),l.jsx("td",{className:"px-6 py-4 text-gray-500",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(q0,{className:"h-3 w-3"}),C.address]})}),l.jsx("td",{className:"px-6 py-4 text-gray-500",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(ZS,{className:"h-3 w-3 text-indigo-400"}),C.delegate||"-"]})}),l.jsx("td",{className:"px-6 py-4 text-left",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(un,{to:`/aid/${C.family_id}`,className:"text-emerald-600 hover:text-emerald-900 bg-emerald-50 hover:bg-emerald-100 p-2 rounded-lg inline-flex items-center gap-1 transition-colors",title:" ",children:l.jsx(Fs,{className:"h-4 w-4"})}),l.jsx(un,{to:`/edit/${C.family_id}`,className:"text-indigo-600 hover:text-indigo-900 bg-indigo-50 hover:bg-indigo-100 p-2 rounded-lg inline-flex items-center gap-1 transition-colors",title:" ",children:l.jsx(oi,{className:"h-4 w-4"})})]})})]},C.family_id)})})]})})}),x&&l.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",dir:"rtl",children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[80vh] overflow-hidden flex flex-col animate-in zoom-in-95 duration-200",children:[l.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center bg-amber-50",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-2 bg-amber-100 rounded-lg text-amber-600",children:l.jsx(qm,{className:"h-6 w-6"})}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"  "}),l.jsxs("p",{className:"text-sm text-gray-500",children:["   ",g.length," "]})]})]}),l.jsx("button",{onClick:()=>p(!1),className:"text-gray-400 hover:text-gray-600 p-1 hover:bg-gray-200 rounded-full transition-colors",children:l.jsx(Cs,{className:"h-6 w-6"})})]}),l.jsx("div",{className:"p-6 overflow-y-auto flex-1",children:g.length===0?l.jsxs("div",{className:"text-center py-10",children:[l.jsx("div",{className:"bg-green-100 text-green-600 w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4",children:l.jsx(Kl,{className:"h-8 w-8"})}),l.jsx("p",{className:"text-gray-600 font-medium",children:"       "})]}):l.jsx("div",{className:"space-y-6",children:g.map((C,R)=>l.jsxs("div",{className:"border border-gray-200 rounded-xl overflow-hidden shadow-sm",children:[l.jsxs("div",{className:"bg-gray-50 px-4 py-2 border-b border-gray-200 flex justify-between items-center",children:[l.jsxs("span",{className:"font-bold text-gray-700",children:[" : ",C.nid]}),l.jsxs("span",{className:"bg-amber-100 text-amber-700 text-xs px-2 py-1 rounded-full font-bold",children:["  ",C.members.length," "]})]}),l.jsxs("table",{className:"w-full text-right text-sm",children:[l.jsx("thead",{className:"bg-gray-50 text-gray-500 font-bold border-b",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-2",children:" "}),l.jsx("th",{className:"px-4 py-2",children:" "}),l.jsx("th",{className:"px-4 py-2",children:""})]})}),l.jsx("tbody",{className:"divide-y divide-gray-100",children:C.members.map((X,G)=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-4 py-2 font-bold text-indigo-600",children:l.jsxs(un,{to:`/edit/${X.family_id}`,className:"hover:underline",target:"_blank",children:["#",X.family_number]})}),l.jsx("td",{className:"px-4 py-2",children:X.name}),l.jsx("td",{className:"px-4 py-2 text-gray-500",children:X.role||"-"})]},G))})]})]},R))})}),l.jsx("div",{className:"p-4 border-t border-gray-100 bg-gray-50 flex justify-end",children:l.jsx("button",{onClick:()=>p(!1),className:"bg-gray-800 text-white px-6 py-2 rounded-lg font-medium hover:bg-gray-900 transition-colors",children:""})})]})})]})}function tW(){const{user:e}=on(),{familyId:t}=Db(),r=Oa(),[n,s]=E.useState(!0),[a,i]=E.useState(!1),[o,c]=E.useState(""),[u,d]=E.useState(""),[f,h]=E.useState(""),[m,x]=E.useState(""),[p,g]=E.useState(""),[y,w]=E.useState(""),[v,_]=E.useState(""),[S,b]=E.useState([]),[k,T]=E.useState([]),[j,V]=E.useState({name:"",nid:"",dob:"",role:"son",healthNotes:"",isPregnant:!1,isNursing:!1,guardianGender:"male",roleDescription:"",deceasedHusbandName:"",husbandDeathDate:"",shoeSize:"",clothesSize:""}),C=[{value:"husband",label:""},{value:"wife",label:""},{value:"second_wife",label:" "},{value:"widow",label:""},{value:"widower",label:""},{value:"divorced",label:""},{value:"abandoned",label:""},{value:"guardian",label:""},{value:"son",label:""},{value:"daughter",label:""},{value:"other",label:""}];E.useEffect(()=>{R()},[t]);async function R(){try{const q=await ak(t);if(!q){alert("  "),r("/families");return}const O=await Uo();b(O),c(q.family_number),d(q.address||""),h(q.contact||""),x(q.alternative_mobile||""),g(q.housing_status||""),w(q.family_needs||""),_(q.delegate||""),B(q.is_departed||!1);const Ee=(await N5(t)).map(Ve=>({id:Ve.individual_id,name:Ve.name,nid:Ve.nid||"",dob:Ve.dob||"",role:Ve.role,healthNotes:Ve.notes||"",isPregnant:Ve.is_pregnant||!1,isNursing:Ve.is_nursing||!1,shoeSize:Ve.shoe_size||"",clothesSize:Ve.clothes_size||""}));T(Ee),s(!1)}catch(q){console.error("Load error:",q),alert("   "),r("/families")}}const[X,G]=E.useState(null),Y=async()=>{if(!j.name||!j.dob){alert("    ");return}if(!j.nid){alert("  ");return}if(j.nid.length!==9){alert("      9 ");return}if(k.some(Ee=>Ee.nid===j.nid&&Ee.id!==X)){alert("        ");return}const O=X?k.find(Ee=>Ee.id===X):null;if(!O||O.nid!==j.nid)try{if(await zd(j.nid)){alert("        ");return}}catch(Ee){console.error("Error checking NID:",Ee),alert("        ");return}X?(T(k.map(Ee=>Ee.id===X?{...j,id:X}:Ee)),G(null)):T([...k,{...j,id:crypto.randomUUID(),isNew:!0}]),oe()},se=q=>{G(q.id),V({name:q.name,nid:q.nid||"",dob:q.dob,role:q.role,healthNotes:q.healthNotes||"",isPregnant:q.isPregnant||!1,isNursing:q.isNursing||!1,shoeSize:q.shoeSize||"",clothesSize:q.clothesSize||""})},ie=()=>{G(null),oe()},oe=()=>{V({name:"",nid:"",dob:"",role:"son",healthNotes:"",isPregnant:!1,isNursing:!1,guardianGender:"male",roleDescription:"",deceasedHusbandName:"",husbandDeathDate:"",shoeSize:"",clothesSize:""})},W=q=>{T(k.filter(O=>O.id!==q))},ue=async()=>{if(k.length===0){alert("       ");return}i(!0);try{const q={family_id:t,family_number:o,address:u,contact:f,alternative_mobile:m,housing_status:p,family_needs:y,delegate:v},O=k.map(be=>{let Ee;return be.role==="guardian"?Ee=be.guardianGender||"male":Ee=["wife","second_wife","widow","daughter","divorced","abandoned"].includes(be.role)?"female":"male",{individual_id:be.id,name:be.name,nid:be.nid||null,dob:be.dob||null,gender:Ee,role:be.role,role_description:be.role==="other"?be.roleDescription:null,deceased_husband_name:be.role==="widow"?be.deceasedHusbandName:null,husband_death_date:be.role==="widow"?be.husbandDeathDate:null,is_pregnant:be.isPregnant||!1,is_nursing:be.isNursing||!1,shoe_size:be.shoeSize||null,clothes_size:be.clothesSize||null,notes:be.healthNotes||null}});await Sv(q,O,e),alert("   "),r("/families")}catch(q){console.error("Save error:",q),alert("   : "+q.message)}finally{i(!1)}},[ve,F]=E.useState(!1),[H,D]=E.useState(!1),[z,B]=E.useState(!1),ne=()=>{F(!0)},U=()=>{D(!0)},J=async()=>{if(t){D(!1),i(!0);try{const q={family_id:t,family_number:o,address:u,contact:f,delegate:v,is_departed:!z},O=k.map(be=>{const Ee=["wife","second_wife","widow","daughter","divorced","abandoned"].includes(be.role)?"female":"male";return{individual_id:be.id,name:be.name,nid:be.nid||null,dob:be.dob||null,gender:Ee,role:be.role,is_pregnant:be.isPregnant||!1,is_nursing:be.isNursing||!1,notes:be.healthNotes||null}});await Sv(q,O,e),B(!z),alert(z?"     ":"      ")}catch(q){console.error("Error marking departed:",q),alert("   : "+q.message)}finally{i(!1)}}},ae=async()=>{if(t){F(!1),s(!0);try{await dk(t),alert("   ."),r("/families",{replace:!0})}catch(q){console.error("Delete Error:",q),alert("   : "+q.message)}finally{s(!1)}}};return n?l.jsx("div",{className:"p-8 text-center",children:" ..."}):l.jsxs("div",{className:"max-w-4xl mx-auto space-y-6 md:space-y-8 pb-24 md:pb-10 px-4 md:px-0",children:[l.jsx("div",{className:"flex justify-between items-center",children:l.jsxs("div",{className:"flex items-center gap-3 md:gap-4 w-full",children:[l.jsx("button",{onClick:()=>r("/search"),className:"bg-gray-100 p-2 md:p-3 rounded-full hover:bg-gray-200 transition",children:l.jsx(X0,{className:"h-5 w-5 md:h-6 md:w-6"})}),l.jsx("h1",{className:"text-xl md:text-3xl font-bold text-gray-800 truncate",children:"  "})]})}),l.jsxs("section",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100",children:[l.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[l.jsx(q0,{className:"h-5 w-5 text-indigo-600"})," "]}),l.jsxs("div",{className:"mb-4 p-3 bg-blue-50 text-blue-800 rounded-lg text-sm font-bold border border-blue-100",children:["  : ",o]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),l.jsx("input",{type:"text",value:o,disabled:!0,className:"w-full p-2 border border-gray-200 bg-gray-50 text-gray-500 rounded-lg cursor-not-allowed"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),l.jsx("input",{type:"text",value:u,onChange:q=>d(q.target.value),disabled:!((e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="manager"),className:`w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none ${(e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="manager"?"":"bg-gray-50 text-gray-500 cursor-not-allowed"}`})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),l.jsx("input",{type:"text",value:f,onChange:q=>h(q.target.value),disabled:!((e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="manager"),className:`w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none ${(e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="manager"?"":"bg-gray-50 text-gray-500 cursor-not-allowed"}`})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"  "}),l.jsx("input",{type:"text",value:m,onChange:q=>x(q.target.value),disabled:!((e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="manager"),className:`w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none ${(e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="manager"?"":"bg-gray-50 text-gray-500 cursor-not-allowed"}`})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),l.jsxs("select",{value:p,onChange:q=>g(q.target.value),disabled:!((e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="manager"),className:`w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none ${(e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="manager"?"bg-white":"bg-gray-50 text-gray-500 cursor-not-allowed"}`,children:[l.jsx("option",{value:"",children:"--  --"}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),l.jsx("input",{type:"text",value:y,onChange:q=>w(q.target.value),disabled:!((e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="manager"),className:`w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none ${(e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="manager"?"":"bg-gray-50 text-gray-500 cursor-not-allowed"}`})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" / "}),l.jsxs("select",{value:v,onChange:q=>_(q.target.value),disabled:!((e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="manager"),className:`w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 outline-none ${(e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="manager"?"bg-white":"bg-gray-50 text-gray-500 cursor-not-allowed"}`,children:[l.jsx("option",{value:"",children:"--   --"}),S.map(q=>l.jsx("option",{value:q.name,children:q.name},q.delegate_id))]})]})]})]}),((e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="manager")&&l.jsxs("section",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100",children:[l.jsxs("h2",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[l.jsx(To,{className:"h-5 w-5 text-indigo-600"}),"  "]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),l.jsx("input",{type:"text",value:j.name,onChange:q=>V({...j,name:q.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg outline-none"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),l.jsx("input",{type:"text",value:j.nid,onChange:q=>{const O=q.target.value.replace(/\D/g,"").slice(0,9);V({...j,nid:O})},className:"w-full p-2 border border-gray-300 rounded-lg outline-none font-mono tracking-widest",placeholder:"9 ",inputMode:"numeric"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),l.jsx("input",{type:"date",value:j.dob,onChange:q=>V({...j,dob:q.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg outline-none"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),l.jsx("select",{value:j.role,onChange:q=>V({...j,role:q.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg outline-none",children:C.map(q=>l.jsx("option",{value:q.value,children:q.label},q.value))})]}),j.role==="guardian"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"  *"}),l.jsxs("select",{value:j.guardianGender,onChange:q=>V({...j,guardianGender:q.target.value}),className:"w-full p-2 border border-yellow-300 bg-yellow-50 rounded-lg outline-none",children:[l.jsx("option",{value:"male",children:""}),l.jsx("option",{value:"female",children:""})]})]}),j.role==="other"&&l.jsxs("div",{className:"md:col-span-2",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"  *"}),l.jsx("input",{type:"text",value:j.roleDescription,onChange:q=>V({...j,roleDescription:q.target.value}),className:"w-full p-2 border border-yellow-300 bg-yellow-50 rounded-lg outline-none",placeholder:":    ..."})]}),j.role==="widow"&&l.jsxs("div",{className:"md:col-span-2 grid grid-cols-2 gap-2",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"  "}),l.jsx("input",{type:"text",value:j.deceasedHusbandName,onChange:q=>V({...j,deceasedHusbandName:q.target.value}),className:"w-full p-2 border border-blue-200 bg-blue-50 rounded-lg outline-none",placeholder:" "})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),l.jsx("input",{type:"date",value:j.husbandDeathDate,onChange:q=>V({...j,husbandDeathDate:q.target.value}),className:"w-full p-2 border border-blue-200 bg-blue-50 rounded-lg outline-none text-right"})]})]}),l.jsxs("div",{className:"md:col-span-1",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),l.jsx("input",{value:j.shoeSize,onChange:q=>V({...j,shoeSize:q.target.value}),placeholder:": 42",className:"w-full p-2 border border-gray-300 rounded-lg outline-none"})]}),l.jsxs("div",{className:"md:col-span-1",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),l.jsx("input",{value:j.clothesSize,onChange:q=>V({...j,clothesSize:q.target.value}),placeholder:": XL",className:"w-full p-2 border border-gray-300 rounded-lg outline-none"})]}),l.jsxs("div",{className:"md:col-span-3",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),l.jsx("input",{type:"text",value:j.healthNotes,onChange:q=>V({...j,healthNotes:q.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg outline-none",placeholder:"..."})]}),["wife","second_wife","daughter","widow","divorced","abandoned"].includes(j.role)&&l.jsxs("div",{className:"md:col-span-3 flex gap-6 p-3 bg-pink-50 rounded-lg border border-pink-100",children:[l.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:j.isPregnant,onChange:q=>V({...j,isPregnant:q.target.checked}),className:"w-4 h-4 text-pink-600 rounded focus:ring-pink-500"}),l.jsx("span",{className:"text-sm font-medium text-gray-700",children:""})]}),l.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:j.isNursing,onChange:q=>V({...j,isNursing:q.target.checked}),className:"w-4 h-4 text-pink-600 rounded focus:ring-pink-500"}),l.jsx("span",{className:"text-sm font-medium text-gray-700",children:""})]})]})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("button",{onClick:Y,className:`w-full text-white px-6 py-2 rounded-lg transition flex items-center justify-center gap-2 ${X?"bg-orange-600 hover:bg-orange-700":"bg-gray-900 hover:bg-gray-800"}`,children:[X?l.jsx(Oc,{className:"h-4 w-4"}):l.jsx(gi,{className:"h-4 w-4"}),X?"  ":" "]}),X&&l.jsx("button",{onClick:ie,className:"bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300",children:""})]})]}),l.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[l.jsx("h3",{className:"font-semibold text-gray-700 p-4 bg-gray-50 border-b",children:"  "}),l.jsxs("table",{className:"w-full text-right",children:[l.jsx("thead",{className:"text-xs text-gray-500 bg-gray-50 uppercase border-b",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3",children:""}),l.jsx("th",{className:"px-6 py-3",children:""}),((e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="manager")&&l.jsxs(l.Fragment,{children:[l.jsx("th",{className:"px-6 py-3",children:""}),l.jsx("th",{className:"px-6 py-3",children:""})]})]})}),l.jsx("tbody",{className:"divide-y divide-gray-100",children:k.map(q=>{var O;return l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-6 py-4 font-medium text-gray-900",children:q.name}),l.jsx("td",{className:"px-6 py-4",children:((O=C.find(be=>be.value===q.role))==null?void 0:O.label)||q.role}),((e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="manager")&&l.jsxs(l.Fragment,{children:[l.jsx("td",{className:"px-6 py-4",children:l.jsx("button",{onClick:()=>se(q),className:"text-indigo-600 hover:text-indigo-800 p-1 hover:bg-indigo-50 rounded-full font-bold text-sm",children:""})}),l.jsx("td",{className:"px-6 py-4",children:l.jsx("button",{onClick:()=>W(q.id),className:"text-red-500 hover:text-red-700 p-1 hover:bg-red-50 rounded-full",children:l.jsx(nn,{className:"h-4 w-4"})})})]})]},q.id)})})]})]}),((e==null?void 0:e.role)==="admin"||(e==null?void 0:e.role)==="manager")&&l.jsxs("div",{className:"flex flex-col md:flex-row justify-between pt-4 gap-4",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[l.jsxs("button",{type:"button",onClick:ne,className:"bg-red-50 text-red-600 px-6 py-3 rounded-xl font-bold hover:bg-red-100 transition flex items-center justify-center gap-2",children:[l.jsx(nn,{className:"h-5 w-5"}),"  "]}),l.jsxs("button",{type:"button",onClick:U,className:`px-6 py-3 rounded-xl font-bold transition flex items-center justify-center gap-2 ${z?"bg-green-50 text-green-600 hover:bg-green-100 border border-green-200":"bg-orange-50 text-orange-600 hover:bg-orange-100 border border-orange-200"}`,children:[l.jsx(n0,{className:"h-5 w-5"}),z?" ":" "]})]}),l.jsxs("button",{onClick:ue,disabled:a||k.length===0,className:`
                bg-indigo-600 text-white px-8 py-3.5 rounded-xl font-bold text-lg shadow-lg hover:bg-indigo-700 transform transition md:hover:-translate-y-1 flex items-center justify-center gap-2
                ${a||k.length===0?"opacity-50 cursor-not-allowed":""}
            `,children:[l.jsx(Oc,{className:"h-5 w-5"}),a?" ...":" "]})]}),l.jsx(Ar,{children:ve&&l.jsx(Ze.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:()=>F(!1),children:l.jsxs(Ze.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-white rounded-2xl p-6 max-w-md w-full shadow-2xl space-y-4",onClick:q=>q.stopPropagation(),children:[l.jsxs("div",{className:"flex items-center gap-3 text-red-600 mb-2",children:[l.jsx("div",{className:"bg-red-100 p-2 rounded-full",children:l.jsx(nn,{className:"h-6 w-6"})}),l.jsx("h3",{className:"text-xl font-bold",children:"  "})]}),l.jsxs("p",{className:"text-gray-600 leading-relaxed",children:["          ",l.jsx("span",{className:"font-bold text-gray-900",children:o}),"  ",l.jsx("br",{}),l.jsx("span",{className:"text-red-500 font-bold text-sm mt-2 block",children:"      ."})]}),l.jsxs("div",{className:"flex gap-3 pt-4",children:[l.jsx("button",{onClick:ae,className:"flex-1 bg-red-600 text-white py-2.5 rounded-xl font-bold hover:bg-red-700 transition shadow-lg shadow-red-200",children:"  "}),l.jsx("button",{onClick:()=>F(!1),className:"flex-1 bg-gray-100 text-gray-700 py-2.5 rounded-xl font-bold hover:bg-gray-200 transition",children:""})]})]})})}),l.jsx(Ar,{children:H&&l.jsx(Ze.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",onClick:()=>D(!1),children:l.jsxs(Ze.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-white rounded-2xl p-6 max-w-md w-full shadow-2xl space-y-4",onClick:q=>q.stopPropagation(),children:[l.jsxs("div",{className:`flex items-center gap-3 mb-2 ${z?"text-green-600":"text-orange-600"}`,children:[l.jsx("div",{className:`p-2 rounded-full ${z?"bg-green-100":"bg-orange-100"}`,children:l.jsx(n0,{className:"h-6 w-6"})}),l.jsx("h3",{className:"text-xl font-bold",children:z?"  ":" "})]}),l.jsx("p",{className:"text-gray-600 leading-relaxed",children:z?l.jsxs(l.Fragment,{children:["          ",l.jsx("span",{className:"font-bold text-gray-900",children:o})," ",l.jsx("br",{}),l.jsx("span",{className:"text-green-600 font-bold text-sm mt-2 block",children:"         ."})]}):l.jsxs(l.Fragment,{children:["         ",l.jsx("span",{className:"font-bold text-gray-900",children:o}),"   ",l.jsx("br",{}),l.jsx("span",{className:"text-orange-600 font-bold text-sm mt-2 block",children:'            " ".'})]})}),l.jsxs("div",{className:"flex gap-3 pt-4",children:[l.jsx("button",{onClick:J,className:`flex-1 text-white py-2.5 rounded-xl font-bold transition shadow-lg ${z?"bg-green-600 hover:bg-green-700 shadow-green-200":"bg-orange-600 hover:bg-orange-700 shadow-orange-200"}`,children:z?"  ":"  "}),l.jsx("button",{onClick:()=>D(!1),className:"flex-1 bg-gray-100 text-gray-700 py-2.5 rounded-xl font-bold hover:bg-gray-200 transition",children:""})]})]})})})]})}function rW(){const{user:e}=on(),{familyId:t}=Db(),r=Oa(),[n,s]=E.useState(!0),[a,i]=E.useState(null),[o,c]=E.useState([]),[u,d]=E.useState(null);E.useEffect(()=>{f()},[t]);const f=async()=>{s(!0),d(null);try{console.log("Loading aid data for family:",t);const m=await ak(t);if(!m){d("  ");return}i(m);const x=await C5(t);console.log("Loaded aid records:",x),Array.isArray(x)?(x.sort((p,g)=>new Date(g.date)-new Date(p.date)),c(x)):c([])}catch(m){console.error("Error loading data:",m),d("    .   .")}finally{s(!1)}},h=async m=>{if(confirm("      "))try{await j5(m),f()}catch(x){console.error("Delete error",x),alert("  ")}};return n?l.jsx("div",{className:"p-10 text-center",children:" ..."}):u?l.jsxs("div",{className:"p-10 text-center",children:[l.jsx("div",{className:"text-red-500 text-xl font-bold mb-4",children:u}),l.jsx("button",{onClick:()=>r("/families"),className:"text-indigo-600 hover:underline",children:" "})]}):l.jsxs("div",{className:"max-w-5xl mx-auto space-y-6 md:space-y-8 pb-24 md:pb-10 px-4 md:px-0",children:[l.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-2 md:mb-6",children:l.jsxs("div",{className:"flex items-center gap-3 md:gap-4 w-full",children:[l.jsx("button",{onClick:()=>r("/families"),className:"bg-white p-2.5 rounded-xl shadow-sm border border-gray-100 hover:bg-gray-50 transition shrink-0",children:l.jsx(X0,{className:"h-5 w-5 md:h-6 md:w-6"})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("h1",{className:"text-xl md:text-3xl font-bold text-gray-800 truncate",children:" "}),l.jsxs("p",{className:"text-sm text-gray-500 mt-0.5 truncate bg-indigo-50/50 px-2 py-0.5 rounded-lg border border-indigo-100/50 inline-block",children:[" : ",l.jsx("span",{className:"font-bold text-indigo-600",children:a.family_number})]})]})]})}),l.jsx("div",{className:"max-w-4xl mx-auto",children:l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"flex justify-between items-center mb-2",children:l.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"  "})}),o.length===0?l.jsxs("div",{className:"bg-gray-50 border-2 border-dashed border-gray-200 rounded-2xl p-10 text-center",children:[l.jsx(Fs,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500 font-medium",children:"       "})]}):l.jsx("div",{className:"space-y-4",children:o.map(m=>l.jsxs("div",{className:"bg-white p-4 md:p-5 rounded-2xl shadow-sm border border-gray-100 flex flex-col md:flex-row gap-4 items-start md:items-center hover:shadow-md transition group",children:[l.jsx("div",{className:"bg-indigo-50 p-2.5 md:p-3 rounded-xl shrink-0",children:l.jsx(Fs,{className:"h-5 w-5 md:h-6 md:w-6 text-indigo-600"})}),l.jsxs("div",{className:"flex-1 min-w-0 w-full",children:[l.jsxs("div",{className:"flex flex-wrap items-center justify-between md:justify-start gap-2 mb-2",children:[l.jsx("span",{className:"font-bold text-gray-800 text-base md:text-lg truncate",children:m.items}),l.jsxs("span",{className:"bg-gray-100 text-gray-600 px-2 py-1 rounded-lg text-[10px] md:text-xs font-medium flex items-center gap-1",children:[l.jsx(KS,{className:"h-3 w-3"}),m.date]})]}),l.jsxs("div",{className:"text-xs md:text-sm text-gray-500 flex flex-wrap items-center gap-x-4 gap-y-1",children:[l.jsxs("span",{className:"flex items-center gap-1.5",children:[l.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-indigo-400"}),": ",l.jsx("span",{className:"text-gray-700 font-medium",children:m.recipient})]}),m.notes&&l.jsxs("span",{className:"flex items-center gap-1.5 italic text-gray-400",children:[l.jsx("span",{className:"hidden md:inline",children:""}),m.notes]})]})]}),(e==null?void 0:e.role)==="admin"&&l.jsxs("button",{onClick:()=>h(m.delivery_id),className:"w-full md:w-auto mt-2 md:mt-0 text-red-400 hover:text-red-600 p-2.5 md:p-2 bg-red-50 md:bg-transparent rounded-xl md:rounded-lg transition flex items-center justify-center gap-2 md:opacity-0 md:group-hover:opacity-100",title:" ",children:[l.jsx(nn,{className:"h-4 w-4 md:h-5 md:w-5"}),l.jsx("span",{className:"md:hidden text-xs font-bold",children:" "})]})]},m.delivery_id))})]})})]})}function nW(){const{user:e}=on(),{selectedCamp:t}=Nn(),[r,n]=E.useState(!0),[s,a]=E.useState("parcels"),[i,o]=E.useState([]),[c,u]=E.useState([]),[d,f]=E.useState([]),[h,m]=E.useState(""),[x,p]=E.useState("all"),[g,y]=E.useState({min:"",max:""}),[w,v]=E.useState(""),[_,S]=E.useState(new Set),[b,k]=E.useState(!1),[T,j]=E.useState({name:"",date:new Date().toISOString().split("T")[0]}),[V,C]=E.useState(null),[R,X]=E.useState(!1),[G,Y]=E.useState(!1);E.useEffect(()=>{t&&se()},[t]);const se=async()=>{n(!0);try{const B=await H5(t.camp_id);o(B);const ne=await rn(t.camp_id),U=await zn(t.camp_id),J=await ik(),ae=["","husband","father","",""],q=["","widow","","divorced","","abandoned"," ","second_wife","","guardian"],be=ne.filter(Ee=>!Ee.is_departed).map(Ee=>{const Ve=U.filter(lt=>lt.family_id===Ee.family_id),Ue=zs(Ve),me=J.filter(lt=>lt.family_id===Ee.family_id),et=me.filter(lt=>lt.parcel_id).map(lt=>lt.parcel_id);return{id:Ee.family_id,serial:Ee.family_number,headName:Ue?Ue.name:"  ",headNid:Ue?Ue.nid:"",delegate:Ee.delegate||" ",receivedParcels:et,size:Ve.length,aidHistory:me}});be.sort((Ee,Ve)=>parseInt(Ee.serial||0)-parseInt(Ve.serial||0)),u(be),f(J)}catch(B){console.error("Error loading data:",B),alert("    ")}finally{n(!1)}},ie=B=>{C(B),a("names")},oe=async()=>{if(T.name)try{await G5({...T,camp_id:t.camp_id,status:"active"}),k(!1),j({name:"",date:new Date().toISOString().split("T")[0]}),se()}catch(B){console.error(B),alert(" ")}},W=async B=>{if(window.confirm("       "))try{await K5(B.parcel_id,{status:"completed"}),se()}catch{alert(" ")}},ue=async B=>{if(window.confirm("     "))try{await X5(B),se()}catch{alert("   ")}},ve=B=>{const ne=new Set(_);ne.has(B)?ne.delete(B):ne.add(B),S(ne)},F=async()=>{var ne;if(G)return;if(!w)return alert("   ");if(_.size===0)return alert("  ");const B=i.find(U=>U.parcel_id===w);if(window.confirm(`  "${B.name}"  ${_.size} `)){Y(!0);try{const U=Array.from(_);let J=0,ae=0;for(const q of U){const O=c.find(be=>be.id===q);if(O&&!O.receivedParcels.includes(w))try{await kv({family_id:q,parcel_id:w,items:B.name,date:new Date().toISOString().split("T")[0],recipient:O.headName,notes:" "}),J++}catch(be){if((ne=be.message)!=null&&ne.includes("unique")||be.code==="23505")ae++;else throw be}}alert(`    ${J}  ${ae>0?` (  ${ae} )`:""}.`),S(new Set),se()}catch(U){console.error(U),alert("   ")}finally{Y(!1)}}},H=async B=>{const ne=B.target.files[0];if(!ne)return;const U=new FileReader;U.onload=async J=>{var ae;try{const q=J.target.result,O=x0(q,{type:"binary"}),be=O.SheetNames[0],Ee=O.Sheets[be],Ue=At.sheet_to_json(Ee,{header:1}).slice(1);let me=0;for(const et of Ue){const lt=(ae=et[0])==null?void 0:ae.toString().trim(),zt=et[1];if(!lt||!zt)continue;const Yt=c.find(re=>re.headNid===lt),he=i.find(re=>re.display_id==zt);Yt&&he&&(Yt.receivedParcels.includes(he.parcel_id)||(await kv({family_id:Yt.id,parcel_id:he.parcel_id,items:he.name,date:new Date().toISOString().split("T")[0],recipient:Yt.headName,notes:" Excel"}),me++))}alert(`  ${me}  .`),se()}catch(q){console.error(q),alert("  ")}},U.readAsBinaryString(ne)},D=E.useMemo(()=>c.filter(B=>{const ne=B.headName&&B.headName.includes(h)||B.headNid&&B.headNid.includes(h)||B.serial&&B.serial.toString().includes(h),U=x==="all"||B.delegate===x,J=V?B.receivedParcels.includes(V):!0,ae=B.size||0,q=g.min?parseInt(g.min):0,O=g.max?parseInt(g.max):999,be=ae>=q&&ae<=O;return ne&&U&&J&&be}),[c,h,x,V,g]),z=E.useMemo(()=>{const B=new Set(c.map(ne=>ne.delegate).filter(Boolean));return Array.from(B)},[c]);return r?l.jsx("div",{className:"p-10 text-center text-gray-500",children:"  ..."}):l.jsxs("div",{className:"container mx-auto max-w-5xl p-4 md:p-6 min-h-screen bg-gray-50 font-sans pb-24 md:pb-10",dir:"rtl",children:[l.jsxs("div",{className:"bg-white p-1.5 rounded-2xl shadow-sm mb-6 grid grid-cols-2 gap-2 w-full max-w-lg mx-auto border border-gray-100",children:[l.jsxs("button",{onClick:()=>a("parcels"),className:`py-3 rounded-xl font-bold transition-all text-center flex items-center justify-center gap-2 ${s==="parcels"?"bg-indigo-600 text-white shadow-md transform scale-[1.02]":"text-gray-500 hover:bg-gray-50 hover:text-indigo-600"}`,children:[l.jsx(Fs,{className:`h-5 w-5 ${s==="parcels"?"text-indigo-200":"text-gray-400"}`})," "]}),l.jsxs("button",{onClick:()=>a("names"),className:`py-3 rounded-xl font-bold transition-all text-center flex items-center justify-center gap-2 ${s==="names"?"bg-indigo-600 text-white shadow-md transform scale-[1.02]":"text-gray-500 hover:bg-gray-50 hover:text-indigo-600"}`,children:[l.jsx(vn,{className:`h-5 w-5 ${s==="names"?"text-indigo-200":"text-gray-400"}`})," "]})]}),l.jsxs("div",{className:"space-y-6",children:[s==="parcels"&&l.jsxs(Ze.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"space-y-4",children:[l.jsxs("div",{className:"flex justify-between items-center bg-white p-4 rounded-2xl shadow-sm",children:[l.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[l.jsx(Fs,{className:"h-6 w-6 text-indigo-600"})," / "]}),l.jsx("button",{onClick:()=>k(!0),className:"bg-indigo-600 text-white w-10 h-10 rounded-full flex items-center justify-center font-bold text-2xl shadow-lg hover:bg-indigo-700 transition",children:l.jsx(gi,{className:"h-6 w-6"})})]}),l.jsxs("div",{className:"grid gap-4",children:[i.length===0&&l.jsx("div",{className:"text-center text-gray-400 py-10",children:"    "}),i.map(B=>l.jsxs("div",{className:"bg-white p-5 rounded-2xl shadow-sm border border-gray-100 flex justify-between items-center group hover:border-indigo-100 transition",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("span",{className:"bg-gray-100 text-gray-600 font-bold px-3 py-1 rounded-lg",children:["#",B.display_id]}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-bold text-gray-800 text-lg",children:B.name}),l.jsxs("span",{className:"text-sm text-gray-500 flex items-center gap-1",children:[l.jsx(KS,{className:"h-3 w-3"}),B.date]})]}),l.jsx("span",{className:`text-xs px-2 py-1 rounded-md font-bold ${B.status==="active"?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"}`,children:B.status==="active"?" ":""})]}),l.jsxs("div",{className:"flex gap-2 opacity-100 sm:opacity-0 group-hover:opacity-100 transition",children:[l.jsxs("button",{onClick:()=>ie(B.parcel_id),className:"px-3 py-1 bg-indigo-50 text-indigo-600 rounded-lg hover:bg-indigo-100 text-sm font-bold border border-indigo-200",children:[l.jsx(vn,{className:"h-4 w-4 inline-block ml-1"}),""]}),B.status==="active"&&l.jsx("button",{onClick:()=>W(B),className:"px-3 py-1 bg-green-50 text-green-600 rounded-lg hover:bg-green-100 text-sm font-bold border border-green-200",children:""}),l.jsx("button",{onClick:()=>ue(B.parcel_id),className:"p-2 text-red-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition",children:l.jsx(nn,{className:"h-5 w-5"})})]})]},B.parcel_id))]})]}),s==="names"&&l.jsxs(Ze.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-white p-4 md:p-6 rounded-3xl shadow-sm border border-gray-100 min-h-[500px] flex flex-col",children:[l.jsxs("div",{className:"flex flex-col gap-4 mb-6 sticky top-0 md:static bg-white z-10 p-2 md:p-0 -mx-4 px-4 md:mx-0",children:[w&&_.size>0||V?l.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between bg-indigo-50 p-3 rounded-2xl border border-indigo-100 flex-wrap gap-3 animate-pulse-soft",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"bg-indigo-600 text-white w-8 h-8 rounded-full flex items-center justify-center font-bold shadow-sm shrink-0",children:_.size}),l.jsx("span",{className:"text-indigo-800 font-bold text-sm",children:"  "})]}),l.jsxs("div",{className:"flex flex-wrap items-center gap-2 w-full md:w-auto",children:[V&&l.jsxs("button",{onClick:()=>C(null),className:"bg-white text-gray-700 hover:text-red-600 px-3 py-2 rounded-xl text-sm font-bold border border-gray-200 transition flex items-center gap-1 flex-1 md:flex-none justify-center",children:[l.jsx(tE,{className:"h-4 w-4"})," "]}),w&&_.size>0&&l.jsxs("button",{onClick:F,disabled:G,className:`flex items-center justify-center gap-2 px-5 py-2.5 text-white text-sm font-bold rounded-xl shadow-md transition flex-1 md:flex-none ${G?"bg-gray-400 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700 hover:scale-105 active:scale-95"}`,children:[l.jsx(Oc,{className:`h-4 w-4 ${G?"animate-spin":""}`}),G?" ...":" "]})]})]}):null,l.jsxs("div",{className:"flex flex-col gap-3",children:[l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("div",{className:"relative flex-1",children:[l.jsx(Ai,{className:"absolute right-3 top-3 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"text",placeholder:"  ( )...",value:h,onChange:B=>m(B.target.value),className:"w-full pr-10 pl-4 py-2.5 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none transition shadow-sm"})]}),l.jsx("button",{onClick:()=>X(!R),className:`md:hidden px-3 py-2 rounded-xl transition border ${R?"bg-indigo-100 border-indigo-200 text-indigo-700":"bg-gray-50 border-gray-200 text-gray-600"}`,children:l.jsx(Xl,{className:"h-5 w-5"})})]}),l.jsxs("div",{className:`${R?"grid":"hidden"} md:grid grid-cols-1 md:grid-cols-12 gap-3 items-end`,children:[l.jsx("div",{className:"col-span-1 md:col-span-4"}),l.jsx("div",{className:"col-span-1 md:col-span-3",children:l.jsxs("select",{value:x,onChange:B=>p(B.target.value),className:"w-full px-4 py-2.5 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none cursor-pointer",children:[l.jsx("option",{value:"all",children:" "}),z.map(B=>l.jsx("option",{value:B,children:B},B))]})}),l.jsxs("div",{className:"col-span-1 md:col-span-2 flex items-center gap-2 bg-gray-50 rounded-xl px-2 border border-gray-200 h-[46px]",children:[l.jsx("span",{className:"text-gray-400 text-xs font-bold whitespace-nowrap",children:":"}),l.jsx("input",{type:"number",placeholder:"",value:g.min,onChange:B=>y({...g,min:B.target.value}),className:"w-full bg-transparent text-center text-sm font-bold outline-none"}),l.jsx("span",{className:"text-gray-300",children:"-"}),l.jsx("input",{type:"number",placeholder:"",value:g.max,onChange:B=>y({...g,max:B.target.value}),className:"w-full bg-transparent text-center text-sm font-bold outline-none"})]}),l.jsx("div",{className:"col-span-1 md:col-span-3",children:l.jsxs("select",{value:w,onChange:B=>v(B.target.value),className:`w-full px-4 py-2.5 border rounded-xl font-bold outline-none shadow-sm transition cursor-pointer appearance-none ${w?"bg-indigo-600 text-white border-indigo-600 ring-2 ring-indigo-200":"bg-white border-gray-200 text-gray-500 hover:border-gray-300"}`,children:[l.jsx("option",{value:"",className:"text-gray-500 bg-white",children:"--    --"}),i.filter(B=>B.status==="active").map(B=>l.jsxs("option",{value:B.parcel_id,className:"text-black bg-white",children:[" ",B.name," (#",B.display_id,")"]},B.parcel_id))]})})]})]})]}),l.jsxs("div",{className:"flex-1 overflow-auto border rounded-xl border-gray-100 bg-white shadow-inner",children:[l.jsxs("table",{className:"w-full text-right text-sm hidden md:table",children:[l.jsx("thead",{className:"bg-gray-50 text-gray-600 font-bold sticky top-0 z-10 shadow-sm",children:l.jsxs("tr",{children:[l.jsx("th",{className:"p-4 w-12 text-center",children:l.jsx("input",{type:"checkbox",onChange:B=>{B.target.checked?S(new Set(D.map(ne=>ne.id))):S(new Set)},checked:D.length>0&&_.size===D.length,className:"w-5 h-5 rounded text-indigo-600 focus:ring-indigo-500 border-gray-300 cursor-pointer"})}),l.jsx("th",{className:"p-4",children:""}),l.jsx("th",{className:"p-4",children:" ()"}),l.jsx("th",{className:"p-4",children:""}),l.jsx("th",{className:"p-4",children:" "}),l.jsx("th",{className:"p-4 w-[25%]",children:" "}),l.jsx("th",{className:"p-4 w-10"})]})}),l.jsxs("tbody",{className:"divide-y divide-gray-100",children:[D.map(B=>l.jsxs("tr",{className:`hover:bg-indigo-50 transition cursor-pointer group ${_.has(B.id)?"bg-indigo-50":""}`,onClick:()=>ve(B.id),children:[l.jsx("td",{className:"p-4 text-center",onClick:ne=>ne.stopPropagation(),children:l.jsx("input",{type:"checkbox",checked:_.has(B.id),onChange:()=>ve(B.id),className:"w-5 h-5 rounded text-indigo-600 focus:ring-indigo-500 border-gray-300 cursor-pointer"})}),l.jsx("td",{className:"p-4",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("span",{className:"bg-gray-100 text-gray-600 px-2.5 py-1 rounded-lg text-xs font-bold font-mono group-hover:bg-white transition",children:["#",B.serial]}),l.jsx("span",{className:`font-bold ${_.has(B.id)?"text-indigo-700":"text-gray-800"}`,children:B.headName})]})}),l.jsx("td",{className:"p-4 text-gray-500 font-mono text-xs",children:B.headNid}),l.jsx("td",{className:"p-4 text-gray-500 text-xs",children:B.delegate}),l.jsx("td",{className:"p-4 text-center font-bold text-indigo-900 bg-indigo-50/50 rounded-lg",children:B.size}),l.jsx("td",{className:"p-4",children:l.jsx("div",{className:"flex flex-wrap gap-1",children:B.receivedParcels.map(ne=>{const U=i.find(J=>J.parcel_id===ne);return U?l.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 bg-green-50 text-green-700 text-[10px] font-bold border border-green-200 rounded shadow-sm",children:U.name},ne):null})})}),l.jsx("td",{className:"p-4",onClick:ne=>ne.stopPropagation(),children:l.jsx(un,{to:`/aid/${B.id}`,target:"_blank",className:"inline-flex items-center justify-center p-2 bg-indigo-50 hover:bg-indigo-100 text-indigo-600 rounded-lg transition border border-indigo-100 shadow-sm",title:"    ",children:l.jsx(Fs,{className:"h-4 w-4"})})})]},B.id)),D.length===0&&l.jsx("tr",{children:l.jsx("td",{colSpan:"7",className:"p-12 text-center text-gray-400 font-medium",children:"    "})})]})]}),l.jsxs("div",{className:"md:hidden space-y-2 p-2 bg-gray-50",children:[D.length>0&&l.jsx("div",{className:"flex items-center justify-between bg-white p-3 rounded-xl border border-gray-200 shadow-sm mb-2",children:l.jsxs("label",{className:"flex items-center gap-3 text-sm font-bold text-gray-700 cursor-pointer w-full",children:[l.jsx("input",{type:"checkbox",onChange:B=>{B.target.checked?S(new Set(D.map(ne=>ne.id))):S(new Set)},checked:D.length>0&&_.size===D.length,className:"w-5 h-5 rounded text-indigo-600 focus:ring-indigo-500 border-gray-300"}),l.jsxs("span",{children:["  (",D.length,")"]})]})}),D.map(B=>l.jsxs("div",{className:`bg-white p-4 rounded-xl shadow-sm border ${_.has(B.id)?"border-indigo-500 ring-1 ring-indigo-500 bg-indigo-50":"border-gray-200"} transition active:scale-98`,onClick:()=>ve(B.id),children:[l.jsxs("div",{className:"flex justify-between items-start mb-3",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("input",{type:"checkbox",checked:_.has(B.id),onChange:()=>ve(B.id),className:"w-5 h-5 rounded text-indigo-600 focus:ring-indigo-500 border-gray-300 pointer-events-none"}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("span",{className:"bg-gray-100 text-gray-600 px-2 py-0.5 rounded text-[10px] font-bold font-mono",children:["#",B.serial]}),l.jsx("h3",{className:`font-bold text-sm ${_.has(B.id)?"text-indigo-700":"text-gray-900"}`,children:B.headName})]}),l.jsx("div",{className:"text-gray-500 text-xs font-mono mt-0.5",children:B.headNid})]})]}),l.jsx(un,{to:`/aid/${B.id}`,target:"_blank",onClick:ne=>ne.stopPropagation(),className:"p-2 bg-gray-100 text-gray-500 rounded-lg",children:l.jsx(Fs,{className:"h-4 w-4"})})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs text-gray-600 bg-gray-50 p-2.5 rounded-lg mb-2",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-400 block mb-0.5",children:":"}),B.delegate]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-400 block mb-0.5",children:" :"}),l.jsx("span",{className:"font-bold text-indigo-700",children:B.size})]})]}),B.receivedParcels.length>0&&l.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:B.receivedParcels.map(ne=>{const U=i.find(J=>J.parcel_id===ne);return U?l.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 bg-green-50 text-green-700 text-[10px] font-bold border border-green-200 rounded shadow-sm",children:U.name},ne):null})})]},B.id)),D.length===0&&l.jsx("div",{className:"p-10 text-center text-gray-400 font-medium",children:"    "})]})]}),l.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100 flex flex-col md:flex-row justify-end gap-2",children:l.jsxs("label",{className:"flex items-center justify-center gap-2 px-4 py-3 bg-gray-50 hover:bg-gray-100 text-gray-600 text-sm font-bold rounded-xl cursor-pointer transition border border-gray-200 w-full md:w-auto",children:[l.jsx(e0,{className:"h-4 w-4 text-green-600"}),l.jsx("span",{children:"   Excel"}),l.jsx("input",{type:"file",accept:".xlsx, .xls",className:"hidden",onChange:H})]})})]})]}),b&&l.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 backdrop-blur-sm",children:l.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-sm p-6 shadow-2xl",children:[l.jsx("h3",{className:"text-xl font-bold mb-4",children:"  /  "}),l.jsx("input",{type:"text",placeholder:"  (:   1)",value:T.name,onChange:B=>j({...T,name:B.target.value}),className:"w-full mb-3 p-3 border border-gray-200 rounded-xl outline-none focus:ring-2 focus:ring-indigo-500",autoFocus:!0}),l.jsx("input",{type:"date",value:T.date,onChange:B=>j({...T,date:B.target.value}),className:"w-full mb-6 p-3 border border-gray-200 rounded-xl outline-none focus:ring-2 focus:ring-indigo-500"}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:oe,className:"flex-1 bg-indigo-600 text-white font-bold py-3 rounded-xl hover:bg-indigo-700 transition",children:""}),l.jsx("button",{onClick:()=>k(!1),className:"flex-1 bg-gray-100 text-gray-700 font-bold py-3 rounded-xl hover:bg-gray-200 transition",children:""})]})]})})]})}const sW=e=>{if(!e)return 0;try{const t=new Date(e);if(isNaN(t.getTime()))return 0;const r=Date.now()-t.getTime();return Math.abs(new Date(r).getUTCFullYear()-1970)}catch{return 0}},t_=(e,t)=>e==="other"?t||"":{ready_tent:" ",manufactured_tent:" ",house:""}[e]||e||"-",_h=e=>({husband:"",wife:"",second_wife:" ",widow:"",widower:"",divorced:"",abandoned:"",guardian:"",son:"",daughter:"",other:""})[e]||e,Yu=({sortConfig:e,column:t})=>e.key!==t?l.jsx("div",{className:"w-4 h-4 inline-block opacity-20",children:""}):l.jsx("div",{className:"w-4 h-4 inline-block",children:e.direction==="ascending"?"":""});function aW(){const{selectedCamp:e}=Nn(),[t,r]=E.useState([]),[n,s]=E.useState(!0),[a,i]=E.useState("all"),[o,c]=E.useState(""),[u,d]=E.useState("all"),[f,h]=E.useState(""),[m,x]=E.useState(""),[p,g]=E.useState(""),[y,w]=E.useState("all"),[v,_]=E.useState("active"),[S,b]=E.useState({key:"familyNumber",direction:"ascending"});E.useEffect(()=>{e?k():(r([]),s(!1))},[e]);const k=async()=>{if(e){s(!0);try{const C=await rn(e.camp_id),R=await zn(e.camp_id),X=R.map(G=>{const Y=C.find(ie=>ie.family_id===G.family_id)||{},se=R.filter(ie=>ie.family_id===G.family_id).length;return{...G,familyNumber:Y.family_number||"-",familyAddress:Y.address||"-",familyContact:Y.contact||"-",familyAlternativeMobile:Y.alternative_mobile||"-",familyHousingStatus:Y.housing_status||"-",familyNeeds:Y.family_needs||"-",familyDelegate:Y.delegate||"-",familyShelterType:Y.shelter_type||"-",familyShelterOther:Y.shelter_type_other||"-",familySize:se,familyIsDeparted:Y.is_departed||!1,age:sW(G.dob),healthNotes:G.health_notes||G.notes||"",isPregnant:G.is_pregnant||!1,isNursing:G.is_nursing||!1,shoeSize:G.shoe_size||"-",clothesSize:G.clothes_size||"-"}});r(X)}catch(C){console.error("Load error:",C)}finally{s(!1)}}},T=C=>{let R="ascending";S.key===C&&S.direction==="ascending"&&(R="descending"),b({key:C,direction:R})},j=E.useMemo(()=>{let C=t.filter(R=>{if(o){const X=o.toString().toLowerCase().trim(),G=(R.familyNumber||"").toString().toLowerCase().trim(),Y=(R.name||"").toLowerCase(),se=(R.nid||"").toString();if(u==="all"){if(!G.includes(X)&&!Y.includes(X)&&!se.includes(X))return!1}else if(u==="name"){if(!Y.includes(X))return!1}else if(u==="familyNumber"){if(G!==X)return!1}else if(u==="nid"&&!se.includes(X))return!1}return!(a!=="all"&&R.role!==a||f&&R.age<parseInt(f)||m&&R.age>parseInt(m)||p&&R.familySize!==parseInt(p)||y==="pregnant"&&!R.isPregnant||y==="nursing"&&!R.isNursing||v==="active"&&R.familyIsDeparted||v==="departed"&&!R.familyIsDeparted)});return S.key&&C.sort((R,X)=>{let G=R[S.key],Y=X[S.key];if(S.key==="familyNumber"){const se=parseInt(G),ie=parseInt(Y);!isNaN(se)&&!isNaN(ie)&&(G=se,Y=ie)}return G<Y?S.direction==="ascending"?-1:1:G>Y?S.direction==="ascending"?1:-1:0}),C},[t,a,f,m,y,o,p,S,v,u]),V=()=>{const C=At.json_to_sheet(j.map(X=>({" ":X.familyNumber,:X.name,:X.nid||"",:_h(X.role),:X.age," ":X.familySize," ":X.familyContact," ":X.familyAlternativeMobile,:X.familyAddress,:X.familyDelegate," ":t_(X.familyShelterType,X.familyShelterOther)," ":X.familyHousingStatus," ":X.familyNeeds," ":X.shoeSize," ":X.clothesSize,:X.isPregnant?"":"",:X.isNursing?"":"",:X.healthNotes}))),R=At.book_new();R.Workbook||(R.Workbook={}),R.Workbook.Views||(R.Workbook.Views=[]),R.Workbook.Views[0]||(R.Workbook.Views[0]={}),R.Workbook.Views[0].RTL=!0,At.book_append_sheet(R,C,""),Si(R,"family_data_export.xlsx")};return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:" "}),l.jsxs("button",{onClick:V,className:"bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg font-medium flex items-center gap-2 shadow-sm transition-colors",children:[l.jsx(ms,{className:"h-4 w-4"}),"  Excel"]})]}),l.jsxs("div",{className:"bg-white p-4 md:p-6 rounded-3xl shadow-sm border border-gray-100 space-y-4 md:space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[l.jsxs("div",{className:"flex flex-col gap-1",children:[l.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase mr-1",children:" "}),l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("select",{value:u,onChange:C=>d(C.target.value),className:"w-[85px] md:w-[100px] p-2.5 bg-gray-50 border border-gray-200 rounded-xl text-xs md:text-sm font-bold focus:ring-2 focus:ring-indigo-500 outline-none cursor-pointer",children:[l.jsx("option",{value:"all",children:""}),l.jsx("option",{value:"name",children:""}),l.jsx("option",{value:"familyNumber",children:" "}),l.jsx("option",{value:"nid",children:""})]}),l.jsxs("div",{className:"relative flex-1",children:[l.jsx("input",{type:"text",placeholder:u==="all"?"  ...":u==="name"?" ...":u==="familyNumber"?" ...":" ...",className:"w-full p-2.5 pl-9 bg-gray-50 border border-gray-200 rounded-xl text-xs md:text-sm focus:ring-2 focus:ring-indigo-500 outline-none font-medium",value:o,onChange:C=>c(C.target.value)}),l.jsx(Ai,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"})]})]})]}),l.jsxs("div",{className:"flex flex-col gap-1",children:[l.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase mr-1",children:" / "}),l.jsxs("select",{className:"w-full p-2.5 bg-gray-50 border border-gray-200 rounded-xl text-xs md:text-sm font-bold outline-none focus:ring-2 focus:ring-indigo-500",value:a,onChange:C=>i(C.target.value),children:[l.jsx("option",{value:"all",children:""}),l.jsx("option",{value:"husband",children:""}),l.jsx("option",{value:"wife",children:""}),l.jsx("option",{value:"second_wife",children:" "}),l.jsx("option",{value:"widow",children:""}),l.jsx("option",{value:"widower",children:""}),l.jsx("option",{value:"divorced",children:""}),l.jsx("option",{value:"abandoned",children:""}),l.jsx("option",{value:"guardian",children:""}),l.jsx("option",{value:"son",children:""}),l.jsx("option",{value:"daughter",children:""}),l.jsx("option",{value:"other",children:""})]})]}),l.jsxs("div",{className:"flex flex-col gap-1",children:[l.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase mr-1",children:" ( - )"}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{type:"number",placeholder:"",className:"w-full p-2.5 bg-gray-50 border border-gray-200 rounded-xl text-xs md:text-sm outline-none font-bold",value:f,onChange:C=>h(C.target.value)}),l.jsx("input",{type:"number",placeholder:"",className:"w-full p-2.5 bg-gray-50 border border-gray-200 rounded-xl text-xs md:text-sm outline-none font-bold",value:m,onChange:C=>x(C.target.value)})]})]}),l.jsxs("div",{className:"flex flex-col gap-1",children:[l.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase mr-1",children:" "}),l.jsxs("select",{className:"w-full p-2.5 bg-gray-50 border border-gray-200 rounded-xl text-xs md:text-sm font-bold outline-none",value:y,onChange:C=>w(C.target.value),children:[l.jsx("option",{value:"all",children:""}),l.jsx("option",{value:"pregnant",children:""}),l.jsx("option",{value:"nursing",children:""})]})]}),l.jsxs("div",{className:"flex flex-col gap-1",children:[l.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase mr-1",children:" "}),l.jsx("input",{type:"number",placeholder:" ",className:"w-full p-2.5 bg-gray-50 border border-gray-200 rounded-xl text-xs md:text-sm outline-none font-bold",value:p,onChange:C=>g(C.target.value)})]}),l.jsxs("div",{className:"flex flex-col gap-1",children:[l.jsx("label",{className:"text-[10px] font-black text-gray-400 uppercase mr-1",children:" "}),l.jsxs("select",{className:"w-full p-2.5 bg-gray-50 border border-gray-200 rounded-xl text-xs md:text-sm font-bold outline-none",value:v,onChange:C=>_(C.target.value),children:[l.jsx("option",{value:"active",children:""}),l.jsx("option",{value:"departed",children:""}),l.jsx("option",{value:"all",children:""})]})]})]}),l.jsx("div",{className:"flex justify-center pt-2",children:l.jsxs("button",{onClick:k,className:"w-full md:w-auto px-10 py-3.5 bg-indigo-600 hover:bg-indigo-700 text-white rounded-2xl flex items-center justify-center gap-3 transition-all font-black text-sm md:text-base shadow-xl shadow-indigo-100 active:scale-95",children:[l.jsx(K8,{className:"h-5 w-5"}),"  "]})})]}),l.jsx("div",{className:"hidden md:block bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-right min-w-[1500px]",children:[l.jsx("thead",{className:"bg-gray-50 text-xs text-gray-500 uppercase font-bold border-b select-none whitespace-nowrap",children:l.jsxs("tr",{children:[l.jsxs("th",{className:"px-4 py-3 cursor-pointer hover:bg-gray-100 sticky right-0 bg-gray-50 z-10",onClick:()=>T("familyNumber"),children:["  ",l.jsx(Yu,{sortConfig:S,column:"familyNumber"})]}),l.jsxs("th",{className:"px-4 py-3 cursor-pointer hover:bg-gray-100 sticky right-[100px] bg-gray-50 z-10",onClick:()=>T("name"),children:[" ",l.jsx(Yu,{sortConfig:S,column:"name"})]}),l.jsx("th",{className:"px-4 py-3",children:""}),l.jsxs("th",{className:"px-4 py-3 cursor-pointer hover:bg-gray-100",onClick:()=>T("role"),children:[" ",l.jsx(Yu,{sortConfig:S,column:"role"})]}),l.jsxs("th",{className:"px-4 py-3 cursor-pointer hover:bg-gray-100",onClick:()=>T("age"),children:[" ",l.jsx(Yu,{sortConfig:S,column:"age"})]}),l.jsx("th",{className:"px-4 py-3",children:""}),l.jsx("th",{className:"px-4 py-3",children:""}),l.jsx("th",{className:"px-4 py-3",children:""}),l.jsx("th",{className:"px-4 py-3",children:""}),l.jsx("th",{className:"px-4 py-3",children:" "}),l.jsx("th",{className:"px-4 py-3",children:" "}),l.jsx("th",{className:"px-4 py-3",children:""}),l.jsx("th",{className:"px-4 py-3",children:""}),l.jsx("th",{className:"px-4 py-3",children:""}),l.jsx("th",{className:"px-4 py-3",children:""}),l.jsx("th",{className:"px-4 py-3",children:" "}),l.jsx("th",{className:"px-4 py-3",children:""}),l.jsx("th",{className:"px-4 py-3 sticky left-0 bg-gray-50 z-10",children:""})]})}),l.jsx("tbody",{className:"divide-y divide-gray-100 text-sm whitespace-nowrap",children:n?l.jsx("tr",{children:l.jsx("td",{colSpan:"18",className:"text-center p-8",children:" ..."})}):j.length===0?l.jsx("tr",{children:l.jsx("td",{colSpan:"18",className:"text-center p-8 text-gray-500",children:"  "})}):j.map((C,R)=>l.jsxs("tr",{className:`transition ${C.familyIsDeparted?"bg-orange-50/40 hover:bg-orange-50":"hover:bg-gray-50"}`,children:[l.jsxs("td",{className:"px-4 py-3 font-bold text-indigo-700 sticky right-0 bg-white z-10",children:["#",C.familyNumber]}),l.jsx("td",{className:"px-4 py-3 font-medium text-gray-900 sticky right-[100px] bg-white z-10",children:C.name}),l.jsx("td",{className:"px-4 py-3 font-mono text-xs",children:C.nid}),l.jsx("td",{className:"px-4 py-3",children:l.jsx("span",{className:`px-2 py-1 rounded text-xs ${C.role==="husband"?"bg-blue-100 text-blue-700":"bg-gray-100"}`,children:_h(C.role)})}),l.jsx("td",{className:"px-4 py-3",children:C.age}),l.jsx("td",{className:"px-4 py-3 text-center",children:C.familySize}),l.jsx("td",{className:"px-4 py-3 font-mono text-xs",children:C.familyContact}),l.jsx("td",{className:"px-4 py-3 font-mono text-xs",children:C.familyAlternativeMobile}),l.jsx("td",{className:"px-4 py-3",children:C.familyDelegate}),l.jsx("td",{className:"px-4 py-3",children:t_(C.familyShelterType,C.familyShelterOther)}),l.jsx("td",{className:"px-4 py-3",children:C.familyHousingStatus}),l.jsx("td",{className:"px-4 py-3 truncate max-w-[150px]",children:C.familyAddress}),l.jsx("td",{className:"px-4 py-3 truncate max-w-[150px]",children:C.familyNeeds}),l.jsx("td",{className:"px-4 py-3 text-center",children:C.shoeSize}),l.jsx("td",{className:"px-4 py-3 text-center",children:C.clothesSize}),l.jsxs("td",{className:"px-4 py-3 text-pink-600 font-bold",children:[C.isPregnant&&" ",C.isNursing&&""]}),l.jsx("td",{className:"px-4 py-3 truncate max-w-[150px]",children:C.healthNotes}),l.jsx("td",{className:"px-4 py-3 sticky left-0 bg-white z-10",children:l.jsx(un,{to:`/edit/${C.family_id}`,className:"text-indigo-600 bg-indigo-50 p-2 rounded-lg",children:l.jsx(oi,{className:"h-4 w-4"})})})]},R))})]})})}),l.jsx("div",{className:"md:hidden space-y-4",children:n?l.jsx("div",{className:"bg-white p-8 rounded-2xl text-center",children:" ..."}):j.length===0?l.jsx("div",{className:"bg-white p-8 rounded-2xl text-center",children:"  "}):j.map((C,R)=>l.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-4",children:[l.jsxs("div",{className:"flex justify-between items-start mb-3",children:[l.jsxs("div",{children:[l.jsxs("span",{className:"font-black text-indigo-600",children:["#",C.familyNumber]}),l.jsx("h3",{className:"font-bold text-gray-900 mt-1",children:C.name}),l.jsx("p",{className:"text-xs text-gray-500",children:C.nid})]}),l.jsx(un,{to:`/edit/${C.family_id}`,className:"bg-indigo-50 text-indigo-600 p-2 rounded-xl",children:l.jsx(oi,{className:"h-5 w-5"})})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-3 text-xs",children:[l.jsxs("div",{className:"bg-gray-50 p-2 rounded-lg",children:[l.jsx("p",{className:"text-gray-400 font-bold uppercase text-[10px]",children:""}),l.jsx("p",{className:"font-bold",children:_h(C.role)})]}),l.jsxs("div",{className:"bg-gray-50 p-2 rounded-lg",children:[l.jsx("p",{className:"text-gray-400 font-bold uppercase text-[10px]",children:""}),l.jsxs("p",{className:"font-bold",children:[C.age," "]})]})]}),l.jsxs("div",{className:"flex justify-between text-[10px] text-gray-400 pt-2 border-t font-mono",children:[l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx(q0,{className:"h-3 w-3"}),C.familyAddress]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx(Xx,{className:"h-3 w-3"}),C.familyContact]})]})]},R))}),l.jsxs("div",{className:"p-4 bg-white/50 text-xs text-gray-500 text-center rounded-xl",children:[" : ",j.length]})]})}const bh=e=>{if(!e)return 0;try{const t=new Date(e);if(isNaN(t.getTime()))return 0;const r=new Date;let n=r.getFullYear()-t.getFullYear();const s=r.getMonth()-t.getMonth();return(s<0||s===0&&r.getDate()<t.getDate())&&n--,n}catch{return 0}},iW=e=>({husband:"",wife:"",second_wife:" ",widow:"",widower:"",divorced:"",abandoned:"",guardian:"",son:"",daughter:"",other:""})[e]||e,r_=[{value:"husband",label:""},{value:"wife",label:""},{value:"second_wife",label:" "},{value:"widow",label:""},{value:"widower",label:""},{value:"divorced",label:""},{value:"abandoned",label:""},{value:"guardian",label:""},{value:"son",label:""},{value:"daughter",label:""},{value:"other",label:""}];function oW(){const{user:e}=on(),{selectedCamp:t}=Nn(),[r,n]=E.useState(!0),[s,a]=E.useState([]),[i,o]=E.useState([]),[c,u]=E.useState([]),[d,f]=E.useState([]),[h,m]=E.useState({}),[x,p]=E.useState([]),[g,y]=E.useState([]),[w,v]=E.useState("all"),[_,S]=E.useState("all"),[b,k]=E.useState(""),[T,j]=E.useState(""),[V,C]=E.useState(""),[R,X]=E.useState(""),[G,Y]=E.useState("all"),[se,ie]=E.useState([]),oe=E.useMemo(()=>{if(x.length===0)return[];const he=c.filter(re=>x.includes(re.camp_id));return[...new Set(he.map(re=>re.name))].filter(Boolean).sort()},[c,x]),[W,ue]=E.useState(!1),[ve,F]=E.useState(!1),[H,D]=E.useState([]),[z,B]=E.useState(""),[ne,U]=E.useState(""),[J,ae]=E.useState(!1),[q,O]=E.useState(!1),[be,Ee]=E.useState([{key:"display_family_number",label:" ",visible:!0},{key:"name",label:"",visible:!0},{key:"nid",label:"",visible:!0},{key:"role_translated",label:"",visible:!0},{key:"age",label:"",visible:!0},{key:"member_count",label:" ",visible:!0},{key:"camp_name",label:"",visible:!1},{key:"dob",label:" ",visible:!1},{key:"gender",label:"",visible:!1},{key:"role_description",label:" ",visible:!1},{key:"contact",label:" ",visible:!1},{key:"alternative_mobile",label:" ",visible:!1},{key:"housing_status",label:" ",visible:!1},{key:"address",label:"",visible:!1},{key:"delegate",label:"",visible:!1},{key:"is_pregnant_label",label:"",visible:!1},{key:"is_nursing_label",label:"",visible:!1},{key:"health_notes",label:" ",visible:!1},{key:"shoe_size",label:" ",visible:!1},{key:"clothes_size",label:" ",visible:!1},{key:"family_needs",label:"",visible:!1},{key:"head_name",label:" ",visible:!1},{key:"head_nid",label:"  ",visible:!1},{key:"spouse_name",label:" /",visible:!1},{key:"spouse_nid",label:" ",visible:!1},{key:"last_aid_info",label:"  ",visible:!1}]);E.useEffect(()=>{Ve()},[]);const Ve=async()=>{n(!0);try{const[he,re,pe]=await Promise.all([uk(),Uo(),ik()]);o(he),u(re);const Re=new Set,K={};pe.forEach(de=>{if(de.items){const Ne=de.items.split(/[,]+/).map(je=>je.trim()).filter(Boolean);Ne.forEach(je=>Re.add(je)),K[de.family_id]||(K[de.family_id]={items:new Set,lastDate:de.date,lastItems:de.items}),Ne.forEach(je=>K[de.family_id].items.add(je)),new Date(de.date)>new Date(K[de.family_id].lastDate)&&(K[de.family_id].lastDate=de.date,K[de.family_id].lastItems=de.items)}}),f(Array.from(Re).sort()),m(K);let Se=[];t?Se=[t.camp_id]:he.length>0&&(Se=[he[0].camp_id]),p(Se),await Ue(Se,he,K)}catch(he){console.error(he)}finally{n(!1)}},Ue=async(he,re=i,pe=h)=>{n(!0);try{let Re=[],K=[];if(he.length===0){a([]);return}for(const de of he){const[Ne,je]=await Promise.all([rn(de),zn(de)]),Ie=re.find(Fe=>Fe.camp_id===de);Ne.forEach(Fe=>{Fe.camp_name=(Ie==null?void 0:Ie.name)||"-",Fe.display_family_number=he.length>1?`${Fe.camp_name} - ${Fe.family_number}`:Fe.family_number}),Re.push(...Ne),K.push(...je)}const Se=K.map(de=>{const Ne=Re.find(Oe=>Oe.family_id===de.family_id)||{},je=K.filter(Oe=>Oe.family_id===de.family_id),Ie=bh(de.dob),Fe=pe[de.family_id],Xe=zs(je),Te=je.find(Oe=>(Oe.role==="wife"||Oe.role==="husband"||Oe.role==="second_wife")&&Oe.individual_id!==(Xe==null?void 0:Xe.individual_id));return{...de,camp_name:Ne.camp_name,family_number:Ne.family_number,display_family_number:Ne.display_family_number,member_count:je.length,contact:Ne.contact,alternative_mobile:Ne.alternative_mobile,housing_status:Ne.housing_status,address:Ne.address,delegate:Ne.delegate,family_needs:Ne.family_needs,age:Ie,is_female_head:["","","",""," ",""].includes(de.role)||de.role==="wife"&&!je.some(Oe=>Oe.role==="husband"),role_translated:iW(de.role),is_pregnant_label:de.is_pregnant?"":"",is_nursing_label:je.some(Oe=>bh(Oe.dob)<2)?"":"",head_name:(Xe==null?void 0:Xe.name)||"-",head_nid:(Xe==null?void 0:Xe.nid)||"-",spouse_name:(Te==null?void 0:Te.name)||"-",spouse_nid:(Te==null?void 0:Te.nid)||"-",last_aid_info:Fe?`${Fe.lastItems} (${Fe.lastDate})`:"-"}});a(Se)}catch(Re){console.error(Re)}finally{n(!1)}},me=E.useMemo(()=>{const he=s.filter(Re=>{if(g.length>0&&!g.includes(Re.role))return!1;let K=Re.age;if(_==="infant"&&K>2||_==="child"&&(K<2||K>18)||_==="adult"&&K<18||b&&K<parseInt(b)||T&&K>parseInt(T)||G==="pregnant"&&!Re.is_pregnant||G==="nursing"&&!s.some(Se=>Se.family_id===Re.family_id&&bh(Se.dob)<2)||G==="female_head"&&!Re.is_female_head||G==="health_notes"&&!Re.health_notes||w!=="all"&&Re.delegate!==w||V&&Re.member_count<parseInt(V)||R&&Re.member_count>parseInt(R))return!1;if(se.length>0){const Se=h[Re.family_id];if(!Se||!se.some(de=>Se.items.has(de)))return!1}return!0}),re=new Set(he.map(Re=>Re.family_id));let pe=[];if(W){const Re=s.filter(K=>re.has(K.family_id));ve?pe=Re.filter(K=>!(H.length>0&&!H.includes(K.role)||z&&K.age<parseInt(z)||ne&&K.age>parseInt(ne))):pe=Re}else pe=he;return pe.sort((Re,K)=>Re.camp_name!==K.camp_name?Re.camp_name.localeCompare(K.camp_name,"ar"):(parseInt(Re.family_number)||0)-(parseInt(K.family_number)||0))},[s,g,w,_,b,T,V,R,G,se,W,ve,H,z,ne,h]),et=()=>{const he=be.filter(K=>K.visible),re=me.map(K=>{const Se={};return he.forEach(de=>Se[de.label]=K[de.key]),Se}),pe=At.json_to_sheet(re),Re=At.book_new();At.book_append_sheet(Re,pe,""),Si(Re,"custom_report.xlsx")},lt=he=>Ee(re=>re.map(pe=>pe.key===he?{...pe,visible:!pe.visible}:pe)),zt=(he,re="search")=>{(re==="search"?y:D)(Re=>Re.includes(he)?Re.filter(K=>K!==he):[...Re,he])},Yt=he=>{const re=x.includes(he)?x.filter(pe=>pe!==he):[...x,he];p(re),Ue(re)};return l.jsxs("div",{className:"flex flex-col h-screen overflow-hidden bg-gray-50 text-right font-sans",dir:"rtl",children:[l.jsxs("header",{className:"bg-white border-b border-gray-100 p-3 md:p-4 flex flex-col md:flex-row justify-between items-center shadow-sm z-30 gap-4",children:[l.jsxs("div",{className:"flex items-center justify-between w-full md:w-auto",children:[l.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[l.jsx("div",{className:"bg-indigo-50 p-2 rounded-xl",children:l.jsx(vo,{className:"h-4 w-4 md:h-5 md:w-5 text-indigo-600"})}),l.jsx("h1",{className:"text-lg md:text-xl font-black text-gray-800",children:"  "})]}),l.jsx("button",{onClick:()=>O(!q),className:"md:hidden bg-indigo-50 text-indigo-600 p-2 rounded-lg",children:l.jsx(Xl,{className:"h-5 w-5"})})]}),l.jsxs("div",{className:"flex items-center justify-between w-full md:w-auto gap-4 md:gap-6",children:[l.jsxs("div",{className:"flex flex-col items-end",children:[l.jsxs("span",{className:"text-xs md:text-sm font-black text-indigo-600",children:[" : ",me.length]}),l.jsxs("span",{className:"text-[9px] md:text-[10px] text-gray-400 font-bold hidden md:block",children:["  : ",s.length]})]}),l.jsxs("button",{onClick:et,className:"bg-[#22c55e] hover:bg-green-600 text-white px-3 md:px-5 py-2 rounded-lg text-xs md:text-sm font-bold flex items-center gap-2 shadow-sm transition-all active:scale-95 flex-1 md:flex-none justify-center",children:[l.jsx(ms,{className:"h-3 w-3 md:h-4 md:w-4"}),"  (Excel)"]})]})]}),l.jsxs("div",{className:"flex flex-1 overflow-hidden relative",children:[q&&l.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 md:hidden",onClick:()=>O(!1)}),l.jsxs("aside",{className:`
                    fixed md:relative inset-y-0 right-0 z-50 md:z-auto
                    w-80 bg-white border-l border-gray-100 overflow-y-auto custom-scrollbar p-6 space-y-8
                    transform transition-transform duration-300 ease-in-out
                    ${q?"translate-x-0":"translate-x-full md:translate-x-0"}
                `,children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsxs("h2",{className:"font-black text-gray-800 flex items-center gap-2 text-sm",children:[l.jsx(Xl,{className:"h-4 w-4 text-indigo-500"}),"   "]}),l.jsx("button",{onClick:()=>O(!1),className:"md:hidden text-gray-400",children:l.jsx(zy,{className:"h-5 w-5 rotate-90"})})]}),l.jsxs("section",{children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("label",{className:"text-[11px] font-black text-gray-400 uppercase tracking-widest",children:" "}),l.jsx("button",{onClick:()=>{const he=i.map(re=>re.camp_id);p(he),Ue(he)},className:"text-[10px] text-indigo-600 underline font-bold",children:""})]}),l.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-32 overflow-y-auto p-1 custom-scrollbar",children:i.map(he=>l.jsxs("label",{className:`flex items-center gap-2 p-1.5 rounded-lg border transition-all cursor-pointer ${x.includes(he.camp_id)?"bg-indigo-50 border-indigo-200":"bg-gray-50 border-transparent hover:border-gray-200"}`,children:[l.jsx("input",{type:"checkbox",checked:x.includes(he.camp_id),onChange:()=>Yt(he.camp_id),className:"h-3.5 w-3.5 text-indigo-600 rounded"}),l.jsx("span",{className:"text-[10px] font-bold text-gray-600 truncate",children:he.name})]},he.camp_id))})]}),l.jsxs("section",{children:[l.jsxs("div",{className:"flex justify-between items-center mb-3",children:[l.jsx("label",{className:"text-[11px] font-black text-gray-400 uppercase tracking-widest",children:"   "}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:()=>y(["husband","second_wife","widow","widower","divorced","abandoned","guardian","other"]),className:"text-[10px] text-indigo-600 underline font-bold",children:" "}),l.jsx("button",{onClick:()=>y([]),className:"text-[10px] text-gray-400 underline font-bold",children:""})]})]}),l.jsx("div",{className:"grid grid-cols-2 gap-y-2",children:r_.map(he=>l.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:g.includes(he.value),onChange:()=>zt(he.value,"search"),className:"h-4 w-4 rounded border-gray-300 text-indigo-600"}),l.jsx("span",{className:"text-xs font-bold text-gray-600",children:he.label})]},he.value))})]}),l.jsxs("section",{className:"space-y-4",children:[l.jsx("div",{className:"bg-gradient-to-br from-indigo-50 to-blue-50 p-4 rounded-2xl border border-indigo-100 shadow-sm shadow-indigo-100/50",children:l.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[l.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center transition-all ${W?"bg-indigo-600 text-white":"bg-white text-gray-300 border border-gray-100"}`,children:l.jsx(vn,{className:"h-5 w-5"})}),l.jsxs("div",{children:[l.jsx("span",{className:"text-xs font-black text-indigo-900 block",children:"   "}),l.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[l.jsx("input",{type:"checkbox",checked:W,onChange:he=>ue(he.target.checked),className:"h-4 w-4 rounded border-indigo-200 text-indigo-600"}),l.jsx("span",{className:"text-[10px] text-indigo-500 font-bold",children:"  "})]})]})]})}),l.jsx(Ar,{children:W&&l.jsxs(Ze.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"bg-white p-4 rounded-2xl border border-orange-100 shadow-sm border-dashed space-y-4",children:[l.jsxs("div",{className:"flex items-center gap-2 text-orange-600 mb-2",children:[l.jsx(Xl,{className:"h-3 w-3"}),l.jsx("span",{className:"text-[10px] font-black",children:"    "})]}),l.jsxs("label",{className:"flex items-center gap-2 cursor-pointer py-1 border-b border-gray-50",children:[l.jsx("input",{type:"checkbox",checked:ve,onChange:he=>F(he.target.checked),className:"h-3.5 w-3.5 rounded text-orange-500"}),l.jsx("span",{className:"text-[10px] font-bold text-gray-500",children:"  (  )"})]}),ve&&l.jsxs("div",{className:"space-y-4 pt-2",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-[9px] font-black text-gray-400 block mb-2",children:"   :"}),l.jsx("div",{className:"grid grid-cols-2 gap-y-1.5",children:r_.map(he=>l.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:H.includes(he.value),onChange:()=>zt(he.value,"display"),className:"h-3 w-3 rounded text-orange-500"}),l.jsx("span",{className:"text-[10px] font-bold text-gray-500",children:he.label})]},he.value))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-[9px] font-black text-gray-400 block mb-2",children:"  :"}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{type:"number",placeholder:"",value:z,onChange:he=>B(he.target.value),className:"w-full text-[10px] p-2 bg-gray-50 border border-gray-100 rounded-lg outline-none focus:ring-1 focus:ring-orange-200"}),l.jsx("input",{type:"number",placeholder:"",value:ne,onChange:he=>U(he.target.value),className:"w-full text-[10px] p-2 bg-gray-50 border border-gray-100 rounded-lg outline-none focus:ring-1 focus:ring-orange-200"})]})]})]})]})})]}),l.jsxs("section",{className:"space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-[10px] font-black text-gray-400 block mb-1.5",children:" "}),l.jsxs("div",{className:"flex gap-1",children:[l.jsx("input",{type:"number",placeholder:"",value:b,onChange:he=>k(he.target.value),className:"w-full p-2 bg-gray-50 border border-gray-100 rounded-lg text-xs"}),l.jsx("input",{type:"number",placeholder:"",value:T,onChange:he=>j(he.target.value),className:"w-full p-2 bg-gray-50 border border-gray-100 rounded-lg text-xs"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-[10px] font-black text-gray-400 block mb-1.5",children:" "}),l.jsxs("div",{className:"flex gap-1",children:[l.jsx("input",{type:"number",placeholder:"",value:V,onChange:he=>C(he.target.value),className:"w-full p-2 bg-gray-50 border border-gray-100 rounded-lg text-xs"}),l.jsx("input",{type:"number",placeholder:"",value:R,onChange:he=>X(he.target.value),className:"w-full p-2 bg-gray-50 border border-gray-100 rounded-lg text-xs"})]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-[10px] font-black text-gray-400 block mb-1.5",children:"  "}),l.jsxs("select",{value:G,onChange:he=>Y(he.target.value),className:"w-full text-xs font-bold p-2.5 bg-gray-50 border border-gray-100 rounded-xl outline-none",children:[l.jsx("option",{value:"all",children:""}),l.jsx("option",{value:"pregnant",children:""}),l.jsxs("option",{value:"nursing",children:[" ( ","<"," 2)"]}),l.jsx("option",{value:"female_head",children:" "}),l.jsx("option",{value:"health_notes",children:" /  "})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-[10px] font-black text-gray-400 block mb-1.5",children:""}),l.jsxs("select",{value:w,onChange:he=>v(he.target.value),className:"w-full text-xs font-bold p-2.5 bg-gray-50 border border-gray-100 rounded-xl outline-none",children:[l.jsx("option",{value:"all",children:""}),oe.map(he=>l.jsx("option",{value:he,children:he},he))]})]})]}),l.jsxs("section",{className:"pt-4 border-t border-gray-100",children:[l.jsxs("button",{onClick:()=>ae(!J),className:"w-full flex items-center justify-between text-gray-700 hover:text-indigo-600 transition-colors p-3 rounded-2xl bg-gray-50 hover:bg-indigo-50 hover:bg-opacity-50",children:[l.jsxs("span",{className:"font-black text-xs flex items-center gap-2",children:[l.jsx(vo,{className:"h-4 w-4"}),"   "]}),J?l.jsx(zy,{className:"h-4 w-4"}):l.jsx(Zd,{className:"h-4 w-4"})]}),J&&l.jsx("div",{className:"bg-white rounded-2xl mt-3 border border-gray-100 p-2 shadow-inner",children:l.jsx(A8,{axis:"y",values:be,onReorder:Ee,className:"space-y-1",children:be.map(he=>l.jsxs(O8,{value:he,className:"flex items-center gap-3 p-2.5 bg-gray-50/50 hover:bg-white rounded-xl border border-transparent hover:border-indigo-100 cursor-move transition-all group",children:[l.jsx(W8,{className:"h-3 w-3 text-gray-300 group-hover:text-indigo-400"}),l.jsxs("label",{className:"flex items-center gap-3 flex-1 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:he.visible,onChange:()=>lt(he.key),className:"h-4 w-4 rounded border-gray-300 text-indigo-600"}),l.jsx("span",{className:"text-[11px] font-bold text-gray-600",children:he.label})]})]},he.key))})})]})]}),l.jsx("main",{className:"flex-1 overflow-auto p-3 md:p-6 bg-gray-50",children:l.jsx("div",{className:"bg-white rounded-2xl md:rounded-[2.5rem] shadow-sm border border-gray-100 overflow-hidden min-h-full",children:l.jsx("div",{className:"overflow-x-auto custom-scrollbar",children:l.jsxs("table",{className:"w-full text-right text-sm min-w-[800px] md:min-w-0",children:[l.jsx("thead",{className:"bg-gray-50 border-b border-gray-100 sticky top-0 z-10",children:l.jsx("tr",{children:be.filter(he=>he.visible).map(he=>l.jsx("th",{className:"p-3 md:p-5 text-[9px] md:text-[10px] font-black text-gray-400 uppercase tracking-widest border-l border-gray-50",children:he.label},he.key))})}),l.jsx("tbody",{className:"divide-y divide-gray-50",children:r?l.jsx("tr",{children:l.jsx("td",{colSpan:"30",className:"p-20 md:p-32 text-center text-gray-400 font-bold text-xs md:text-sm",children:"  ..."})}):me.length===0?l.jsx("tr",{children:l.jsxs("td",{colSpan:"30",className:"p-20 md:p-32 text-center text-gray-300",children:[l.jsx(qS,{className:"h-8 w-8 md:h-10 md:w-10 mx-auto mb-4 opacity-20"}),l.jsx("p",{className:"font-bold text-xs md:text-sm",children:"     "})]})}):me.map((he,re)=>l.jsx("tr",{className:"hover:bg-indigo-50/30 transition-colors group",children:be.filter(pe=>pe.visible).map(pe=>l.jsx("td",{className:"p-3 md:p-5 border-l border-gray-50 font-bold text-gray-600 text-[10px] md:text-[11px]",children:pe.key==="role_translated"?l.jsx("span",{className:`px-2 py-0.5 md:px-2.5 md:py-1 rounded-lg text-[8px] md:text-[9px] font-black ${he.role==="husband"?"bg-blue-100 text-blue-700":he.role==="wife"?"bg-pink-100 text-pink-700":"bg-gray-100 text-gray-600"}`,children:he[pe.key]}):he[pe.key]||"-"},pe.key))},re))})]})})})})]}),l.jsx("style",{jsx:!0,children:`
                .custom-scrollbar::-webkit-scrollbar { width: 5px; }
                .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
                .custom-scrollbar::-webkit-scrollbar-thumb { background: #e5e7eb; border-radius: 20px; }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #d1d5db; }
            `})]})}const dT=({family:e,members:t=[],isDepartedOverride:r=null})=>{const n=r!==null?r:e.is_departed,s=zs(t),a=i=>{const o={husband:"",wife:"",second_wife:" ",widow:"",divorced:"",abandoned:"",guardian:"",son:"",daughter:"",other:""};return i.role==="other"&&i.role_description?i.role_description:o[i.role]||i.role};return l.jsxs("div",{className:"printable-card bg-white text-gray-900 shadow-none relative overflow-visible flex flex-col mx-auto border-b border-gray-200 print:border-none",style:{width:"210mm",minHeight:"297mm",padding:"20mm",direction:"rtl",pageBreakAfter:"always",breakAfter:"page",position:"relative",boxSizing:"border-box"},children:[n&&l.jsx("div",{className:"absolute inset-0 z-0 flex items-center justify-center overflow-hidden pointer-events-none",children:l.jsx("div",{className:"text-red-500/10 text-9xl font-black rotate-45 border-8 border-red-500/10 p-10 rounded-3xl uppercase tracking-widest",children:" "})}),l.jsx("div",{className:`absolute top-0 right-0 w-40 h-40 rounded-bl-[100px] ${n?"bg-red-50":"bg-indigo-900/5"}`}),l.jsx("div",{className:`absolute bottom-0 left-0 w-60 h-20 rounded-tr-[100px] ${n?"bg-red-50":"bg-indigo-900/5"}`}),l.jsxs("div",{className:`flex justify-between items-start mb-8 border-b-2 pb-6 relative z-10 ${n?"border-red-100":"border-indigo-900/10"}`,children:[l.jsxs("div",{children:[l.jsxs("h1",{className:`text-3xl font-bold mb-1 flex items-center gap-3 ${n?"text-red-700":"text-indigo-900"}`,children:["  ",n&&l.jsx("span",{className:"bg-red-100 text-red-600 px-3 py-1 rounded-full text-xs font-bold border border-red-200",children:""})]}),l.jsx("p",{className:"text-gray-500 text-sm",children:" "})]}),l.jsxs("div",{className:"text-left",children:[l.jsxs("div",{className:`text-4xl font-black ${n?"text-red-100":"text-indigo-900/10"}`,children:["#",e.family_number]}),l.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:[" : ",new Date().toLocaleDateString("ar-EG")]})]})]}),l.jsxs("div",{className:`grid grid-cols-2 gap-6 mb-8 p-5 rounded-xl border relative z-10 ${n?"bg-red-50 border-red-100":"bg-gray-50 border-gray-100"}`,children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-xs text-gray-400 font-bold uppercase mb-2",children:" "}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center font-bold text-xl ${n?"bg-red-200 text-red-700":"bg-indigo-100 text-indigo-700"}`,children:(s==null?void 0:s.name.charAt(0))||""}),l.jsxs("div",{children:[l.jsx("div",{className:"font-bold text-lg text-gray-800",children:(s==null?void 0:s.name)||" "}),l.jsx("div",{className:"text-sm text-gray-500 font-mono",children:(s==null?void 0:s.nid)||"-"})]})]})]}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-xs text-gray-400 font-bold uppercase mb-2",children:" "}),l.jsxs("div",{className:"space-y-1",children:[l.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[l.jsx(q0,{className:`h-4 w-4 ${n?"text-red-500":"text-indigo-500"}`}),l.jsx("span",{children:e.address||" "})]}),l.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700",children:[l.jsx(Xx,{className:`h-4 w-4 ${n?"text-red-500":"text-indigo-500"}`}),l.jsx("span",{dir:"ltr",className:"text-left",children:e.contact||" "})]})]})]})]}),l.jsxs("div",{className:"flex-1 relative z-10",children:[l.jsxs("h3",{className:`text-lg font-bold mb-4 flex items-center gap-2 border-b pb-2 ${n?"text-red-700 border-red-100":"text-indigo-900 border-indigo-100"}`,children:[l.jsx(vn,{className:"h-5 w-5"}),"  (",t.length," )"]}),l.jsxs("table",{className:"w-full text-right text-sm border-collapse",children:[l.jsx("thead",{children:l.jsxs("tr",{className:`border-b-2 ${n?"border-red-100":"border-indigo-100"}`,children:[l.jsx("th",{className:`pb-3 pr-2 font-bold text-xs uppercase ${n?"text-red-900/60":"text-indigo-900/60"}`,children:""}),l.jsx("th",{className:`pb-3 font-bold text-xs uppercase ${n?"text-red-900/60":"text-indigo-900/60"}`,children:""}),l.jsx("th",{className:`pb-3 font-bold text-xs uppercase ${n?"text-red-900/60":"text-indigo-900/60"}`,children:" "}),l.jsx("th",{className:`pb-3 font-bold text-xs uppercase ${n?"text-red-900/60":"text-indigo-900/60"}`,children:" "}),l.jsx("th",{className:`pb-3 font-bold text-xs uppercase ${n?"text-red-900/60":"text-indigo-900/60"}`,children:" "})]})}),l.jsx("tbody",{className:"divide-y divide-gray-100",children:t.map(i=>{const o=["wife","second_wife","widow","divorced","abandoned","daughter"].includes(i.role);return l.jsxs("tr",{className:"hover:bg-gray-50/50",children:[l.jsx("td",{className:"py-3 pr-2 font-bold text-gray-800 text-xs",children:i.name}),l.jsx("td",{className:"py-3",children:l.jsx("span",{className:`text-[10px] px-2 py-1 rounded-full font-medium ${["husband","father","widow"].includes(i.role)?"bg-indigo-100 text-indigo-700":["wife","mother"].includes(i.role)?"bg-pink-100 text-pink-700":"bg-gray-100 text-gray-600"}`,children:a(i)})}),l.jsx("td",{className:"py-3 font-medium text-gray-700 font-mono text-xs whitespace-nowrap",children:i.dob||"-"}),l.jsx("td",{className:"py-3 font-mono text-gray-500 text-xs",children:i.nid||"-"}),l.jsx("td",{className:"py-3",children:l.jsxs("div",{className:"flex flex-col gap-1 items-start",children:[i.notes&&l.jsx("span",{className:"text-red-600 text-[10px] font-medium bg-red-50 px-2 py-1 rounded border border-red-100 mb-1",children:i.notes}),o&&l.jsxs("div",{className:"flex gap-4 mt-1",children:[l.jsxs("div",{className:"flex items-center gap-1.5",title:"",children:[i.is_pregnant?l.jsx(Kl,{className:"h-4 w-4 text-indigo-600"}):l.jsx(t0,{className:"h-4 w-4 text-gray-300"}),l.jsx("span",{className:"text-[10px] text-gray-500",children:""})]}),l.jsxs("div",{className:"flex items-center gap-1.5",title:"",children:[i.is_nursing?l.jsx(Kl,{className:"h-4 w-4 text-indigo-600"}):l.jsx(t0,{className:"h-4 w-4 text-gray-300"}),l.jsx("span",{className:"text-[10px] text-gray-500",children:""})]})]})]})})]},i.individual_id)})})]})]}),l.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-200 flex justify-between items-end text-xs text-gray-400 relative z-10",children:[l.jsxs("div",{children:[l.jsx("p",{children:"   "}),l.jsx("p",{className:"mt-1",children:"    "})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"mb-2 text-gray-500",children:" "}),l.jsx("div",{className:"w-32 h-10 border-b-2 border-gray-300"})]})]})]})};function lW(){const{selectedCamp:e}=Nn(),[t,r]=E.useState(""),[n,s]=E.useState(!1),[a,i]=E.useState(null),[o,c]=E.useState([]),[u,d]=E.useState(!1),[f,h]=E.useState([]),m=async y=>{if(y.preventDefault(),!e){alert("   ");return}if(t.trim()){s(!0),h([]),i(null);try{const w=await rn(e.camp_id),v=await zn(e.camp_id),_=t.toLowerCase(),S=w.find(b=>{var k;return((k=b.family_number)==null?void 0:k.toString())===_});if(S)x(S,v);else{const b=[];for(const k of w){const T=v.filter(V=>V.family_id===k.family_id),j=zs(T);j&&j.name.toLowerCase().includes(_)&&b.push({fam:k,headName:j.name})}b.length===1?x(b[0].fam,v):b.length>1?h(b):alert("        ")}}catch(w){console.error("Search error:",w),alert("   ")}finally{s(!1)}}},x=(y,w)=>{const v=w.filter(S=>S.family_id===y.family_id),_=p(v);i(y),c(_),h([])},p=y=>y.sort((w,v)=>{const _=S=>{if(!S)return 5;const b=S.toLowerCase().trim();return["husband","father","","",""].includes(b)?1:["widow","","","divorced","","abandoned","","guardian"].includes(b)?2:["wife","mother","","",""," ","second_wife"].includes(b)?3:["son","daughter","",""].includes(b)?4:5};return _(w.role)-_(v.role)||new Date(w.dob||0).getTime()-new Date(v.dob||0).getTime()}),g=y=>{if(d(!1),!e){alert("   ");return}let w=`/print-cards?mode=${y}`;if(y==="single"){if(!a)return;w=`/print-cards?mode=single&id=${a.family_id}`}window.open(w,"_blank")};return l.jsxs("div",{className:"space-y-6 pb-20 md:pb-10 px-4 md:px-0",children:[l.jsxs("div",{className:"bg-white p-4 md:p-6 rounded-2xl shadow-sm border border-gray-100 mb-6 md:mb-8",children:[l.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between mb-6",children:[l.jsx("h1",{className:"text-xl md:text-2xl font-bold text-gray-800",children:" "}),l.jsxs("div",{className:"flex gap-2 relative w-full md:w-auto",children:[e&&l.jsxs("div",{className:"relative w-full md:w-auto",children:[l.jsxs("button",{onClick:()=>d(!u),className:"w-full md:w-auto bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2.5 rounded-xl flex items-center justify-center gap-2 font-bold transition shadow-sm text-sm",disabled:n,children:[l.jsx(QS,{className:"h-4 w-4"})," ",l.jsx(Zd,{className:"h-4 w-4"})]}),u&&l.jsxs("div",{className:"absolute top-full left-0 mt-2 w-56 bg-white rounded-xl shadow-xl border border-gray-100 overflow-hidden z-50",children:[a&&l.jsxs("button",{onClick:()=>g("single"),className:"w-full text-right px-4 py-3 hover:bg-gray-50 flex items-center justify-between text-sm",children:[l.jsx("span",{children:"  "}),l.jsx(vn,{className:"h-3 w-3 text-gray-400"})]}),l.jsxs("button",{onClick:()=>g("active"),className:"w-full text-right px-4 py-3 hover:bg-gray-50 flex items-center justify-between text-sm border-t",children:[l.jsx("span",{children:"   "}),l.jsx("span",{className:"bg-indigo-100 text-indigo-700 text-xs px-2 rounded-full",children:""})]}),l.jsxs("button",{onClick:()=>g("inactive"),className:"w-full text-right px-4 py-3 hover:bg-gray-50 flex items-center justify-between text-sm border-t",children:[l.jsx("span",{children:"  "}),l.jsx("span",{className:"bg-red-100 text-red-600 text-xs px-2 rounded-full",children:""})]}),l.jsxs("button",{onClick:()=>g("all"),className:"w-full text-right px-4 py-3 hover:bg-gray-50 flex items-center justify-between text-sm border-t",children:[l.jsx("span",{children:"  ( + )"}),l.jsx("span",{className:"bg-gray-100 text-gray-600 text-xs px-2 rounded-full",children:""})]})]})]}),u&&l.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>d(!1)})]})]}),l.jsxs("form",{onSubmit:m,className:"relative max-w-2xl mx-auto",children:[l.jsx("input",{type:"text",placeholder:"      ...",className:"w-full pl-12 pr-12 py-3 border-2 border-indigo-100 rounded-xl focus:border-indigo-500 focus:ring-4 focus:ring-indigo-100 outline-none transition-all",value:t,onChange:y=>r(y.target.value)}),l.jsx(Ai,{className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 h-5 w-5"}),f.length>0&&l.jsx("div",{className:"absolute top-full left-0 right-0 bg-white mt-1 rounded-xl shadow-xl border border-gray-100 overflow-hidden text-right z-50 max-h-60 overflow-y-auto",children:f.map((y,w)=>l.jsxs("button",{onClick:async()=>{const v=await zn(e.camp_id);x(y.fam,v)},className:"w-full p-3 hover:bg-indigo-50 flex justify-between border-b last:border-0 text-sm transition-colors",children:[l.jsx("span",{className:"font-bold",children:y.headName}),l.jsxs("span",{className:"text-gray-500",children:["#",y.fam.family_number]})]},w))})]})]}),a&&l.jsx("div",{className:"flex justify-center bg-gray-100 p-4 md:p-8 rounded-3xl overflow-auto",children:l.jsx(dT,{family:a,members:o})})]})}function cW(){const{selectedCamp:e,loading:t}=Nn(),[r]=Hj(),n=r.get("mode")||"active",s=r.get("id"),[a,i]=E.useState(null),[o,c]=E.useState(!0);E.useEffect(()=>{!t&&e&&u()},[e,t,n,s]);const u=async()=>{try{c(!0);const f=await rn(e.camp_id),h=await zn(e.camp_id);let m=[];s?m=f.filter(p=>p.family_id===s):n==="active"?m=f.filter(p=>!p.is_departed):n==="inactive"?m=f.filter(p=>p.is_departed):n==="all"&&(m=f);const x=m.map(p=>({family:p,members:d(h.filter(g=>g.family_id===p.family_id))}));i(x)}catch(f){console.error(f),alert("    ")}finally{c(!1)}},d=f=>f.sort((h,m)=>{const x=p=>{if(!p)return 5;const g=p.toLowerCase().trim();return["husband","father","","",""].includes(g)?1:["widow","","","divorced","","abandoned","","guardian"].includes(g)?2:["wife","mother","","",""," ","second_wife"].includes(g)?3:["son","daughter","",""].includes(g)?4:5};return x(h.role)-x(m.role)||new Date(h.dob||0).getTime()-new Date(m.dob||0).getTime()});return t||o?l.jsx("div",{className:"flex justify-center items-center h-screen",children:"   ..."}):!a||a.length===0?l.jsx("div",{className:"p-10 text-center text-xl font-bold",children:"   "}):l.jsxs("div",{className:"bg-white min-h-screen",children:[l.jsx("style",{children:`
                @media print {
                    @page { margin: 0; size: A4; }
                    body { margin: 0; padding: 0; }
                    .no-print { display: none !important; }
                    .printable-card {
                        break-after: page;
                        page-break-after: always;
                    }
                }
            `}),l.jsxs("div",{className:"no-print sticky top-0 bg-white border-b shadow-sm z-50 px-6 py-4 flex justify-between items-center mb-8",children:[l.jsxs("h1",{className:"text-xl font-bold",children:["  (",a.length," )"]}),l.jsxs("button",{onClick:()=>window.print(),className:"bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-2 rounded-lg flex items-center gap-2 font-bold transition shadow-lg",children:[l.jsx(QS,{className:"h-5 w-5"})," "]})]}),l.jsx("div",{children:a.map((f,h)=>l.jsx(dT,{family:f.family,members:f.members},f.family.family_id||h))})]})}function uW(){const{user:e}=on(),t=Oa(),[r,n]=E.useState([]),[s,a]=E.useState(!0);E.useEffect(()=>{i()},[]);const i=async()=>{a(!0);try{const m=await lk();n(m)}catch(m){console.error(m)}finally{a(!1)}},o=async m=>{try{await Ev(m),n(r.filter(x=>x.notification_id!==m))}catch(x){console.error(x)}},c=async()=>{if(window.confirm("    ")){for(const m of r)await Ev(m.notification_id);n([])}},[u,d]=E.useState(!1),f=async()=>{if(window.confirm(`         

     .`)){d(!0);try{const m=await D5(e);m.success&&(alert(`   !

    
   : ${m.totalDuplicates}
   : ${m.notificationsSent}`),await i())}catch(m){console.error("Error scanning duplicates:",m),alert("   .    .")}finally{d(!1)}}},h=async()=>{if(window.confirm(`       

     !`))try{await O5(),n([]),alert("     !")}catch(m){console.error("Error deleting notifications:",m),alert("   .    .")}};return!e||e.role!=="admin"?l.jsx("div",{className:"p-10 text-center text-gray-500",children:"     "}):l.jsxs("div",{className:"max-w-4xl mx-auto space-y-6 pb-24 md:pb-10 px-4 md:px-0",children:[l.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"bg-indigo-100 p-2.5 md:p-3 rounded-xl border border-indigo-200",children:l.jsx(Ym,{className:"h-5 w-5 md:h-6 md:w-6 text-indigo-700"})}),l.jsx("h1",{className:"text-xl md:text-2xl font-bold text-gray-800",children:" "})]}),l.jsxs("div",{className:"flex flex-wrap gap-2 w-full md:w-auto",children:[l.jsx("button",{onClick:f,disabled:u,className:"flex-1 md:flex-none text-[11px] md:text-sm font-bold text-white bg-orange-600 hover:bg-orange-700 px-3 md:px-4 py-2.5 rounded-xl transition shadow-md shadow-orange-100 disabled:opacity-50",children:u?" ...":"   "}),r.length>0&&l.jsxs("div",{className:"flex gap-2 w-full md:w-auto mt-2 md:mt-0",children:[l.jsx("button",{onClick:c,className:"flex-1 md:flex-none text-[11px] md:text-sm font-bold text-indigo-600 bg-indigo-50 hover:bg-indigo-100 px-3 md:px-4 py-2.5 rounded-xl transition border border-indigo-100",children:"  "}),l.jsxs("button",{onClick:h,className:"flex-1 md:flex-none text-[11px] md:text-sm font-bold text-white bg-red-600 hover:bg-red-700 px-3 md:px-4 py-2.5 rounded-xl transition flex items-center justify-center gap-2 shadow-md shadow-red-100",children:[l.jsx(nn,{className:"h-4 w-4"})," "]})]})]})]}),s?l.jsx("div",{className:"text-center py-20 text-gray-500",children:" ..."}):r.length===0?l.jsxs("div",{className:"bg-white p-12 rounded-3xl shadow-sm text-center border border-gray-100",children:[l.jsx("div",{className:"bg-gray-50 h-16 w-16 rounded-full flex items-center justify-center mx-auto mb-4",children:l.jsx(Ym,{className:"h-8 w-8 text-gray-300"})}),l.jsx("h3",{className:"text-lg font-bold text-gray-700",children:"   "}),l.jsx("p",{className:"text-gray-400 mt-2",children:"   "})]}):l.jsx("div",{className:"space-y-4",children:l.jsx(Ar,{children:r.map(m=>l.jsxs(Ze.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"bg-white p-4 md:p-5 rounded-2xl shadow-sm border border-gray-100 flex gap-3 md:gap-4 items-start hover:shadow-md transition group",children:[l.jsx("div",{className:`p-2.5 rounded-xl shrink-0 ${m.type==="alert"?"bg-red-50 text-red-600":"bg-blue-50 text-blue-600"}`,children:m.type==="alert"?l.jsx(To,{className:"h-5 w-5"}):l.jsx(To,{className:"h-5 w-5"})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("p",{className:"text-gray-800 font-semibold text-sm md:text-lg leading-relaxed mb-1.5 md:mb-2",children:m.message}),l.jsxs("div",{className:"flex flex-wrap gap-x-4 gap-y-1.5 text-[10px] md:text-xs text-gray-500 font-medium",children:[l.jsxs("span",{className:"flex items-center gap-1.5 bg-gray-50 px-2 py-1 rounded-lg",children:[l.jsx(V8,{className:"h-3.5 w-3.5 text-gray-400"}),new Date(m.created_at).toLocaleString("ar-EG",{dateStyle:"short",timeStyle:"short"})]}),l.jsxs("span",{className:"flex items-center gap-1.5 bg-gray-50 px-2 py-1 rounded-lg",children:[l.jsx(To,{className:"h-3.5 w-3.5 text-gray-400"}),m.user_name]})]})]}),l.jsxs("div",{className:"flex flex-col md:flex-row gap-2",children:[m.link&&l.jsx("button",{onClick:()=>t(m.link),className:"p-2.5 md:p-2 text-indigo-500 hover:text-indigo-700 hover:bg-indigo-50 bg-indigo-50 md:bg-transparent rounded-xl md:rounded-lg transition flex items-center justify-center",title:" ",children:l.jsx(z8,{className:"h-5 w-5"})}),l.jsx("button",{onClick:()=>o(m.notification_id),className:"p-2.5 md:p-2 text-gray-400 hover:text-green-600 hover:bg-green-50 bg-gray-50 md:bg-transparent rounded-xl md:rounded-lg transition flex items-center justify-center",title:" ",children:l.jsx(U8,{className:"h-5 w-5"})})]})]},m.notification_id))})})]})}function dW(){const{user:e}=on(),{camps:t,refreshCamps:r,selectedCamp:n}=Nn(),[s,a]=E.useState([]),[i,o]=E.useState(!1),[c,u]=E.useState(!1),[d,f]=E.useState(null),[h,m]=E.useState(0),[x,p]=E.useState({name:"",phone:"",nid:"",dob:"",notes:""}),[g,y]=E.useState(!1),[w,v]=E.useState(!1),[_,S]=E.useState(null),[b,k]=E.useState({name:"",manager_name:"",manager_phone:"",manager_nid:""}),[T,j]=E.useState(!1),[V,C]=E.useState(null),[R,X]=E.useState([]),[G,Y]=E.useState({email:"",password:"",username:"",fullName:"",role:"user",camp_id:"",assigned_camps:[]}),[se,ie]=E.useState(!0);E.useEffect(()=>{r()},[]),E.useEffect(()=>{oe()},[n]);const oe=async()=>{ie(!0);try{const U=await U5();if(m(U),n){const J=await Uo(n.camp_id);a(J)}else a([]);if((e==null?void 0:e.role)==="system_admin")try{const J=await F5();X(J)}catch(J){console.error("Failed to load users",J)}}catch(U){console.error("Failed to load data",U)}finally{ie(!1)}},W=async()=>{if(!n){alert("   ");return}if(window.confirm(`           (${h} )   "${n.name}"`))try{const U=await B5(n.camp_id);alert(`  ${U}    ${n.name}`),oe()}catch(U){alert(U.message)}},ue=()=>{if(t.length===0){alert("   ");return}const U=t.map(q=>({"  / ":q.name," ":q.manager_name||"-","  ":q.manager_phone||"-","  ":q.manager_nid||"-"})),J=At.json_to_sheet(U,{rtl:!0}),ae=At.book_new();At.book_append_sheet(ae,J,""),Si(ae,"_.xlsx")},ve=async U=>{var J;if(U.preventDefault(),!!((J=x.name)!=null&&J.trim())){if(!n){alert("      ");return}try{const ae={...x,camp_id:n.camp_id};d?await L5(d.delegate_id,ae):await I5(ae),o(!1),f(null),p({name:"",phone:"",nid:"",dob:"",notes:""}),oe()}catch(ae){console.error(ae),alert(ae.message)}}},F=async U=>{if(window.confirm("      "))try{await M5(U),oe()}catch(J){console.error(J)}},H=async U=>{var J;if(U.preventDefault(),!!((J=b.name)!=null&&J.trim()))try{_?await $5(_.camp_id,b):await V5(b),y(!1),S(null),k({name:"",manager_name:"",manager_phone:"",manager_nid:""}),await r()}catch(ae){alert(ae.message)}},D=async U=>{if(window.confirm("           ."))try{await z5(U),await r()}catch(J){console.error(J)}},z=async U=>{if(U.preventDefault(),G.role==="manager"&&!G.camp_id){alert("    ");return}if(G.role==="supervisor"&&(!G.assigned_camps||G.assigned_camps.length===0)){alert("      ");return}try{if(V){const J={username:G.username,fullName:G.fullName,role:G.role,camp_id:G.role==="admin"||G.role==="system_admin"||G.role==="supervisor"?null:G.camp_id,assigned_camps:G.role==="supervisor"?G.assigned_camps:null};G.email!==V.email&&(J.email=G.email),G.password&&G.password.trim()!==""&&(J.password=G.password),await P5(V.user_id,J),alert("    !")}else{const J={email:U0(G.username),password:G.password,username:G.username,fullName:G.fullName,role:G.role,camp_id:G.role==="admin"||G.role==="system_admin"||G.role==="supervisor"?null:G.camp_id,assigned_camps:G.role==="supervisor"?G.assigned_camps:null};await ok(J),alert("   !")}j(!1),C(null),Y({email:"",password:"",username:"",fullName:"",role:"user",camp_id:"",assigned_camps:[]}),oe()}catch(J){alert(": "+J.message)}},B=async(U,J)=>{if(window.confirm(`      "${J}"      .`))try{await R5(U),alert("   "),oe()}catch(ae){alert("   : "+ae.message)}};if((e==null?void 0:e.role)!=="system_admin"&&(e==null?void 0:e.role)!=="admin"&&(e==null?void 0:e.role)!=="manager")return l.jsx("div",{className:"p-10 text-center",children:"     "});const ne=()=>{if(s.length===0){alert("   ");return}const U=s.map(q=>({:q.name," ":q.phone||"-"," ":q.nid||"-"," ":q.dob||"-",:q.notes||"-"})),J=At.json_to_sheet(U,{rtl:!0}),ae=At.book_new();At.book_append_sheet(ae,J,""),Si(ae,"_.xlsx")};return l.jsxs("div",{className:"max-w-4xl mx-auto space-y-6 md:space-y-8 pb-20 md:pb-10 px-4 md:px-0",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-4 md:mb-6",children:[l.jsx("div",{className:"bg-gray-100 p-2 md:p-3 rounded-xl md:rounded-full",children:l.jsx(ZS,{className:"h-5 w-5 md:h-6 md:w-6 text-gray-700"})}),l.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-800",children:" "})]}),(e==null?void 0:e.role)==="system_admin"&&l.jsxs("section",{className:"bg-gradient-to-l from-indigo-50 to-white p-6 rounded-2xl shadow-sm border border-indigo-100",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsxs("h2",{className:"text-xl font-bold text-indigo-900 flex items-center gap-2",children:[l.jsx(JS,{className:"h-5 w-5 text-indigo-600"}),"  "]}),l.jsxs("button",{onClick:()=>{C(null),Y({email:"",password:"",username:"",role:"user",camp_id:"",assigned_camps:[]}),j(!0)},className:"bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg font-bold flex items-center gap-2 transition text-sm shadow-sm",children:[l.jsx(r0,{className:"h-4 w-4"}),"  "]})]}),l.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"               ."}),l.jsx("div",{className:"space-y-3 mt-6",children:se?l.jsx("div",{className:"text-center text-gray-500",children:" ..."}):R.length===0?l.jsx("div",{className:"text-center py-8 bg-gray-50 rounded-xl border-2 border-dashed border-gray-200 text-gray-400",children:"   "}):l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:l.jsx(Ar,{children:R.map(U=>{var ae;const J=t.find(q=>q.camp_id===U.camp_id);return l.jsx(Ze.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white rounded-xl border border-indigo-100 p-4 hover:border-indigo-200 transition relative group",children:l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[l.jsx("h3",{className:"font-bold text-gray-800 text-lg",children:((ae=U.user_metadata)==null?void 0:ae.fullName)||U.username}),l.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${U.role==="system_admin"?"bg-purple-100 text-purple-700":U.role==="admin"?"bg-red-100 text-red-700":U.role==="supervisor"?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"}`,children:U.role==="system_admin"?"  ":U.role==="admin"?" ":U.role==="supervisor"?" ":" "})]}),l.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-4 h-4 rounded-full bg-indigo-100 flex items-center justify-center text-xs",children:""}),cd(U.email)]}),J&&l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-4 h-4 rounded-full bg-indigo-100 flex items-center justify-center text-xs",children:""}),J.name]}),U.role==="supervisor"&&U.assigned_camps&&U.assigned_camps.length>0&&l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-4 h-4 rounded-full bg-green-100 flex items-center justify-center text-xs",children:""}),l.jsxs("div",{className:"text-xs",children:[U.assigned_camps.length," ",U.assigned_camps.length===1?"":""]})]}),U.last_sign_in_at&&l.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:["  : ",new Date(U.last_sign_in_at).toLocaleDateString("ar-EG")]})]})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:()=>{var q;C(U),Y({email:U.email,password:"",username:U.username,fullName:((q=U.user_metadata)==null?void 0:q.fullName)||"",role:U.role,camp_id:U.camp_id||"",assigned_camps:U.assigned_camps||[]}),j(!0)},className:"p-2 bg-indigo-50 text-indigo-600 rounded-lg hover:bg-indigo-100 shadow-sm border border-indigo-100 transition",title:"",children:l.jsx(oi,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>B(U.user_id,U.username),className:"p-2 bg-red-50 text-red-500 rounded-lg hover:bg-red-100 shadow-sm border border-red-100 transition",title:"",children:l.jsx(nn,{className:"h-4 w-4"})})]})]})},U.user_id)})})})})]}),l.jsxs("section",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100",children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[l.jsx(Jm,{className:"h-5 w-5 text-indigo-600"}),"  / "]}),l.jsx("div",{className:"flex gap-2",children:((e==null?void 0:e.role)==="system_admin"||(e==null?void 0:e.role)==="admin")&&l.jsxs(l.Fragment,{children:[l.jsxs("button",{onClick:()=>{if(t.length===0){alert("   ");return}v(!0)},className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-bold flex items-center gap-2 transition text-sm shadow-sm",title:"  Excel",children:[l.jsx(ms,{className:"h-4 w-4"})," Excel"]}),l.jsxs("button",{onClick:()=>{S(null),k({name:"",manager_name:"",manager_phone:"",manager_nid:""}),y(!0)},className:"bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg font-bold flex items-center gap-2 transition text-sm shadow-sm",children:[l.jsx(gi,{className:"h-4 w-4"})," "]})]})})]}),l.jsx("div",{className:"space-y-3",children:se?l.jsx("div",{className:"text-center text-gray-500",children:" ..."}):l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:l.jsxs(Ar,{children:[t.filter(U=>(e==null?void 0:e.role)==="system_admin"||(e==null?void 0:e.role)==="admin"||U.camp_id===(n==null?void 0:n.camp_id)).map(U=>l.jsx(Ze.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-gray-50 rounded-xl border border-gray-100 p-4 hover:border-indigo-100 transition relative group",children:l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-bold text-gray-800 text-lg mb-1",children:U.name}),l.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[U.manager_name&&l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-4 h-4 rounded-full bg-indigo-100 flex items-center justify-center text-xs",children:""})," ",U.manager_name]}),U.manager_phone&&l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-4 h-4 rounded-full bg-indigo-100 flex items-center justify-center text-xs",children:""})," ",U.manager_phone]}),U.manager_nid&&l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-4 h-4 rounded-full bg-indigo-100 flex items-center justify-center text-xs",children:""})," ",U.manager_nid]})]})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:()=>{S(U),k({...U}),y(!0)},className:"p-2 bg-white text-indigo-600 rounded-lg hover:bg-indigo-50 shadow-sm border border-gray-100 transition",title:"",children:l.jsx(oi,{className:"h-4 w-4"})}),((e==null?void 0:e.role)==="system_admin"||(e==null?void 0:e.role)==="admin")&&l.jsx("button",{onClick:()=>D(U.camp_id),className:"p-2 bg-white text-red-500 rounded-lg hover:bg-red-50 shadow-sm border border-gray-100 transition",title:"",children:l.jsx(nn,{className:"h-4 w-4"})})]})]})},U.camp_id)),t.length===0&&l.jsx("div",{className:"col-span-2 text-center py-8 bg-gray-50 rounded-xl border-2 border-dashed border-gray-200 text-gray-400",children:"   "})]})})})]}),l.jsxs("section",{className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100",children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[l.jsx(Qm,{className:"h-5 w-5 text-indigo-600"}),"  / ",n&&l.jsxs("span",{className:"text-sm font-normal text-gray-500 mr-2",children:["(",n.name,")"]})]}),n&&l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("button",{onClick:()=>{if(s.length===0){alert("   ");return}u(!0)},className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-bold flex items-center gap-2 transition text-sm shadow-sm",title:"  Excel",children:[l.jsx(ms,{className:"h-4 w-4"})," Excel"]}),l.jsxs("button",{onClick:()=>{f(null),p({name:"",phone:"",nid:"",dob:"",notes:""}),o(!0)},className:"bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg font-bold flex items-center gap-2 transition text-sm shadow-sm",children:[l.jsx(gi,{className:"h-4 w-4"})," "]})]})]}),((e==null?void 0:e.role)==="system_admin"||(e==null?void 0:e.role)==="admin")&&n&&h>0&&l.jsxs("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded-xl mb-6 flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"bg-blue-100 p-2 rounded-full",children:l.jsx(qm,{className:"h-5 w-5 text-blue-600"})}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-bold text-blue-800",children:"     "}),l.jsxs("p",{className:"text-sm text-blue-600",children:[" ",h,"        ."]})]})]}),l.jsxs("button",{onClick:W,className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-bold text-sm transition shadow-sm",children:["  ",n.name]})]}),n?l.jsx("div",{className:"space-y-3",children:se?l.jsx("div",{className:"text-center text-gray-500",children:" ..."}):s.length===0?l.jsx("div",{className:"text-center py-8 bg-gray-50 rounded-xl border-2 border-dashed border-gray-200 text-gray-400",children:"      "}):l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:l.jsx(Ar,{children:s.map(U=>l.jsx(Ze.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-gray-50 rounded-xl border border-gray-100 p-4 hover:border-indigo-100 transition relative group",children:l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-bold text-gray-800 text-lg mb-1",children:U.name}),l.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[U.phone&&l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-4 h-4 rounded-full bg-indigo-100 flex items-center justify-center text-xs",children:""})," ",U.phone]}),U.nid&&l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-4 h-4 rounded-full bg-indigo-100 flex items-center justify-center text-xs",children:""})," ",U.nid]})]})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:()=>{f(U),p({...U}),o(!0)},className:"p-2 bg-white text-indigo-600 rounded-lg hover:bg-indigo-50 shadow-sm border border-gray-100 transition",title:"",children:l.jsx(oi,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>F(U.delegate_id),className:"p-2 bg-white text-red-500 rounded-lg hover:bg-red-50 shadow-sm border border-gray-100 transition",title:"",children:l.jsx(nn,{className:"h-4 w-4"})})]})]})},U.delegate_id))})})}):l.jsxs("div",{className:"bg-amber-50 border border-amber-200 text-amber-800 px-4 py-8 rounded-xl text-center",children:[l.jsx(qm,{className:"h-8 w-8 mx-auto mb-2 text-amber-500"}),l.jsx("p",{className:"font-bold",children:"          ."})]})]}),l.jsx(Ar,{children:c&&l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:l.jsxs(Ze.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white rounded-2xl shadow-xl w-full max-w-4xl max-h-[90vh] flex flex-col overflow-hidden",children:[l.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"bg-green-100 p-2 rounded-lg",children:l.jsx(ms,{className:"h-6 w-6 text-green-600"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-bold text-xl text-gray-800",children:"  "}),l.jsx("p",{className:"text-sm text-gray-500",children:"   "})]})]}),l.jsx("button",{onClick:()=>u(!1),className:"p-2 bg-white rounded-full hover:bg-gray-100 transition",children:l.jsx(Cs,{className:"h-5 w-5 text-gray-500"})})]}),l.jsx("div",{className:"flex-1 overflow-auto p-6",children:l.jsx("div",{className:"border border-gray-200 rounded-xl overflow-hidden",children:l.jsxs("table",{className:"w-full text-right",children:[l.jsx("thead",{className:"bg-gray-50 text-gray-600 font-bold text-sm",children:l.jsxs("tr",{children:[l.jsx("th",{className:"p-4 border-b border-gray-100",children:""}),l.jsx("th",{className:"p-4 border-b border-gray-100",children:" "}),l.jsx("th",{className:"p-4 border-b border-gray-100",children:" "}),l.jsx("th",{className:"p-4 border-b border-gray-100",children:" "}),l.jsx("th",{className:"p-4 border-b border-gray-100",children:""})]})}),l.jsx("tbody",{className:"divide-y divide-gray-100",children:s.map(U=>l.jsxs("tr",{className:"hover:bg-gray-50 transition",children:[l.jsx("td",{className:"p-4 font-bold text-gray-800",children:U.name}),l.jsx("td",{className:"p-4 text-gray-600",children:U.phone||"-"}),l.jsx("td",{className:"p-4 text-gray-600",children:U.nid||"-"}),l.jsx("td",{className:"p-4 text-gray-600",children:U.dob||"-"}),l.jsx("td",{className:"p-4 text-gray-600 max-w-xs truncate",children:U.notes||"-"})]},U.delegate_id))})]})})}),l.jsxs("div",{className:"p-6 border-t border-gray-100 bg-gray-50 flex justify-end gap-3",children:[l.jsx("button",{onClick:()=>u(!1),className:"px-6 py-2.5 bg-white border border-gray-200 text-gray-700 font-bold rounded-xl hover:bg-gray-50 transition",children:""}),l.jsxs("button",{onClick:()=>{ne(),u(!1)},className:"px-6 py-2.5 bg-green-600 text-white font-bold rounded-xl hover:bg-green-700 transition flex items-center gap-2 shadow-lg shadow-green-200",children:[l.jsx(ms,{className:"h-5 w-5"}),"  Excel"]})]})]})})}),l.jsx(Ar,{children:w&&l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:l.jsxs(Ze.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white rounded-2xl shadow-xl w-full max-w-4xl max-h-[90vh] flex flex-col overflow-hidden",children:[l.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"bg-green-100 p-2 rounded-lg",children:l.jsx(ms,{className:"h-6 w-6 text-green-600"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-bold text-xl text-gray-800",children:"  "}),l.jsx("p",{className:"text-sm text-gray-500",children:"   "})]})]}),l.jsx("button",{onClick:()=>v(!1),className:"p-2 bg-white rounded-full hover:bg-gray-100 transition",children:l.jsx(Cs,{className:"h-5 w-5 text-gray-500"})})]}),l.jsx("div",{className:"flex-1 overflow-auto p-6",children:l.jsx("div",{className:"border border-gray-200 rounded-xl overflow-hidden",children:l.jsxs("table",{className:"w-full text-right",children:[l.jsx("thead",{className:"bg-gray-50 text-gray-600 font-bold text-sm",children:l.jsxs("tr",{children:[l.jsx("th",{className:"p-4 border-b border-gray-100",children:"  / "}),l.jsx("th",{className:"p-4 border-b border-gray-100",children:" "}),l.jsx("th",{className:"p-4 border-b border-gray-100",children:" "}),l.jsx("th",{className:"p-4 border-b border-gray-100",children:" "})]})}),l.jsx("tbody",{className:"divide-y divide-gray-100",children:t.map(U=>l.jsxs("tr",{className:"hover:bg-gray-50 transition",children:[l.jsx("td",{className:"p-4 font-bold text-gray-800",children:U.name}),l.jsx("td",{className:"p-4 text-gray-600",children:U.manager_name||"-"}),l.jsx("td",{className:"p-4 text-gray-600",children:U.manager_phone||"-"}),l.jsx("td",{className:"p-4 text-gray-600",children:U.manager_nid||"-"})]},U.camp_id))})]})})}),l.jsxs("div",{className:"p-6 border-t border-gray-100 bg-gray-50 flex justify-end gap-3",children:[l.jsx("button",{onClick:()=>v(!1),className:"px-6 py-2.5 bg-white border border-gray-200 text-gray-700 font-bold rounded-xl hover:bg-gray-50 transition",children:""}),l.jsxs("button",{onClick:()=>{ue(),v(!1)},className:"px-6 py-2.5 bg-green-600 text-white font-bold rounded-xl hover:bg-green-700 transition flex items-center gap-2 shadow-lg shadow-green-200",children:[l.jsx(ms,{className:"h-5 w-5"}),"  Excel"]})]})]})})}),l.jsx(Ar,{children:i&&l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:l.jsxs(Ze.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"bg-white rounded-2xl shadow-xl w-full max-w-lg overflow-hidden",children:[l.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[l.jsx("h3",{className:"font-bold text-xl text-gray-800",children:d?"  ":"  "}),l.jsx("button",{onClick:()=>o(!1),className:"p-2 bg-white rounded-full hover:bg-gray-100 transition",children:l.jsx(Cs,{className:"h-5 w-5 text-gray-500"})})]}),l.jsxs("form",{onSubmit:ve,className:"p-6 space-y-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:["  ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"text",required:!0,value:x.name,onChange:U=>p({...x,name:U.target.value}),className:"w-full p-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:" ..."})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:" "}),l.jsx("input",{type:"text",value:x.phone||"",onChange:U=>p({...x,phone:U.target.value}),className:"w-full p-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:"059..."})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:" "}),l.jsx("input",{type:"text",value:x.nid||"",onChange:U=>p({...x,nid:U.target.value}),className:"w-full p-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:" ..."})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:" "}),l.jsx("input",{type:"date",value:x.dob||"",onChange:U=>p({...x,dob:U.target.value}),className:"w-full p-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:""}),l.jsx("textarea",{value:x.notes||"",onChange:U=>p({...x,notes:U.target.value}),className:"w-full p-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none h-24 resize-none",placeholder:" ..."})]}),l.jsxs("div",{className:"pt-4 flex gap-3",children:[l.jsx("button",{type:"button",onClick:()=>o(!1),className:"flex-1 py-3 bg-gray-100 text-gray-700 font-bold rounded-xl hover:bg-gray-200 transition",children:""}),l.jsx("button",{type:"submit",className:"flex-1 py-3 bg-indigo-600 text-white font-bold rounded-xl hover:bg-indigo-700 transition",children:d?" ":""})]})]})]})})}),l.jsx(Ar,{children:T&&l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:l.jsxs(Ze.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"bg-white rounded-2xl shadow-xl w-full max-w-lg overflow-hidden",children:[l.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[l.jsx("h3",{className:"font-bold text-xl text-gray-800",children:V?"  ":"  "}),l.jsx("button",{onClick:()=>{j(!1),C(null)},className:"p-2 bg-white rounded-full hover:bg-gray-100 transition",children:l.jsx(Cs,{className:"h-5 w-5 text-gray-500"})})]}),l.jsxs("form",{onSubmit:z,className:"p-6 space-y-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:["  () ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"text",required:!0,value:G.fullName,onChange:U=>Y({...G,fullName:U.target.value}),className:"w-full p-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:":  "})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:["  /  () ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"text",required:!0,value:G.username,onChange:U=>Y({...G,username:U.target.value}),className:"w-full p-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:": 1234  ahmad"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"        ."})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:[" ",!V&&l.jsx("span",{className:"text-red-500",children:"*"}),V&&l.jsx("span",{className:"text-gray-500 text-xs font-normal",children:" ( -     )"})]}),l.jsx("input",{type:"text",required:!V,minLength:6,value:G.password,onChange:U=>Y({...G,password:U.target.value}),className:"w-full p-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:V?"     ":"******"}),!V&&l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"     6   "})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:" "}),l.jsxs("select",{value:G.role,onChange:U=>Y({...G,role:U.target.value,camp_id:"",assigned_camps:[]}),className:"w-full p-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none",children:[l.jsx("option",{value:"user",children:"  (  )"}),l.jsx("option",{value:"supervisor",children:" ( )"}),l.jsx("option",{value:"admin",children:" ( )"}),l.jsx("option",{value:"system_admin",children:"  ( )"})]})]}),G.role==="user"&&l.jsxs("div",{className:"bg-yellow-50 p-4 rounded-xl border border-yellow-200",children:[l.jsxs("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:["  ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsxs("select",{value:G.camp_id,onChange:U=>Y({...G,camp_id:U.target.value}),className:"w-full p-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none",required:!0,children:[l.jsx("option",{value:"",children:"--   --"}),t.map(U=>l.jsx("option",{value:U.camp_id,children:U.name},U.camp_id))]}),l.jsx("p",{className:"text-xs text-yellow-700 mt-2",children:"        ."})]}),G.role==="supervisor"&&l.jsxs("div",{className:"bg-green-50 p-4 rounded-xl border border-green-200",children:[l.jsxs("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:["   ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:t.map(U=>l.jsxs("label",{className:"flex items-center gap-3 p-2 hover:bg-green-100 rounded-lg cursor-pointer transition",children:[l.jsx("input",{type:"checkbox",checked:G.assigned_camps.includes(U.camp_id),onChange:J=>{J.target.checked?Y({...G,assigned_camps:[...G.assigned_camps,U.camp_id]}):Y({...G,assigned_camps:G.assigned_camps.filter(ae=>ae!==U.camp_id)})},className:"w-4 h-4 text-green-600 rounded focus:ring-green-500"}),l.jsx("span",{className:"text-sm text-gray-700",children:U.name})]},U.camp_id))}),l.jsx("p",{className:"text-xs text-green-700 mt-2",children:"         ."})]}),l.jsxs("div",{className:"pt-4 flex gap-3",children:[l.jsx("button",{type:"button",onClick:()=>j(!1),className:"flex-1 py-3 bg-gray-100 text-gray-700 font-bold rounded-xl hover:bg-gray-200 transition",children:""}),l.jsx("button",{type:"submit",className:"flex-1 py-3 bg-indigo-600 text-white font-bold rounded-xl hover:bg-indigo-700 transition",children:V?" ":" "})]})]})]})})}),l.jsx(Ar,{children:g&&l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:l.jsxs(Ze.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"bg-white rounded-2xl shadow-xl w-full max-w-lg overflow-hidden",children:[l.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[l.jsx("h3",{className:"font-bold text-xl text-gray-800",children:_?"  ":"  "}),l.jsx("button",{onClick:()=>y(!1),className:"p-2 bg-white rounded-full hover:bg-gray-100 transition",children:l.jsx(Cs,{className:"h-5 w-5 text-gray-500"})})]}),l.jsxs("form",{onSubmit:H,className:"p-6 space-y-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:["  /  ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"text",required:!0,value:b.name,onChange:U=>k({...b,name:U.target.value}),className:"w-full p-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:" ..."})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:" "}),l.jsx("input",{type:"text",value:b.manager_name||"",onChange:U=>k({...b,manager_name:U.target.value}),className:"w-full p-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:"  ..."})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:" "}),l.jsx("input",{type:"text",value:b.manager_phone||"",onChange:U=>k({...b,manager_phone:U.target.value}),className:"w-full p-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:"059..."})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:" "}),l.jsx("input",{type:"text",value:b.manager_nid||"",onChange:U=>k({...b,manager_nid:U.target.value}),className:"w-full p-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none",placeholder:" ..."})]})]}),l.jsxs("div",{className:"pt-4 flex gap-3",children:[l.jsx("button",{type:"button",onClick:()=>y(!1),className:"flex-1 py-3 bg-gray-100 text-gray-700 font-bold rounded-xl hover:bg-gray-200 transition",children:""}),l.jsx("button",{type:"submit",className:"flex-1 py-3 bg-indigo-600 text-white font-bold rounded-xl hover:bg-indigo-700 transition",children:_?" ":""})]})]})]})})})]})}function fW(){return l.jsx("div",{className:"min-h-[60vh] flex items-center justify-center p-4 md:p-8 pb-24 md:pb-10",children:l.jsxs("div",{className:"max-w-md w-full text-center space-y-6",children:[l.jsxs("div",{className:"mx-auto w-24 h-24 bg-gradient-to-br from-indigo-100 to-purple-100 rounded-full flex items-center justify-center relative",children:[l.jsx(XS,{className:"h-12 w-12 text-indigo-600 absolute"}),l.jsx($8,{className:"h-8 w-8 text-purple-600 absolute bottom-2 right-2"})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"  "}),l.jsx("p",{className:"text-lg text-gray-600",children:"     "})]}),l.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6 text-right",children:l.jsx("p",{className:"text-sm text-blue-800 leading-relaxed",children:"           .     ."})}),l.jsx("div",{className:"pt-4",children:l.jsxs("div",{className:"inline-flex items-center gap-2 text-sm text-gray-500",children:[l.jsx("div",{className:"w-2 h-2 bg-indigo-500 rounded-full animate-pulse"}),"  "]})})]})})}const n_=27,hW=()=>l.jsx("div",{className:"wave-top",children:l.jsx("svg",{viewBox:"0 0 500 100",preserveAspectRatio:"none",children:l.jsx("path",{d:"M0,50 C150,100 350,0 500,50 L500,0 L0,0 Z"})})}),mW=()=>l.jsx("div",{className:"wave-bottom",children:l.jsx("svg",{viewBox:"0 0 500 100",preserveAspectRatio:"none",children:l.jsx("path",{d:"M0,50 C150,0 350,100 500,50 L500,150 L0,150 Z"})})}),pW=()=>l.jsx("svg",{className:"tent-watermark",viewBox:"0 0 24 24",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",children:l.jsx("path",{d:"M12 2L2 22H22L12 2ZM12 6.8L19.5 20H4.5L12 6.8Z"})});function xW(){const{selectedCamp:e,loading:t}=Nn(),[r,n]=E.useState([]),[s,a]=E.useState(!0);E.useEffect(()=>{t||(e?i():a(!1))},[e,t]);const i=async()=>{a(!0);try{const c=await rn(e.camp_id),u=await zn(e.camp_id),d=c.map(f=>{const h=u.filter(x=>x.family_id===f.family_id),m=zs(h);return{...f,headName:m?m.name:" ",headNid:m&&m.nid||"-",memberCount:h.length,under_two_count:h.filter(x=>x.dob?(new Date().getTime()-new Date(x.dob).getTime())/(1e3*60*60*24*365.25)<=2:!1).length}});d.sort((f,h)=>(parseInt(f.family_number)||0)-(parseInt(h.family_number)||0)),n(d)}catch(c){console.error("Error loading cards data:",c)}finally{a(!1)}};if(s)return l.jsx("div",{className:"p-10 text-center",children:" ..."});if(!e)return l.jsx("div",{className:"p-10 text-center",children:"  "});const o=[];for(let c=0;c<r.length;c+=n_)o.push(r.slice(c,c+n_));return l.jsxs("div",{style:{background:"#e2e8f0",minHeight:"100vh",padding:"20px"},children:[l.jsx("div",{className:"no-print flex justify-center p-3 sticky top-0 z-50 mb-5",children:l.jsx("button",{onClick:()=>window.print(),className:"bg-red-600 text-white px-10 py-2 rounded font-black hover:bg-red-700 shadow-lg",children:"   "})}),o.map((c,u)=>l.jsx("div",{className:"page",children:c.map(d=>{const f=d.headName||" ",h=d.headNid||"-",m=d.contact||"-",x=e.name,p=d.delegate||"-",g=d.memberCount||0,y=d.under_two_count||0,w=e.manager_name||" ";return l.jsxs("div",{className:"card",children:[l.jsx(hW,{}),l.jsx(pW,{}),l.jsxs("div",{className:"content-container",children:[l.jsx("div",{className:"text-[12px] font-[900] text-red-700 border-b border-gray-100 pb-0.5 text-center truncate",children:f}),l.jsxs("div",{className:"space-y-1 mt-1",children:[l.jsxs("div",{className:"flex justify-center items-center gap-2 text-[10px] font-black text-slate-800",children:[l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("span",{className:"text-[7.5px] text-gray-400 font-bold",children:":"}),l.jsx("span",{children:h})]}),l.jsx("div",{className:"h-3 w-[1px] bg-gray-300"}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("span",{className:"text-[7.5px] text-gray-400 font-bold",children:":"}),l.jsx("span",{dir:"ltr",children:m})]})]}),l.jsxs("div",{className:"flex justify-between items-center bg-gray-50/50 p-0.5 rounded px-1",children:[l.jsxs("div",{className:"flex items-center gap-1 truncate w-[48%]",children:[l.jsx("span",{className:"text-[7.5px] font-bold text-indigo-400",children:":"}),l.jsx("span",{className:"text-[8.5px] font-black text-indigo-900 truncate",children:w})]}),l.jsx("div",{className:"h-3 w-[1px] bg-indigo-100 mx-1"}),l.jsxs("div",{className:"flex items-center gap-1 truncate w-[48%]",children:[l.jsx("span",{className:"text-[7.5px] font-bold text-slate-400",children:":"}),l.jsx("span",{className:"text-[8.5px] font-black text-slate-700 truncate",children:p})]})]})]}),l.jsxs("div",{className:"flex justify-between items-end pt-0.5 border-t border-gray-100",children:[l.jsxs("div",{className:"text-[8.5px] text-blue-900 font-black truncate max-w-[130px]",children:[" ",x]}),l.jsxs("div",{className:"flex items-center gap-1",children:[y>0&&l.jsxs("div",{className:"flex items-center gap-1 bg-amber-50 border border-amber-300 px-1 rounded shadow-sm",children:[l.jsx("span",{className:"text-[9px]",children:""}),l.jsx("span",{className:"text-[11px] font-black text-amber-700",children:y})]}),l.jsxs("div",{className:"flex items-center gap-1 bg-indigo-950 text-white px-2 py-0.5 rounded shadow-sm",children:[l.jsx("span",{className:"text-[7.5px] font-bold opacity-70",children:""}),l.jsx("span",{className:"text-[15px] font-black leading-none",children:g})]})]})]})]}),l.jsx(mW,{})]},d.family_id)})},u))]})}function gW(){const{user:e}=on(),{selectedCamp:t}=Nn(),[r,n]=E.useState(!1),[s,a]=E.useState(navigator.onLine),[i,o]=E.useState([]),[c,u]=E.useState(!1),[d,f]=E.useState(""),[h,m]=E.useState(""),[x,p]=E.useState(""),[g,y]=E.useState(""),[w,v]=E.useState(""),[_,S]=E.useState(""),[b,k]=E.useState(""),[T,j]=E.useState([]),[V,C]=E.useState(""),[R,X]=E.useState(""),[G,Y]=E.useState([]),[se,ie]=E.useState({name:"",nid:"",role:"son",healthNotes:"",isPregnant:!1,isNursing:!1,guardianGender:"male",roleDescription:"",deceasedHusbandName:"",husbandDeathDate:"",shoeSize:"",clothesSize:""}),[oe,W]=E.useState(""),[ue,ve]=E.useState(""),[F,H]=E.useState(""),[D,z]=E.useState(""),[B,ne]=E.useState(""),[U,J]=E.useState(""),[ae,q]=E.useState(""),[O,be]=E.useState(""),Ee=[{value:"husband",label:""},{value:"wife",label:""},{value:"second_wife",label:" "},{value:"widow",label:""},{value:"widower",label:""},{value:"divorced",label:""},{value:"abandoned",label:""},{value:"guardian",label:""},{value:"son",label:""},{value:"daughter",label:""},{value:"other",label:""}];E.useEffect(()=>{const K=localStorage.getItem("offline_drafts");K&&o(JSON.parse(K));const Se=()=>a(!0),de=()=>a(!1);return window.addEventListener("online",Se),window.addEventListener("offline",de),()=>{window.removeEventListener("online",Se),window.removeEventListener("offline",de)}},[]),E.useEffect(()=>{t&&Ve()},[t]);const Ve=async()=>{try{if(navigator.onLine){const K=await Uo(t.camp_id);j(K),localStorage.setItem(`delegates_${t.camp_id}`,JSON.stringify(K))}else{const K=localStorage.getItem(`delegates_${t.camp_id}`);K&&j(JSON.parse(K))}}catch(K){console.error(K)}};E.useEffect(()=>{t&&Ue()},[t,s,i]);const Ue=async()=>{let K=0;if(s&&t)try{const Ie=await rn(t.camp_id);Ie.length>0&&(K=Ie.reduce((Fe,Xe)=>{const Te=parseInt(Xe.family_number);return!isNaN(Te)&&Te>Fe?Te:Fe},0))}catch(Ie){console.error("Error fetching families for number suggestion:",Ie)}let Se=0;const de=i.filter(Ie=>Ie.campId===(t==null?void 0:t.camp_id));de.length>0&&(Se=de.reduce((Ie,Fe)=>{const Xe=parseInt(Fe.familyNumber);return!isNaN(Xe)&&Xe>Ie?Xe:Ie},0));const Ne=parseInt(localStorage.getItem(`next_fam_num_${t==null?void 0:t.camp_id}`))||0,je=Math.max(K,Se,Ne-1)+1;d===""&&f(String(je))},me=K=>{if(!K||K.trim()==="")return!0;const Se=K.replace(/\D/g,"");return Se.length===10?Se.startsWith("0"):Se.length===9?!Se.startsWith("0"):!1},et=K=>["husband","son","father","grandfather","brother","uncle"].includes(K)?"male":["wife","daughter","mother","grandmother","sister","aunt","widow","divorced","abandoned","second_wife"].includes(K)?"female":"male",lt=async()=>{if(!se.name.trim())return alert("   ");if(!oe||!ue||!F)return alert("   ");const K=parseInt(oe),Se=parseInt(ue),de=parseInt(F),Ne=new Date().getFullYear();if(isNaN(K)||K<1||K>31||isNaN(Se)||Se<1||Se>12||isNaN(de)||de<1900||de>Ne)return alert("    ");const je=`${de}-${String(Se).padStart(2,"0")}-${String(K).padStart(2,"0")}`;let Ie="";if(se.role==="widow"){if(!se.deceasedHusbandName)return alert("     ");if(!D||!B||!U)return alert("    ");const Te=parseInt(D),Oe=parseInt(B),Je=parseInt(U);if(isNaN(Te)||Te<1||Te>31||isNaN(Oe)||Oe<1||Oe>12||isNaN(Je)||Je<1900||Je>Ne)return alert("    ");Ie=`${Je}-${String(Oe).padStart(2,"0")}-${String(Te).padStart(2,"0")}`}if(!se.nid||se.nid.length===0)return alert("   ");const Fe=se.nid.replace(/\D/g,"");if(Fe.length!==9)return alert("       9  ");if(G.some(Te=>Te.nid===Fe))return alert("        !");if(i.some(Te=>Te.members&&Te.members.some(Oe=>Oe.nid===Fe)))return alert(" :         !");if(s)try{if(await zd(Fe))return alert("        !")}catch(Te){console.error("Error checking DB:",Te)}Y([...G,{...se,nid:Fe,dob:je,husbandDeathDate:Ie,id:Date.now()}]),ie({name:"",nid:"",role:"son",healthNotes:"",isPregnant:!1,isNursing:!1,guardianGender:"male",roleDescription:"",deceasedHusbandName:"",husbandDeathDate:"",shoeSize:"",clothesSize:""}),W(""),ve(""),H(""),z(""),ne(""),J("")},zt=()=>{if(!d)return alert("   ");if(!h)return alert("  ");if(x&&!me(x))return alert(`    .
   10    0
 9     0`);if(g&&!me(g))return alert("     .");if(G.length===0)return alert("      ");const K=x.replace(/\D/g,""),Se=g.replace(/\D/g,""),de={id:Date.now(),campId:t.camp_id,familyNumber:d,address:h,phone:K,alternativeMobile:Se,housingStatus:w,familyNeeds:_,delegate:b,shelterType:V,shelterOther:R,members:G,timestamp:new Date().toISOString(),status:"pending"},Ne=[...i,de];o(Ne),localStorage.setItem("offline_drafts",JSON.stringify(Ne)),q("    "),setTimeout(()=>q(""),2500);const je=parseInt(d);if(isNaN(je))f("");else{const Ie=je+1;f(String(Ie)),t&&localStorage.setItem(`next_fam_num_${t.camp_id}`,String(Ie))}m(""),p(""),y(""),v(""),S(""),C(""),X(""),Y([])},Yt=K=>{if(!window.confirm("      "))return;const Se=i.filter(de=>de.id!==K);o(Se),localStorage.setItem("offline_drafts",JSON.stringify(Se))},he=async()=>{if(!s)return alert("   ");n(!0);const K=i.filter(Ne=>Ne.campId===t.camp_id);if(K.length===0)return n(!1),alert("     ");let Se=0,de=0;for(const Ne of K)try{if((await rn(Ne.campId)).some(Fe=>Fe.family_number===Ne.familyNumber))throw new Error(`  ${Ne.familyNumber}  `);for(const Fe of Ne.members)if(Fe.nid&&await zd(Fe.nid))throw new Error(`  (${Fe.nid})  ${Fe.name}    `);const Ie=await jc({family_number:Ne.familyNumber,address:Ne.address,contact:Ne.phone,alternative_mobile:Ne.alternativeMobile||null,housing_status:Ne.housingStatus||null,family_needs:Ne.familyNeeds||null,delegate:Ne.delegate||null,shelter_type:Ne.shelterType||null,shelter_type_other:Ne.shelterType==="other"?Ne.shelterOther:null,camp_id:Ne.campId});for(const Fe of Ne.members){let Xe;Fe.role==="guardian"?Xe=Fe.guardianGender||"male":Xe=et(Fe.role),await Wd({family_id:Ie.family_id,name:Fe.name,nid:Fe.nid||null,dob:Fe.dob||null,gender:Xe,role:Fe.role,role_description:Fe.role==="other"?Fe.roleDescription:null,deceased_husband_name:Fe.role==="widow"?Fe.deceasedHusbandName:null,husband_death_date:Fe.role==="widow"?Fe.husbandDeathDate:null,is_pregnant:Fe.isPregnant||!1,is_nursing:Fe.isNursing||!1,shoe_size:Fe.shoeSize||null,clothes_size:Fe.clothesSize||null,notes:Fe.healthNotes||null})}Se++,re(Ne.id)}catch(je){console.error(je),de++,pe(Ne.id,"error",je.message)}n(!1),Se>0&&q(`   ${Se}  !`),de>0&&be(`   ${de} .     .`),setTimeout(()=>{q(""),be("")},5e3)},re=K=>{o(Se=>{const de=Se.filter(Ne=>Ne.id!==K);return localStorage.setItem("offline_drafts",JSON.stringify(de)),de})},pe=(K,Se,de)=>{o(Ne=>{const je=Ne.map(Ie=>Ie.id===K?{...Ie,status:Se,error:de}:Ie);return localStorage.setItem("offline_drafts",JSON.stringify(je)),je})},Re=K=>{window.confirm("         .")&&(f(K.familyNumber),m(K.address),p(K.phone),y(K.alternativeMobile||""),v(K.housingStatus||""),S(K.familyNeeds||""),k(K.delegate||""),C(K.shelterType||""),X(K.shelterOther||""),Y(K.members),u(!1),re(K.id))};return l.jsxs("div",{className:"flex flex-col md:flex-row gap-6 min-h-[calc(100vh-100px)] pb-24 md:pb-10 px-4 md:px-0",children:[l.jsxs("div",{className:"flex-1 order-2 md:order-1",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[l.jsxs("h1",{className:"text-xl md:text-2xl font-bold flex items-center gap-2",children:[l.jsx("div",{className:"bg-gray-100 p-2 rounded-xl",children:l.jsx(Zm,{className:"h-5 w-5 md:h-6 md:w-6 text-gray-500"})}),l.jsx("span",{className:"md:inline",children:"  ( )"})]}),l.jsxs("div",{className:"flex items-center gap-3 w-full sm:w-auto justify-between sm:justify-end",children:[l.jsx("div",{className:`px-4 py-1.5 rounded-full text-[11px] font-bold flex items-center gap-2 border shadow-sm ${s?"bg-green-50 text-green-700 border-green-200":"bg-red-50 text-red-700 border-red-200"}`,children:s?l.jsxs(l.Fragment,{children:[l.jsx(Y8,{className:"h-3.5 w-3.5"})," "]}):l.jsxs(l.Fragment,{children:[l.jsx(Zm,{className:"h-3.5 w-3.5"})," "]})}),l.jsxs("button",{onClick:()=>u(!c),className:"md:hidden bg-indigo-600 p-2.5 rounded-xl text-white relative shadow-lg shadow-indigo-200 active:scale-95 transition",children:[l.jsx(ih,{className:"h-5 w-5"}),i.length>0&&l.jsx("span",{className:"absolute -top-1.5 -right-1.5 bg-red-500 text-white text-[10px] w-5 h-5 rounded-full flex items-center justify-center border-2 border-white font-bold",children:i.length})]})]})]}),l.jsxs(Ar,{children:[ae&&l.jsx(Ze.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0},className:"bg-green-50 border border-green-200 text-green-800 p-3 rounded-xl mb-4 text-sm font-bold shadow-sm",children:ae}),O&&l.jsx(Ze.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0},className:"bg-red-50 border border-red-200 text-red-800 p-3 rounded-xl mb-4 text-sm font-bold shadow-sm",children:O})]}),l.jsxs("div",{className:"bg-white p-4 md:p-6 rounded-2xl shadow-sm border border-gray-100 space-y-4",children:[l.jsx("h3",{className:"text-gray-400 font-bold text-xs uppercase tracking-wider mb-2 border-b pb-2",children:" "}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:["  ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{value:d,onChange:K=>f(K.target.value),className:"w-full border-2 border-gray-100 rounded-xl px-3 py-2 text-base focus:border-indigo-500 focus:ring-0 transition outline-none",placeholder:": 101",inputMode:"numeric"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:""}),l.jsxs("select",{value:b,onChange:K=>k(K.target.value),className:"w-full border-2 border-gray-100 rounded-xl px-3 py-2 text-base focus:border-indigo-500 focus:ring-0 transition outline-none bg-white",children:[l.jsx("option",{value:"",children:" "}),T.map((K,Se)=>l.jsx("option",{value:K.name,children:K.name},Se))]})]}),l.jsxs("div",{className:"md:col-span-2",children:[l.jsxs("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:[" ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{value:h,onChange:K=>m(K.target.value),className:"w-full border-2 border-gray-100 rounded-xl px-3 py-2 text-base focus:border-indigo-500 focus:ring-0 transition outline-none",placeholder:"  "})]}),l.jsxs("div",{className:"md:col-span-2",children:[l.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:" "}),l.jsx("input",{value:x,onChange:K=>{const Se=K.target.value.replace(/\D/g,"");Se.length<=10&&p(Se)},className:`w-full border-2 rounded-xl px-3 py-2 text-base focus:ring-0 transition outline-none ${x&&!me(x)?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-100 focus:border-indigo-500"}`,placeholder:"059xxxxxxx",inputMode:"tel"}),x&&!me(x)&&l.jsx("p",{className:"text-[10px] text-red-500 mt-1",children:"   10  (  0)  9  ( 0)"})]}),l.jsxs("div",{className:"md:col-span-2",children:[l.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:"   ()"}),l.jsx("input",{value:g,onChange:K=>{const Se=K.target.value.replace(/\D/g,"");Se.length<=10&&y(Se)},className:`w-full border-2 rounded-xl px-3 py-2 text-base focus:ring-0 transition outline-none ${g&&!me(g)?"border-red-300 bg-red-50 focus:border-red-500":"border-gray-100 focus:border-indigo-500"}`,placeholder:"059xxxxxxx",inputMode:"tel"}),g&&!me(g)&&l.jsx("p",{className:"text-[10px] text-red-500 mt-1",children:"   10  (  0)  9  ( 0)"})]}),l.jsxs("div",{className:"md:col-span-2",children:[l.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:" "}),l.jsxs("select",{value:w,onChange:K=>v(K.target.value),className:"w-full border-2 border-gray-100 rounded-xl px-3 py-2 text-base focus:border-indigo-500 bg-white outline-none",children:[l.jsx("option",{value:"",children:"--    --"}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""}),l.jsx("option",{value:"",children:""})]})]}),l.jsxs("div",{className:"md:col-span-2",children:[l.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:" "}),l.jsx("input",{value:_,onChange:K=>S(K.target.value),className:"w-full border-2 border-gray-100 rounded-xl px-3 py-2 text-base focus:border-indigo-500 outline-none",placeholder:"..."})]})]}),l.jsxs("div",{className:"mt-4 border-t pt-4",children:[l.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:"  / "}),l.jsxs("select",{value:V,onChange:K=>C(K.target.value),className:"w-full border-2 border-gray-100 rounded-xl px-3 py-2 text-base focus:border-indigo-500 bg-white outline-none",children:[l.jsx("option",{value:"",children:"--    --"}),l.jsx("option",{value:"ready_tent",children:" "}),l.jsx("option",{value:"manufactured_tent",children:" "}),l.jsx("option",{value:"house",children:""}),l.jsx("option",{value:"other",children:""})]}),V==="other"&&l.jsx("input",{value:R,onChange:K=>X(K.target.value),className:"w-full border-2 border-indigo-100 rounded-xl px-3 py-2 mt-2 text-base focus:border-indigo-500 outline-none",placeholder:" "})]})]}),l.jsxs("div",{className:"bg-white p-4 md:p-6 rounded-2xl shadow-sm border border-gray-100 mt-6 relative overflow-hidden",children:[l.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-indigo-50 rounded-bl-[80px] -z-0"}),l.jsxs("h3",{className:"font-bold mb-4 flex items-center gap-2 relative z-10 text-indigo-900",children:[l.jsx(To,{className:"h-5 w-5"}),"   "]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 relative z-10",children:[l.jsxs("div",{className:"md:col-span-3",children:[l.jsxs("label",{className:"block text-[10px] font-bold text-gray-400 mb-1",children:["  ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{value:se.name,onChange:K=>ie({...se,name:K.target.value}),placeholder:" ",className:"w-full border-2 border-gray-100 rounded-xl px-3 py-2 focus:border-indigo-500 outline-none text-base"})]}),l.jsxs("div",{className:"md:col-span-1",children:[l.jsx("label",{className:"block text-[10px] font-bold text-gray-400 mb-1",children:""}),l.jsx("select",{value:se.role,onChange:K=>ie({...se,role:K.target.value}),className:"w-full border-2 border-gray-100 rounded-xl px-2 py-2 focus:border-indigo-500 outline-none text-base bg-white",children:Ee.map(K=>l.jsx("option",{value:K.value,children:K.label},K.value))})]}),l.jsxs(Ar,{children:[se.role==="guardian"&&l.jsx(Ze.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"md:col-span-4",children:l.jsxs("div",{className:"bg-yellow-50 p-3 rounded-xl border border-yellow-200",children:[l.jsx("label",{className:"block text-[10px] font-bold text-gray-600 mb-1",children:" "}),l.jsxs("div",{className:"flex gap-4",children:[l.jsxs("label",{className:"flex items-center gap-2 cursor-pointer bg-white px-3 py-2 rounded-lg border border-yellow-100",children:[l.jsx("input",{type:"radio",value:"male",checked:se.guardianGender==="male",onChange:()=>ie({...se,guardianGender:"male"}),name:"gGender"}),l.jsx("span",{children:""})]}),l.jsxs("label",{className:"flex items-center gap-2 cursor-pointer bg-white px-3 py-2 rounded-lg border border-yellow-100",children:[l.jsx("input",{type:"radio",value:"female",checked:se.guardianGender==="female",onChange:()=>ie({...se,guardianGender:"female"}),name:"gGender"}),l.jsx("span",{children:""})]})]})]})}),se.role==="other"&&l.jsxs(Ze.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"md:col-span-4",children:[l.jsx("label",{className:"block text-[10px] font-bold text-gray-500 mb-1",children:" "}),l.jsx("input",{value:se.roleDescription,onChange:K=>ie({...se,roleDescription:K.target.value}),placeholder:":  ...",className:"w-full border-2 border-yellow-200 bg-yellow-50 rounded-xl px-3 py-2 focus:border-indigo-500 outline-none text-base"})]}),se.role==="widow"&&l.jsxs(Ze.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"md:col-span-4 grid grid-cols-1 md:grid-cols-2 gap-4 bg-purple-50 p-4 rounded-xl border border-purple-100",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-[10px] font-bold text-purple-700 mb-1",children:"  "}),l.jsx("input",{value:se.deceasedHusbandName,onChange:K=>ie({...se,deceasedHusbandName:K.target.value}),className:"w-full border-2 border-white bg-white rounded-xl px-3 py-2 focus:border-purple-500 outline-none text-base",placeholder:" "})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-[10px] font-bold text-purple-700 mb-1",children:" "}),l.jsxs("div",{className:"grid grid-cols-3 gap-2",dir:"ltr",children:[l.jsx("input",{placeholder:"Y",className:"w-full border-2 border-white bg-white rounded-xl px-1 py-2 text-center text-base outline-none focus:border-purple-500",inputMode:"numeric",value:U,onChange:K=>J(K.target.value)}),l.jsx("input",{placeholder:"M",className:"w-full border-2 border-white bg-white rounded-xl px-1 py-2 text-center text-base outline-none focus:border-purple-500",inputMode:"numeric",value:B,onChange:K=>ne(K.target.value)}),l.jsx("input",{placeholder:"D",className:"w-full border-2 border-white bg-white rounded-xl px-1 py-2 text-center text-base outline-none focus:border-purple-500",inputMode:"numeric",value:D,onChange:K=>z(K.target.value)})]})]})]})]}),l.jsxs("div",{className:"md:col-span-2",children:[l.jsxs("label",{className:"block text-[10px] font-bold text-gray-400 mb-1",children:["  ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-2",dir:"ltr",children:[l.jsx("input",{placeholder:"Y",className:"w-full border-2 border-gray-100 rounded-xl px-1 py-2 text-center text-base outline-none focus:border-indigo-500",inputMode:"numeric",value:F,onChange:K=>H(K.target.value)}),l.jsx("input",{placeholder:"M",className:"w-full border-2 border-gray-100 rounded-xl px-1 py-2 text-center text-base outline-none focus:border-indigo-500",inputMode:"numeric",value:ue,onChange:K=>ve(K.target.value)}),l.jsx("input",{placeholder:"D",className:"w-full border-2 border-gray-100 rounded-xl px-1 py-2 text-center text-base outline-none focus:border-indigo-500",inputMode:"numeric",value:oe,onChange:K=>W(K.target.value)})]})]}),l.jsxs("div",{className:"md:col-span-2 flex gap-2",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("label",{className:"block text-[10px] font-bold text-gray-400 mb-1",children:" "}),l.jsx("input",{value:se.shoeSize,onChange:K=>ie({...se,shoeSize:K.target.value}),placeholder:": 42",className:"w-full border-2 border-gray-100 rounded-xl px-3 py-2 focus:border-indigo-500 outline-none text-base"})]}),l.jsxs("div",{className:"flex-1",children:[l.jsx("label",{className:"block text-[10px] font-bold text-gray-400 mb-1",children:" "}),l.jsx("input",{value:se.clothesSize,onChange:K=>ie({...se,clothesSize:K.target.value}),placeholder:": XL",className:"w-full border-2 border-gray-100 rounded-xl px-3 py-2 focus:border-indigo-500 outline-none text-base"})]})]}),l.jsxs("div",{className:"md:col-span-4 flex gap-3 items-end",children:[l.jsxs("div",{className:"flex-1",children:[l.jsxs("label",{className:"block text-[10px] font-bold text-gray-400 mb-1",children:["  (9 ) ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{value:se.nid,onChange:K=>{const Se=K.target.value.replace(/\D/g,"").slice(0,9);ie({...se,nid:Se})},placeholder:" ",className:"w-full border-2 border-gray-100 rounded-xl px-3 py-2 focus:border-indigo-500 outline-none text-base font-mono tracking-widest text-center",inputMode:"numeric"})]}),l.jsx("button",{onClick:lt,className:"bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl h-[46px] w-[46px] flex items-center justify-center shadow-lg transition transform active:scale-95 shrink-0 mb-[1px]",title:" ",children:l.jsx(gi,{className:"h-6 w-6"})})]})]}),l.jsxs("div",{className:"space-y-2 mt-4 bg-gray-50/50 rounded-xl p-2 min-h-[100px]",children:[G.length===0&&l.jsx("p",{className:"text-center text-gray-400 text-xs py-8",children:"    "}),G.map((K,Se)=>{var de;return l.jsxs("div",{className:"flex justify-between items-center bg-white p-3 rounded-lg border border-gray-100 shadow-sm animate-in slide-in-from-bottom-2 fade-in duration-300",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"bg-indigo-100 text-indigo-700 w-6 h-6 rounded flex items-center justify-center text-xs font-bold",children:Se+1}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-bold text-gray-800",children:K.name}),l.jsxs("div",{className:"flex gap-2 text-[10px] text-gray-500",children:[l.jsx("span",{children:(de=Ee.find(Ne=>Ne.value===K.role))==null?void 0:de.label}),l.jsx("span",{children:""}),l.jsx("span",{className:"font-mono",children:K.dob}),l.jsx("span",{children:""}),l.jsx("span",{className:"font-mono",children:K.nid}),(K.shoeSize||K.clothesSize)&&l.jsxs("span",{className:"text-indigo-600",children:["(",K.shoeSize||"-"," / ",K.clothesSize||"-",")"]})]})]})]}),l.jsx("button",{onClick:()=>Y(G.filter(Ne=>Ne.id!==K.id)),className:"text-red-400 hover:bg-red-50 p-2 rounded-lg transition",children:l.jsx(nn,{className:"h-4 w-4"})})]},K.id)})]})]}),l.jsx("div",{className:"sticky bottom-4 mt-6",children:l.jsxs("button",{onClick:zt,className:"w-full bg-gray-900 hover:bg-gray-800 text-white py-4 rounded-2xl font-bold text-lg flex items-center justify-center gap-3 shadow-xl transition transform active:scale-95",children:[l.jsx(Oc,{className:"h-6 w-6"}),"  "]})})]}),l.jsx("div",{className:`
                fixed inset-y-0 right-0 z-50 w-80 bg-white shadow-2xl transform transition-transform duration-300 ease-in-out md:translate-x-0
                md:static md:w-56 md:shadow-none md:bg-gray-50 md:rounded-2xl md:h-auto md:order-2 md:border md:block
                ${c?"translate-x-0":"translate-x-full"}
            `,children:l.jsxs("div",{className:"h-full flex flex-col p-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4 md:mb-6",children:[l.jsxs("h2",{className:"font-bold text-gray-700 flex items-center gap-2 text-sm md:text-base",children:[l.jsx(ih,{className:"h-5 w-5"})," (",i.length,")"]}),l.jsx("button",{onClick:()=>u(!1),className:"md:hidden text-gray-400",children:l.jsx(Cs,{className:"h-6 w-6"})})]}),s&&i.length>0&&t&&l.jsxs("button",{onClick:he,disabled:r,className:"w-full mb-4 bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-xl font-bold text-xs flex items-center justify-center gap-2 shadow-sm transition disabled:opacity-50",children:[r?l.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin"}):l.jsx(eE,{className:"h-4 w-4"}),l.jsxs("span",{children:["  (",i.filter(K=>K.campId===t.camp_id).length,")"]})]}),l.jsxs("div",{className:"flex-1 overflow-y-auto space-y-3 -mx-2 px-2 pb-20 md:pb-0 custom-scrollbar",children:[i.length===0&&l.jsxs("div",{className:"text-center py-10 opacity-50 space-y-2",children:[l.jsx(ih,{className:"h-12 w-12 mx-auto text-gray-300"}),l.jsx("p",{className:"text-xs",children:"  "})]}),i.map(K=>l.jsxs("div",{className:`bg-white p-3 rounded-xl border relative group transition hover:shadow-md ${K.status==="error"?"border-red-200 bg-red-50":"border-gray-100"}`,children:[l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsxs("div",{onClick:()=>Re(K),className:"cursor-pointer flex-1",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("h4",{className:"font-bold text-gray-800 text-sm",children:["#",K.familyNumber]}),K.campId!==(t==null?void 0:t.camp_id)&&l.jsx("span",{className:"text-[9px] bg-gray-200 px-1 rounded text-gray-600",children:" "})]}),l.jsxs("p",{className:"text-[10px] text-gray-500 mt-0.5 max-w-[140px] truncate",children:[K.members.length," "]})]}),l.jsx("button",{onClick:()=>Yt(K.id),className:"text-gray-400 hover:text-red-500 p-1",children:l.jsx(nn,{className:"h-4 w-4"})})]}),K.error&&l.jsxs("div",{className:"mt-2 text-[10px] text-red-600 bg-red-100/50 p-1.5 rounded flex items-start gap-1",children:[l.jsx(Ho,{className:"h-3 w-3 mt-0.5 shrink-0"}),l.jsxs("span",{children:[K.error.substring(0,50),"..."]})]})]},K.id))]})]})}),c&&l.jsx("div",{className:"fixed inset-0 bg-black/20 z-40 md:hidden backdrop-blur-sm",onClick:()=>u(!1)})]})}function vW(){const[e,t]=E.useState(""),[r,n]=E.useState(!1),[s,a]=E.useState(null),i=async o=>{if(o.preventDefault(),!!e.trim()){n(!0),a(null);try{const{data:c,error:u}=await Be.rpc("check_family_status",{search_nid:e});if(u)throw u;!c||c.status==="not_found"?a({status:"not_found"}):a({status:"found",data:{campName:c.campName,memberCount:c.memberCount}})}catch(c){console.error("Check error full:",c),a({status:"error",message:c.message+(c.details?` (${c.details})`:"")+(c.hint?` [Hint: ${c.hint}]`:"")})}finally{n(!1)}}};return l.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center items-center p-4",dir:"rtl",children:[l.jsxs("div",{className:"max-w-md w-full bg-white rounded-2xl shadow-xl overflow-hidden",children:[l.jsxs("div",{className:"bg-indigo-600 p-6 text-center",children:[l.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-full flex items-center justify-center mx-auto mb-4 backdrop-blur-sm",children:l.jsx(X8,{className:"h-8 w-8 text-white"})}),l.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"  "}),l.jsx("p",{className:"text-indigo-100 text-sm",children:"       "})]}),l.jsxs("div",{className:"p-8",children:[l.jsxs("form",{onSubmit:i,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),l.jsxs("div",{className:"relative",children:[l.jsx(Ai,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"text",value:e,onChange:o=>t(o.target.value.replace(/\D/g,"").slice(0,9)),className:"w-full pr-10 pl-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none transition text-lg tracking-widest font-mono",placeholder:"   (9 )",inputMode:"numeric"})]})]}),l.jsx("button",{type:"submit",disabled:r||e.length<9,className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white py-3 rounded-xl font-bold text-lg flex items-center justify-center gap-2 transition disabled:opacity-50 disabled:cursor-not-allowed shadow-lg shadow-indigo-200",children:r?l.jsx(YS,{className:"h-6 w-6 animate-spin"}):" "})]}),l.jsxs("div",{className:"mt-8",children:[(s==null?void 0:s.status)==="found"&&l.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-5 text-center animate-in fade-in slide-in-from-bottom-4",children:[l.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-3",children:l.jsx(B8,{className:"h-6 w-6 text-green-600"})}),l.jsx("h3",{className:"text-lg font-bold text-green-800 mb-1",children:" "}),l.jsxs("div",{className:"text-sm text-green-700 space-y-1",children:[l.jsxs("p",{children:[": ",l.jsx("strong",{children:s.data.campName})]}),l.jsxs("p",{children:[" : ",l.jsx("strong",{children:s.data.memberCount})]})]})]}),(s==null?void 0:s.status)==="not_found"&&l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-5 text-center animate-in fade-in slide-in-from-bottom-4",children:[l.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-3",children:l.jsx(tE,{className:"h-6 w-6 text-red-600"})}),l.jsx("h3",{className:"text-lg font-bold text-red-800 mb-1",children:"  "}),l.jsx("p",{className:"text-sm text-red-600",children:"       ."})]}),(s==null?void 0:s.status)==="error"&&l.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-xl p-4 text-center animate-in fade-in slide-in-from-bottom-4",dir:"ltr",children:[l.jsx("p",{className:"text-sm text-orange-800 font-bold mb-2",children:" Technical Error /  "}),l.jsx("p",{className:"text-xs text-orange-700 font-mono break-all",children:s.message})]})]})]}),l.jsx("div",{className:"bg-gray-50 border-t p-4 text-center",children:l.jsxs(un,{to:"/login",className:"inline-flex items-center text-sm text-indigo-600 hover:text-indigo-800 font-medium group",children:["  ",l.jsx(X0,{className:"mr-1 h-4 w-4 group-hover:-translate-x-1 transition"})]})})]}),l.jsxs("footer",{className:"mt-8 text-center text-gray-400 text-xs",children:[" ",new Date().getFullYear(),"   "]})]})}var s_;(function(e){e.STRING="string",e.NUMBER="number",e.INTEGER="integer",e.BOOLEAN="boolean",e.ARRAY="array",e.OBJECT="object"})(s_||(s_={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var a_;(function(e){e.LANGUAGE_UNSPECIFIED="language_unspecified",e.PYTHON="python"})(a_||(a_={}));var i_;(function(e){e.OUTCOME_UNSPECIFIED="outcome_unspecified",e.OUTCOME_OK="outcome_ok",e.OUTCOME_FAILED="outcome_failed",e.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"})(i_||(i_={}));var o_;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(o_||(o_={}));var l_;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(l_||(l_={}));var c_;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(c_||(c_={}));var u_;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER"})(u_||(u_={}));var nc;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.OTHER="OTHER"})(nc||(nc={}));var d_;(function(e){e.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",e.RETRIEVAL_QUERY="RETRIEVAL_QUERY",e.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",e.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",e.CLASSIFICATION="CLASSIFICATION",e.CLUSTERING="CLUSTERING"})(d_||(d_={}));var f_;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"})(f_||(f_={}));var h_;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(h_||(h_={}));var m_;(function(e){e.GENERATE_CONTENT="generateContent",e.STREAM_GENERATE_CONTENT="streamGenerateContent",e.COUNT_TOKENS="countTokens",e.EMBED_CONTENT="embedContent",e.BATCH_EMBED_CONTENTS="batchEmbedContents"})(m_||(m_={}));nc.RECITATION,nc.SAFETY,nc.LANGUAGE;const kh=(e,t,r)=>{const n=e.toLowerCase().trim(),s=n.match(/(|).*(\d+).*(||).*(\d+)/);if(s){const o=parseInt(s[2]),c=parseInt(s[4]);return r.filter(u=>{const d=dp(u.dob);return d>=o&&d<=c}).length}const a=n.match(/(|).*.*.*(\d+)/);if(a)return r.filter(o=>dp(o.dob)<parseInt(a[2])).length;if(n.includes("")||n.includes(""))return r.some(o=>o.is_pregnant)?"":"";if(n.includes("")||n.includes("")||n.includes(""))return r.filter(o=>o.gender==="female"||o.gender==="").length;if(n.includes("")||n.includes("")||n.includes(""))return r.filter(o=>o.gender==="male"||o.gender==="").length;if(n.includes("")||n.includes("")||n.includes("wife")){const o=r.find(c=>c.role&&(c.role.toLowerCase().includes("wife")||c.role.includes("")||c.role.includes("")));return(o==null?void 0:o.name)||"-"}if(n.includes(" ")||n.includes(" ")||n.includes("husband")){const o=r.find(c=>c.role&&(c.role.toLowerCase().includes("husband")||c.role.includes("")||c.role.includes("")));return(o==null?void 0:o.name)||"-"}if(n.includes(" ")||n.includes(" ")||n.includes("dob")){if(n.includes("")||n.includes("")||n.includes("")||n.includes("husband")){const o=zs(r);return(o==null?void 0:o.dob)||"-"}if(n.includes("")||n.includes("wife")){const o=r.find(c=>c.role&&(c.role.toLowerCase().includes("wife")||c.role.includes("")));return(o==null?void 0:o.dob)||"-"}}const i=zs(r);return n.includes(" ")||n.includes(" ")||n.includes(" ")?(i==null?void 0:i.name)||"-":(n.includes("")||n.includes(""))&&(i==null?void 0:i.nid)||"-"},yW=async e=>{const t=e.filter(n=>!n.system);if(t.length===0)return{};const r=async n=>{const s=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({columns:t})});if(!s.ok)throw new Error(`Failed: ${s.status}`);const a=s.headers.get("content-type");if(!a||!a.includes("application/json"))throw new Error("Not JSON");return await s.json()};try{try{const n=await r("/api/process-report");return n.logic||n}catch{const s=await r("/.netlify/functions/process-report");return s.logic||s}}catch(n){throw console.error("AI Bridge Notice:",n.message),n}},dp=e=>{if(!e)return 0;try{const t=new Date(e);if(isNaN(t.getTime()))return 0;const r=new Date;let n=r.getFullYear()-t.getFullYear();const s=r.getMonth()-t.getMonth();return(s<0||s===0&&r.getDate()<t.getDate())&&n--,n}catch{return 0}};function wW(){const{user:e}=on(),{selectedCamp:t}=Nn(),[r,n]=E.useState(!1),[s,a]=E.useState(!1),[i,o]=E.useState(null),[c,u]=E.useState([]),[d,f]=E.useState([]),[h,m]=E.useState([{id:"1",label:" ",description:"  ",system:!0},{id:"2",label:"  ",description:"    ",system:!0},{id:"3",label:"  (11-17)",description:"      11  17",system:!1}]),[x,p]=E.useState([]);E.useEffect(()=>{t&&g()},[t]);const g=async()=>{n(!0);try{const[b,k]=await Promise.all([rn(t.camp_id),zn(t.camp_id)]);u(b),f(k)}catch(b){console.error(b)}finally{n(!1)}},y=()=>{const b={id:Math.random().toString(36).substr(2,9),label:"",description:"",system:!1};m([...h,b])},w=b=>{m(h.filter(k=>k.id!==b))},v=(b,k,T)=>{m(h.map(j=>j.id===b?{...j,[k]:T}:j))},_=async()=>{a(!0),o(null);let b="ai",k={};try{k=await yW(h)}catch(T){console.warn("Switching to Local Processing Mode:",T.message),b="local",T.message==="API_KEY_MISSING"?o(":  AI  .     ."):o(":     (CORS/Halt).     .")}try{console.log("Smart Report Debug - Mode:",b),b==="ai"&&console.log("Smart Report Debug - AI Logic:",k);const T=c.map(j=>{const V=d.filter(R=>R.family_id===j.family_id);(j.family_number==="1"||j.family_number===1)&&console.log("Family #1 Roles:",V.map(R=>`"${R.role}"`).join(", "));const C={};return h.forEach(R=>{if(R.system){if(R.id==="1"&&(C[R.label]=j.family_number),R.id==="2"){const X=zs(V);C[R.label]=(X==null?void 0:X.name)||"-"}}else if(b==="ai"){const X=k[R.id];if(X)try{const Y=new Function("family","members","helpers",`return ${X}`)(j,V,{calculateAge:dp});C[R.label]=Y!=null&&Y!==""?Y:"-"}catch(G){console.error(`AI Execution Error [${R.label}]:`,G),C[R.label]=kh(R.description,j,V)||"-"}else C[R.label]=kh(R.description,j,V)||"-"}else C[R.label]=kh(R.description,j,V)||"-"}),C});console.log("Smart Report Debug - Sample Data:",T.slice(0,2)),p(T)}catch(T){console.error(T),o("    ")}finally{a(!1)}},S=()=>{const b=At.json_to_sheet(x),k=At.book_new();At.book_append_sheet(k,b," "),Si(k,`Smart_Report_${t==null?void 0:t.name}.xlsx`)};return l.jsxs("div",{className:"min-h-full bg-slate-50/50",dir:"rtl",children:[l.jsx("div",{className:"bg-white border-b border-indigo-100 p-6 mb-8 shadow-sm",children:l.jsxs("div",{className:"max-w-7xl mx-auto flex flex-col md:flex-row md:items-center justify-between gap-4",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("div",{className:"p-3 bg-indigo-600 rounded-2xl shadow-lg shadow-indigo-200",children:l.jsx(GS,{className:"h-6 w-6 text-white"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-black text-slate-800",children:"   (AI)"}),l.jsx("p",{className:"text-slate-500 text-sm font-medium mt-1",children:"        "})]})]}),x.length>0&&l.jsxs("button",{onClick:S,className:"bg-emerald-500 hover:bg-emerald-600 text-white px-6 py-3 rounded-xl font-bold flex items-center gap-2 transition-all shadow-lg shadow-emerald-100 active:scale-95",children:[l.jsx(e0,{className:"h-5 w-5"}),"  Excel"]})]})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 pb-20",children:l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[l.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[l.jsxs("div",{className:"bg-white rounded-[2.5rem] p-8 border border-slate-100 shadow-xl shadow-slate-200/50",children:[l.jsxs("div",{className:"flex items-center justify-between mb-8",children:[l.jsxs("h2",{className:"text-lg font-black text-slate-800 flex items-center gap-2",children:[l.jsx(Hy,{className:"h-5 w-5 text-indigo-500"}),"  "]}),l.jsx("button",{onClick:y,className:"p-2 bg-indigo-50 text-indigo-600 rounded-full hover:bg-indigo-100 transition-colors",title:"  ",children:l.jsx(gi,{className:"h-5 w-5"})})]}),l.jsx("div",{className:"space-y-4 max-h-[50vh] overflow-y-auto px-1 custom-scrollbar",children:l.jsxs(Ar,{initial:!1,children:[i&&l.jsxs(Ze.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},className:"bg-red-50 border border-red-100 p-4 rounded-2xl flex gap-3 text-red-600 text-sm font-bold items-start mb-4",children:[l.jsx(Ho,{className:"h-5 w-5 shrink-0"}),i]}),h.map((b,k)=>l.jsxs(Ze.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,scale:.95},className:`p-5 rounded-2xl border transition-all ${b.system?"bg-slate-50 border-slate-100":"bg-white border-indigo-100 shadow-sm"}`,children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsxs("span",{className:"text-[10px] font-black uppercase tracking-widest text-indigo-400",children:[" #",k+1]}),!b.system&&l.jsx("button",{onClick:()=>w(b.id),className:"text-red-400 hover:text-red-600 p-1",children:l.jsx(nn,{className:"h-4 w-4"})})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("input",{placeholder:"  (:  )",value:b.label,onChange:T=>v(b.id,"label",T.target.value),className:"w-full bg-white border border-slate-200 rounded-xl px-4 py-2 text-sm font-bold focus:ring-2 focus:ring-indigo-100 outline-none transition-all placeholder:text-slate-300"}),l.jsx("textarea",{placeholder:"      ...",value:b.description,onChange:T=>v(b.id,"description",T.target.value),disabled:b.system,rows:2,className:"w-full bg-white border border-slate-200 rounded-xl px-4 py-2 text-sm font-medium focus:ring-2 focus:ring-indigo-100 outline-none transition-all placeholder:text-slate-300 resize-none disabled:bg-slate-50 disabled:text-slate-400"})]})]},b.id))]})}),l.jsx("button",{onClick:_,disabled:s||r||!t,className:"w-full mt-8 bg-indigo-600 hover:bg-indigo-700 disabled:bg-slate-300 text-white py-4 rounded-2xl font-black text-lg shadow-lg shadow-indigo-100 transition-all active:scale-[0.98] flex items-center justify-center gap-3",children:s?l.jsxs(l.Fragment,{children:[l.jsx(YS,{className:"h-6 w-6 animate-spin"}),"  ..."]}):l.jsxs(l.Fragment,{children:[l.jsx(Hy,{className:"h-6 w-6"}),"   "]})})]}),l.jsx("div",{className:"bg-amber-50 rounded-3xl p-6 border border-amber-100",children:l.jsxs("div",{className:"flex gap-4",children:[l.jsx(qS,{className:"h-5 w-5 text-amber-600 shrink-0 mt-1"}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-black text-amber-900 text-sm",children:"  "}),l.jsxs("p",{className:"text-xs text-amber-800/80 mt-1 leading-relaxed",children:["   :",l.jsx("br",{}),'- "    10 "',l.jsx("br",{}),'- "    "',l.jsx("br",{}),'- "    "']})]})]})})]}),l.jsx("div",{className:"lg:col-span-2",children:l.jsxs("div",{className:"bg-white rounded-[2.5rem] border border-slate-100 shadow-xl overflow-hidden h-full flex flex-col",children:[l.jsxs("div",{className:"p-8 border-b border-slate-50 flex items-center justify-between",children:[l.jsxs("h3",{className:"font-black text-slate-800 flex items-center gap-3",children:[l.jsx(q8,{className:"h-5 w-5 text-indigo-500"}),"  ( 10 )"]}),x.length>0&&l.jsxs("span",{className:"bg-indigo-50 text-indigo-600 text-xs font-black px-4 py-1.5 rounded-full",children:[" : ",x.length]})]}),l.jsx("div",{className:"flex-1 overflow-auto custom-scrollbar",children:x.length>0?l.jsxs("table",{className:"w-full border-collapse",children:[l.jsx("thead",{className:"bg-slate-50 sticky top-0",children:l.jsx("tr",{children:h.map(b=>l.jsx("th",{className:"text-right p-5 text-[10px] font-black text-slate-400 uppercase tracking-widest border-b border-slate-100",children:b.label||" "},b.id))})}),l.jsx("tbody",{className:"divide-y divide-slate-50",children:x.slice(0,10).map((b,k)=>l.jsx("tr",{className:"hover:bg-indigo-50/20 transition-colors",children:h.map(T=>l.jsx("td",{className:"p-5 text-sm font-bold text-slate-600",children:b[T.label]??"-"},T.id))},k))})]}):l.jsxs("div",{className:"h-full flex flex-col items-center justify-center p-20 text-center",children:[l.jsx("div",{className:"w-24 h-24 bg-slate-50 rounded-full flex items-center justify-center mb-6",children:l.jsx(e0,{className:"h-10 w-10 text-slate-200"})}),l.jsx("h4",{className:"text-lg font-black text-slate-400",children:"   "}),l.jsx("p",{className:"text-slate-300 text-sm mt-2",children:'      " " '})]})})]})})]})}),l.jsx("style",{jsx:!0,children:`
                .custom-scrollbar::-webkit-scrollbar { width: 5px; height: 5px; }
                .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
                .custom-scrollbar::-webkit-scrollbar-thumb { background: #e2e8f0; border-radius: 10px; }
                .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #cbd5e1; }
            `})]})}function qr({children:e}){const{user:t,logout:r}=on(),{selectedCamp:n,camps:s,changeCamp:a,loading:i}=Nn(),o=Oa(),c=Ra(),u=E.useRef(null),[d,f]=E.useState(!1),[h,m]=E.useState(0),[x,p]=E.useState(!1),g=()=>{r(),o("/login")};E.useEffect(()=>{p(!1)},[c.pathname]),E.useEffect(()=>{(async()=>{if((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="system_admin"){const k=await lk();m(k.length)}})()},[t]),E.useEffect(()=>{const b=()=>{u.current&&u.current.scrollTop>300?f(!0):f(!1)},k=u.current;return k&&k.addEventListener("scroll",b),()=>k==null?void 0:k.removeEventListener("scroll",b)},[]);const y=()=>{var b;(b=u.current)==null||b.scrollTo({top:0,behavior:"smooth"})},w=[{name:"",path:"/",icon:Wy},{name:" ",path:"/entry",icon:r0},{name:" ",path:"/families",icon:vn},{name:"  ",path:"/aid-import",icon:Fs},{name:" ",path:"/family-profile",icon:Qm},{name:" ",path:"/search",icon:Ai},{name:" ",path:"/custom-report",icon:vo},{name:"  (AI)",path:"/smart-report",icon:GS},{name:"  ",path:"/offline",icon:Zm}];(t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="system_admin"?(w.push({name:"",path:"/notifications",icon:Ym,badge:h}),w.push({name:" ",path:"/settings",icon:vo}),w.push({name:" ",path:"/backup",icon:XS})):((t==null?void 0:t.role)==="manager"||(t==null?void 0:t.role)==="user"||(t==null?void 0:t.role)==="supervisor")&&w.push({name:" ",path:"/settings",icon:Qm});const v=c.pathname==="/settings",_=!i&&!n&&!v&&s.length>0,S=!i&&s.length===0&&!v;return l.jsxs("div",{className:"flex h-screen overflow-hidden bg-slate-50",children:[l.jsxs("div",{className:"md:hidden fixed top-0 w-full bg-white z-40 px-4 py-3 shadow-sm flex items-center justify-between h-16",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"bg-white p-0.5 rounded-lg",children:l.jsx("img",{src:"/favicon.png",alt:"Logo",className:"h-7 w-7 object-contain"})}),l.jsx("span",{className:"font-bold text-gray-800",children:" "})]}),l.jsx("button",{onClick:()=>p(!0),className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg",children:l.jsx(G8,{className:"h-6 w-6"})})]}),x&&l.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 md:hidden backdrop-blur-sm",onClick:()=>p(!1)}),l.jsxs("nav",{className:`
                fixed inset-y-0 right-0 z-50 w-[85vw] max-w-xs bg-white shadow-2xl transform transition-transform duration-300 ease-in-out
                md:relative md:w-64 md:translate-x-0 md:shadow-lg md:flex md:flex-col md:justify-between md:shrink-0
                ${x?"translate-x-0":"translate-x-full md:translate-x-0"}
                pt-4 md:pt-6 pb-4 px-3 md:px-4 flex flex-col justify-between overflow-y-auto h-full
            `,children:[l.jsxs("div",{children:[l.jsx("div",{className:"md:hidden flex justify-end mb-2",children:l.jsx("button",{onClick:()=>p(!1),className:"p-1.5 text-gray-500 hover:bg-red-50 hover:text-red-600 rounded-full transition",children:l.jsx(Cs,{className:"h-5 w-5"})})}),l.jsxs("div",{className:"hidden md:flex items-center gap-3 px-2 mb-6",children:[l.jsx("div",{className:"bg-white p-1 rounded-lg shadow-sm border border-gray-100",children:l.jsx("img",{src:"/favicon.png",alt:"Logo",className:"h-8 w-8 object-contain"})}),l.jsxs("div",{children:[l.jsx("h2",{className:"font-bold text-lg text-gray-800",children:" "}),l.jsxs("p",{className:"text-xs text-gray-500",children:[" ",(t==null?void 0:t.fullName)||(t==null?void 0:t.username)]})]})]}),l.jsx("div",{className:"md:hidden mb-4 px-2",children:l.jsxs("p",{className:"text-xs font-bold text-gray-800",children:[" ",(t==null?void 0:t.fullName)||(t==null?void 0:t.username)]})}),l.jsxs("div",{className:"mb-6 px-1",children:[l.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase mb-2 block",children:" /  "}),l.jsxs("div",{className:"relative",children:[l.jsxs("select",{value:(n==null?void 0:n.camp_id)||"",onChange:b=>{const k=s.find(T=>T.camp_id===b.target.value);a(k||null),p(!1)},className:"w-full appearance-none bg-indigo-50 border border-indigo-100 text-indigo-900 text-xs md:text-sm rounded-xl px-2.5 md:px-3 py-2 md:py-2.5 font-bold outline-none focus:ring-2 focus:ring-indigo-500 cursor-pointer",children:[l.jsx("option",{value:"",disabled:!0,children:"--   --"}),s.map(b=>l.jsx("option",{value:b.camp_id,children:b.name},b.camp_id))]}),l.jsx(Zd,{className:"absolute left-2 md:left-3 top-1/2 -translate-y-1/2 h-3.5 md:h-4 w-3.5 md:w-4 text-indigo-400 pointer-events-none"})]})]}),l.jsx("div",{className:"space-y-2",children:w.map(b=>l.jsxs(Q1,{to:b.path,className:({isActive:k})=>`flex items-center gap-2 md:gap-3 px-3 md:px-4 py-2.5 md:py-3 rounded-xl transition-all text-sm md:text-base ${k?"bg-indigo-50 text-indigo-700 shadow-sm font-medium":"text-gray-600 hover:bg-gray-100 hover:text-gray-900"}`,children:[l.jsxs("div",{className:"flex items-center gap-2 md:gap-3 flex-1 min-w-0",children:[l.jsx(b.icon,{className:"h-5 w-5 shrink-0"}),l.jsx("span",{className:"truncate",children:b.name})]}),b.badge>0&&l.jsx("span",{className:"bg-red-500 text-white text-xs font-bold px-2 py-0.5 rounded-full shrink-0",children:b.badge})]},b.path))})]}),l.jsxs("div",{className:"mt-auto space-y-2 pt-6",children:[s.length===0&&((t==null?void 0:t.role)==="admin"||(t==null?void 0:t.role)==="system_admin")&&l.jsxs("div",{className:"bg-yellow-50 p-2.5 md:p-3 rounded-xl border border-yellow-200 text-xs text-yellow-800 mb-2",children:[l.jsx("p",{className:"font-bold mb-1",children:" "}),"   .      ."]}),l.jsxs("button",{onClick:g,className:"w-full flex items-center gap-2 md:gap-3 px-3 md:px-4 py-2.5 md:py-3 rounded-xl text-sm md:text-base text-red-600 hover:bg-red-50 hover:text-red-700 transition-all",children:[l.jsx(H8,{className:"h-5 w-5"}),l.jsx("span",{className:"font-medium",children:" "})]})]})]}),l.jsxs("main",{ref:u,className:"flex-1 overflow-y-auto p-4 md:p-8 relative scroll-smooth pt-20 md:pt-8 w-full",children:[n&&l.jsxs("div",{className:"mb-6 flex items-center gap-2 text-indigo-900 bg-indigo-50/50 p-3 rounded-xl border border-indigo-100 w-fit",children:[l.jsx(Jm,{className:"h-5 w-5 text-indigo-600"}),l.jsx("span",{className:"font-bold",children:"   :"}),l.jsx("span",{className:"bg-white px-3 py-0.5 rounded-lg shadow-sm border border-indigo-100 font-black text-indigo-700",children:n.name})]}),_&&l.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-white rounded-2xl p-8 max-w-md w-full shadow-2xl text-center space-y-6",children:[l.jsx("div",{className:"mx-auto w-16 h-16 bg-indigo-100 rounded-full flex items-center justify-center",children:l.jsx(Jm,{className:"h-8 w-8 text-indigo-600"})}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"  "}),l.jsx("p",{className:"text-gray-500",children:"            ."})]}),l.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl border border-gray-100",children:[l.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase mb-2 block text-right",children:" / "}),l.jsxs("div",{className:"relative",children:[l.jsxs("select",{value:(n==null?void 0:n.camp_id)||"",onChange:b=>{const k=s.find(T=>T.camp_id===b.target.value);a(k||null)},className:"w-full appearance-none bg-white border border-gray-300 text-gray-900 text-lg rounded-xl px-4 py-3 font-bold outline-none focus:ring-2 focus:ring-indigo-500 cursor-pointer",children:[l.jsx("option",{value:"",disabled:!0,children:"--    --"}),s.map(b=>l.jsx("option",{value:b.camp_id,children:b.name},b.camp_id))]}),l.jsx(Zd,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 pointer-events-none"})]})]})]})}),S&&l.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-white rounded-2xl p-8 max-w-md w-full shadow-2xl text-center space-y-6",children:[l.jsx("div",{className:"mx-auto w-16 h-16 bg-yellow-100 rounded-full flex items-center justify-center",children:l.jsx(vo,{className:"h-8 w-8 text-yellow-600"})}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"  "}),l.jsxs("p",{className:"text-gray-500",children:["       .",l.jsx("br",{}),"      ."]})]}),l.jsx("button",{onClick:()=>o("/settings"),className:"w-full bg-indigo-600 text-white py-3 rounded-xl font-bold hover:bg-indigo-700 transition",children:"   "})]})}),l.jsx("div",{className:"max-w-7xl mx-auto pb-24 md:pb-10",children:e}),l.jsx("div",{className:"md:hidden fixed bottom-0 left-0 right-0 bg-white/80 backdrop-blur-lg border-t border-gray-100 px-6 py-2 flex justify-between items-center z-40 shadow-[0_-4px_20px_rgba(0,0,0,0.05)]",children:[{icon:Wy,path:"/",label:""},{icon:r0,path:"/entry",label:""},{icon:vn,path:"/families",label:""},{icon:vo,path:"/custom-report",label:""}].map(b=>l.jsxs(Q1,{to:b.path,className:({isActive:k})=>`flex flex-col items-center gap-1 transition-all ${k?"text-indigo-600":"text-gray-400"}`,children:[l.jsx(b.icon,{className:"h-6 w-6"}),l.jsx("span",{className:"text-[10px] font-bold",children:b.label})]},b.path))}),d&&l.jsx("button",{onClick:y,className:"fixed bottom-20 left-6 bg-indigo-600/90 hover:bg-indigo-700 text-white p-3 rounded-full shadow-lg transition-all animate-bounce hover:animate-none z-50 md:bottom-8 md:left-8 backdrop-blur-sm",title:" ",children:l.jsx(L8,{className:"h-6 w-6"})})]})]})}const Cr=({children:e})=>{const{user:t,loading:r}=on();return r?l.jsx("div",{className:"p-10 text-center",children:" ..."}):t?e:l.jsx(jj,{to:"/login"})};function _W(){return l.jsx(q5,{children:l.jsx(Y5,{children:l.jsx(Uj,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:l.jsxs(Fj,{children:[l.jsx(rr,{path:"/login",element:l.jsx(J8,{})}),l.jsx(rr,{path:"/check",element:l.jsx(vW,{})}),l.jsx(rr,{path:"/",element:l.jsx(Cr,{children:l.jsx(qr,{children:l.jsx(Q8,{})})})}),l.jsx(rr,{path:"/entry",element:l.jsx(Cr,{children:l.jsx(qr,{children:l.jsx(Zz,{})})})}),l.jsx(rr,{path:"/families",element:l.jsx(Cr,{children:l.jsx(qr,{children:l.jsx(eW,{})})})}),l.jsx(rr,{path:"/family-profile",element:l.jsx(Cr,{children:l.jsx(qr,{children:l.jsx(lW,{})})})}),l.jsx(rr,{path:"/edit/:familyId",element:l.jsx(Cr,{children:l.jsx(qr,{children:l.jsx(tW,{})})})}),l.jsx(rr,{path:"/aid/:familyId",element:l.jsx(Cr,{children:l.jsx(qr,{children:l.jsx(rW,{})})})}),l.jsx(rr,{path:"/aid-import",element:l.jsx(Cr,{children:l.jsx(qr,{children:l.jsx(nW,{})})})}),l.jsx(rr,{path:"/search",element:l.jsx(Cr,{children:l.jsx(qr,{children:l.jsx(aW,{})})})}),l.jsx(rr,{path:"/custom-report",element:l.jsx(Cr,{children:l.jsx(qr,{children:l.jsx(oW,{})})})}),l.jsx(rr,{path:"/smart-report",element:l.jsx(Cr,{children:l.jsx(qr,{children:l.jsx(wW,{})})})}),l.jsx(rr,{path:"/notifications",element:l.jsx(Cr,{children:l.jsx(qr,{children:l.jsx(uW,{})})})}),l.jsx(rr,{path:"/settings",element:l.jsx(Cr,{children:l.jsx(qr,{children:l.jsx(dW,{})})})}),l.jsx(rr,{path:"/backup",element:l.jsx(Cr,{children:l.jsx(qr,{children:l.jsx(fW,{})})})}),l.jsx(rr,{path:"/cards",element:l.jsx(Cr,{children:l.jsx(xW,{})})}),l.jsx(rr,{path:"/print-cards",element:l.jsx(Cr,{children:l.jsx(cW,{})})}),l.jsx(rr,{path:"/offline",element:l.jsx(Cr,{children:l.jsx(qr,{children:l.jsx(gW,{})})})})]})})})})}const bW="modulepreload",kW=function(e){return"/"+e},p_={},SW=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));s=Promise.allSettled(r.map(c=>{if(c=kW(c),c in p_)return;p_[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":bW,u||(f.as="script"),f.crossOrigin="",f.href=c,o&&f.setAttribute("nonce",o),document.head.appendChild(f),u)return new Promise((h,m)=>{f.addEventListener("load",h),f.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return s.then(i=>{for(const o of i||[])o.status==="rejected"&&a(o.reason);return t().catch(a)})};function EW(e={}){const{immediate:t=!1,onNeedRefresh:r,onOfflineReady:n,onRegistered:s,onRegisteredSW:a,onRegisterError:i}=e;let o,c;const u=async(f=!0)=>{await c};async function d(){if("serviceWorker"in navigator){if(o=await SW(async()=>{const{Workbox:f}=await import("./workbox-window.prod.es5-vqzQaGvo.js");return{Workbox:f}},[]).then(({Workbox:f})=>new f("/sw.js",{scope:"/",type:"classic"})).catch(f=>{i==null||i(f)}),!o)return;o.addEventListener("activated",f=>{(f.isUpdate||f.isExternal)&&window.location.reload()}),o.addEventListener("installed",f=>{f.isUpdate||n==null||n()}),o.register({immediate:t}).then(f=>{a?a("/sw.js",f):s==null||s(f)}).catch(f=>{i==null||i(f)})}}return c=d(),u}const NW=EW({onNeedRefresh(){confirm("  .   ")&&NW(!0)},onOfflineReady(){console.log("App is ready for offline work.")}});Sh.createRoot(document.getElementById("root")).render(l.jsx(N_.StrictMode,{children:l.jsx(_W,{})}));
